{"items":[{"comments":[{"comment_id":134575807,"body":"This is not a homework-solving site. Please provide what you&#39;ve tried so far and what is it that you are struggling concretely."},{"comment_id":134576022,"body":"Hi  @Valerij Dobler, this is not homework, I stuck in that case and I minimize the code because of customer policy. I will update my code in the next day. Thank for your comment!"}],"last_activity_date":1684852800,"question_id":76315659,"body":"<p>I am facing with a block in my task.\nLet me describe the issue.</p>\n<p>I have a class</p>\n<pre><code>public class MyEntity {   \n     private String version;    \n     private LocalDate effectiveDate; \n}\n</code></pre>\n<p>My table:</p>\n<pre><code>MyTable(version varchar(255), effective_date datetime)\n</code></pre>\n<p>My task is insert a new record into a table with some condition.</p>\n<p>my sample request:</p>\n<pre><code>{\n  &quot;version&quot;:&quot;111.21&quot;,\n  &quot;effective_date&quot;:&quot;23-May-2023\n}\n</code></pre>\n<p>So I need to implement a method in my service class that solve this issue.</p>\n<pre><code>public ResponseBody&lt;Object&gt; saveVersion(NewVersionRequest request){\n   //get current version\n   //if(request.getVersion().equals(currentVersion.getVersion())...\n}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/ijE0N.png\" rel=\"nofollow noreferrer\">The example result in table</a> - please take a look</p>\n<p>There is a current version is 0.1 with effective_date is 10-May-23.\nThe following version that can insert into the table base on some conditions:</p>\n<ol>\n<li>not duplicate version.</li>\n<li>the effective_date of new version must after the present(LocalDate.now()) and not duplicate</li>\n<li>the new version must higher than the current version and the effective_date must higher than the current effective_date.</li>\n<li>the new version can lower than the other version that existed in table, and that effective_date must before the version that existed in the table (for example, please take a look on my photo).</li>\n<li>the new the new version can highest, and that effective_date too.</li>\n</ol>\n<p>Thank you!</p>\n"},{"comments":[{"comment_id":134573436,"body":"What does <code>org.springframework.security</code> logging to DEBUG say?"},{"comment_id":134573498,"body":"Also the toString from your Principal does have the roles you assume (Granted Authoriities); are you missing some mapping for the roles from the access token into your principal?"},{"comment_id":134575836,"body":"What exactly do you mean with missing some mapping? where do i miss it?"},{"comment_id":134576035,"body":"That&#39;s not Spring Security DEBUG logs. You have to change your log configuration."}],"last_activity_date":1684852770,"question_id":76313881,"body":"<p>Vaadin application (JAVA: 19, Vaadin: 24.0.5, Spring boot: 3.0.6)\ndidnt get roles after sso login</p>\n<p>I have a vaadin project and want to secure my views. The <code>MainView.java</code> should allow access to user with <code>@RolesAllowed({&quot;ROLE_ADMIN&quot;, &quot;ADMIN&quot;})</code>. After the login through my sso-service, the user is authenticated and got the necessary roles:</p>\n<pre><code>Retrieved SecurityContextImpl [Authentication=OAuth2AuthenticationToken [Principal=Name: [USERTEST], Granted Authorities: [[OAUTH2_USER, SCOPE_company]], User Attributes: [{userCode=USERTEST, userTeam=T_X, userEmail=user@company.at, userKtksnr=0, roles=[ADMIN, ROLE_ADMIN], principal={authorities=[], details={remoteAddress=127.0.0.1, sessionId=null, tokenValue=H7G7LR-Ghiq5BmPFqcuGrAt5ZxI, tokenType=Bearer, decodedDetails=null}, authenticated=true, userAuthentication={authorities=[], details={remoteAddress=0:0:0:0:0:0:0:1, sessionId=BFE069B0209E3DADDEFBCFC1BACB23A9}, authenticated=true, principal={userCode=USERTEST, userTeam=T_X, userEmail=user@company.at, userKtksnr=0, roles=[ADMIN, ROLE_ADMIN]}, credentials=null, name=User{userCode='USERTEST', userTeam='T_X', userEmail='user@company.at', userKtksnr=0, roles=[ADMIN, ROLE_ADMIN]}}, clientOnly=false, credentials=, oauth2Request={clientId=company, scope=[company], requestParameters={code=PSVUul, grant_type=authorization_code, scope=company, response_type=code, state=R6czQI2wlFbfNwfqoulg6ckrthGnTS4JJjS7nkdAlg0=, redirect_uri=http://localhost:7060/company/login/oauth2/code/company, client_id=company}, resourceIds=[], authorities=[], approved=true, refresh=false, redirectUri=http://localhost:7060/company/login/oauth2/code/company, responseTypes=[code], extensions={}, refreshTokenRequest=null, grantType=authorization_code}, principal={userCode=USERTEST, userTeam=T_X, userEmail=user@company.at, userKtksnr=0, roles=[ADMIN, ROLE_ADMIN]}, name=User{userCode='USERTEST', userTeam='T_X', userEmail='user@company.at', userKtksnr=0, roles=[ADMIN, ROLE_ADMIN]}}, applicationRoles=ADMIN,ROLE_ADMIN}], Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=5278B052E19AD339C2CCF1A20E5ACA8D], Granted Authorities=[OAUTH2_USER, SCOPE_company]]]\n</code></pre>\n<p>A TestView.java with the annotation <code>@PermitAll</code> is working as espected (without authentication redirect to SSO and with authentication View is visible).</p>\n<p>But the MainView.java with annotation <code>@RolesAllowed({&quot;ROLE_ADMIN&quot;, &quot;ADMIN&quot;})</code> the access is always denied:</p>\n<p><strong>Client Application:</strong></p>\n<p>MainView.java</p>\n<pre><code>import com.vaadin.flow.component.html.*;\nimport com.vaadin.flow.component.orderedlayout.VerticalLayout;\nimport com.vaadin.flow.router.PageTitle;\nimport com.vaadin.flow.router.Route;\nimport jakarta.annotation.security.RolesAllowed;\n\n@PageTitle(&quot;MainView&quot;)\n@Route(value = &quot;&quot;, layout = MainLayout.class)\n@RolesAllowed({&quot;ROLE_ADMIN&quot;, &quot;ADMIN&quot;})\npublic class MainView extends VerticalLayout {\n    public MainView() {\n        H3 title = new H3(&quot;Application&quot;);\n        add(title);\n    }\n}\n</code></pre>\n<p>UiSecurityConfig.java</p>\n<pre class=\"lang-java prettyprint-override\"><code>import com.vaadin.flow.spring.security.VaadinWebSecurity;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.web.util.matcher.AntPathRequestMatcher;\n\n@EnableWebSecurity\n@Configuration\npublic class UiSecurityConfig extends VaadinWebSecurity {\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http.authorizeHttpRequests().requestMatchers(new AntPathRequestMatcher(&quot;/public/**&quot;))\n                .permitAll()\n                .and()\n                .oauth2Login() ;\n        super.configure(http);\n    }\n}\n</code></pre>\n<p>application.yml</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>server:\n  port: 7060\n  servlet:\n    context-path: /application\nspring:\n  security:\n    oauth2:\n      client:\n        registration:\n          company:\n            client-id: application\n            client-secret:\n            scope: MAM\n            authorization-grant-type: authorization_code\n            redirect-uri: http://localhost:7060/application/login/oauth2/code/company\n        provider:\n          company:\n            authorization-uri: http://localhost:9090/sso-service/auth/oauth/authorize\n            token-uri: http://localhost:9090/sso-service/auth/oauth/token\n            user-info-uri: http://localhost:9090/sso-service/auth/user/me\n            user-name-attribute: userCode\nresourceserver:\n  api:\n    project:\n      url: http://localhost:9090/sso-service/auth/user/me\nlogging:\n  level:\n    org:\n      springframework:\n        security: DEBUG\n</code></pre>\n<p><strong>Spring-oauth2-SSO-Application:</strong></p>\n<p>Here is the custom ´UserController´ where ´/user/me´ is called and the User get all the information:</p>\n<pre><code>@RestController\npublic class UserController {\n\nprivate QueryUserDataTemplate queryTemplate;\n\n@Autowired\npublic UserController(QueryUserDataTemplate queryTemplate) {\n    this.queryTemplate = queryTemplate;\n}\n\n@GetMapping(&quot;/user/me&quot;)\npublic User user(Principal principal) {\n    User user = (User) SecurityContextHolder.getContext().getAuthentication().getPrincipal();\n\n    String clientId = ((OAuth2Authentication) SecurityContextHolder.getContext().getAuthentication()).getOAuth2Request().getClientId();\n    List&lt;String&gt; roleList = queryTemplate.queryForApplicationRoles(user.getSybCode(), clientId);\n    if (roleList != null) {\n        user.setRoles((Collection) roleList);\n    }\n    return new UserResult(principal, user.getSybCode(), user.getSybTeam(), user.getSybEmail(), user.getSybKtksnr(), user.getRoles(), user.getAuthorities());\n}\n\n\npublic static class UserResult extends User {\n\n    private final Principal principal;\n\n    private UserResult(Principal principal, String username, String sybTeam, String sybEmail, Long sybktksnr,\n                       Collection applicationRoles, List&lt;GrantedAuthority&gt; authorities) {\n        super(username, sybTeam, sybEmail, sybktksnr, applicationRoles, authorities);\n        this.principal = principal;\n    }\n\n    public Principal getPrincipal() {\n        return principal;\n    }\n}\n</code></pre>\n<p>If you need any other info, please let me know!</p>\n<p>EDIT:\nDEBUG INFO:</p>\n<pre><code>Request received for POST '/?v-r=uidl&amp;v-uiId=0':\n\norg.apache.catalina.connector.RequestFacade@24c0d321\n\nservletPath:/\npathInfo:null\nheaders: \nhost: localhost:7060\nconnection: keep-alive\ncontent-length: 529\nsec-ch-ua: &quot;Google Chrome&quot;;v=&quot;113&quot;, &quot;Chromium&quot;;v=&quot;113&quot;, &quot;Not-A.Brand&quot;;v=&quot;24&quot;\nsec-ch-ua-platform: &quot;Windows&quot;\nsec-ch-ua-mobile: ?0\nuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36\ncontent-type: application/json; charset=UTF-8\naccept: */*\norigin: http://localhost:7060\nsec-fetch-site: same-origin\nsec-fetch-mode: cors\nsec-fetch-dest: empty\nreferer: http://localhost:7060/mam/\naccept-encoding: gzip, deflate, br\naccept-language: de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7\ncookie: JSESSIONID=F95188E5E420170BFF950B0C8D6BB8C6\n\n\nSecurity filter chain: [\n  DisableEncodeUrlFilter\n  WebAsyncManagerIntegrationFilter\n  SecurityContextHolderFilter\n  HeaderWriterFilter\n  CsrfFilter\n  LogoutFilter\n  OAuth2AuthorizationRequestRedirectFilter\n  OAuth2LoginAuthenticationFilter\n  DefaultLoginPageGeneratingFilter\n  DefaultLogoutPageGeneratingFilter\n  RequestCacheAwareFilter\n  SecurityContextHolderAwareRequestFilter\n  AnonymousAuthenticationFilter\n  ExceptionTranslationFilter\n  AuthorizationFilter\n]\n</code></pre>\n"},{"last_activity_date":1684852724,"question_id":76315961,"body":"<p>I am having multiple API tests which have different sets of multipart input values which vary dynamically,\nI want to create 1 common function which can accept these varying multiple multipart into a single multipart line so that I don't have to create multiple response functions to accept these varying values.</p>\n<pre><code>public test1(){\n| KEY| VALUE |\n|key1 | value1|\n|key2 | value2|\n|key3 | value3|\n}\n\npublic test2(){\n| KEY| VALUE |\n|key1 | value1|\n|key2 | value2|\n}\n\npublic test3(){\n| KEY| VALUE |\n|key1 | value1|\n|key2 | value2|\n|key3 | value3|\n|key4 | value4|\n|key5 | value5|\n}\n</code></pre>\n<p><strong>Actual:</strong></p>\n<pre><code> public void common() {\n    Response response = given().urlEncodingEnabled(true).config(RestAssured.config()\n                            .encoderConfig(encoderConfig().encodeContentTypeAs(&quot;multipart/form-data&quot;, ContentType.TEXT)))\n                            .multiPart(&quot;key1&quot;,&quot;value1&quot;)\n                            .multiPart(&quot;key2&quot;,&quot;value2&quot;)\n                            .multiPart(&quot;key3&quot;,&quot;value3&quot;)\n                            .multiPart(&quot;key4&quot;,&quot;value4&quot;)\n                            .multiPart(&quot;key5&quot;,&quot;value5&quot;)\n                            .config(RestAssured.config()\n                            .contentType(ContentType.JSON)\n                            .headers(request.getHeaders())\n                            .post(path);\n}\n</code></pre>\n<p><strong>Expected:</strong></p>\n<pre><code> public void common() {\n    given().urlEncodingEnabled(true).config(RestAssured.config()\n    .encoderConfig(encoderConfig().encodeContentTypeAs(&quot;multipart/form-data&quot;, ContentType.TEXT)))\n    .multiPart(&quot;key1&quot;,&quot;value1&quot;;&quot;key2&quot;,&quot;value2&quot;;&quot;key3&quot;,&quot;value3&quot;;&quot;key4&quot;,&quot;value4&quot;;&quot;key5&quot;,&quot;value5&quot;)\n    .config(RestAssured.config()\n    .contentType(ContentType.JSON)\n    .headers(request.getHeaders())\n    .post(path);\n}\n</code></pre>\n<p>Any pointers will be appreciated.</p>\n"},{"last_activity_date":1684852582,"question_id":76315777,"body":"<p>I have an object array like below.</p>\n<pre><code>[\n    {\n        &quot;defName&quot;: &quot;Project&quot;,\n        &quot;defDesc&quot;: &quot;Project 1&quot;,\n        &quot;defID&quot;: &quot;abcd123&quot;,\n        &quot;defClass&quot;: &quot;class1&quot;\n    },\n    {\n        &quot;defName&quot;: &quot;Project&quot;,\n        &quot;defDesc&quot;: &quot;Project 2&quot;,\n        &quot;defID&quot;: &quot;asdoihw1345&quot;,\n        &quot;defClass&quot;: &quot;class2&quot;\n    },\n    {\n        &quot;defName&quot;: &quot;Project&quot;,\n        &quot;defDesc&quot;: &quot;Project 3&quot;,\n        &quot;defID&quot;: &quot;ewrwu123&quot;,\n        &quot;defClass&quot;: &quot;class3&quot;\n    },\n    {\n        &quot;defName&quot;: &quot;Product&quot;,\n        &quot;defDesc&quot;: &quot;Product 1&quot;,\n        &quot;defID&quot;: &quot;pgkorejgoi1234&quot;,\n        &quot;defClass&quot;: &quot;class1&quot;\n    },\n    {\n        &quot;defName&quot;: &quot;Product&quot;,\n        &quot;defDesc&quot;: &quot;Product 2&quot;,\n        &quot;defID&quot;: &quot;asadsad2343&quot;,\n        &quot;defClass&quot;: &quot;class2&quot;\n    },\n    {\n        &quot;defName&quot;: &quot;Product&quot;,\n        &quot;defDesc&quot;: &quot;Product 3&quot;,\n        &quot;defID&quot;: &quot;4dgaksld&quot;,\n        &quot;defClass&quot;: &quot;class3&quot;\n    }\n]\n</code></pre>\n<p>I have converted into a <code>List&lt;Defintion&gt;</code>. Now I'm trying to convert to into a <code>Map&lt;String, Map&lt;String, Defintion&gt;</code> where the first map key is the <code>defName</code> and the second map key will be the <code>defDesc</code>. It is confirmed that <code>defDesc</code> will be unique for specific <code>defName</code>.</p>\n<p>Currently I'm doing in the following way.</p>\n<pre><code>List&lt;Definition&gt; definitions = // Got from JSON\nMap&lt;String, List&lt;Definition&gt;&gt; definitionByName = definitions.stream().collect(Collectors.groupingBy(Definition::getDefName));\nMap&lt;String, Map&lt;String, Definition&gt;&gt; definitionMap = new HashMap&lt;&gt;();\ndefinitionByName.forEach((name, definitionList) -&gt; {\n    Map&lt;String, Definition&gt; definitionDescMap = definitionList.stream()\n            .collect(Collectors.toMap(def -&gt; def.getDefDesc(), Function.identity()));\n    definitionMap.put(name, definitionDescMap);\n});\n</code></pre>\n<p>Can we do it in Single statement? I'm using Java 8 now. Java 8 and new versions solutions are welcome for future references.</p>\n"},{"last_activity_date":1684852553,"question_id":76315938,"body":"<p>My app has a function to load an image from gallery or take a photo from camera.\nWhen using either, it lets you take the image, or choose an image, it then shows the image you have selected, all ok...However when you click next, it is supposed to process the image to the required filter, however it just returns to the home screen.\nThe code for the process after choosing is;\nIt works on older android OS devices (around 29API)</p>\n<pre><code>protected void onSizeChanged(int w, int h, int oldw, int oldh) {\n        // TODO Auto-generated method stub\n        super.onSizeChanged(w, h, oldw, oldh);\n        width = w;\n        height = h;\n\n        Bitmap bitmap = null;\n    \n        try {\n            bitmap = MediaStore.Images.Media.getBitmap(\n                    this.getContext().getContentResolver(), getUri());\n            bitmap = bitmap.copy(bitmap.getConfig(), true);\n\n        float ratioh = (float)height / (float)bitmap.getHeight();\n                float ratiow = (float)width / (float)bitmap.getWidth();\n                float ratio = Math.max(ratioh, ratiow);\n                bitmap = Bitmap.createScaledBitmap(bitmap,\n                        (int)(bitmap.getWidth() * ratio), (int)(bitmap.getHeight() * ratio) , true);\n                if(bitmap.getHeight() == h)\n                {\n                    mBitmap = Bitmap.createBitmap(bitmap,bitmap.getWidth() /2 - w/2,0,w,bitmap.getHeight());\n                }else if(bitmap.getWidth() == w)\n                {                   \n                    mBitmap = Bitmap.createBitmap(bitmap,0,bitmap.getHeight() / 2 - h/2,bitmap.getWidth(),h);\n                }\n                \n                mIvNormal.setImageBitmap(mBitmap);\n                \n            \n        } catch (FileNotFoundException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        if(bitmap!=null &amp;&amp; !bitmap.isRecycled())\n        {\n            bitmap.recycle();\n            bitmap = null;\n        }\n\n\n\n \n</code></pre>\n"},{"comments":[{"comment_id":134572124,"body":"That error simply does not relate to the shown code. Please show e.g. the full stacktrace."}],"answers":[{"answer_id":76315440,"body":"<p>To upload an object to an Amazon S3 bucket, make sure you are using the recommended SDK version, which is <a href=\"https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/home.html\" rel=\"nofollow noreferrer\">AWS SDK for Java V2</a>. You will find many examples of Java and S3 operations in the AWS Code Library.</p>\n<p><a href=\"https://docs.aws.amazon.com/code-library/latest/ug/s3_example_s3_PutObject_section.html\" rel=\"nofollow noreferrer\">Upload an object to an Amazon S3 bucket using an AWS SDK</a></p>\n<p>Here is the complete code example:</p>\n<pre><code>/*\n   Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n   SPDX-License-Identifier: Apache-2.0\n*/\npackage com.example.s3;\n\n// snippet-start:[s3.java2.s3_object_upload.import]\nimport software.amazon.awssdk.auth.credentials.ProfileCredentialsProvider;\nimport software.amazon.awssdk.core.sync.RequestBody;\nimport software.amazon.awssdk.regions.Region;\nimport software.amazon.awssdk.services.s3.S3Client;\nimport software.amazon.awssdk.services.s3.model.PutObjectRequest;\nimport software.amazon.awssdk.services.s3.model.S3Exception;\nimport java.io.File;\nimport java.util.HashMap;\nimport java.util.Map;\n// snippet-end:[s3.java2.s3_object_upload.import]\n\n/**\n * Before running this Java V2 code example, set up your development environment, including your credentials.\n *\n * For more information, see the following documentation topic:\n *\n * https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/get-started.html\n */\n\npublic class PutObject {\n\n    public static void main(String[] args) {\n        final String usage = &quot;\\n&quot; +\n            &quot;Usage:\\n&quot; +\n            &quot;  &lt;bucketName&gt; &lt;objectKey&gt; &lt;objectPath&gt; \\n\\n&quot; +\n            &quot;Where:\\n&quot; +\n            &quot;  bucketName - The Amazon S3 bucket to upload an object into.\\n&quot; +\n            &quot;  objectKey - The object to upload (for example, book.pdf).\\n&quot; +\n            &quot;  objectPath - The path where the file is located (for example, C:/AWS/book2.pdf). \\n\\n&quot; ;\n\n        if (args.length != 3) {\n            System.out.println(usage);\n            System.exit(1);\n        }\n\n        String bucketName = args[0];\n        String objectKey = args[1];\n        String objectPath = args[2];\n        ProfileCredentialsProvider credentialsProvider = ProfileCredentialsProvider.create();\n        Region region = Region.US_EAST_1;\n        S3Client s3 = S3Client.builder()\n            .region(region)\n            .credentialsProvider(credentialsProvider)\n            .build();\n\n        putS3Object(s3, bucketName, objectKey, objectPath);\n        s3.close();\n    }\n\n    // snippet-start:[s3.java2.s3_object_upload.main]\n    // This example uses RequestBody.fromFile to avoid loading the whole file into memory.\n    public static void putS3Object(S3Client s3, String bucketName, String objectKey, String objectPath) {\n        try {\n            Map&lt;String, String&gt; metadata = new HashMap&lt;&gt;();\n            metadata.put(&quot;x-amz-meta-myVal&quot;, &quot;test&quot;);\n            PutObjectRequest putOb = PutObjectRequest.builder()\n                .bucket(bucketName)\n                .key(objectKey)\n                .metadata(metadata)\n                .build();\n\n            s3.putObject(putOb, RequestBody.fromFile(new File(objectPath)));\n            System.out.println(&quot;Successfully placed &quot; + objectKey +&quot; into bucket &quot;+bucketName);\n\n        } catch (S3Exception e) {\n            System.err.println(e.getMessage());\n            System.exit(1);\n        }\n    }\n   // snippet-end:[s3.java2.s3_object_upload.main]\n}\n</code></pre>\n"}],"last_activity_date":1684852532,"question_id":76313449,"body":"<ul>\n<li>I want to: upload a file to s3 bucket through Java</li>\n<li>My problem is: I'm\ngetting an error saying</li>\n</ul>\n<blockquote>\n<p>Your previous request to create the named bucket succeeded and you\nalready own it.</p>\n</blockquote>\n<p>And my question is: How come I'm getting an error related to the creation of a bucket when the putObject method of the s3 client is executed. Why is this happening? How can I fix this? Been days on this and it's making me crazy.</p>\n<p>This is my code:</p>\n<pre><code>private void putObjectFromRequestBody(final RequestBody requestBody,\n                                      final Charset charset,\n                                      final String bucketName,\n                                      final String key) {\n\nfinal PutObjectRequest putObjectRequest = this.buildPutObjectRequest(bucketName, key, charset);\n\nthis.s3Client.putObject(putObjectRequest, requestBody);\n}\n</code></pre>\n"},{"last_activity_date":1684852516,"question_id":76315927,"body":"<p>When I'm running my system (Java + Spring + Reactor + Kafka), the following warning is being reported:</p>\n<pre><code>The configuration 'What to do when there is no initial offset in Kafka or if the current offset does not exist any more on the server (e.g. because that data has been deleted): &lt;ul&gt;&lt;li&gt;earliest: automatically reset the offset to the earliest offset&lt;li&gt;latest: automatically reset the offset to the latest offset&lt;/li&gt;&lt;li&gt;none: throw exception to the consumer if no previous offset is found for the consumer's group&lt;/li&gt;&lt;li&gt;anything else: throw exception to the consumer.&lt;/li&gt;&lt;/ul&gt;' was supplied but isn't a known config.\n</code></pre>\n<p><strong>What Should I do to avoid this warning?</strong></p>\n<p>I already added this value in the application.yml:</p>\n<pre><code>spring:\n    consumer:\n      auto-offset-reset: latest\n</code></pre>\n<p>Apart from that, I'm also using the same programmatic config:</p>\n<pre><code>@Bean(name=&quot;myTopic&quot;)\n@Lazy\npublic KafkaReceiver&lt;String, String&gt; kafkaReceiverForAdyenNotifications() {\n    var receiverOptions = ReceiverOptions.&lt;String, String&gt;create(receiverProperties(getTopicNameCardEvents()))\n        .subscription(Collections.singleton(getTopicNameCardEvents()));\n    return KafkaReceiver.create(receiverOptions);\n}\n\npublic Map&lt;String, Object&gt; receiverProperties(final String name) {\n    var group = name+&quot;-group&quot;+ (Optional.ofNullable(activeProfile).orElse(&quot;&quot;).contains(&quot;local&quot;) ? &quot;-local&quot; : &quot;&quot;);\n    Map&lt;String, Object&gt; props = new HashMap&lt;&gt;();\n    props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, &quot;latest&quot;);\n    return props;\n}\n</code></pre>\n<p>And I'm using these configs here:</p>\n<pre><code>@Bean\n@Profile(&quot;!test&quot;)\npublic ApplicationRunner paymentEventsListenerRunner(@Qualifier(&quot;myTopic&quot;) final KafkaReceiver&lt;String, String&gt; kafkaReceiver) {\n    return args -&gt; kafkaReceiver.receive()\n        .doOnNext(rr -&gt; {\n            try {\n                final MyDTO myDTO = objectMapper.readValue(rr.value(), MyDTO.class);\n                ...\n</code></pre>\n"},{"answers":[{"answer_id":76315888,"body":"<p>The answer is in the stacktrace:</p>\n<pre><code> at org.jooq_3.18.4.DEFAULT.debug(Unknown Source)\n</code></pre>\n<p>That <code>DEFAULT</code> means <code>SQLDialect.DEFAULT</code>, which isn't the right configuration to work with PostgreSQL. Use <code>SQLDialect.POSTGRES</code> instead.</p>\n"}],"last_activity_date":1684852317,"question_id":76315833,"body":"<p>I am writing an insert method in my DAO, taking advantage of PostgreSQL <code>returning</code> support.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public Vendor insert(final Vendor pojo) {\n  final VendorRecord record = dsl.newRecord(VENDOR, pojo);\n\n  record.setDateCreated(OffsetDateTime.now());\n  record.setCreatedBy(&quot;TODO&quot;);\n\n  return dsl\n      .insertInto(VENDOR)\n      .set(record)\n      .returning(VENDOR)\n      .fetchOneInto(Vendor.class);\n}\n</code></pre>\n<p>I get the following exception:</p>\n<pre><code>org.springframework.dao.DataIntegrityViolationException: jOOQ; SQL [insert into &quot;public&quot;.&quot;vendor&quot; (&quot;id&quot;, &quot;name&quot;, &quot;description&quot;, &quot;url&quot;, &quot;date_created&quot;, &quot;created_by&quot;, &quot;date_updated&quot;, &quot;updated_by&quot;) values (?, ?, ?, ?, ?, ?, ?, ?) returning &quot;public&quot;.&quot;vendor&quot;.&quot;id&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;name&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;description&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;url&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;enabled&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;date_created&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;created_by&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;date_updated&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;updated_by&quot;, &quot;public&quot;.&quot;vendor&quot;.&quot;version&quot;]; A result was returned when none was expected.\n\n    at org.jooq_3.18.4.DEFAULT.debug(Unknown Source)\n    at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:105)\n    at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)\n    at org.springframework.boot.autoconfigure.jooq.JooqExceptionTranslator.translate(JooqExceptionTranslator.java:94)\n    at org.springframework.boot.autoconfigure.jooq.JooqExceptionTranslator.handle(JooqExceptionTranslator.java:81)\n    at org.springframework.boot.autoconfigure.jooq.JooqExceptionTranslator.exception(JooqExceptionTranslator.java:55)\n    at org.jooq.impl.ExecuteListeners.exception(ExecuteListeners.java:304)\n    at org.jooq.impl.AbstractQuery.execute(AbstractQuery.java:372)\n    at org.jooq.impl.AbstractDMLQueryAsResultQuery.fetch(AbstractDMLQueryAsResultQuery.java:140)\n    at org.jooq.impl.ResultQueryTrait.fetchLazy(ResultQueryTrait.java:281)\n    at org.jooq.impl.ResultQueryTrait.fetchLazyNonAutoClosing(ResultQueryTrait.java:290)\n    at org.jooq.impl.ResultQueryTrait.fetchOne(ResultQueryTrait.java:509)\n    at org.jooq.impl.ResultQueryTrait.fetchOneInto(ResultQueryTrait.java:533)\n    at com.oliveryasuna.finance.backend.persistence.repository.VendorRepository2.insert(VendorRepository2.java:42)\n    at com.oliveryasuna.finance.backend.persistence.repository.VendorRepositoryTests.insertOne(VendorRepositoryTests.java:47)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568)\n    at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)\n    at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)\n    at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)\n    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)\n    at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)\n    at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)\n    at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)\n    at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\n    at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\n    at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\n    at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\n    at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\n    at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\n    at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102)\n    at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54)\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)\n    at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)\n    at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)\n    at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)\n    at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)\n    at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)\n    at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)\n    at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)\n    at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:235)\n    at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:54)\nCaused by: org.postgresql.util.PSQLException: A result was returned when none was expected.\n    at org.postgresql.jdbc.PgStatement.checkNoResultUpdate(PgStatement.java:280)\n    at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:153)\n    at org.jooq.tools.jdbc.DefaultPreparedStatement.executeUpdate(DefaultPreparedStatement.java:109)\n    at org.jooq.impl.AbstractDMLQuery.executeReturningGeneratedKeys(AbstractDMLQuery.java:1264)\n    at org.jooq.impl.AbstractDMLQuery.execute(AbstractDMLQuery.java:1223)\n    at org.jooq.impl.AbstractQuery.execute(AbstractQuery.java:357)\n    ... 77 more\n</code></pre>\n<p>Here is the DDL for the <code>vendor</code> table:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>create table vendor\n(\n    id           uuid                     not null\n        constraint vendor_pk\n            primary key,\n    name         varchar(50)              not null,\n    description  varchar(255),\n    url          varchar(2048),\n    enabled      boolean                  not null default true,\n    date_created timestamp with time zone not null,\n    created_by   varchar(50)              not null,\n    date_updated timestamp with time zone,\n    updated_by   varchar(50),\n    version      integer                  not null default 0\n);\n</code></pre>\n<p>And I don't use any fancy jOOQ configuration except to generate POJOs.</p>\n<p>Thank you for your time.</p>\n"},{"answers":[{"answer_id":76315604,"body":"<p>I overlooked that even though the browser showed me (in <code>Cookies</code> tab) that <code>JSESSIONID</code> cookie was present it actually was not sent with the request. I did not notice that <code>Cookie</code> header was not present in the requests. I am adding screenshot where a) <code>Cookies</code> tab is present and if opened shows <code>JSESSIONID</code> which gave me the idea that the cookie is being sent and b) where you can see that <code>Cookie</code> header is present in the correct request:\n<a href=\"https://i.stack.imgur.com/djtW3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/djtW3.png\" alt=\"enter image description here\" /></a></p>\n<p>Why <code>Cookie</code> header was not present? Because even though the configuration for <code>CORS</code> was correct on <code>Angular</code> side:\n<a href=\"https://i.stack.imgur.com/ANzUx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ANzUx.png\" alt=\"enter image description here\" /></a>\nbut HTTP interceptor's registration was commented in the AppModule:\n<a href=\"https://i.stack.imgur.com/sVzAX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sVzAX.png\" alt=\"enter image description here\" /></a></p>\n"}],"last_activity_date":1684852098,"question_id":76314410,"body":"<p>Spring Boot application runs on https://localhost:8080 and front-end (Angular) app runs on https://localhost:4200. On each request new JSESSIONID gets set/created as if HTTP session engine does not recognize JSESSIONID it has just set for previous request. But when I start serving front-end app as static content from Spring Boot app (which means same port for Angular app) everything works fine.</p>\n<p><strong>UPDATE 1:</strong> so far I have tracked that this happens because Request object get recycled because this code return false\n<a href=\"https://i.stack.imgur.com/Sr2Lw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sr2Lw.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/ZA2n6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZA2n6.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>UPDATE 2</strong>: I now see that &quot;cookie&quot; header like this one is not present in the request when font-end runs on different port.</p>\n<pre><code>cookie = SLG_G_WPT_TO=en; SLG_GWPT_Show_Hide_tmp=undefined; SLG_wptGlobTipTmp=undefined; JSESSIONID=6C59D1FE6310EE1E141FD96236D9218A\n</code></pre>\n<p>When this code is run:\n<a href=\"https://i.stack.imgur.com/Uu7ZV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uu7ZV.png\" alt=\"enter image description here\" /></a></p>\n"},{"answers":[{"answer_id":76315855,"body":"<p>To limit the throughput for the <code>Person</code> container to 1500 Request Units (RU) per second using the <a href=\"https://azuresdkdocs.blob.core.windows.net/$web/java/azure-cosmos/latest/com/azure/cosmos/ThroughputControlGroupConfig.html\" rel=\"nofollow noreferrer\">ThroughputControlGroupConfig</a> feature of the <a href=\"https://learn.microsoft.com/en-us/java/api/overview/azure/cosmos-db\" rel=\"nofollow noreferrer\">Cosmos DB Java SDK</a>, follow these steps:</p>\n<ol>\n<li>Add the <a href=\"https://central.sonatype.com/artifact/com.azure/azure-cosmos\" rel=\"nofollow noreferrer\">azure-cosmos</a> dependency to your <code>pom.xml</code> file:</li>\n</ol>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.azure&lt;/groupId&gt;\n  &lt;artifactId&gt;azure-cosmos&lt;/artifactId&gt;\n  &lt;version&gt;4.45.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<ol start=\"2\">\n<li>Create an instance of the <code>ThroughputControlGroupConfig</code> object with the desired RU/s limit:</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>ThroughputControlGroupConfig groupConfig = new ThroughputControlGroupConfig(&quot;Person&quot;, 1500);\n</code></pre>\n<ol start=\"3\">\n<li>Add the <code>groupConfig</code> object to the <a href=\"https://azuresdkdocs.blob.core.windows.net/$web/java/azure-cosmos/latest/com/azure/cosmos/CosmosClientBuilder.html\" rel=\"nofollow noreferrer\">CosmosClientBuilder</a> object in the <code>CosmosDBConfig.java</code> file:</li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\npublic CosmosClientBuilder cosmosDBClientBuilder() {\n  this.azureKeyCredential = new AzureKeyCredential(&lt;private key&gt;);\n  DirectConnectionConfig directConnectionConfig = new DirectConnectionConfig();\n  GatewayConnectionConfig gatewayConnectionConfig = new GatewayConnectionConfig();\n  return new CosmosClientBuilder()\n    .endpoint(&lt;url&gt;)\n    .credential(azureKeyCredential)\n    .consistencyLevel(ConsistencyLevel.valueOf(&quot;SESSION&quot;))\n    .multipleWriteRegionsEnabled(false)\n    .preferredRegions(&lt;my regions&gt;)\n    .directMode(directConnectionConfig, gatewayConnectionConfig)\n    .contentResponseOnWriteEnabled(true)\n    .throughputControlGroupConfigs(Collections.singletonList(groupConfig));\n}\n</code></pre>\n<ol start=\"4\">\n<li><p>The <code>Person</code> container is now limited to 1500 RUs/second. To verify the RU/s usage, you can use the <a href=\"https://azuresdkdocs.blob.core.windows.net/$web/java/azure-cosmos/latest/com/azure/cosmos/models/CosmosResponse.html#getRequestCharge()\" rel=\"nofollow noreferrer\">getRequestCharge()</a> method provided by the SDK.</p>\n</li>\n<li><p>You don't need to do anything extra to use the <code>ThroughputControlGroupConfig</code> in the <code>PersonRepository</code> class. The repository uses the <a href=\"https://azuresdkdocs.blob.core.windows.net/$web/java/azure-cosmos/latest/com/azure/cosmos/CosmosClient.html\" rel=\"nofollow noreferrer\">CosmosClient</a> object created by the <code>CosmosClientBuilder</code>, which already has the <code>groupConfig</code> object added to it. So any CRUD operation on the <code>Person</code> container through the repository will be limited to 1500 RUs/second.</p>\n</li>\n</ol>\n<p>For more information about the RU and factors impacting the effective charges, please visit <a href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/request-units\" rel=\"nofollow noreferrer\">Request Units in Azure Cosmos DB</a>.</p>\n"}],"last_activity_date":1684852057,"question_id":76249707,"body":"<p>I'm using Microsoft cosmos Nosql DB and a spring boot backend with the reactive cosmos client.</p>\n<p>Theres a container Person.java, and the backend application does CRUD operations on it.</p>\n<p>Below if existing code for it:</p>\n<pre><code>------------------------------------------------\nPerson.java\n------------------------------------------------\npackage com.cosmos.containers;\n\nimport com.azure.spring.data.cosmos.core.mapping.Container;\nimport com.azure.spring.data.cosmos.core.mapping.PartitionKey;\nimport lombok.AllArgsConstructor;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\nimport org.springframework.data.annotation.Id;\nimport org.springframework.data.annotation.Version;\n\n@Container(containerName = &quot;Person&quot;)\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Person extends DomainEntity {\n\n    @Id private String id;\n\n    @PartitionKey private String partitionKey;\n\n    private String name;\n}\n\n\n</code></pre>\n<pre><code>------------------------------------------------\nCosmosDBConfig.java\n------------------------------------------------\npackage com.cosmos.config;\n\nimport com.azure.core.credential.AzureKeyCredential;\nimport com.azure.cosmos.ConsistencyLevel;\nimport com.azure.cosmos.CosmosClientBuilder;\nimport com.azure.cosmos.DirectConnectionConfig;\nimport com.azure.cosmos.GatewayConnectionConfig;\nimport com.azure.spring.data.cosmos.config.AbstractCosmosConfiguration;\nimport com.azure.spring.data.cosmos.config.CosmosConfig;\nimport com.azure.spring.data.cosmos.repository.config.EnableReactiveCosmosRepositories;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\n@EnableReactiveCosmosRepositories(\n        basePackages = {&quot;com.cosmos.repositories&quot;})\n@Slf4j\npublic class CosmosDBConfig extends AbstractCosmosConfiguration {\n\n    private AzureKeyCredential azureKeyCredential;\n\n\n    @Override\n    protected String getDatabaseName() {\n        return &quot;MyDataBase&quot;;\n    }\n\n    @Bean\n    public CosmosClientBuilder cosmosDBClientBuilder() {\n        this.azureKeyCredential = new AzureKeyCredential(&lt;private key&gt;);\n        DirectConnectionConfig directConnectionConfig = new DirectConnectionConfig();\n        GatewayConnectionConfig gatewayConnectionConfig = new GatewayConnectionConfig();\n        return new CosmosClientBuilder()\n                .endpoint(&lt;url&gt;)\n                .credential(azureKeyCredential)\n                .consistencyLevel(\n                        ConsistencyLevel.valueOf(&quot;SESSION&quot;))\n                .multipleWriteRegionsEnabled(false)\n                .preferredRegions(&lt;my regions&gt;)\n                .directMode(directConnectionConfig, gatewayConnectionConfig);\n    }\n\n\n    @Override\n    public CosmosConfig cosmosConfig() {\n        return CosmosConfig.builder()\n                .enableQueryMetrics(true)\n                .maxDegreeOfParallelism(-1)\n                .build();\n    }\n\n\n}\n\n</code></pre>\n<pre><code>------------------------------------------------\nPersonRepository.java\n------------------------------------------------\n\npackage com.cosmos.repositories;\n\nimport com.azure.spring.data.cosmos.repository.ReactiveCosmosRepository;\n\n@Repository\npublic interface PersonRepository extends ReactiveCosmosRepository&lt;Person, String&gt; {\n\n}\n\n</code></pre>\n<pre><code>------------------------------------------------\nMyPersonService.java\n------------------------------------------------\n@Service\npublic class MyPersonService {\n    @Autowired\n    private PersonRepository repository;\n\n    public Person save(Person person) {\n        return repository.save(person);\n    }\n}\n\n</code></pre>\n<p>Now lets say I want to limit the usage of RUs for Person container to 1500 RUs/seconds using the ThroughputControlGroupConfig feature of java sdk in this code base(<a href=\"https://the9090rule.medium.com/controlling-an-applications-throughput-consumption-in-cosmos-db-with-throughputcontrolgroup-247cc0eafa92\" rel=\"nofollow noreferrer\">details docs of ThroughputControlGroupConfig can be found here</a>).</p>\n<p>How do I do this.</p>\n<p>More specifically I want to know how to I pass his ThroughputControlGroupConfig to the <code>PersonRepository</code> class</p>\n"},{"comments":[{"comment_id":90229559,"body":"Pretty sure that this is only working between docker containers all setup with networking like this. you&#39;re essentially creating a separate network (confluent) here, and the two containers (zookeeper and kafka) can talk to each other, but you cannot access it from outside directly with localhost. i think it works if you use /etc/hosts, but i&#39;m not sure. it wouldn&#39;t be a workaround, though, because the containers are not running on localhost. they&#39;re running on confluent network. does it work if you specify the ip address instead of localhost?"}],"answers":[{"comments":[{"comment_id":90232603,"body":"Thank you (+1). The second option worked for me and probably I&#39;ll stick to it. I&#39;ll accept the answer later if none appears with a better solution (as you already mentioned we loose ability to establish connection from within the container)."}],"answer_id":51632885,"body":"<p>When you first connect to a kafka node, it will give you back all the kafka node and the url where to connect. Then your application will try to connect to every kafka directly.</p>\n<p>Issue is always what is the kafka will give you as url ? It's why there is the <code>KAFKA_ADVERTISED_LISTENERS</code> which will be used by kafka to tell the world how it can be accessed.</p>\n<p>Now for your use-case, there is multiple small stuff to think about:</p>\n<p>Let say you set <code>plaintext://kafka:9092</code></p>\n<ul>\n<li>This is OK if you have an application in your docker compose that use kafka.  This application will get from kafka the URL with <code>kafka</code> that is resolvable through the docker network.</li>\n<li>If you try to connect from your main system or from another container which is not in the same docker network this will fail, as the <code>kafka</code> name cannot be resolved.</li>\n</ul>\n<p>==&gt; To fix this, you need to have a specific DNS server like a service discovery one, but it is big trouble for small stuff.  Or you set manually the <code>kafka</code> name to the container ip in each <code>/etc/hosts</code></p>\n<p>If you set <code>plaintext://localhost:9092</code></p>\n<ul>\n<li>This will be ok on your system if you have a port mapping ( -p 9092:9092 when launching kafka)</li>\n<li>This will fail if you test from an application on a container (same docker network or not) (localhost is the container itself not the kafka one)</li>\n</ul>\n<p>==&gt; If you have this and wish to use a kafka client in another container, one way to fix this is to share the network for both container (same ip)</p>\n<p>Last option : set an IP in the name: <code>plaintext://x.y.z.a:9092</code> ( kafka advertised url cannot be 0.0.0.0 as stated in the doc <a href=\"https://kafka.apache.org/documentation/#brokerconfigs_advertised.listeners\" rel=\"noreferrer\">https://kafka.apache.org/documentation/#brokerconfigs_advertised.listeners</a> )</p>\n<p>This will be ok for everybody... BUT how can you get the x.y.z.a name ?</p>\n<p>The only way is to hardcode this ip when you launch the container: <code>docker run .... --net confluent --ip 10.x.y.z ...</code>.  Note that you need to adapt the ip to one valid ip in the <code>confluent</code> subnet.</p>\n"},{"comments":[{"comment_id":100464604,"body":"But what if I want to use only 9092? I mean 9092 outside, not 29092"},{"comment_id":100483479,"body":"@Maria Then change the port mapping <code>PLAINTEXT_HOST:&#47;&#47;localhost:9092</code> with <code>-p 9092:9092</code>. You&#39;ll likely still want a separate listener for containers inside the Docker network"},{"comment_id":100501394,"body":"Do you mean that in this case I need only &quot;-p 9092:9092&quot; and don&#39;t need &quot;-p 9092:9092&quot;  ?"},{"comment_id":100527668,"body":"@Maria If you have a client on the host, you <b>will</b> need to expose some port. That port will depend on how the advertised listeners are set."},{"comment_id":100531033,"body":"Oh man, stupid me. I mean I don&#39;t need exect &quot;-p 29092:29092&quot; ? I can have only -p 9092:9092&quot; ?"},{"comment_id":100552913,"body":"@Maria I think I&#39;ve answered that 3 times now? You can, yes, but only if you have changed to <code>PLAINTEXT_HOST:&#47;&#47;localhost:9092</code>, as compared to my answer"}],"answer_id":51634499,"body":"<p><strong>tl;dr</strong> - A simple port forward from the container to the host will <em>not work</em>... Hosts files (e.g. <code>/etc/hosts</code> on *NIX systems) should not be modified to work around Kafka networking, as this solution is not portable.</p>\n<p>1) What exact IP/hostname + port do you want to connect to? Make sure that value is set as <code>advertised.listeners</code> (not <code>advertised.host.name</code> and <code>advertised.port</code>, as these are deprecated) on the broker.</p>\n<p>2) Make sure that the server(s) listed  as part of <code>bootstrap.servers</code> are actually resolvable. E.g <code>ping</code> an IP/hostname, use <code>netcat</code> to check ports... If your clients are in a container, you need to do this <em>from the container</em>, not only your host</p>\n<p>3) To verify the ports are mapped correctly on the host, ensure that <code>docker ps</code> shows the kafka container is mapped from <code>0.0.0.0:&lt;host_port&gt; -&gt; &lt;advertised_listener_port&gt;/tcp</code>. The ports must match if trying to run a client from outside the Docker network.</p>\n<hr />\n<blockquote>\n<p>The below answer uses <code>confluentinc</code> docker images to address the question that was asked, <strong>not</strong> <code>wurstmeister/kafka</code>. More specifically, the latter images are not well-maintained despite being the one of the most popular Kafka docker image. If you have <code>KAFKA_ADVERTISED_HOST_NAME</code> variable set, remove it (it's a deprecated property)</p>\n</blockquote>\n<p>The following sections try to aggregate all the details needed to use another image. For other, commonly used Kafka images,  <strong>it's all the same <em>Apache</em> Kafka</strong> running in a container.<br />\nYou're just dependent on <em>how it is configured</em>. And <em>which variables</em> make it so.</p>\n<blockquote>\n<h4><code>wurstmeister/kafka</code></h4>\n<p>Refer their README section on <a href=\"https://github.com/wurstmeister/kafka-docker/blob/master/README.md#listener-configuration\" rel=\"nofollow noreferrer\">listener configuration</a>, Also <a href=\"https://github.com/wurstmeister/kafka-docker/wiki/Connectivity\" rel=\"nofollow noreferrer\">read their Connectivity wiki</a>.</p>\n</blockquote>\n<blockquote>\n<h4><code>bitnami/kafka</code></h4>\n<p>If you want a small container, try these. The images are much smaller than the Confluent ones and are much more well maintained than <code>wurstmeister</code>. <a href=\"https://github.com/bitnami/containers/tree/main/bitnami/kafka#accessing-apache-kafka-with-internal-and-external-clients\" rel=\"nofollow noreferrer\">Refer their README</a> for listener configuration.</p>\n</blockquote>\n<blockquote>\n<h4><code>debezium/kafka</code></h4>\n<p>Docs on it <a href=\"https://debezium.io/documentation/faq/#how_to_connect_to_kafka_when_using_the_debezium_docker_images\" rel=\"nofollow noreferrer\">are mentioned here</a>.</p>\n<p><strong>Note</strong>: advertised host and port settings are deprecated. Advertised <strong><em>listeners</em></strong> covers both. Similar to the Confluent containers, Debezium can use <code>KAFKA_</code> prefixed broker settings to update its properties.</p>\n</blockquote>\n<blockquote>\n<h4>Others</h4>\n<ul>\n<li><code>ubuntu/kafka</code> requires you to add <code>--override advertised.listeners=kafka:9092</code> via Docker image args... I find that less portable than environment variables, so not recommended</li>\n<li><code>spotify/kafka</code> is deprecated and outdated.</li>\n<li><code>fast-data-dev</code> or <code>lensesio/box</code> are great for an all in one solution, with Schema Registry, Kafka Connect, etc, but are bloated if you <strong>only</strong> want Kafka. Plus, it's a Docker anti pattern to run many services in one container</li>\n<li>Your own <code>Dockerfile</code> - Why? Is something incomplete with these others? Start with a pull request, not starting from scratch.</li>\n</ul>\n</blockquote>\n<p>For supplemental reading, a <strong>fully-functional</strong> <code>docker-compose</code>, and network diagrams, see <a href=\"https://confluent.io/blog/kafka-listeners-explained/\" rel=\"nofollow noreferrer\">this blog by @rmoff</a></p>\n<h1>Answer</h1>\n<p><a href=\"https://docs.confluent.io/current/quickstart/ce-docker-quickstart.html\" rel=\"nofollow noreferrer\">The Confluent quickstart (Docker) document</a> assumes all produce and consume requests will be within the Docker network.</p>\n<p>You could fix the problem of connecting to <code>kafka:9092</code> by running your Kafka client code within its own container as that uses the Docker network bridge, but otherwise you'll need to add some more environment variables for exposing the container externally, while still having it work within the Docker network.</p>\n<p>First add a protocol mapping of <code>PLAINTEXT_HOST:PLAINTEXT</code> that will map the listener protocol to a Kafka protocol</p>\n<p>Key: <code>KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</code><br />\nValue: <code>PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT</code></p>\n<p>Then setup two advertised listeners on different ports. (<code>kafka</code> here refers to the docker container name; it might also be named <code>broker</code>, so double check your service + hostnames).</p>\n<p>Key: <code>KAFKA_ADVERTISED_LISTENERS</code><br />\nValue: <code>PLAINTEXT://kafka:9092,PLAINTEXT_HOST://localhost:29092</code></p>\n<p><strong>Notice the protocols here match the left-side values of the protocol mapping setting above</strong></p>\n<p>When running the container, add <code>-p 29092:29092</code> for the host port mapping, and advertised <code>PLAINTEXT_HOST</code> listener.</p>\n<hr />\n<p>So... (<strong>with the above settings</strong>)</p>\n<blockquote>\n<p>If something <strong>still</strong> doesn't work, <code>KAFKA_LISTENERS</code> can be set to include <code>&lt;PROTOCOL&gt;://0.0.0.0:&lt;PORT&gt;</code> where both options match the advertised setting and Docker-forwarded port</p>\n</blockquote>\n<h3>Client on same machine, not in a container</h3>\n<p>Advertising localhost and the associated port will let you connect outside of the container, as you'd expect.</p>\n<p>In other words, when running any Kafka Client <strong>outside</strong> the Docker network (including CLI tools you might have installed locally), use <code>localhost:29092</code> for bootstrap servers and <code>localhost:2181</code> for Zookeeper (requires Docker port forwarding)</p>\n<h3>Client on another machine</h3>\n<p>If trying to connect from an external server, you'll need to advertise the external hostname/ip (e.g. <code>192.168.x.y</code>) of the host <em><strong>as well as/in place of localhost</strong></em>.<br />\nSimply advertising localhost with a port forward  will not work because Kafka protocol will still continue to advertise the listeners you've configured.</p>\n<p>This setup requires Docker port forwarding <strong>and</strong> router port forwarding (and firewall / security group changes) if not in the same local network, for example, your container is running in the cloud and you want to interact with it from your local machine.</p>\n<h3>Client (or another broker) in a container, on the same host</h3>\n<p>This is the least error-prone configuration; you can use DNS service names directly.</p>\n<p>When running an app <strong>in the Docker network</strong>, use <code>kafka:9092</code> (see advertised <code>PLAINTEXT</code> listener config above) for bootstrap servers and <code>zookeeper:2181</code> for Zookeeper, just like any other Docker service communication (doesn't require any port forwarding)</p>\n<hr />\n<p>If you use separate <code>docker run</code> commands, or Compose files, you need to define a shared <code>network</code> manually using compose <code>networks</code> section or <code>docker network --create</code></p>\n<hr />\n<p><a href=\"https://github.com/confluentinc/examples/blob/5.3.1-post/cp-all-in-one/docker-compose.yml\" rel=\"nofollow noreferrer\">See the example Compose file for the full Confluent stack</a> or <a href=\"https://github.com/conduktor/kafka-stack-docker-compose/blob/v6.2.1/zk-single-kafka-single.yml\" rel=\"nofollow noreferrer\">more minimal one</a> for a single broker.</p>\n<p>If using multiple brokers, then they need to use unique hostnames + advertised listeners. <a href=\"https://github.com/conduktor/kafka-stack-docker-compose/blob/v6.2.1/zk-single-kafka-multiple.yml\" rel=\"nofollow noreferrer\">See example</a></p>\n<h1>Related question</h1>\n<p><a href=\"https://stackoverflow.com/q/68401788/2308683\">Connect to Kafka on host from Docker (ksqlDB)</a></p>\n<h1>Appendix</h1>\n<p>For anyone interested in <strong>Kubernetes</strong> deployments:</p>\n<ul>\n<li><a href=\"https://strimzi.io/blog/2019/04/17/accessing-kafka-part-1\" rel=\"nofollow noreferrer\">Accessing Kafka</a></li>\n<li>Operators (recommended): <a href=\"https://operatorhub.io/?keyword=Kafka\" rel=\"nofollow noreferrer\">https://operatorhub.io/?keyword=Kafka</a></li>\n<li>Helm Artifact Hub: <a href=\"https://artifacthub.io/packages/search?ts_query_web=kafka&amp;sort=stars&amp;page=1\" rel=\"nofollow noreferrer\">https://artifacthub.io/packages/search?ts_query_web=kafka&amp;sort=stars&amp;page=1</a></li>\n</ul>\n"},{"comments":[{"comment_id":111914710,"body":"<code>ip_address_of_your_computer_but_not_localhost</code> ... Localhost works fine, if you refer my answer... And Compose would be better than <code>docker run</code>"},{"comment_id":112004450,"body":"Should not be localhost. Because you have to think of your containers as an external system.That&#39;s why you should point it to the computer&#39;s ip address, not its localhost."},{"comment_id":112008356,"body":"You can port forward from the container, then access from your host on <code>localhost</code>. Did you try the settings listed in my answer? Or read <a href=\"https://rmoff.net/2018/08/02/kafka-listeners-explained/\" rel=\"nofollow noreferrer\">rmoff.net/2018/08/02/kafka-listeners-explained</a> ?"}],"answer_id":61796286,"body":"<p>before zookeeper</p>\n\n<ol>\n<li>docker container run --name zookeeper -p 2181:2181 zookeeper</li>\n</ol>\n\n<p>after kafka</p>\n\n<ol start=\"2\">\n<li>docker container run --name kafka -p 9092:9092 -e KAFKA_ZOOKEEPER_CONNECT=192.168.8.128:2181 -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://ip_address_of_your_computer_but_not_localhost!!!:9092 -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 confluentinc/cp-kafka</li>\n</ol>\n\n<p>in kafka consumer and producer config</p>\n\n<pre><code>@Bean\npublic ProducerFactory&lt;String, String&gt; producerFactory() {\n    Map&lt;String, Object&gt; configProps = new HashMap&lt;&gt;();\n    configProps.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \"192.168.8.128:9092\");\n    configProps.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);\n    configProps.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class);\n    return new DefaultKafkaProducerFactory&lt;&gt;(configProps);\n}\n\n@Bean\npublic ConsumerFactory&lt;String, String&gt; consumerFactory() {\n    Map&lt;String, Object&gt; props = new HashMap&lt;&gt;();\n    props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \"192.168.8.128:9092\");\n    props.put(ConsumerConfig.GROUP_ID_CONFIG, \"group_id\");\n    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);\n    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);\n    return new DefaultKafkaConsumerFactory&lt;&gt;(props);\n}\n</code></pre>\n\n<p>I run my project with these regulations. Good luck dude.</p>\n"},{"comments":[{"comment_id":129055199,"body":"This doesn&#39;t really add anything to the accepted answer. &quot;M1 Mac&quot; doesn&#39;t matter since all Docker hosts would act the same. Also port 9092 is being used &quot;from the docker&quot; here..."}],"answer_id":69721543,"body":"<p>This allows me to access <code>localhost:9092</code> in Kafka applications on my M1 Mac</p>\n<pre><code>Key: KAFKA_ADVERTISED_LISTENERS\nValue: PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092\n</code></pre>\n<p>plus port forwarding :</p>\n<pre><code>ports\n   - &quot;9092:9092&quot;\n</code></pre>\n<p>Finally, again, for my set up, I have to set listeners key this way</p>\n<pre><code>Key: KAFKA_LISTENERS\nValue: PLAINTEXT://0.0.0.0:29092,PLAINTEXT_HOST://0.0.0.0:9092\n</code></pre>\n"},{"comments":[{"comment_id":130844075,"body":"No. Please do not edit <code>&#47;etc&#47;hosts</code>. With this code, you still get an error that <code>UnknownHost: kafka</code>... Just use <code>127.0.0.1:9092</code> here, and set <code>KAFKA_ADVERTISED_LISTENERS</code> accordingly to <code>PLAINTEXT:&#47;&#47;localhost:9092</code>"}],"answer_id":73667872,"body":"<p>the simplest way to solve this is adding a custom hostname to your broker using -h option</p>\n<pre><code>docker run -d \\\n    --net=confluent \\\n    --name=kafka \\\n    -h broker-1 \\\n    -p 9092:9092 \\\n    -e KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\\n    -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9092 \\\n    -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 \\\n    confluentinc/cp-kafka:4.1.0\n</code></pre>\n<p>and edit your /etc/hosts</p>\n<pre><code>127.0.0.1   broker-1\n</code></pre>\n<p>and use:</p>\n<pre><code>props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;broker-1:9092&quot;);\n</code></pre>\n"},{"comments":[{"comment_id":134560063,"body":"Your container data isn&#39;t being preserved here, by the way. Also, have you tested this with connecting from a different machine?"}],"answer_id":76239803,"body":"<pre><code>      KAFKA_BROKER_ID: 1\n      KAFKA_ADVERTISED_HOST_NAME: kafka:9092\n      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181\n      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\n      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092\n      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT\n      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\n</code></pre>\n<p>This configuration works fine</p>\n<p>make sure from inside docker you are connecting <code>kafka:29092</code></p>\n<p>from outside container <code>localhost:9092</code></p>\n<p>full working docker compose config</p>\n<pre><code>version: &quot;3.3&quot;\n\n    services:\n      zookeeper:\n        image: confluentinc/cp-zookeeper:6.2.0\n        container_name: zookeeper\n        networks:\n          - broker-kafka\n        ports:\n          - &quot;2181:2181&quot;\n        environment:\n          ZOOKEEPER_CLIENT_PORT: 2181\n          ZOOKEEPER_TICK_TIME: 2000\n          ALLOW_ANONYMOUS_LOGIN: yes\n        volumes:\n          - ./bitnami/zookeeper:/bitnami/zookeeper\n    \n      kafka:\n        image: confluentinc/cp-kafka:6.2.0\n        container_name: kafka\n        networks:\n          - broker-kafka\n        depends_on:\n          - zookeeper\n        ports:\n          - &quot;9092:9092&quot;\n        expose:\n          - &quot;9092&quot;\n        environment:\n          KAFKA_BROKER_ID: 1\n          KAFKA_ADVERTISED_HOST_NAME: kafka:9092\n          KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181\n          KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\n          KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092\n          KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT\n          KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\n          # KAFKA_AUTO_CREATE_TOPICS_ENABLE: &quot;false&quot;\n          # KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0\n          # KAFKA_CONFLUENT_LICENSE_TOPIC_REPLICATION_FACTOR: 1\n          KAFKA_CONFLUENT_BALANCER_TOPIC_REPLICATION_FACTOR: 1\n          # KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1\n          KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 1\n        volumes:\n          - ./bitnami/kafka:/bitnami/kafka\n    \n      kafdrop:\n        image: obsidiandynamics/kafdrop\n        container_name: kafdrop\n        ports:\n          - &quot;9000:9000&quot;\n        expose:\n          - &quot;9000&quot;\n        networks:\n          - broker-kafka\n        environment:\n          KAFKA_BROKERCONNECT: &quot;PLAINTEXT://kafka:29092&quot;\n          JVM_OPTS: &quot;-Xms16M -Xmx48M -Xss180K -XX:-TieredCompilation -XX:+UseStringDeduplication -noverify&quot;\n          SPRING_PROFILES_ACTIVE: &quot;dev&quot;\n        depends_on:\n          - kafka\n          - zookeeper\n    \n      consumer:\n        container_name: consumer\n        build:\n          context: ./consumer\n          dockerfile: Dockerfile\n        environment:\n          - KAFKA_TOPIC_NAME=app\n          - KAFKA_SERVER=kafka\n          - KAFKA_PORT=29092\n        ports:\n          - 8001:8001\n        restart: &quot;always&quot;\n        depends_on:\n          - zookeeper\n          - kafka\n          - publisher\n          - kafdrop\n        networks:\n          - broker-kafka\n    \n      publisher:\n        container_name: publisher\n        build:\n          context: ./producer\n          dockerfile: Dockerfile\n        environment:\n          - KAFKA_TOPIC_NAME=app\n          - KAFKA_SERVER=kafka\n          - KAFKA_PORT=29092\n        ports:\n          - 8000:8000\n        restart: &quot;always&quot;\n        depends_on:\n          - zookeeper\n          - kafka\n          - kafdrop\n        networks:\n          - broker-kafka\n        volumes:\n          - ./testproducer:/producer\n    \n    networks:\n      broker-kafka:\n        driver: bridge\n</code></pre>\n"}],"last_activity_date":1684851869,"question_id":51630260,"body":"<p>I setup a single node Kafka Docker container on my local machine like it is described in <a href=\"https://docs.confluent.io/current/installation/docker/docs/installation/recipes/single-node-client.html\" rel=\"noreferrer\">the Confluent documentation</a> (steps 2-3).</p>\n\n<p>In addition, I also exposed Zookeeper's port 2181 and Kafka's port 9092 so that I'll be able to connect to them from a client running on local machine:</p>\n\n<pre><code>$ docker run -d \\\n    -p 2181:2181 \\\n    --net=confluent \\\n    --name=zookeeper \\\n    -e ZOOKEEPER_CLIENT_PORT=2181 \\\n    confluentinc/cp-zookeeper:4.1.0\n\n$ docker run -d \\\n    --net=confluent \\\n    --name=kafka \\\n    -p 9092:9092 \\\n    -e KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\\n    -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9092 \\\n    -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 \\\n    confluentinc/cp-kafka:4.1.0\n</code></pre>\n\n<p><strong>Problem:</strong> When I try to connect to Kafka from the host machine, the connection fails because it <code>can't resolve address: kafka:9092</code>.</p>\n\n<p>Here is my Java code:</p>\n\n<pre><code>Properties props = new Properties();\nprops.put(\"bootstrap.servers\", \"localhost:9092\");\nprops.put(\"client.id\", \"KafkaExampleProducer\");\nprops.put(\"key.serializer\", LongSerializer.class.getName());\nprops.put(\"value.serializer\", StringSerializer.class.getName());\nKafkaProducer&lt;Long, String&gt; producer = new KafkaProducer&lt;&gt;(props);\nProducerRecord&lt;Long, String&gt; record = new ProducerRecord&lt;&gt;(\"foo\", 1L, \"Test 1\");\nproducer.send(record).get();\nproducer.flush();\n</code></pre>\n\n<p>The exception:</p>\n\n<pre><code>java.io.IOException: Can't resolve address: kafka:9092\n    at org.apache.kafka.common.network.Selector.doConnect(Selector.java:235) ~[kafka-clients-2.0.0.jar:na]\n    at org.apache.kafka.common.network.Selector.connect(Selector.java:214) ~[kafka-clients-2.0.0.jar:na]\n    at org.apache.kafka.clients.NetworkClient.initiateConnect(NetworkClient.java:864) [kafka-clients-2.0.0.jar:na]\n    at org.apache.kafka.clients.NetworkClient.ready(NetworkClient.java:265) [kafka-clients-2.0.0.jar:na]\n    at org.apache.kafka.clients.producer.internals.Sender.sendProducerData(Sender.java:266) [kafka-clients-2.0.0.jar:na]\n    at org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:238) [kafka-clients-2.0.0.jar:na]\n    at org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:176) [kafka-clients-2.0.0.jar:na]\n    at java.lang.Thread.run(Thread.java:748) [na:1.8.0_144]\nCaused by: java.nio.channels.UnresolvedAddressException: null\n    at sun.nio.ch.Net.checkAddress(Net.java:101) ~[na:1.8.0_144]\n    at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:622) ~[na:1.8.0_144]\n    at org.apache.kafka.common.network.Selector.doConnect(Selector.java:233) ~[kafka-clients-2.0.0.jar:na]\n    ... 7 common frames omitted\n</code></pre>\n\n<p><strong>Question:</strong> How to connect to Kafka running in Docker? My code is running from host machine, not Docker. </p>\n\n<p>Note: I know that I could theoretically play around with DNS setup and <code>/etc/hosts</code> but it is a workaround - it shouldn't be like that.</p>\n\n<p>There is also similar question <a href=\"https://stackoverflow.com/q/32302444/2065796\">here</a>, however it is based on <code>ches/kafka</code> image. I use <code>confluentinc</code> based image which is not the same.</p>\n"},{"last_activity_date":1684851791,"question_id":76315824,"body":"<p>I wanted to log http response code. My code looks like this:</p>\n<pre><code>        onCompletion()\n                .log(&quot;${in.header.operationName}&quot; + &quot; - &quot; + &quot;${in.header.CamelHttpResponseCode}&quot;);\n\n        from(\n                cxf(&quot;/test&quot;)\n                        .wsdlURL(&quot;wsdl/wsdl.wsdl&quot;)\n                        .serviceClass(&quot;org.tempuri.Class&quot;)\n                        .dataFormat(DataFormat.POJO)\n                        .advanced().schemaValidationEnabled(true)\n        )\n                .to(direct(&quot;route&quot;));\n</code></pre>\n<p>Why does camel not see the response code in header?</p>\n<p>The result I expect is log with http status. For example:\n<code>OperationName - 200</code></p>\n"},{"comments":[{"comment_id":134575716,"body":"What would your function return if <code>e</code> is null?"},{"comment_id":134575815,"body":"If you expect only these two values and not even null, it becomes a validation thing. So validate the input before calling this function or throw <code>IllegalArgumentException</code>"},{"comment_id":134576015,"body":"@biziclop in this case it&#39;d emit an <code>NPE</code> since you cannot call <code>Enum#ordinal</code> on a <code>null</code>. For OP, validation and <i>robustness</i> to change are valid here too: If you added another enum constant, then this method would no longer work. Admittedly, a compile-time check would be able to catch that, the only real &quot;evil&quot; thing I can think of here is someone instrumenting new enum constants at runtime. It may just be that the check for this case isn&#39;t overly involved."}],"last_activity_date":1684851640,"question_id":76315805,"body":"<p>I have a function that <code>switch</code>es on a value of some enum type, and in all cases returns a value. However, the Java compiler is not happy with this function unless it also returns a default value. A minimal example is as follows:</p>\n<pre><code>class Main {\n    enum MyEnum {\n        A,\n        B\n    }\n    \n    static String toString(MyEnum e) {\n        switch (e) {\n            case A: return &quot;A&quot;;\n            case B: return &quot;B&quot;;\n        }\n        // COMPILER COMPLAINS HERE: 'MISSING RETURN STATEMENT'\n    }\n    \n    public static void main(String[] args) {\n        System.out.println(toString(MyEnum.A) + toString(MyEnum.B));\n    }\n}\n</code></pre>\n<p>Adding either a <code>default</code> case in the <code>switch</code>, or simply returning a default value at the end of the function, now allows the code to compile:</p>\n<pre><code>// only 1 of the 2 fixes is required to get this to compile\nstatic String toString(MyEnum e) {\n    switch (e) {\n        case A: return &quot;A&quot;;\n        case B: return &quot;B&quot;;\n        default: return null;  // fix 1\n    }\n    return null; // fix 2\n}\n</code></pre>\n<p>Why is this the case? As I understand it, enums in Java are type-safe so cannot contain unexpected values (whereas in say, C or C++, you could force in a random integer into a function that takes an enum type and really cause problems). As a result the code without a default feels like it should work, but clearly the Java compiler isn't happy about it. Does anybody have information on what about the Java language causes this to be the case?</p>\n"},{"last_activity_date":1684851424,"question_id":76315706,"body":"<p>I have developed a spring boot applicatoin using sts.\nI had been using sts inbuilt maven plugin to run the build and have been running it via sts.\nAnd it runs fine when I'm running it via sts. (Run As spring boot application option)\nBut when I move the generated jar to server, I'm getting the below error.</p>\n<pre><code>o.s.boot.SpringApplication:821 - Application run failed\norg.springframework.beans.factory.BeanDefinitionStoreException: Failed to parse configuration class [ABCApplication]; nested exception is java.io.FileNotFoundException: class path resource [a/b/c/d/e.class] cannot be opened because it does not exist\n</code></pre>\n<p>This is my code for ABCApplication.class</p>\n<pre><code>@SpringBootApplication\n@EnableJpaRepositories({&quot;&quot;})\n@EntityScan({&quot;&quot;})\n@ComponentScan({&quot;x.x.x&quot;,&quot;a.b.c&quot;,&quot;x.x.x&quot;,&quot;x.x.x.x&quot;,&quot;x.x.x.x&quot;})\n@EnableJpaAuditing\npublic class ABCApplication{\n\n    public static void main(String[] args) {\n        SpringApplication.run(ABCApplication.class, args);\n    }\n\n}\n</code></pre>\n<p>The a/b/c/d/e.class is in a xyz.jar which I have included in the resources folder of my project.\nAnd I have added the package to componentScan of ABCApplication.class.</p>\n<p>And this is the entry in pom.xml.</p>\n<pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;x.x.x&lt;/groupId&gt;\n            &lt;artifactId&gt;xyz&lt;/artifactId&gt;\n            &lt;version&gt;1.0&lt;/version&gt;\n            &lt;scope&gt;system&lt;/scope&gt;\n            &lt;systemPath&gt;${project.basedir}/src/main/resources/xyz.jar\n            &lt;/systemPath&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<p>Someone please help, I'm not able to run it on server but it's running fine on my system via sts. And if i unzip the application jar file, I can see xyz.jar inside BOOT-INF\\classes\\</p>\n<p>The xyz.jar that I have is an external jar that is built using gradle, but I'm assuming that should not be an issue? All the jars are built in jdk 8\nxyz.jar does not use the spring-boot plugin. So it's not created as a spring-boot jar</p>\n<p>I have validated my pom.xml entry, ensured that the xyz.jar in which the e.class resides in is available inside application jar. The package is also available in componentScan.</p>\n"},{"answers":[{"comments":[{"comment_id":134522210,"body":"I was thinking the same. I took inspiration from the code i posted, but some things are not that clear to me. Since i don&#39;t use Strings, but a Categoria, what should i change to make it work? Because both Dragboard and Clipboard work with Strings, images... but with other Data types it&#39;s a little more complicated"},{"comment_id":134523013,"body":"@TrySoHard, you have a <code>ListView</code> of <code>Categoria</code>s.  There&#39;s nothing wrong with that, but it does have implications. In particular, when an item is dropped on your <code>ListView</code> you have to somehow obtain a <code>Categoria</code> from the <code>DragEvent</code>.  That could be by extracting one that is stored in the event already, or it could be by (re)constructing one from string or other contents obtainable from the event.  What you <i>cannot</i> do is store a String in the event when the drag is initiated, and then expect to find that string among the list items."},{"comment_id":134523061,"body":"You may also find that you need to be cleverer about looking for existing items than using <code>indexOf()</code>.  As <code>Categoria</code> is presently implemented, it uses object identity as its measure of equality.  If you plan on an approach where you (re)construct <code>Categoria</code> objects at need instead of passing existing instances around, then different instances will compare unequal even if all their fields have the same values.  That might not produce the results you want."},{"comment_id":134523587,"body":"Some of these comments would probably be better as part of an edited answer.  Also, on a phone, there is so much indenting of code in the code blocks that the code cannot be seen."}],"answer_id":76284109,"body":"<p>Based primarily on the exception class and details message, if the code presented is responsible for the exception then it likely results from one of these <code>indexOf()</code> invocations returning -1 (to indicate that the searched-for item is not in the <code>items</code> list):</p>\n<blockquote>\n<pre><code>                    int draggedIdx = items.indexOf(db.getString());\n                    int thisIdx = items.indexOf(getItem());\n</code></pre>\n</blockquote>\n<p>If either one is not found, then the subsequent</p>\n<blockquote>\n<pre><code>                    Categoria temp = categorie.get(draggedIdx);\n                    categorie.set(draggedIdx, categorie.get(thisIdx));\n                    categorie.set(thisIdx, temp);\n</code></pre>\n</blockquote>\n<p>would throw exactly such an exception.</p>\n<p>Indeed, since <code>items</code> is a <code>ObservableList&lt;Categoria&gt;</code>, it seems unlikely that <code>items.indexOf(db.getString())</code> could be expected ever to return other than -1, as <code>items</code> cannot contain any <code>String</code>s.</p>\n"},{"comments":[{"comment_id":134531580,"body":"Thank you very much for the dedication. I&#39;ll study more about the documentation you posted, so i can make this work with Classes!"},{"comment_id":134562988,"body":"I just saw your edit, and that&#39;s what i implemented. It makes total sense because indexOf uses &#39;equals&#39; of Categoria to compare the dragged element and compare it to the list, find the same object and take its id. Still... the dragged id is always -1, even after implementing the equals and hashcode (i use Intellij, and i auto generated the equals and hashcode), the problem is here. Do you have further advice to give me? I&#39;m truly sorry if i&#39;m looking stupid, but after hours of trying, maybe there&#39;s something i&#39;m missing."},{"comment_id":134563027,"body":"Also, i updated the code with the new &#39;setOnDragDropped&#39; and the &#39;equals&#39; and &#39;hashcode&#39; in Categoria."},{"comment_id":134564349,"body":"I would appreciate that so so much, take your time, you already did very much. And again, sorry if i&#39;m sounding like such an hardhead!"},{"comment_id":134575620,"body":"Added class based example."}],"answer_id":76285625,"body":"<p>Here is an example of using a custom data format when dragging a serializable record to reorder a list in a list view.</p>\n<p>In the picture, the &quot;Planet&quot; category is in the process of being dragged over the &quot;Star&quot; category.  It would be a bit clearer if the drag cursor was shown, but the screenshot does not pick up the cursor.</p>\n<p><a href=\"https://i.stack.imgur.com/Qy1fB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qy1fB.png\" alt=\"enter image description here\" /></a></p>\n<p>You could modify it to use a custom class, but I find it easier to work with records for this case.</p>\n<p>I won't go over what you are doing wrong in your current implementation, as <a href=\"https://stackoverflow.com/a/76284109/1155209\">John Bollinger's answer and comments</a> have already covered most of that.</p>\n<p>I won't explain this much, it is similar to the answer to the earlier related question (which, also, I didn't really explain :-), but modified for a custom data type rather than an image:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/20412445/how-to-create-a-reorder-able-tableview-in-javafx\">How to create a reorder-able TableView in JavaFx</a></li>\n</ul>\n<p>Hopefully, you can understand what is happening by reading the code, referring to the javadoc, and checking out the Oracle <a href=\"https://docs.oracle.com/javase/8/javafx/events-tutorial/drag-drop.htm\" rel=\"nofollow noreferrer\">tutorial</a> and <a href=\"https://docs.oracle.com/javase/8/javafx/events-tutorial/paper-doll.htm\" rel=\"nofollow noreferrer\">cool example</a> on drag and drop in JavaFX.</p>\n<pre><code>import javafx.application.Application;\nimport javafx.collections.FXCollections;\nimport javafx.collections.ListChangeListener;\nimport javafx.collections.ObservableList;\nimport javafx.geometry.Insets;\nimport javafx.scene.Scene;\nimport javafx.scene.control.ListCell;\nimport javafx.scene.control.ListView;\nimport javafx.scene.input.*;\nimport javafx.scene.layout.VBox;\nimport javafx.stage.Stage;\n\nimport java.io.Serializable;\nimport java.util.Collections;\nimport java.util.List;\n\n\npublic class DraggableRecords extends Application {\n\n    public record Category(\n            String name,\n            String description\n    ) implements Serializable {}\n\n    private static final ObservableList&lt;Category&gt; categories = FXCollections.observableArrayList(\n            new Category(&quot;Star&quot;, &quot;A ball of hot plasma&quot;),\n            new Category(&quot;Planet&quot;, &quot;A large, rounded astronomical body that is neither a star nor its remnant.&quot;),\n            new Category(&quot;Galaxy&quot;, &quot;A system of stars, bound together by gravity&quot;),\n            new Category(&quot;Universe&quot;, &quot;All of space and time and their contents,&quot;)\n    );\n\n    private static final DataFormat CATEGORY_DATA_FORMAT = new DataFormat(\n            &quot;application/jewelsea-category&quot;\n    );\n\n    private static final String REORDER_CATEGORIES =\n            &quot;Drag the categories to order from largest to smallest&quot;;\n\n    private static final String CATEGORIES_ARE_IN_ORDER =\n            &quot;The categories have been reordered correctly&quot;;\n\n    @Override\n    public void start(Stage stage) {\n        do {\n            Collections.shuffle(categories);\n        } while (categoriesAreInOrder());\n\n        ListView&lt;Category&gt; categoryListView = new ListView&lt;&gt;(categories);\n        categoryListView.setCellFactory(param -&gt; new CategoryCell());\n        categoryListView.setPrefSize(\n                430, 180\n        );\n\n        VBox layout = new VBox(categoryListView);\n        layout.setPadding(new Insets(10));\n\n        stage.setTitle(REORDER_CATEGORIES);\n        stage.setScene(new Scene(layout));\n        stage.show();\n\n        categories.addListener((ListChangeListener&lt;Category&gt;) change -&gt; {\n            stage.setTitle(\n                    categoriesAreInOrder()\n                            ? CATEGORIES_ARE_IN_ORDER\n                            : REORDER_CATEGORIES\n            );\n        });\n    }\n\n    private boolean categoriesAreInOrder() {\n        List&lt;String&gt; displayedCategoryNames = categories.stream().map(\n                Category::name\n        ).toList();\n\n        return displayedCategoryNames.equals(\n                List.of(&quot;Universe&quot;, &quot;Galaxy&quot;, &quot;Star&quot;, &quot;Planet&quot;)\n        );\n    }\n\n    public static void main(String[] args) {\n        launch(DraggableRecords.class);\n    }\n\n    private static final class CategoryCell extends ListCell&lt;Category&gt; {\n        public CategoryCell() {\n            final ListCell&lt;Category&gt; thisCell = this;\n\n            setOnDragDetected(event -&gt; {\n                if (getItem() == null) {\n                    return;\n                }\n\n                Dragboard dragboard = startDragAndDrop(TransferMode.MOVE);\n                ClipboardContent content = new ClipboardContent();\n                content.putString(getItem().toString());\n                content.put(CATEGORY_DATA_FORMAT, getItem());\n\n                dragboard.setContent(content);\n\n                event.consume();\n            });\n\n            setOnDragOver(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasContent(CATEGORY_DATA_FORMAT)) {\n                    event.acceptTransferModes(TransferMode.MOVE);\n                }\n\n                event.consume();\n            });\n\n            setOnDragEntered(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasContent(CATEGORY_DATA_FORMAT)) {\n                    setOpacity(0.3);\n                }\n            });\n\n            setOnDragExited(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasContent(CATEGORY_DATA_FORMAT)) {\n                    setOpacity(1);\n                }\n            });\n\n            setOnDragDropped(event -&gt; {\n                if (getItem() == null) {\n                    return;\n                }\n\n                Dragboard db = event.getDragboard();\n                boolean success = false;\n\n                if (db.hasContent(CATEGORY_DATA_FORMAT)) {\n                    Category droppedCategory = (Category) db.getContent(\n                            CATEGORY_DATA_FORMAT\n                    );\n                    ObservableList&lt;Category&gt; items = getListView().getItems();\n                    int draggedIdx = items.indexOf(\n                            droppedCategory\n                    );\n                    int thisIdx = items.indexOf(getItem());\n\n                    Category temp = categories.get(draggedIdx);\n                    categories.set(draggedIdx, categories.get(thisIdx));\n                    categories.set(thisIdx, temp);\n\n                    success = true;\n                }\n                event.setDropCompleted(success);\n\n                event.consume();\n            });\n\n            setOnDragDone(DragEvent::consume);\n        }\n\n        @Override\n        protected void updateItem(Category item, boolean empty) {\n            super.updateItem(item, empty);\n\n            setText(\n                    (empty || item == null)\n                            ? null\n                            : item.name + &quot;\\n&quot; + item.description\n            );\n        }\n    }\n}\n</code></pre>\n<p>The solution provided isn't the only solution.  You could use a different serialization format (e.g. a JSON string) rather than the custom binary format used here.  That might be good if you need compatibility with other applications.  I won't demonstrate an alternative string serialization using JSON here though.</p>\n<p>It is possible to place multiple entries in the <code>DragBoard</code> for the same item, with each entry providing a different representation of the same data.  I did that here, using a custom data format for the binary data and a string format, which just invokes <code>toString</code> on the item.  If you drag within the app, which understands the binary format, the app can use the binary format.  However, if you drag to something outside the app, which won't understand the custom format, it will fall back to the string format.  This can be seen by dragging items from the example into a text editor.</p>\n<p><strong>FAQ</strong></p>\n<blockquote>\n<p>so i can make this work with Classes</p>\n</blockquote>\n<p>For a class, generate <code>hashCode</code> and <code>equals</code> functions using your IDE and use equals instead of <code>==</code> to test equivalence, so that you avoid some of the issues mentioned by John Bollinger.</p>\n<p>For a record you don't need to write the hashing and equals functions, or the accessor functions, as the records provide them.</p>\n<p>Other than that, most of the implementation is the same regardless of whether you choose to use records or classes.</p>\n<pre><code>import javafx.application.Application;\nimport javafx.collections.FXCollections;\nimport javafx.collections.ListChangeListener;\nimport javafx.collections.ObservableList;\nimport javafx.geometry.Insets;\nimport javafx.scene.Scene;\nimport javafx.scene.control.ListCell;\nimport javafx.scene.control.ListView;\nimport javafx.scene.input.*;\nimport javafx.scene.layout.VBox;\nimport javafx.stage.Stage;\n\nimport java.io.Serializable;\nimport java.util.Collections;\nimport java.util.List;\nimport java.util.Objects;\n\n\npublic class DraggableRecords extends Application {\n\n    public static final class Category implements Serializable {\n        private final String name;\n        private final String description;\n\n        public Category(String name, String description) {\n            this.name = name;\n            this.description = description;\n        }\n\n        public String getName() {\n            return name;\n        }\n\n        public String getDescription() {\n            return description;\n        }\n\n        @Override\n        public boolean equals(Object o) {\n            if (this == o) return true;\n            if (o == null || getClass() != o.getClass()) return false;\n            Category category = (Category) o;\n            return Objects.equals(name, category.name) &amp;&amp; Objects.equals(description, category.description);\n        }\n\n        @Override\n        public int hashCode() {\n            return Objects.hash(name, description);\n        }\n\n        @Override\n        public String toString() {\n            return &quot;Category{&quot; +\n                    &quot;name='&quot; + name + '\\'' +\n                    &quot;, description='&quot; + description + '\\'' +\n                    '}';\n        }\n    }\n\n    private static final ObservableList&lt;Category&gt; categories = FXCollections.observableArrayList(\n            new Category(&quot;Star&quot;, &quot;A ball of hot plasma.&quot;),\n            new Category(&quot;Planet&quot;, &quot;A large, rounded astronomical body that is neither a star nor its remnant.&quot;),\n            new Category(&quot;Galaxy&quot;, &quot;A system of stars, bound together by gravity.&quot;),\n            new Category(&quot;Universe&quot;, &quot;All of space and time and their contents.&quot;)\n    );\n\n    private static final DataFormat CATEGORY_DATA_FORMAT = new DataFormat(\n            &quot;application/jewelsea-category&quot;\n    );\n\n    private static final String REORDER_CATEGORIES =\n            &quot;Drag the categories to order from largest to smallest&quot;;\n\n    private static final String CATEGORIES_ARE_IN_ORDER =\n            &quot;The categories have been reordered from correctly&quot;;\n\n    @Override\n    public void start(Stage stage) {\n        do {\n            Collections.shuffle(categories);\n        } while (categoriesAreInOrder());\n\n        ListView&lt;Category&gt; categoryListView = new ListView&lt;&gt;(categories);\n        categoryListView.setCellFactory(param -&gt; new CategoryCell());\n        categoryListView.setPrefSize(\n                430, 180\n        );\n\n        VBox layout = new VBox(categoryListView);\n        layout.setPadding(new Insets(10));\n\n        stage.setTitle(REORDER_CATEGORIES);\n        stage.setScene(new Scene(layout));\n        stage.show();\n\n        categories.addListener((ListChangeListener&lt;Category&gt;) change -&gt; {\n            stage.setTitle(\n                    categoriesAreInOrder()\n                            ? CATEGORIES_ARE_IN_ORDER\n                            : REORDER_CATEGORIES\n            );\n        });\n    }\n\n    private boolean categoriesAreInOrder() {\n        List&lt;String&gt; displayedCategoryNames = categories.stream().map(\n                Category::getName\n        ).toList();\n\n        return displayedCategoryNames.equals(\n                List.of(&quot;Universe&quot;, &quot;Galaxy&quot;, &quot;Star&quot;, &quot;Planet&quot;)\n        );\n    }\n\n    public static void main(String[] args) {\n        launch(DraggableRecords.class);\n    }\n\n    private static final class CategoryCell extends ListCell&lt;Category&gt; {\n        public CategoryCell() {\n            final ListCell&lt;Category&gt; thisCell = this;\n\n            setOnDragDetected(event -&gt; {\n                if (getItem() == null) {\n                    return;\n                }\n\n                Dragboard dragboard = startDragAndDrop(TransferMode.MOVE);\n                ClipboardContent content = new ClipboardContent();\n                content.putString(getItem().toString());\n                content.put(CATEGORY_DATA_FORMAT, getItem());\n\n                dragboard.setContent(content);\n\n                event.consume();\n            });\n\n            setOnDragOver(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasContent(CATEGORY_DATA_FORMAT)) {\n                    event.acceptTransferModes(TransferMode.MOVE);\n                }\n\n                event.consume();\n            });\n\n            setOnDragEntered(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasContent(CATEGORY_DATA_FORMAT)) {\n                    setOpacity(0.3);\n                }\n            });\n\n            setOnDragExited(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasContent(CATEGORY_DATA_FORMAT)) {\n                    setOpacity(1);\n                }\n            });\n\n            setOnDragDropped(event -&gt; {\n                if (getItem() == null) {\n                    return;\n                }\n\n                Dragboard db = event.getDragboard();\n                boolean success = false;\n\n                if (db.hasContent(CATEGORY_DATA_FORMAT)) {\n                    Category droppedCategory = (Category) db.getContent(\n                            CATEGORY_DATA_FORMAT\n                    );\n                    ObservableList&lt;Category&gt; items = getListView().getItems();\n                    int draggedIdx = items.indexOf(\n                            droppedCategory\n                    );\n                    int thisIdx = items.indexOf(getItem());\n\n                    Category temp = categories.get(draggedIdx);\n                    categories.set(draggedIdx, categories.get(thisIdx));\n                    categories.set(thisIdx, temp);\n\n                    success = true;\n                }\n                event.setDropCompleted(success);\n\n                event.consume();\n            });\n\n            setOnDragDone(DragEvent::consume);\n        }\n\n        @Override\n        protected void updateItem(Category item, boolean empty) {\n            super.updateItem(item, empty);\n\n            setText(\n                    (empty || item == null)\n                            ? null\n                            : item.getName() + &quot;\\n&quot; + item.getDescription()\n            );\n        }\n    }\n}\n</code></pre>\n"}],"last_activity_date":1684851343,"question_id":76284010,"body":"<p>i'm implementing a Drag and drop system for a ListView. I've drawn inspiration from this code:</p>\n<p><a href=\"https://gist.github.com/jewelsea/7821196\" rel=\"nofollow noreferrer\">https://gist.github.com/jewelsea/7821196</a></p>\n<p>This is what i did:</p>\n<pre><code>package com.example.ratatouille23.View.Supervisore;\n\n\n\npublic class CategoryOrder {\n\n    @FXML\n    private VBox vbox;\n\n    ObservableList&lt;Categoria&gt; categorie;\n\n    @FXML\n    public void initialize() {\n\n        popolaListview();\n    }\n\n    private void popolaListview() {\n\n\n        Piatto piatto1 = new Piatto(&quot;A&quot;, &quot;B&quot;,\n                &quot;C&quot;,\n                &quot;D&quot;);\n\n        ArrayList&lt;Piatto&gt; lista1 = new ArrayList&lt;Piatto&gt;();\n\n        lista1.add(piatto1);\n\n\n\n        Categoria cat1 = new Categoria(&quot;Antipasti&quot;, lista1);\n\n        Categoria cat2 = new Categoria(&quot;Primi piatti&quot;, lista1);\n\n        ArrayList&lt;Categoria&gt; listaCat = new ArrayList&lt;Categoria&gt;();\n\n        listaCat.add(cat1);\n        listaCat.add(cat2);\n        listaCat.add(cat2);\n        listaCat.add(cat1);\n\n\n        categorie = FXCollections.observableArrayList(listaCat);\n\n        ListView&lt;Categoria&gt; listaCategorie = new ListView&lt;&gt;(categorie);\n        listaCategorie.setCellFactory(new Callback&lt;ListView&lt;Categoria&gt;, ListCell&lt;Categoria&gt;&gt;() {\n            @Override\n            public ListCell&lt;Categoria&gt; call(ListView&lt;Categoria&gt; listaCategorie) {\n                return new CategoriaCell();\n            }\n        });\n\n        vbox.getChildren().add(listaCategorie);\n\n    }\n\n\n\n    private class CategoriaCell extends ListCell&lt;Categoria&gt; {\n\n        public CategoriaCell() {\n            ListCell thisCell = this;\n\n            setContentDisplay(ContentDisplay.TEXT_ONLY);\n\n            setAlignment(Pos.CENTER_LEFT);\n\n            setOnDragDetected(event -&gt; {\n                if (getItem() == null) {\n                    return;\n                }\n\n\n                Dragboard dragboard = startDragAndDrop(TransferMode.MOVE);\n                ClipboardContent content = new ClipboardContent();\n\n                content.putString(String.valueOf(getItem()));\n\n                dragboard.setContent(content);\n\n                event.consume();\n            });\n\n            setOnDragOver(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasString()) {\n                    event.acceptTransferModes(TransferMode.MOVE);\n                }\n\n                event.consume();\n            });\n\n            setOnDragEntered(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasString()) {\n                    setOpacity(0.3);\n                }\n            });\n\n            setOnDragExited(event -&gt; {\n                if (event.getGestureSource() != thisCell &amp;&amp;\n                        event.getDragboard().hasString()) {\n                    setOpacity(1);\n                }\n            });\n\n            setOnDragDropped(event -&gt; {\n                if (getItem().equals(null)) {\n                    return;\n                }\n\n                Dragboard db = event.getDragboard();\n                boolean success = false;\n\n                if (db.hasContent(CATEGORY_DATA_FORMAT)) {\n                    Categoria droppedCategory = (Categoria) db.getContent(\n                            CATEGORY_DATA_FORMAT\n                    );\n\n        \n                    ObservableList&lt;Categoria&gt; items = getListView().getItems();\n\n\n                    int draggedIdx = items.indexOf(droppedCategory);\n\n                    int thisIdx = items.indexOf(getItem());\n\n                    Categoria temp = categorie.get(draggedIdx);\n                    categorie.set(draggedIdx, categorie.get(thisIdx));\n                    categorie.set(thisIdx, temp);\n\n                    success = true;\n                }\n                event.setDropCompleted(success);\n\n                event.consume();\n            });\n            setOnDragDone(DragEvent::consume);\n        }\n\n        @Override\n        protected void updateItem(Categoria item, boolean empty) {\n            super.updateItem(item, empty);\n            if (empty || item == null) {\n                setText(null);\n            } else {\n                setText(item.getNome());\n            }\n        }\n    }\n\n}\n\n\n</code></pre>\n<p>These are my Piatto and Categoria classes:</p>\n<pre><code>package com.example.ratatouille23.Model;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class Categoria {\n\n    private String nomeCategoria;\n    private List&lt;Piatto&gt; listaPiatti;\n\n    public Categoria(String nome, List&lt;Piatto&gt; lista) {\n        this.nomeCategoria = nome;\n        listaPiatti = lista;\n    }\n\n    public String getNome() {\n        return nomeCategoria;\n    }\n\n    public void setNome(String nome) {\n        this.nomeCategoria = nome;\n    }\n\n    public List&lt;Piatto&gt; getPiatti() {\n        return listaPiatti;\n    }\n\n    public void setPiatti(List&lt;Piatto&gt; piatti) {\n        this.listaPiatti = piatti;\n    }\n\n    @Override\n    public String toString() {\n        return nomeCategoria;\n    }\n\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (!(o instanceof Categoria categoria)) return false;\n        return Objects.equals(nomeCategoria, categoria.nomeCategoria) &amp;&amp; Objects.equals(listaPiatti, categoria.listaPiatti);\n    }\n\n    @Override\n    public int hashCode() {\n        return Objects.hash(nomeCategoria, listaPiatti);\n    }\n}\n\n\n\n\npackage com.example.ratatouille23.Model;\n\npublic class Piatto {\n    private String nomePiatto;\n    private String costoPiatto;\n    private String allergeni;\n    private String descrizione;\n\n    public Piatto(String nomePiatto, String costoPiatto, String allergeni, String descrizione) {\n        this.nomePiatto = nomePiatto;\n        this.costoPiatto = costoPiatto;\n        this.allergeni = allergeni;\n        this.descrizione = descrizione;\n    }\n\n    public String getNomePiatto() {\n        return nomePiatto;\n    }\n\n    public void setNomePiatto(String nomePiatto) {\n        this.nomePiatto = nomePiatto;\n    }\n\n    public String getCostoPiatto() {\n        return costoPiatto;\n    }\n\n    public void setCostoPiatto(String costoPiatto) {\n        this.costoPiatto = costoPiatto;\n    }\n\n    public String getAllergeni() {\n        return allergeni;\n    }\n\n    public void setAllergeni(String allergeni) {\n        this.allergeni = allergeni;\n    }\n\n    public String getDescrizione() {\n        return descrizione;\n    }\n\n    public void setDescrizione(String descrizione) {\n        this.descrizione = descrizione;\n    }\n\n    @Override\n    public String toString() {\n        return nomePiatto;\n    }\n}\n\n</code></pre>\n<p>The code executes just fine, and my ListView is populated. When i drag and drop an element, however, this is the error it gives me:</p>\n<pre><code>Exception in thread &quot;JavaFX Application Thread&quot; java.lang.IndexOutOfBoundsException: Index -1 out of bounds for length 4\n    at java.base/jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:100)\n    at java.base/jdk.internal.util.Preconditions.outOfBoundsCheckIndex(Preconditions.java:106)\n    at java.base/jdk.internal.util.Preconditions.checkIndex(Preconditions.java:302)\n</code></pre>\n<p>And the line that throws it is:</p>\n<pre><code>                event.consume();\n</code></pre>\n<p>I don't really know how to solve this. Any help is appreciated.</p>\n"},{"comments":[{"comment_id":134575967,"body":"Be careful; <code>initShot</code> should probably call <code>setX</code> and <code>setY</code>. You&#39;ll need some kind of game loop that updates each bullet&#39;s position every frame, and checks if each bullet intersects any aliens. This would be easier to do if your game logic wasn&#39;t mixed in with your UI code"}],"last_activity_date":1684851305,"question_id":76315717,"body":"<p>I'm using Java writing Spaceinvaders code, how can I get bullets to destroy aliens?</p>\n<p>I want there's a buttets shot from gamer when press &quot;J&quot; in keyboard.But I don't kown how to achive it.I'm a bigenner of code.I'll do my best to show you the relevant bits of code and any help indicating what might be the problem would be greatly appreciated :)\nThis is the shot class</p>\n<pre><code>package SpaceInvaders;\n\nimport javax.swing.*;\nimport java.awt.*;\nimport java.net.URL;\n\npublic class Shot {\n    public static URL BulletURL = Data.class.getResource(&quot;bullet.png&quot;);\n    public static ImageIcon bullet = new ImageIcon(BulletURL);//子弹\n    public int x;\n    public int y;\n\n    public Shot(){\n\n    }\n\n    public Shot(int x,int y){\n\n        initShot(x,y);\n    }\n\n\n    public void setX(int x) {\n\n        this.x = x;\n    }\n\n    public void setY(int y) {\n\n        this.y = y;\n    }\n    private void initShot(int x,int y){\n\n    }\n}\n</code></pre>\n<p>and This is the main class involved</p>\n<pre><code>public class GamePanel extends JPanel implements KeyListener , ActionListener {\n    boolean isStar = false;//默认不开始\n    boolean isFail = false;\n    int gamerx;\n    int gamery;\n    int bulletx = 0;\n    int bullety = 0;\n    int score;\n    int bulletSpeed;\n    boolean bulletVisiable;\n    //存储子弹对象\n    Shot shot;\n    int [] alienx = new int[6];\n    int [] alieny = new int[6];\n    String Direction;\n    public GamePanel(){\n        init();\n        setSizeOfGame();\n        this.setFocusable(true);\n        this.addKeyListener(this);\n    }\n\n    public void setSizeOfGame(){\n\n        Data.alien.setImage(Data.alien.getImage().getScaledInstance(50,50,Image.SCALE_DEFAULT));\n        Shot.bullet.setImage(Shot.bullet.getImage().getScaledInstance(20,10,Image.SCALE_DEFAULT));\n        Data.gamer.setImage(Data.gamer.getImage().getScaledInstance(50,50,Image.SCALE_DEFAULT));\n        Data.background.setImage(Data.background.getImage().getScaledInstance(1395,680,Image.SCALE_DEFAULT));\n    }\n    public void init(){\n        gamerx = 100;\n        gamery = 230;\n        bulletSpeed = 20;\n        bulletVisiable = false;\n        score = 0;\n        for(int i=0;i&lt;6;i++){\n            alienx[i]=1395;\n            alieny[i]=230 + i*100;\n        }\n        Direction = &quot;R&quot;;\n        shot=new Shot(gamerx,gamery);\n        timer.start();\n    }\n    @Override//annotation\n    //画笔\n    protected void paintComponent(Graphics g){\n\n        try {\n            super.paintComponent(g);//clean scan\n            this.setBackground(Color.WHITE);\n\n            Data.header.paintIcon(this,g,0,10);\n            //操作界面大小\n            g.fillRect(25,180,1395,680);\n            Data.background.paintIcon(this,g,25,180);\n\n            g.setColor(Color.cyan);\n            g.setFont(new Font(&quot;微软雅黑&quot;,Font.BOLD,30));\n            g.drawString(&quot;积分： &quot;+score,1250,50);\n            g.setFont(new Font(&quot;微软雅黑&quot;,Font.BOLD,20));\n            g.setColor(Color.green);\n            g.drawString(&quot;你&quot;,5,300);\n            g.drawString(&quot;的&quot;,5,400);\n            g.drawString(&quot;家&quot;,5,500);\n            g.drawString(&quot;园&quot;,5,600);\n\n            Data.gamer.paintIcon(this,g,gamerx,gamery);\n            Shot.bullet.paintIcon(this,g,bulletx,bullety);\n            for(int i=0;i&lt;6;i++){\n                Data.alien.paintIcon(this,g,alienx[i],alieny[i]);\n            }\n\n            if(isStar == false){\n                g.setColor(Color.white);\n                g.setFont(new Font(&quot;微软雅黑&quot;,Font.BOLD,40));\n                g.drawString(&quot;Press any button to start&quot;,460,400);\n            }\n\n            if(isFail){\n                g.setColor(Color.RED);\n                g.setFont(new Font(&quot;微软雅黑&quot;,Font.BOLD,40));\n                g.drawString(&quot;太空侵略者入侵了你的家园,&quot;,460,400);\n                g.drawString(&quot;按空格键重新守护,&quot;,500,450);\n            }\n\n        }\n\n        catch (Exception e){\n            e.printStackTrace();\n        }\n\n    }\n\n    @Override\n    //TODO：键盘监听\n    public void keyPressed(KeyEvent e) {\n        try {\n            int keyCode = e.getKeyCode();\n\n            if (keyCode == KeyEvent.VK_SPACE) {\n                if(isFail){\n                    isFail = false;\n                    init();\n                }\n                else {\n                    isStar = !isStar;\n                }\n                repaint();\n\n            }\n            //move\n            if(keyCode == KeyEvent.VK_W){\n                Direction = &quot;W&quot;;\n            }else if(keyCode == KeyEvent.VK_S){\n                Direction = &quot;S&quot;;\n            }else if(keyCode == KeyEvent.VK_A){\n                Direction = &quot;A&quot;;\n            }else if(keyCode == KeyEvent.VK_D){\n                Direction = &quot;D&quot;;\n            }\n//LOOK HERE LOOK HERE LOOK HERE!!!!!\n            if(keyCode == KeyEvent.VK_J){\n                bulletx = gamerx;\n                bullety = gamery;\n            }\n        }\n        catch (Exception ee){\n            ee.printStackTrace();\n        }\n    }\n    //定时器\n    Timer timer = new Timer(100,this);\n    //事件监听\n    @Override\n    public void actionPerformed(ActionEvent e) {\n        if(isStar &amp;&amp; !isFail){\n\n            for(int i = 0;i&lt;6;i++) {\n                alienx[i] = alienx[i] - 25;\n            }\n\n        if(Direction.equals(&quot;W&quot;)){\n            bullety = bullety - 25;\n            gamery = gamery - 20;\n            //边界判断\n            if(gamery &lt; 180)\n                gamery = 700;\n        }else if(Direction.equals(&quot;S&quot;)){\n            bullety = bullety + 25;\n            gamery = gamery + 20;\n            //边界判断\n            if(gamery &gt; 860)\n                gamery = 60;\n        }else if(Direction.equals(&quot;A&quot;)){\n            bulletx = bulletx - 25;\n            gamerx = gamerx - 20;\n            if(gamerx &lt; 10){\n                gamerx = 1370;\n            }\n        } else if (Direction.equals(&quot;D&quot;)) {\n            bulletx = bulletx + 25;\n            gamerx = gamerx + 20;\n            if(gamerx &gt; 1395){\n                gamerx = 25;\n            }\n        }\n        //TODO：失败判断\n        if(alienx[0] &lt;= 0){\n            isFail = true;\n        }\n            repaint();\n        }\n        timer.start();\n    }\n\n\n\n    //没用\n    @Override\n    public void keyReleased(KeyEvent e) {}\n    @Override\n    public void keyTyped(KeyEvent e) {}\n}\n\n</code></pre>\n"},{"answers":[{"answer_id":76315087,"body":"<p>By default springdoc serves the api documentation</p>\n<p>at /v3/api-docs in json format\nat /v3/api-docs.yaml in yaml format</p>\n<p>The first is shown to as a link in swagger-ui. To have the second shown as link you need to set the following spring configuration property</p>\n<p>springdoc.swagger-ui.url: /v3/api-docs.yaml</p>\n"},{"answer_id":76315729,"body":"<p>Yes, it is possible to have Swagger link the API documentation in YAML format by default when using Springdoc.</p>\n<p>Springdoc integrates with Swagger UI to generate API documentation, and Swagger UI supports both JSON and YAML formats. To configure Springdoc to use YAML as the default format, you can follow these steps:</p>\n<p>Include the necessary dependencies: Make sure you have the required dependencies in your project. You need springdoc-openapi-ui for Swagger UI integration and snakeyaml for YAML support.</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springdoc&lt;/groupId&gt;\n    &lt;artifactId&gt;springdoc-openapi-ui&lt;/artifactId&gt;\n    &lt;version&gt;1.7.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.yaml&lt;/groupId&gt;\n    &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;\n    &lt;version&gt;2.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Configure Springdoc to use YAML format: In your Spring Boot application configuration, you can define a bean of type OpenAPI and configure it to produce YAML output. You can use the YamlOpenAPIResource class provided by Springdoc to generate the YAML documentation.</p>\n<pre><code>import io.swagger.v3.oas.models.OpenAPI;\nimport org.springdoc.core.SwaggerUiConfigParameters;\nimport org.springdoc.core.SwaggerUiConfigParametersBuilder;\nimport org.springdoc.core.SwaggerUiConfigProperties;\n\n@Configuration\npublic class SwaggerConfiguration {\n\n    @Bean\n    public OpenAPI openAPI() {\n        return new OpenAPI();\n    }\n\n    @Bean\n    public SwaggerUiConfigParameters swaggerUiConfigParameters() {\n        SwaggerUiConfigProperties properties = new SwaggerUiConfigProperties();\n        properties.setConfigUrl(&quot;/v3/api-docs.yaml&quot;); // Set the YAML URL as the default\n\n        return new SwaggerUiConfigParametersBuilder(properties).build();\n    }\n}\n</code></pre>\n<p>In this configuration, setConfigUrl() is used to set the default URL for the Swagger UI configuration. By setting it to &quot;/v3/api-docs.yaml&quot;, it tells Swagger UI to load the documentation in YAML format by default.</p>\n<p>Generate and access the YAML documentation: Start your application, and you can access the API documentation in YAML format by navigating to the following URL:</p>\n<p>bash</p>\n<pre><code>http://localhost:8080/swagger-ui/index.html?configUrl=/v3/api-docs.yaml\n</code></pre>\n<p>This URL will load Swagger UI with the API documentation in YAML format.</p>\n<p>Note: The configUrl parameter is used to specify the URL of the Swagger configuration file. In this case, it points to the YAML file generated by Springdoc.</p>\n"}],"last_activity_date":1684851176,"question_id":76315011,"body":"<p>Using springdoc is it possibile to have swagger link the api documentation in yaml format by default?</p>\n<p>By default springdoc have swagger link the api documentation in json format. Sometimes it's desirable to have the documentation in yaml format by default.</p>\n"},{"comments":[{"comment_id":134572860,"body":"How are you measuring? Did you time the two implementations of <code>AuthenticationProvider</code> or end-to-end request-response time?"},{"comment_id":134573365,"body":"Ahh good question.  I did nothing as elaborate as that.  I was simply looking at the response time in postman when I ran my tests against myApp.  The reason I am looking at the authentication is that if I turn off all authentication the transactions complete in under 10ms.  When I enable Basic Authentication directly to the vault I see request-response times of 375ms and when I use the InMemoryUserDetailsManager and not direct calls to Vault I see very similar request-response times of 370ms.  I thought it would be more with an InMemory data structure."},{"comment_id":134575751,"body":"Your screenshots suggests a &lt;1% difference."}],"last_activity_date":1684851035,"question_id":76314045,"body":"<p>I was playing around with a little Spring Boot application that uses Hashicorp Vault. I wanted to implement Basic Authentication and wondered if I could keep the users details in the vault.  There will never be many users for this app perhaps 5 - 10 different users.  As the vault is used for other things I wanted to avoid having to keep the users in a separate database somewhere.</p>\n<p>The vault has kv (v1) engine which contains the username, a Bcrypt encoded password and the Roles of the user.</p>\n<p>When a user logins into this app it does a lookup for the provided username in the vault and compares the password provided (which is BCrypt encoded) with the encoded password string from the vault and if authenticated collects the Roles etc etc...</p>\n<p>Something like this.</p>\n<p>I include this into my POM file</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.springframework.vault&lt;/groupId&gt;\n   &lt;artifactId&gt;spring-vault-core&lt;/artifactId&gt;\n   &lt;version&gt;3.0.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>A simple User POJO</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class VaultBasicUser {\n    private String password;\n    private String roles;\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getRoles() {\n        return roles;\n    }\n\n    public void setRoles(String roles) {\n        this.roles = roles;\n    }\n}\n</code></pre>\n<p>My Custom Authentication Provider</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Slf4j\n@Component\npublic class BasicVaultAuthentication implements AuthenticationProvider {\n\n    @Autowired\n    private VaultTemplate vaultTemplate;\n    \n    @Override\n    public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n        \n        String name = authentication.getName();\n        String password = authentication.getCredentials().toString();\n        \n        VaultResponseSupport&lt;VaultBasicUser&gt; vaultResponse = vaultTemplate.read(&quot;myApp/users/&quot; + name, VaultBasicUser.class);\n        \n        String vaultSecret = vaultResponse.getData().getPassword();\n        \n        if (vaultSecret != null) {\n            if (BCrypt.checkpw(password, vaultSecret)) {\n        \n                String vaultRoles = vaultResponse.getData().getRoles();\n                        \n                List&lt;GrantedAuthority&gt; roles = new ArrayList&lt;&gt;();\n                \n                String[] stringOfRoles = vaultRoles.split(&quot;,&quot;);\n                for (String singleRole : stringOfRoles) {\n                    roles.add(new SimpleGrantedAuthority(singleRole.replaceAll(&quot;\\s&quot;, &quot;&quot;)));\n                }\n                \n                UserDetails principal = new User(name, password, roles);\n                Authentication auth = new UsernamePasswordAuthenticationToken(principal, password, roles);\n                return auth;\n            }\n            else {\n                log.info(&quot;Incorrect Credentials (Password)&quot;);\n                return null;\n            }\n        }\n        else {\n            log.info(&quot;Incorrect Credentials (User Not found in Vault)&quot;);\n            return null;\n        }\n    }\n\n    @Override\n    public boolean supports(Class&lt;?&gt; authentication) {\n        return authentication.equals(UsernamePasswordAuthenticationToken.class\n        );\n    }\n</code></pre>\n<p>This works, however when testing I noticed that each transaction's authentication was taking about 375ms to process.  I wondered if I change my strategy a little if I could reduce the 375ms for the authentication.</p>\n<p>So I thought perhaps I could populate an InMemoryUserDetailsManager at startup and then the users will be in memory so the authentication part won't rely on API calls to the Vault for each transaction thereby reducing the time for authentication.</p>\n<p>I tried something like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\n    public UserDetailsService userDetailsService(PasswordEncoder encoder) {\n        \n        Collection&lt;UserDetails&gt; allUsers = new ArrayList();\n\n        log.info(&quot;Collecting MyApp users from Vault: &quot; + vaultConfig.getUrl());\n\n        // ***** Get All users from Vault HERE ***** \n            VaultEndpoint vaultEndpoint;\n            try {\n                vaultEndpoint = VaultEndpoint.from(new URI(vaultConfig.getUrl()));\n                VaultTemplate vaultTemplate = new VaultTemplate(vaultEndpoint, new TokenAuthentication(vaultConfig.getToken()));\n                List&lt;String&gt; vaultUsers = vaultTemplate.list(&quot;myApp/users&quot;);\n\n                for (String vaultUser : vaultUsers) {\n                    VaultResponseSupport&lt;VaultBasicUser&gt; vaultResponse = vaultTemplate.read(&quot;myApp/users/&quot; + vaultUser, VaultBasicUser.class);\n                    String password = vaultResponse.getData().getPassword();\n                    String vaultRoles = vaultResponse.getData().getRoles();\n                    \n                    log.info(&quot;Adding User: [&quot; + vaultUser + &quot;, &quot; + password + &quot;, &quot; + vaultRoles + &quot;]&quot;);\n                    allUsers.add(User.withUsername(vaultUser).password(password).roles(vaultRoles).build());\n                }\n\n            } catch (URISyntaxException ex) {\n                log.error(&quot;Unable to read in MyApp users from Vault: &quot; + ex.getMessage());\n                log.info(&quot;Adding some Default Users...&quot;);\n                allUsers.add(User.withUsername(&quot;myapp_admin&quot;).password(encoder.encode(&quot;adminPassword&quot;)).roles(&quot;MYADMIN&quot;).build());\n                allUsers.add(User.withUsername(&quot;myapp_poweruser&quot;).password(encoder.encode(&quot;powerUserPassword&quot;)).roles(&quot;MYELEVATED&quot;).build());\n                allUsers.add(User.withUsername(&quot;myapp_client&quot;).password(encoder.encode(&quot;clientPassword&quot;)).roles(&quot;MYUSER&quot;).build());\n            }\n        } else {\n            log.info(&quot;Authentication configured for [&quot; + authType.getType() + &quot;] - Not connecting to Vault!&quot;);\n        }\n\n        return new InMemoryUserDetailsManager(allUsers);\n    }\n</code></pre>\n<p>However, when I run the same test the authentication still takes approximately 370ms.  Is my thinking totally wrong here?  Shouldn't retrieving the user details from memory be faster than getting them from the vault directly?  Have I got a problem somewhere else?</p>\n<p><strong>Edit #1:</strong> Added some screenshots of using the Profiler in Netbeans.</p>\n<p>This image is of using the BasicVaultAuthentication Custom Authentication Provider (This is where the call to the Vault happens right before the BCrypt.checkpw)</p>\n<p><a href=\"https://i.stack.imgur.com/2fcyg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2fcyg.png\" alt=\"enter image description here\" /></a></p>\n<p>This picture is using the InMemoryUserDetailsManager However the authentication should be against the users that have been loaded into memory.</p>\n<p><a href=\"https://i.stack.imgur.com/XyMJ0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XyMJ0.png\" alt=\"enter image description here\" /></a></p>\n"},{"comments":[{"comment_id":134534751,"body":"Why are you using PrimaryKeyJoinColumn instead of @MapsId? Try it instead and remove the mappedby- mappedby means the other side has the foreign key or at least defines the relationship which isn’t the case here. Do you really have both a customer_id and a separate appraised_for column or should that too be a single relation to the customer table?"},{"comment_id":134540766,"body":"@Chris, I removed the PrimaryKeyJoinColumn and renamed the customer_id column: @Column(name=&quot;appraised_for&quot;, insertable=false, updatable=false)."}],"answers":[{"answer_id":76315683,"body":"<p>Since you have a composite primary key mapped in the entity that references other entities, you might want to let JPA handle the foreign key values directly so you don't have to set them yourself. With JPA 2.0 and beyond, you can mark relationship with @Id or if using basic/embeddableId mappings for the identifiers, tell JPA that the relationship controls the mapping using @MapsId instead:</p>\n<pre><code>@Entity\n@Table(name = &quot;appraisal&quot;)\n@IdClass(AppraisalId.class)\npublic class Appraisal {\n    \n    @Id\n    private Long vehicleId;\n    \n    @MapsId(&quot;vehicleId&quot;)\n    @OneToOne\n    @JoinColumn(name=&quot;vehicle_id&quot;)\n    private Vehicle vehicle;\n    \n    @Id\n    private Long customerId;\n    \n    @MapsId(&quot;customerId&quot;)\n    @OneToOne\n    @JoinColumn(name=&quot;appraised_for&quot;, referencedColumnName=&quot;id&quot;)\n    private Customer customer;\n    \n    ..\n}\n</code></pre>\n"}],"last_activity_date":1684850908,"question_id":76291469,"body":"<p>I'm trying to link two entities using JPA via a one-to-one relationship, but I'm getting a &quot;referenced property unknown&quot; error one one of the classes.  Here is a diagram of the two entities in question:</p>\n<p><a href=\"https://i.stack.imgur.com/8RFHN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8RFHN.png\" alt=\"Model diagram\" /></a></p>\n<p>The vehicle_id column of the appraisal table links to the id of the vehicle. For that reason, I added the @PrimaryKeyJoinColumn annotation in the Appraisal class:</p>\n<pre><code>@Entity\n@Table(name = &quot;appraisal&quot;)\n@Data\n@IdClass(AppraisalId.class)\npublic class Appraisal {\n    \n    @Id\n    @Column(name=&quot;vehicle_id&quot;)\n    private Long vehicleId;\n    \n    @PrimaryKeyJoinColumn\n    @OneToOne(mappedBy = &quot;appraisal&quot;)\n    private Vehicle vehicle;\n    \n    @Id\n    @Column(name=&quot;customer_id&quot;)\n    private Long customerId;\n    \n    @OneToOne\n    @JoinColumn(name=&quot;appraised_for&quot;, referencedColumnName=&quot;id&quot;)\n    private Customer customer;\n    \n    //1 column omitted for brevity\n}\n</code></pre>\n<p>Notice that the Appraisal class uses a composite PK.  Here is the AppraisalId class:</p>\n<pre><code>@Data\npublic class AppraisalId implements Serializable {\n    \n    private static final long serialVersionUID = -5373569618334807665L;\n    \n    private Long vehicleId;\n    private Long customerId;\n\n}\n</code></pre>\n<p>Here's the Vehicle class:</p>\n<pre><code>@Entity\n@Table(name = &quot;vehicle&quot;)\n@Getter\n@Setter\npublic class Vehicle {\n    \n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name=&quot;id&quot;)\n    private Long id;\n    \n    @OneToOne(mappedBy = &quot;vehicle&quot;)\n    private Appraisal appraisal;\n    \n    //other columns omitted for brevity\n}\n</code></pre>\n<p>Note that I'm using the Lombok @Data annotation to generate getters and setters.</p>\n<p>The exact error is &quot;Unknown mappedBy in: ca.allauto.ups.model.Appraisal.vehicle, referenced property unknown: ca.allauto.ups.model.Vehicle.appraisal&quot;.</p>\n<p><strong>Any ideas what I'm doing wrong?</strong></p>\n"},{"comments":[{"comment_id":134561134,"body":"Not an answer,just a couple of observations: (1) For Lucene 9.6.0, you need to use <a href=\"https://mvnrepository.com/artifact/org.apache.lucene/lucene-analysis-common\" rel=\"nofollow noreferrer\"><code>lucene-analysis-common</code></a>. The package was renamed from <code>analyzers</code> to <code>analysis</code>. Don&#39;t mix different JAR versions. (2) The sort you are trying to implement is the default sort order (by score, highest to lowest) - so you can remove it and get the required result (as you mention in the question)."},{"comment_id":134563564,"body":"Some more notes: When you do not try to use an explicit sort, you can retrieve the score from your <code>ScoreDoc</code>, which is: <code>doc=2 score=0.49662238 shardIndex=-1</code> (as you note). But when you get <code>NaN</code> the <code>ScoreDoc</code> is this:  <code>doc=2 score=NaN shardIndex=-1 fields=[0.49662238]</code>. You can see the <code>NaN</code> - but you can also see the score in the <code>fields</code> array - which looks very odd to me (but there may be an explanation). I would ask on the Lucene <code>java-user</code> mailing list - see <a href=\"https://lucene.apache.org/core/discussion.html\" rel=\"nofollow noreferrer\">here</a> for how to subscribe."},{"comment_id":134563811,"body":"Thanks @andrewJames for the hints! The <code>fields</code> property is part of the <code>FieldDoc</code> class (a subclass of <code>ScoreDoc</code>). The JavaDoc says, that it contains information about how to sort the documents. The <code>fields</code> array contains the score in THIS case, because I order by score. But it can also contain other types, depending on the type of the field-type that should be used for sorting."}],"answers":[{"answer_id":76315631,"body":"<p><strong>Short Answer</strong></p>\n<p>Sorting will work the way you expect, using your provided <code>Sort</code> criterion. It is equivalent to the default &quot;relevance&quot; sort order used by Lucene.</p>\n<p>You can still access the relevance score, if you want to, by casting <code>ScoreDoc</code> to <code>FieldDoc</code>.</p>\n<hr />\n<p><strong>Longer Answer</strong></p>\n<p>The sort order defined by:</p>\n<pre><code>Sort sort = new Sort(SortField.FIELD_SCORE);\n</code></pre>\n<p>is the same as the default sort order - which sorts by score (relevance) from highest to lowest. So, documents will be ordered in the same way in both cases.</p>\n<p>But when you use an explicit sort, you can no longer access the score using <code>scoreDoc.score</code>, as noted in the question. Instead you only get <code>NaN</code> (not a number).</p>\n<pre><code>2 : NaN\n</code></pre>\n<hr />\n<p>However, you can still access the score (if you want to) by casting each <code>ScoreDoc</code> instance to a <a href=\"https://lucene.apache.org/core/9_6_0/core/org/apache/lucene/search/FieldDoc.html\" rel=\"nofollow noreferrer\"><code>FieldDoc</code></a>. We get <code>FieldDocs</code> because we have added a sort field to our search.</p>\n<p><code>FieldDoc</code> extends <code>ScoreDoc</code>. It contains &quot;information about how to sort the referenced document&quot;.</p>\n<p>In our case, there is only one sort field and it is the <code>FIELD_SCORE</code> value.</p>\n<p>So, to print the score, we can change this code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (ScoreDoc scoreDoc : topDocs.scoreDocs) {\n    System.out.println(scoreDoc.doc + &quot; : &quot; + scoreDoc.score);\n}\n</code></pre>\n<p>to this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>for (ScoreDoc scoreDoc : topFieldDocs.scoreDocs) {\n    FieldDoc fieldDoc = (FieldDoc) scoreDoc;\n    System.out.println(scoreDoc.doc + &quot; : &quot; + fieldDoc.fields[0]);\n}\n</code></pre>\n<p>Now we will get the score printed, instead of <code>NaN</code>:</p>\n<pre><code>2 : 0.49662238\n</code></pre>\n<p><strong>Speculation:</strong> I may be wrong, but I assume the original <code>scoreDoc.score</code> field is <code>NaN</code> because it doesn't make sense to calculate it and store it here, given there is no guarantee that the applied search will use <code>SortField.FIELD_SCORE</code>.</p>\n<p>I expect users will mostly want to sort by something other than score - and maybe optionally use score as a tie-breaker.</p>\n<p>But if <code>FIELD_SCORE</code> <em>is</em> used, then the score will be available in that field, instead.</p>\n<hr />\n<p>As an aside, instead of this:</p>\n<pre><code>TopDocs topDocs = indexSearcher.search(query, 10, sort);\n</code></pre>\n<p>You can use this:</p>\n<pre><code>TopFieldDocs topFieldDocs = indexSearcher.search(query, 10, sort);\n</code></pre>\n<p>This allows us to access <code>SortField[]</code> - the fields which were used for sorting results. This includes information about field types.</p>\n"}],"last_activity_date":1684850583,"question_id":76306857,"body":"<p>I want to order the results of my Apache Lucene search by relevance. But when I use <code>SortField.FIELD_SCORE</code> for sorting, the score of the resulting documents is always <code>NaN</code>.\nWhen I omit the sort parameter, the search works perfectly fine, and the result documents contain a valid score.</p>\n<p>I use <code>lucene-core 9.6.0</code> and <code>lucene-analyzers-common 8.11.2</code> which are the most up to date versions in the Maven repository right now.</p>\n<p>At first I thought, I messed up my index or query. But I'm able to reproduce the issue with the most simple implementation I can imagine:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class LuceneSearch {\n    public static void main(String[] args) {\n        try {\n            Directory directory = new ByteBuffersDirectory();\n            \n            try (IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(new SimpleAnalyzer()))) {\n                indexWriter.addDocument(createDocument(&quot;a very simple example&quot;));\n                indexWriter.addDocument(createDocument(&quot;another example&quot;));\n                indexWriter.addDocument(createDocument(&quot;hello world&quot;));\n            }\n\n            IndexReader indexReader = DirectoryReader.open(directory);\n            IndexSearcher indexSearcher = new IndexSearcher(indexReader);\n\n            Query query = new TermQuery(new Term(&quot;value&quot;, &quot;hello&quot;));\n            Sort sort = new Sort(SortField.FIELD_SCORE); // &lt;&lt;&lt;&lt; this causes the problem\n            TopDocs topDocs = indexSearcher.search(query, 10, sort);\n            for (ScoreDoc scoreDoc : topDocs.scoreDocs) {\n                System.out.println(scoreDoc.doc + &quot; : &quot; + scoreDoc.score);\n            }\n\n            indexReader.close();\n            directory.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static Document createDocument(String value) {\n        Document document = new Document();\n        document.add(new TextField(&quot;value&quot;, value, Field.Store.NO));\n        return document;\n    }\n}\n</code></pre>\n<p>When I run this simple code, I get <code>2 : NaN</code>. Without the <code>sort</code> parameter, I get <code>2 : 0.49662238</code>. I have no idea what I'm missing here. Or could it be a bug in the library?\nThanks for your help!</p>\n<p><strong>Edit:</strong>\nAs @andrewJames stated in the comments, the ScoreDoc (actually <code>FieldDoc</code>) object contains a property <code>fields</code> which contains the score when using the sort parameter.\nAfter some testing, I found out that the actual score is identical in both cases (with/without sort parameter). So the sorting works correctly.</p>\n"},{"comments":[{"comment_id":134575419,"body":"<a href=\"//meta.stackoverflow.com/q/285551\">Please do not upload images of code/data/errors.</a>"}],"last_activity_date":1684850571,"question_id":76314806,"body":"<p><a href=\"https://i.stack.imgur.com/irW4v.png\" rel=\"nofollow noreferrer\">start</a></p>\n<p><a href=\"https://i.stack.imgur.com/btjNU.png\" rel=\"nofollow noreferrer\">first fragment</a></p>\n<p><a href=\"https://i.stack.imgur.com/O5NWa.png\" rel=\"nofollow noreferrer\">second fragment</a></p>\n<p>I am having a problem where the previous buttons from previous fragments keep displaying in the next fragment in android studio\nhere is the code where i call the fist fragment from the main acitivity:</p>\n<p><a href=\"https://i.stack.imgur.com/UF1za.png\" rel=\"nofollow noreferrer\">code</a></p>\n<p>the button with id  buttonGreekOval  keeps being displayed in the next fragment\nAlso when i go from the firs to second fragment as shown below , the button from both the first and the main class keep being displayed in the second fragment so on.</p>\n<p>Code from where i call the second fragment to start:</p>\n<p><a href=\"https://i.stack.imgur.com/2lY1u.png\" rel=\"nofollow noreferrer\">code</a></p>\n<p>i tried to add this:\nRemove the previous fragment's view from the fragment container but nothing changed</p>\n"},{"answers":[{"comments":[{"comment_id":134575844,"body":"it works! thank you!"}],"answer_id":76315628,"body":"<p>You can write a JPA find method, for your example:</p>\n<pre><code>findAllByProcessEntity_GroupIdsProcessIsIn(Set&lt;Long&gt; setOfIDs)\n</code></pre>\n<p>I am not sure about the groupIdsProcess part, that is annotated with @ElementCollection, but missing a @CollectionTable(...) annotation, does it correctly map and return every value if you use findAll() in the ProcessInstance Repository?</p>\n"}],"last_activity_date":1684850564,"question_id":76315446,"body":"<pre><code>public class ProcessEntity implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE)\n    private Long id;\n    @NotNull\n    private String processDefinitionName;\n    @Column(name = &quot;groups_ids&quot;)\n    @ElementCollection\n    private Set&lt;Long&gt; groupIdsProcess = new HashSet&lt;&gt;();\n}\n\npublic class ProcessInstance implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE)\n    private Long id;\n    @ManyToOne\n    private ProcessEntity processEntity;\n}\n</code></pre>\n<p>I want to filter ProcessInstance using JPA by using a method like:</p>\n<pre><code>List&lt;ProcessInstance&gt; getAllByProcessEntityGroupIdsProcessContains(Set&lt;Long&gt; setOfIDs) \n</code></pre>\n<p>That will return a list of <code>ProcessInstances</code> whose <code>processEntity.groupIdsProcess</code> contains any of the IDs contained in the passed parameter <code>Set&lt;Long&gt; setOfIDs</code></p>\n<p>Is it possible?</p>\n<p>I tried writing a native query without success, help would be appreciated</p>\n"},{"comments":[{"comment_id":134569284,"body":"You need to use a “dynamic root” (<code>&lt;fx:root …&gt;</code>) as shown in the documentation you linked."},{"comment_id":134569727,"body":"@James_D Sorry if this gives you a new notification, but I couldn&#39;t edit my previous reply. First of all, thank you, now I can start my application. The component shows up correctly but when I declare it in my controller, I can only create it as a VBox and not a Custom, so I can&#39;t use the methods in my Custom.java class. How do I solve this?"},{"comment_id":134571446,"body":"Could you clarify the problem? You have <code>@FXML private Custom cc;</code>. In what way doesn&#39;t that work for you? You should probably provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> if you want more effective help (e.g., you haven&#39;t provided the FXML file associated with <code>Menu</code>)."},{"comment_id":134572241,"body":"@Slaw My custom component is a VBox that has two buttons and a label in it. My Menu.fxml is an empty StackPane with my component in the middle. The problem is that when I add (drag and drop from Custom section to the StackPane) my component, it shows up as VBox and not Custom. Here&#39;s a screenshot, it might make what I mean clearer <a href=\"https://imgur.com/a/3Jmf0rY\" rel=\"nofollow noreferrer\">imgur.com/a/3Jmf0rY</a>. I want the component to show up just as Custom, not VBox, because SceneBuilder tells me that it doesn&#39;t find an injectable filed for &#39;cc&#39; even though I have the field you highlighted in my controller class."},{"comment_id":134572372,"body":"Ah, didn&#39;t realize your issue was with how the component appears in Scene Builder. Unfortunately, I&#39;ve never tried to use custom components in Scene Builder from the same project that is being developed. Not sure how to help."}],"last_activity_date":1684850540,"question_id":76311539,"body":"<p>I'm creating a small personal project using Java 20, JavaFX 20 and Maven. I'm having trouble creating reusable components and manipulating them through the main scene's controller.</p>\n<p>First, I followed the steps listed in the official <a href=\"https://docs.oracle.com/javase/8/javafx/api/javafx/fxml/doc-files/introduction_to_fxml.html#custom_components\" rel=\"nofollow noreferrer\">documentation</a>. After that, I went to SceneBuilder and imported my custom component's FXML file in SceneBuilder (Click on the small engine icon where it says &quot;Library&quot; -&gt; JAR/FXML Manager -&gt; Add Library/FXML from file system) and added it to the scene like you would with any default component. I then gave my custom component a fx:id and added it to my scene's controller class so I can to stuff with it, but I get the following error.</p>\n<pre><code>Exception in Application start method\njava.lang.reflect.InvocationTargetException\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:119)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:578)\n    at javafx.graphics@20/com.sun.javafx.application.LauncherImpl.launchApplicationWithArgs(LauncherImpl.java:464)\n    at javafx.graphics@20/com.sun.javafx.application.LauncherImpl.launchApplication(LauncherImpl.java:363)\n    at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:578)\n    at java.base/sun.launcher.LauncherHelper$FXHelper.main(LauncherHelper.java:1081)\nCaused by: java.lang.RuntimeException: Exception in Application start method\n    at javafx.graphics@20/com.sun.javafx.application.LauncherImpl.launchApplication1(LauncherImpl.java:893)\n    at javafx.graphics@20/com.sun.javafx.application.LauncherImpl.lambda$launchApplication$2(LauncherImpl.java:195)\n    at java.base/java.lang.Thread.run(Thread.java:1623)\nCaused by: javafx.fxml.LoadException: \n/C:/Users/user/Desktop/eclipse-workspace/Project 3/target/classes/app/views/fxml/Menu.fxml:43\n\n    at javafx.fxml@20/javafx.fxml.FXMLLoader.constructLoadException(FXMLLoader.java:2722)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader.loadImpl(FXMLLoader.java:2700)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader.loadImpl(FXMLLoader.java:2563)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader.load(FXMLLoader.java:2531)\n    at app/app.Main.loadFXML(Main.java:29)\n    at app/app.Main.start(Main.java:17)\n    at javafx.graphics@20/com.sun.javafx.application.LauncherImpl.lambda$launchApplication1$9(LauncherImpl.java:839)\n    at javafx.graphics@20/com.sun.javafx.application.PlatformImpl.lambda$runAndWait$12(PlatformImpl.java:483)\n    at javafx.graphics@20/com.sun.javafx.application.PlatformImpl.lambda$runLater$10(PlatformImpl.java:456)\n    at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)\n    at javafx.graphics@20/com.sun.javafx.application.PlatformImpl.lambda$runLater$11(PlatformImpl.java:455)\n    at javafx.graphics@20/com.sun.glass.ui.InvokeLaterDispatcher$Future.run(InvokeLaterDispatcher.java:95)\n    at javafx.graphics@20/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)\n    at javafx.graphics@20/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)\n    ... 1 more\nCaused by: java.lang.IllegalArgumentException: Can not set app.components.Custom field app.controllers.Menu.cc to javafx.scene.layout.VBox\n    at java.base/jdk.internal.reflect.FieldAccessorImpl.throwSetIllegalArgumentException(FieldAccessorImpl.java:228)\n    at java.base/jdk.internal.reflect.FieldAccessorImpl.throwSetIllegalArgumentException(FieldAccessorImpl.java:232)\n    at java.base/jdk.internal.reflect.MethodHandleObjectFieldAccessorImpl.set(MethodHandleObjectFieldAccessorImpl.java:115)\n    at java.base/java.lang.reflect.Field.set(Field.java:834)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader.injectFields(FXMLLoader.java:1175)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader$ValueElement.processValue(FXMLLoader.java:870)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader$ValueElement.processStartElement(FXMLLoader.java:764)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader.processStartElement(FXMLLoader.java:2853)\n    at javafx.fxml@20/javafx.fxml.FXMLLoader.loadImpl(FXMLLoader.java:2649)\n    ... 13 more\nException running application app.Main\n</code></pre>\n<p>A weird thing I noticed is that when I add the component to the main scene, it shows up as a VBox and not a Custom even though when I drag it in the &quot;Hierarchy&quot; tab it says the component's name is Custom, not VBox.</p>\n<p>Here are the files related\nCustom.java</p>\n<pre><code>package app.components;\n\nimport java.io.IOException;\n\nimport app.Main;\nimport javafx.fxml.FXML;\nimport javafx.fxml.FXMLLoader;\nimport javafx.scene.control.Button;\nimport javafx.scene.control.Label;\nimport javafx.scene.layout.VBox;\n\npublic class Custom extends VBox {\n    \n    @FXML private Button plusBtn;\n    @FXML private Button minusBtn;\n    @FXML private Label label;\n    \n    public Custom() {\n        FXMLLoader loader = new FXMLLoader(Main.class.getResource(&quot;components/Custom.fxml&quot;));\n        loader.setRoot(this);\n        loader.setController(this);\n        try {\n            loader.load();\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n    \n    public void newText(String text) {\n        label.setText(text);\n    }\n}\n\n</code></pre>\n<p>Custom.fxml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;?import javafx.scene.control.Button?&gt;\n&lt;?import javafx.scene.control.Label?&gt;\n&lt;?import javafx.scene.layout.VBox?&gt;\n\n&lt;VBox alignment=&quot;CENTER&quot; maxHeight=&quot;-Infinity&quot; maxWidth=&quot;-Infinity&quot; minHeight=&quot;-Infinity&quot; minWidth=&quot;-Infinity&quot; xmlns=&quot;http://javafx.com/javafx/19&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot;&gt;\n   &lt;children&gt;\n      &lt;Button fx:id=&quot;plusBtn&quot; mnemonicParsing=&quot;false&quot; text=&quot;+&quot; /&gt;\n      &lt;Label fx:id=&quot;label&quot; text=&quot;Label&quot; /&gt;\n      &lt;Button fx:id=&quot;minusBtn&quot; mnemonicParsing=&quot;false&quot; text=&quot;-&quot; /&gt;\n   &lt;/children&gt;\n&lt;/VBox&gt;\n\n</code></pre>\n<p>At the moment, my main scene is just an empty StackPane with my custom component in the center to which I gave &quot;cc&quot; as the fx:id.</p>\n<p>Menu.java</p>\n<pre><code>package app.controllers;\n\nimport app.components.Custom;\n\npublic class Menu {\n\n    @FXML\n    private Custom cc;\n\n        public void initialize() {\n        cc.newText(&quot;Test&quot;);\n    }\n}\n</code></pre>\n<p>module-info.java</p>\n<pre><code>module app {\n    requires javafx.controls;\n    requires javafx.fxml;\n    requires javafx.media;\n    requires javafx.graphics;\n    requires javafx.base;\n    \n    opens app to javafx.fxml;\n    opens app.controllers to javafx.fxml;\n    \n    exports app;\n}\n</code></pre>\n"},{"last_activity_date":1684850448,"question_id":76315615,"body":"<p>Is there a kuberenetes API that allows me to change the Ingress resource file dynamically, without having to manually pass in the arguments that i want like the specs etc…, i was able to change the YAML file dynamically , but i have to set the fields by manually passing in the value i want to change to</p>\n"},{"comments":[{"comment_id":134575700,"body":"Any reason you need to use RMI in a production application?"},{"comment_id":134575732,"body":"Uni project sadly (required)..."},{"comment_id":134575830,"body":"I can only suggest to look at the differences between production and development environments. Was development in the same machine and production communicates over the network? That could be a source of delays."}],"last_activity_date":1684850386,"question_id":76315575,"body":"<p>In a localhost environment, <code>registry.lookup</code> in Java RMI (Remote Method Invocation) works fine, but in production and staging environments, the same lookup takes a <strong>very long time (ages)</strong>, which is affecting our application's performance deeply.</p>\n<p>We cannot find any solution, looked for other solutions here but nothing useful.</p>\n<p>The code for the client:</p>\n<pre><code>package it.***.***.network.rmi;\n\nimport java.io.IOException;\nimport java.rmi.NotBoundException;\nimport java.rmi.RemoteException;\nimport java.rmi.registry.LocateRegistry;\nimport java.rmi.registry.Registry;\n\n/**\n * This class represents the RMI client.\n */\npublic class ClientRmi implements ClientRmiIF {\n    private final String serverHost;\n    private final int serverPort;\n    private ServerRmiIF server;\n    private final CommandCallback callback;\n    private static Registry registry;\n    public ClientRmi(String serverHost, CommandCallback callback) throws RemoteException {\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, serverHost);\n        this.serverHost = serverHost;\n        this.serverPort = 1099;\n        this.callback = callback;\n        server = null;\n    }\n\n    public ClientRmi(String serverHost, int serverPort, CommandCallback callback) throws RemoteException {\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, serverHost);\n        this.serverHost = serverHost;\n        this.serverPort = serverPort;\n        this.callback = callback;\n        server = null;\n    }\n\n    @Override\n    public ClientRmi connect() throws RemoteException, NotBoundException {\n        registry = LocateRegistry.getRegistry(serverHost, serverPort);\n        this.server = (ServerRmiIF) registry.lookup(&quot;MyRMIServer&quot;);\n        return this;\n    }\n}\n\n</code></pre>\n<p>And the code for the server:</p>\n<pre><code>package it.***.***.network.rmi;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\n\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.rmi.Naming;\nimport java.rmi.RemoteException;\nimport java.rmi.registry.LocateRegistry;\nimport java.rmi.registry.Registry;\nimport java.rmi.server.UnicastRemoteObject;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Map;\nimport java.util.Set;\n\n/**\n * This class represents the RMI server.\n */\npublic class ServerRmi implements ServerRmiIF {\n    private static Registry registry;\n    private final Set&lt;ClientRmiIF&gt; clients;\n    private final CommandCallback callback;\n    private static final Logger logger = LogManager.getLogger(ServerRmi.class);\n\n\n    public ServerRmi(String hostname, CommandCallback callback) throws RemoteException {\n        clients = new HashSet&lt;&gt;();\n\n        // set java.rmi.server.hostname\n        System.setProperty(&quot;java.rmi.server.hostname&quot;, hostname);\n\n        try {\n            registry = LocateRegistry.createRegistry(1099);\n            ServerRmiIF stub = (ServerRmiIF) UnicastRemoteObject.exportObject(this, 0);\n            registry.rebind(&quot;MyRMIServer&quot;, stub);\n        } catch (RemoteException e) {\n            logger.error(e.getMessage());\n            throw e;\n        }\n        this.callback = callback;\n    }\n}\n</code></pre>\n<p>Any insights on what could be causing the difference in lookup time, or suggestions for what we can investigate, would be greatly appreciated.</p>\n"},{"comments":[{"comment_id":134575081,"body":"What do you mean by &quot;it stops working&quot;? If the app crashes, there is a stack trace. Please look that up on logcat, and add it to your question."},{"comment_id":134575409,"body":"The app does not crashes. The snapshot listener does not get triggered when I add an item or item is modified... it doesn&#39;t even gets to the onEvent function I put there at the start of the function a toast that will tell me if the onEvent function is triggered and it only triggers once when the actvitystarts"},{"comment_id":134575703,"body":"Where are you calling this <code>addChatRoomSnapshotListener()</code> method from?"}],"last_activity_date":1684850378,"question_id":76315184,"body":"<p>I have this Snapshot listener that checks when a chat model is added or modified I want it to give it to me, but the snapshot listener works only when the activity starts and from there, it stops working. The problem is that it doesn't even goes to the onEvent()...\nthis is the function where I initialize the snapshot listener.\nthe function triggered in the onCreate function.</p>\n<pre><code>private void addChatRoomSnapshotListener() {\n    chatRoomsListener = chatsQuery.addSnapshotListener(new EventListener&lt;QuerySnapshot&gt;() {\n        @Override\n        public void onEvent(@Nullable QuerySnapshot value, @Nullable FirebaseFirestoreException error) {\n            if (error != null) {\n                error.printStackTrace();\n\n                return;\n            }\n            for (DocumentChange change : value.getDocumentChanges()) {\n                switch (change.getType()) {\n                    case ADDED:\n                        ChatModel chatModel = change.getDocument().toObject(ChatModel.class);\n                        chatModel.setId(change.getDocument().getId());\n                        chats.add(chatModel);\n                        adapter.notifyDataSetChanged();\n                        break;\n                    case MODIFIED:\n                        Toast.makeText(getApplicationContext(), &quot;modifeid&quot;, Toast.LENGTH_SHORT).show();\n                        // Handle modified document\n                        ChatModel modifiedChat = change.getDocument().toObject(ChatModel.class);\n                        modifiedChat.setId(change.getDocument().getId());\n                        // Find the position of the modified chat in the list\n                        int modifiedIndex = findChatIndexById(modifiedChat.getId());\n                        if (modifiedIndex != -1) {\n                            // Replace the existing chat with the modified chat\n                            chats.remove(modifiedChat);\n                            chats.add(0, modifiedChat);\n                            adapter.notifyDataSetChanged();\n                            break;\n                        }\n                }\n            }\n        }\n    });\n}\n</code></pre>\n<p>here is how I remove the snapshot listener.</p>\n<pre><code>@Override\nprotected void onPause() {\n    super.onPause();\n    // Remove the snapshot listener to avoid memory leaks\n    Toast.makeText(getApplicationContext(), &quot;listener removed&quot;, Toast.LENGTH_SHORT).show();\n    if (chatRoomsListener != null) {\n        chatRoomsListener.remove();\n    }\n}\n</code></pre>\n"},{"comments":[{"comment_id":134570728,"body":"Add H2 for an in-memory database or stop using <code>@SpringBootTest</code> for simple testcases (which is whatyou are probably doing, without knowing the implications of this)."},{"comment_id":134570750,"body":"H2: Don&#39;t want to add any db tests. @SpringBootTest: What would be an alternative?"},{"comment_id":134570768,"body":"You don&#39;t need to but H2 will be created at startup of your test. This is what you need when writing tests with <code>@SpringBootTest</code> it will bootstrap a full application. If you don&#39;t want that don&#39;t use <code>@SpringBootTest</code> ."}],"answers":[{"answer_id":76313169,"body":"<p>Correct answer: <a href=\"https://stackoverflow.com/questions/76312788/how-to-prevent-a-spring-boot-application-from-instantiating-a-jdbc-datasource-du#comment134570768_76312788\">comment</a> of <a href=\"https://stackoverflow.com/users/2696260/m-deinum\">M. Deinum</a></p>\n"},{"answer_id":76313349,"body":"<p>You get this error as you are probably abusing <code>@SpringBootTest</code> to do tests for services with using <code>@MockBean</code> to inject/create mocks for dependencies/repositories. <code>@SpringBootTest</code> is mainly intended for writing integration tests for the whole application not to test 1 single service.</p>\n<p>The short answer is don't. Either use one of the sliced tests for that or just write a simple unit test (instantiate the service yourself and create mocks using Mockito yourself and inject, don't abuse <code>@SpringBootTest</code> for that).</p>\n<p>If you really want to continue on this way the easiest solution is to add H2 as a test dependency so you have an in-memory database created for you when running tests. You don't use it but it is needed to start the application.</p>\n<p>Another option would be to mock the <code>DataSource</code> in an <code>@TestConfiguration</code>. Problem is you would need to mock a whole lot of methods and classes as well and you are basically mocking so much you have mocked a stub of a datasource implementation.</p>\n"},{"answer_id":76315580,"body":"<p>another way that  M. Deinum said is using @ConextConfiguration and as input enter configurations that you need .</p>\n"}],"last_activity_date":1684850122,"question_id":76312788,"body":"<p>I've recently added JPA to my application for a single database request. Since then the tests are failing:\n<code>java.lang.IllegalStateException: Failed to load ApplicationContext</code></p>\n<p>[...]</p>\n<p><code>Error creating bean with name 'dataSourceScriptDatabaseInitializer'</code></p>\n<p>My understanding here is that during the test run Spring Boot tries to initialize the database connection, but I'm not interested in doing any tests on the added db request. How can I stop this behaviour?</p>\n"},{"comments":[{"comment_id":134558360,"body":"When using <code>MockitoExtension</code>, you don&#39;t have to call <code>openMocks</code> (and openMocks should be called for the test class, not the field)."},{"comment_id":134558406,"body":"@knittl I updated the question and still same error"},{"comment_id":134568527,"body":"Is <code>userInfo</code> and <code>userInfoDto</code> a typo or your real code? One doesn&#39;t exist, the other is never used."}],"answers":[{"answer_id":76315579,"body":"<p>I think you should change the:</p>\n<pre><code>@Autowired\nprivate UserRepository userRepository;\n</code></pre>\n<p>For</p>\n<pre><code>@InjectMocks\nprivate UserRepository userRepository;\n</code></pre>\n<p>I'm assuming your <code>UserInfoDto</code> is <code>@Autowired</code> in original class and the <code>UserRepository</code> is the class you're trying to test</p>\n"}],"last_activity_date":1684850092,"question_id":76305197,"body":"<p>I have snippet code as follows that when trying to mock object it returns null:</p>\n<p><code>userInfoDto</code> is null.</p>\n<pre><code>@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\n@ExtendWith(MockitoExtension.class)\npublic class IntegrationTest {\n    @Autowired\n    private UserRepository userRepository;\n\n    @Mock\n    private UserInfoDto userInfo;\n    @BeforeEach\n    public void init() {\n        when(userInfo.getXCaller()).thenReturn(&quot;Test&quot;);\n    }\n\n}\n</code></pre>\n"},{"comments":[{"comment_id":134573797,"body":"Can you add the complete error log?"},{"comment_id":134573873,"body":"<code>:p.productName</code> there should be no <code>:</code>. Same for the other fields. <code>:</code> should only be followed by the actual parameter name"},{"comment_id":134573982,"body":"Your entity is named <code>Product</code> not <code>Products</code> and as you are writing a JPQL and not a SQL you need to reference the entity not the table. Also <code>:p.categoryId</code> is where you probably wanted to write <code>:categoryId</code> to check if the passed in parameter was <code>null</code> or not. The same applies to your other fields as well."}],"answers":[{"comments":[{"comment_id":134573909,"body":"That is the only part that would not throw an error. It just doesn&#39;t do what it should. <code>:p.productName</code>, <code>:p.brandId</code>, <code>:p.categoryId</code> and <code>:p.modelYear</code> are causing the error. Your &quot;correct&quot; query is still wrong"},{"comment_id":134574009,"body":"Thank you you two for help me. The problem is solved by you. I followed instructions on Baeldung, maybe it has some mistakes."}],"answer_id":76314705,"body":"<p>One of the errors in the query is with the <code>:p.productName is null</code>, change it to <code>(p.productName is null or p.productName = :productName)</code></p>\n<p>The <code>:p.productName</code> is a named parameter and the named parameters are expected to have a value, since <code>:p.productName</code> is not provided with a the exception is thrown. It should be either the property name in the bean if you are using HQL, or it should be the column name from the table if you are using a native query.</p>\n<p>The same is happening for other columns like <code>:p.brandId</code>, <code>:p.categoryId</code>, and <code>:p.modelYear</code>, so you should do it for other columns as well, the correct query will be</p>\n<pre><code>@Query(&quot;SELECT p FROM Product p WHERE &quot; +\n            &quot;(p.productId is null or p.productId = :productId) and &quot; +\n            &quot;(p.productName is null or p.productName = :productName) and &quot; +\n            &quot;(p.brandId is null or p.brandId = :brandId) and &quot; +\n            &quot;(p.categoryId is null or p.categoryId = :categoryId) and &quot; +\n            &quot;(p.modelYear is null or p.modelYear = :modelYear)&quot;)\n</code></pre>\n"},{"answer_id":76314843,"body":"<p>I think you have problem with your query, here is the reasons:</p>\n<p>Look at the other <code>WHERE</code> statements for example <code>and (:p.productName is null or p.productName = :productName)</code> at this point you are putting <code>:p</code> which means it should be a parameter rather than column. By writing <code>:p.productName</code> it means that you are accessing property <code>.productName</code> from parameter <code>:p</code> which is not exist. The right syntax to compare <strong>input parameter</strong> with <strong>value of column</strong> is <code>and (p.productName is null or p.productName = :productName)</code>. Also you can make it more simple <code>and (p.productName = :productName)</code> by this way it will compare for null value or not.</p>\n<p>When you need to check the input parameter and the table column as well you can do like this way:</p>\n<pre><code>and (:productName is null or p.productName = :productName) \n</code></pre>\n<p>or</p>\n<pre><code>and (:productName is not null or p.productName = :productName) \n</code></pre>\n<p>This is the example:</p>\n<pre><code>select\n    p\nfrom\n    Products p\nwhere\n    (p.productId is null\n        or p.productId = :productId)\n    and (p.productName is null\n        or p.productName = :productName)\n    and (p.brandId is null\n        or p.brandId = :brandId)\n    and (p.categoryId is null\n        or p.categoryId = :categoryId)\n    and (p.modelYear is null\n        or p.modelYear = :modelYear)\n\n    \n</code></pre>\n<p>Other exsample:</p>\n<pre><code>select\n    p\nfrom\n    Products p\nwhere\n    (:productId is null\n        or p.productId = :productId)\n    and (:productName is null\n        or p.productName = :productName)\n    and (:brandId is null\n        or p.brandId = :brandId)\n    and (:categoryId is null\n        or p.categoryId = :categoryId)\n    and (:modelYear is null\n        or p.modelYear = :modelYear)\n</code></pre>\n<p>Hope it helps.</p>\n"}],"last_activity_date":1684850026,"question_id":76314460,"body":"<p>I am doing a @GetMapping request to search a product using multiple parameters.</p>\n<p>My ProductController.java</p>\n<pre><code>@GetMapping(&quot;/search&quot;)\n    ResponseEntity&lt;ResponseObject&gt; findBySearch(@RequestParam(required = false) Integer productId,\n                                                @RequestParam(required = false) String productName,\n                                                @RequestParam(required = false) Integer brandId,\n                                                @RequestParam(required = false) Integer categoryId,\n                                                @RequestParam(required = false) Integer modelYear) {\n        List&lt;Product&gt; foundProducts = repository.findProductBySearch(productId, productName, brandId, categoryId, modelYear);\n        return (!foundProducts.isEmpty()) ?\n                ResponseEntity.status(HttpStatus.OK).body(new ResponseObject(HttpStatus.OK.toString(), &quot;Query successfully&quot;, foundProducts))\n                :\n                ResponseEntity.status(HttpStatus.NOT_FOUND).body(new ResponseObject(HttpStatus.NOT_FOUND.toString(), &quot;Cannot find product with provided model&quot;, &quot;&quot;));\n    }\n</code></pre>\n<p>My ProductRepository.java</p>\n<pre><code>@Query(&quot;SELECT p FROM Products p WHERE (:productId is null or p.productId = :productId) and &quot; +\n            &quot;(:p.productName is null or p.productName = :productName) and &quot; +\n            &quot;(:p.brandId is null or p.brandId = :brandId) and &quot; +\n            &quot;(:p.categoryId is null or p.categoryId = :categoryId) and &quot; +\n            &quot;(:p.modelYear is null or p.modelYear = :modelYear)&quot;)\n    List&lt;Product&gt; findProductBySearch(@Param(&quot;productId&quot;) Integer productId,\n                                      @Param(&quot;productName&quot;) String productName,\n                                      @Param(&quot;brandId&quot;) Integer brandId,\n                                      @Param(&quot;categoryId&quot;) Integer categoryId,\n                                      @Param(&quot;modelYear&quot;) Integer modelYear);\n</code></pre>\n<p>My Product.java</p>\n<pre><code>@Entity\n@Table(name = &quot;Products&quot;)\npublic class Product {\n    @Id\n    @SequenceGenerator(\n            name = &quot;product_sequence&quot;,\n            sequenceName = &quot;product_sequence&quot;,\n            allocationSize = 1\n    )\n    @GeneratedValue (\n            strategy = GenerationType.SEQUENCE,\n            generator = &quot;product_sequence&quot;\n    )\n    @Column(name = &quot;product_id&quot;)\n    int productId;\n    @Column(name = &quot;product_name&quot;)\n    String productName;\n    @Column(name = &quot;brand_id&quot;)\n    int brandId;\n    @Column(name = &quot;category_id&quot;)\n    int categoryId;\n    @Column(name = &quot;model_year&quot;)\n    int modelYear;\n    @Column(name = &quot;list_price&quot;)\n    double listPrice;\n\n//getters, setters\n</code></pre>\n<p>When I run project, it produced this error</p>\n<p><strong>org.hibernate.query.SemanticException: A query exception occurred [SELECT p FROM Products p WHERE (:productId is null or p.productId = :productId) and (:p.productName is null or p.productName = :productName) and (:p.brandId is null or p.brandId = :brandId) and (:p.categoryId is null or p.categoryId = :categoryId) and (:p.modelYear is null or p.modelYear = :modelYear)]</strong></p>\n<p>Please help me to find where I got it wrong.</p>\n"},{"last_activity_date":1684849465,"question_id":76315490,"body":"<p>I am (successfully) signing a PDF with a .p12 certificate.</p>\n<p>The problem is, that <strong>after signing the pdf, the file cannot be modified anymore</strong>.</p>\n<p>I know that any modification to the pdf breaks the signature but i still want to allow modifications so the client can do modifications and edit text.</p>\n<p>Heres my minimal reproduction of my valid signature ( I started with the CreateSignature Example of Apache PDfBox):</p>\n<pre class=\"lang-java prettyprint-override\"><code>\n    public void signDetached(PDDocument document, OutputStream output)\n            throws IOException {\n        PDSignature signature = new PDSignature();\n        signature.setFilter(PDSignature.FILTER_ADOBE_PPKLITE);\n        signature.setSubFilter(PDSignature.SUBFILTER_ADBE_PKCS7_DETACHED);\n        signature.setName(&quot;Testing User&quot;);\n        signature.setLocation(&quot;Los Angeles, CA&quot;);\n        signature.setReason(&quot;Testing&quot;);\n        signature.setSignDate(Calendar.getInstance());\n        document.addSignature(signature, this);\n        document.saveIncremental(output);\n    }\n</code></pre>\n<p>This code adds a digital signature dictionary to the PDF, but it doesn't seem to create an approval signature that allows for further modifications to the document.</p>\n<p>What am I doing wrong here? Is it possible to create a non-visible approval signature with Apache PDFBox that allows for modifications and becomes invalidated when those modifications occur?</p>\n<p>Thank you in advance for any help or insights you can provide!</p>\n"},{"comments":[{"comment_id":134573794,"body":"It&#39;s good to state <i>why</i> you need it there, because as it stands now, we can&#39;t tell which solution would work. For example, with the information you&#39;ve given, you might as well do substring + &quot;+0000&quot;, and it would get the task done as it stands now. With that being said, you can change time zones of SimpleDateFormat <a href=\"https://stackoverflow.com/questions/2891361/how-to-set-time-zone-of-a-java-util-date\" title=\"how to set time zone of a java util date\">stackoverflow.com/questions/2891361/&hellip;</a> . That also means the time itself will change (by the 3 hour difference), so you&#39;d need to account for that somehow."}],"answers":[{"answer_id":76314743,"body":"<p>you just need to set the timezone to GMT:</p>\n<p><code>sdf1.setTimeZone(TimeZone.getTimeZone(&quot;GMT&quot;));</code></p>\n<p>Your final code would be:</p>\n<pre><code>String oldDate = &quot;20230523154325&quot;;\nSimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyyMMddHHmmss&quot;);\nDate newDateFormat = null;\ntry {\n    newDateFormat = sdf.parse(oldDate);\n} catch (Exception e) {\n    throw new RuntimeException(e);\n}\n\nSimpleDateFormat sdf1 = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ssZ&quot;);\nsdf1.setTimeZone(TimeZone.getTimeZone(&quot;GMT&quot;));\n\nSystem.out.println(&quot;The date is &quot; + sdf1.format(newDateFormat));\n</code></pre>\n<p>In order to set different timezone check <a href=\"https://stackoverflow.com/questions/2891361/how-to-set-time-zone-of-a-java-util-date\">this</a> out...</p>\n"},{"answer_id":76314746,"body":"<p>Don’t use SimpleDateFormat.  SimpleDateFormat instances have a timezone, which causes misleading parsing results like what you have observed.</p>\n<p>Given the simplicity of your particular use case, I would forget about date-time parsing entirely, and just use a StringBuilder to insert characters:</p>\n<pre><code>String oldDate = &quot;20230523154325&quot;;\nStringBuilder formattedDate = new StringBuilder(oldDate);\nformattedDate.append(&quot;+0000&quot;);\nformattedDate.insert(12, ':');\nformattedDate.insert(10, ':');\nformattedDate.insert(8, 'T');\nformattedDate.insert(6, '-');\nformattedDate.insert(4, '-');\nSystem.out.println(&quot;The date is &quot; + formattedDate);\n</code></pre>\n"},{"answer_id":76314827,"body":"<blockquote>\n<p>I want to change the date format from 20230523154325 to 2023-05-23T15:43:25+0000</p>\n</blockquote>\n<p>You can do that with <code>java.time</code> if you are using Java 8 or higher.</p>\n<h3>Example Code</h3>\n<pre><code>public static void main(String[] args) {\n    // example input\n    String oldDate = &quot;20230523154325&quot;;\n    // prepare a parser\n    DateTimeFormatter parser = DateTimeFormatter.ofPattern(&quot;uuuuMMddHHmmss&quot;);\n    // parse the oldDate with the parser\n    LocalDateTime ldt = LocalDateTime.parse(oldDate, parser);\n    // print the result (NO OFFSET SO FAR!!!)\n    System.out.println(ldt);\n    // add an offset (UTC = +00:00 = Z)\n    OffsetDateTime odt = ldt.atOffset(ZoneOffset.UTC);\n    // print it\n    System.out.println(odt);\n    // prepare a formatter for the desired (non-standard) output\n    DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;uuuu-MM-dd'T'HH:mm:ssxxxx&quot;);\n    // then print the datetime plus offset in the desired format\n    System.out.println(odt.format(formatter));\n}\n</code></pre>\n<h3>Output</h3>\n<pre class=\"lang-none prettyprint-override\"><code>2023-05-23T15:43:25\n2023-05-23T15:43:25Z\n2023-05-23T15:43:25+0000\n</code></pre>\n<hr />\n<h4>Why did your attempt fail to produce the desired result?</h4>\n<p>Your attempt involves the zone/offset of your machine/jvm, which will even change the offset when the code is executed on another machine with a different zone/offset.</p>\n<p>That's why you</p>\n<ul>\n<li>should stop using <code>java.util.Date</code> and <code>java.text.SimpleDateFormat</code> whenever/wherever you can…</li>\n<li>should switch to <code>java.time</code> because you have full control over zone/offset handling</li>\n</ul>\n<hr />\n<h3>Compact / Short Version</h3>\n<pre><code>public static void main(String[] args) {\n    String oldDate = &quot;20230523154325&quot;;\n    DateTimeFormatter parser = DateTimeFormatter.ofPattern(&quot;uuuuMMddHHmmss&quot;);\n    DateTimeFormatter formatter = DateTimeFormatter\n                                    .ofPattern(&quot;uuuu-MM-dd'T'HH:mm:ssxxxx&quot;);\n    String desiredResult = LocalDateTime.parse(oldDate, parser)\n                                        .atOffset(ZoneOffset.UTC)\n                                        .format(formatter);\n    System.out.println(desiredResult);\n}\n</code></pre>\n<h3>Output</h3>\n<pre class=\"lang-none prettyprint-override\"><code>2023-05-23T15:43:25+0000\n</code></pre>\n"}],"last_activity_date":1684849428,"question_id":76314605,"body":"<p>I want to change the date format from <code>&quot;20230523154325&quot;</code> to <code>2023-05-23T15:43:25+0000&quot;</code>.<br />\nAnd I have this piece of code, but unfortunately the result is this: <code>&quot;2023-05-23T15:43:25+0300&quot;</code>.<br />\nSo I don't want to have <code>+0300</code>, I want to have <code>+0000</code> at the end. So, it should be exactly the same for this part <code>2023-05-23T15:43:25</code>, but instead of <code>+0300</code> should be <code>+0000</code>. It's important to have this <code>+0000</code> at the end. Any feedback will be appreciated!</p>\n<pre><code>public static void main(String[] args) {\n    String oldDate = &quot;20230523154325&quot;;\n    SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyyMMddHHmmss&quot;);\n    Date newDateFormat = null;\n\n    try {\n        newDateFormat = sdf.parse(oldDate);\n    } catch (ParseException e) {\n        throw new RuntimeException(e);\n    }\n    \n    SimpleDateFormat sdf1 = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ssZ&quot;);\n    System.out.println(&quot;The date is &quot; + sdf1.format(newDateFormat));\n}\n</code></pre>\n"},{"comments":[{"comment_id":101354453,"body":"Yes it is really the expected behaviour, as it is documented, and you&#39;re getting it."}],"answers":[{"comments":[{"comment_id":113812181,"body":"I have a similar issue. How can we avoid that?"}],"answer_id":57438605,"body":"<p>I don't think there's something wrong with your code. The documentation of this particular exception states clearly:</p>\n\n<blockquote>\n  <p>An exception that occurs when a response returns an error code equal to or greater than 400.</p>\n</blockquote>\n\n<p>If that's not satisfactory for you, we can dig deeper. The exception is thrown in <code>DefaultHttpClient</code> class in a method named <code>channelRead0</code>. Let's see what can we find there.</p>\n\n<pre><code>boolean errorStatus = statusCode &gt;= 400;\nif (errorStatus) {\n    emitter.onError(new HttpClientResponseException(response.getStatus().getReason(), response));\n} else {\n    emitter.onNext(response);\n    emitter.onComplete();\n}\n</code></pre>\n\n<p>This exception is passed further and it looks like it's eventually thrown somewhere. It just works this way, this is the author's design. If you don't like it, you can always use good old built-in <a href=\"https://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html\" rel=\"nofollow noreferrer\">HttpURLConnection</a>, a new <a href=\"https://docs.oracle.com/javase/9/docs/api/jdk/incubator/http/HttpClient.html\" rel=\"nofollow noreferrer\">HttpClient</a> from Java 9 or something 3rd party like <a href=\"https://square.github.io/okhttp/\" rel=\"nofollow noreferrer\">OkHttp</a>.</p>\n"}],"last_activity_date":1684849263,"question_id":57437794,"body":"<p>I am starting today with Micronaut.\nI built this controller:</p>\n<pre><code>@Controller\npublic class MyController implements MyApi{\n\n@Override\npublic String doit() {\n    throw new NotFoundException();\n    }\n}\n</code></pre>\n<p>and this exception handler:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Produces\n@Singleton\n@Requires(classes = { NotFoundException.class, ExceptionHandler.class})\npublic class NotFoundExceptionHandler implements ExceptionHandler&lt;NotFoundException, HttpResponse&gt; {\n\n    @Override\n    public HttpResponse handle(HttpRequest request, NotFoundException exception) {\n        return HttpResponseFactory.INSTANCE.status(HttpStatus.NOT_FOUND);\n    }\n}\n</code></pre>\n<p>And this test:</p>\n<pre><code>@MicronautTest\npublic class MyControllerIT {\n\n@Inject\n@Client(&quot;/&quot;)\nHttpClient client;\n\n@Test\npublic void testHello() {\n    HttpRequest&lt;String&gt; request = HttpRequest.GET(&quot;/myController&quot;);\n    HttpResponse&lt;String&gt; body = client.toBlocking().exchange(request);\n\n    assertThat(body.getStatus(), is(HttpStatus.NOT_FOUND));\n    }\n}\n</code></pre>\n<p>My expectation is that it would pass: I would get a response back with no content, HTTP code 404, message &quot;Not found&quot; and I would be done.</p>\n<p>But, instead, I get:</p>\n<pre><code>io.micronaut.http.client.exceptions.HttpClientResponseException: Not Found\n\nat io.micronaut.http.client.DefaultHttpClient$10.channelRead0(DefaultHttpClient.java:1799)\nat io.micronaut.http.client.DefaultHttpClient$10.channelRead0(DefaultHttpClient.java:1739)\nat io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.micronaut.http.netty.stream.HttpStreamsHandler.channelRead(HttpStreamsHandler.java:185)\nat io.micronaut.http.netty.stream.HttpStreamsClientHandler.channelRead(HttpStreamsClientHandler.java:180)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:438)\nat io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:328)\nat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:302)\nat io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:253)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:287)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352)\nat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1421)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374)\nat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360)\nat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:930)\nat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)\nat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:697)\nat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:632)\nat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:549)\nat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:511)\nat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)\nat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\nat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\nat java.base/java.lang.Thread.run(Thread.java:834)\n</code></pre>\n<p>I found this <a href=\"https://docs.micronaut.io/latest/api/io/micronaut/http/client/exceptions/HttpClientResponseException.html\" rel=\"nofollow noreferrer\">HttpClientResponseException</a> documentation that describes <code>An exception that occurs when a response returns an error code equal to or greater than 400.</code></p>\n<p>Is this really the expected behavior? It seems a little bit odd that it forces me to handle it as an exception when the error code &gt; 400.</p>\n<p>Did I do something wrong in my setup?</p>\n"},{"comments":[{"comment_id":134568516,"body":"Is &quot;Swing design&quot; the name of the sofware you&#39;re using to design Swing forms?"},{"comment_id":134568544,"body":"<a href=\"https://stackoverflow.com/a/22652008/4725875\">This post</a> may assist you."},{"comment_id":134568552,"body":"@MauricePerry No. I use Swing design in Netbeans 8.2."},{"comment_id":134568570,"body":"@DevilsHnd Thank you. But I use the design option in Netbeans, which is drag and drop. So some code is auto-generated and cannot be modified."},{"comment_id":134568677,"body":"@Lucia it can be modified: <a href=\"https://stackoverflow.com/a/43892689/7036419\">stackoverflow.com/a/43892689/7036419</a>"},{"comment_id":134568738,"body":"@MauricePerry Yes, I&#39;ve already followed that link. But when I drag a new combo box, the line <code>cbLicense.setModel(new javax.swing.DefaultComboBoxModel&lt;&gt;(new String[] { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot; }));</code> is created automatically. Even I changed data type after that, that line is still there."},{"comment_id":134568753,"body":"Use <code>Custom creation code</code> in the <code>Code</code> tab of the combobox properties"},{"comment_id":134568795,"body":"@Lucia or right-click on the combobox, and select &quot;Customize code...&quot;"},{"comment_id":134568822,"body":"@MauricePerry I have declared CustomerItem outside of the generation code section. Now I added those code into Custom creation code: <code>cbLicense = CustomerItem[] items = new CustomerItem[3]; items[0] = new CustomerItem(&quot;oh&quot;, false); items[1] = new CustomerItem(&quot;My&quot;, false); items[2] = new CustomerItem(&quot;God&quot;, false);          DefaultComboBoxModel&lt;CustomerItem&gt; model = new DefaultComboBoxModel&lt;&gt;(items);         cbLicense.setModel(model);         cbLicense.setRenderer(new RenderCheckComboBox());</code>"},{"comment_id":134568851,"body":"@MauricePerry I do apologise if it&#39;s hard to read my comment. I dont know to format code on comment. But an error has occured on the line: <code>cbLicense = CustomerItem[] items = new CustomerItem[3];</code>. And with this way, can I retrieve value from the database into combo box?"},{"comment_id":134568872,"body":"Try <code>new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{ new CustomerItem(&quot;oh&quot;, false), new CustomerItem(&quot;My&quot;, false), new CustomerItem(&quot;God&quot;, false)  })</code>"},{"comment_id":134568948,"body":"@MauricePerry It automatically added <code>cbLicense =</code> before your code.         <code>cbLicense = DefaultComboBoxModel&lt;CustomerItem&gt; model = new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{             new CustomerItem(&quot;oh&quot;, false),             new CustomerItem(&quot;My&quot;, false),             new CustomerItem(&quot;God&quot;, false)         });         cbLicense.setModel(model);         cbLicense.setRenderer(new RenderCheckComboBox());</code>"},{"comment_id":134569002,"body":"@MauricePerry Oh, this is <code>Custom creation Code</code> so it will automatically add <code>cbLicense =</code>. But I wanna make changes on <code>cbLicense.setModel</code>."},{"comment_id":134569134,"body":"@Lucia two possible solutions: 1) right-click on the combobox and select &quot;Customize code...&quot;, 2) <code>new JComboBox&lt;&gt;(new DefaultComboBoxModel&lt;&gt;(new CustomerItem[]{ new CustomerItem(&quot;oh&quot;, false), new CustomerItem(&quot;My&quot;, false), new CustomerItem(&quot;God&quot;, false)  }))</code>"}],"answers":[{"answer_id":76311909,"body":"<p>Right-click on the combobox, and select &quot;Customize code...&quot;:</p>\n<p><a href=\"https://i.stack.imgur.com/NNKfV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NNKfV.png\" alt=\"enter image description here\" /></a></p>\n"}],"last_activity_date":1684849238,"question_id":76311455,"body":"<p>I was trying to modify the data type of a combo box named <code>cbLicense</code> in Swing. In this case, I wanna change from <code>String</code> to <code>CustomerItem</code> which is a class. I use Swing design, so I selected the combo box, went to Properties/Code/TypeParameters. But the problem is that on the <code>Generated Code</code> section, there's still a line:</p>\n<p><code>cbLicense.setModel(new javax.swing.DefaultComboBoxModel&lt;&gt;(new String[] { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot; }));</code></p>\n<p>This line has an incompatible type error. So how do I fix it? Do I need to add each <code>CustomerItem </code>object into <code>cbLicense </code>via Design view? Because the <code>CustomerItem </code>value is retrieved from the database.</p>\n<p>Find the way to customize combo box in Swing</p>\n"},{"comments":[{"comment_id":134516619,"body":"Welcome to Stack Overflow! Please clarify your specific problem or add additional details to highlight exactly what you need.  As it&#39;s currently written, it’s hard to tell exactly what you&#39;re asking. See the  <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask page</a> for help clarifying this question. Include the desired behavior, a specific problem or error and the shortest code necessary to  reproduce the issue. See: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."},{"comment_id":134519682,"body":"“M1 Pro chipset doesn&#39;t support Java 8” — not true. At least a few of the several JDK vendors provide an implementation of Java 8 for aarch64 (ARM) that can run on Apple M1/M2 chips. Shop the vendors to see: Azul Systems, BellSoft, SAP, Oracle, IBM, Red Hat, Amazon, Microsoft, Adoptium, and more. For example, Azul Systems offers their <a href=\"https://www.azul.com/downloads/?version=java-8-lts&amp;os=linux&amp;architecture=arm-64-bit&amp;package=jdk#zulu\" rel=\"nofollow noreferrer\">Zulu product for Java 8u372b07</a> for Linux and macOS on ARM 64."},{"comment_id":134575017,"body":"@BasilBourque I added the exact issue what I am getting in the description. kindly help me."}],"last_activity_date":1684849011,"question_id":76281220,"body":"<p>When I run Docker-compose up command, it always ends up with 'Quick started' text at the last. So we can open the application in our browser with localhost. It's working fine with an Intel-based (x86) processor.</p>\n<p>But Docker-compose up command is not working on Macbook Pro with Apple M1 Pro chipset. The command is not executing completely. When I Googled, I was getting M1 Pro chipset doesn't support Java 8. But my project requires Java 8 only.</p>\n<p>I am getting this below issue when I try with zulu version 8</p>\n<pre><code>aem           | #\naem           | # A fatal error has been detected by the Java Runtime Environment:\naem           | #\naem           | #  Internal Error (safepoint.cpp:310), pid=1, tid=0x0000004048c89700\naem           | #  guarantee(PageArmed == 0) failed: invariant\naem           | #\naem           | # JRE version: OpenJDK Runtime Environment (8.0_222-b10) (build 1.8.0_222-b10)\naem           | # Java VM: OpenJDK 64-Bit Server VM (25.222-b10 mixed mode linux-amd64 compressed oops)\naem           | # Failed to write core dump. Core dumps have been disabled. To enable core dumping, try &quot;ulimit -c unlimited&quot; before starting Java again\naem           | #\naem           | # An error report file with more information is saved as:\naem           | # /home/aem/aem/hs_err_pid1.log\naem           | #\naem           | # If you would like to submit a bug report, please visit:\naem           | #   http://bugreport.java.com/bugreport/crash.jsp\naem           | #\naem           | qemu: uncaught target signal 6 (Aborted) - core dumped\n</code></pre>\n<p>Kindly provide any solution if anyone have to get this issue fixed. Thanks in advance.</p>\n"},{"comments":[{"comment_id":134575105,"body":"Feels like an badly implemented GraphQL clone. Why not use GraphQL instead?"}],"last_activity_date":1684848819,"question_id":76315391,"body":"<p>First of all, sorry if the title is kinda misleading, i am in a situation i have no clue where to start with my problem or how to implement it.</p>\n<p>I am trying to create a REST API with Spring Boot and Spring Data JPA. The API can be queried with a custom JSON query language that could look something like this:</p>\n<pre><code>{\n    &quot;sort&quot;: [],\n    &quot;filter&quot;: {\n        &quot;and&quot;: [\n            { \n                &quot;itemName&quot;: {&quot;equals&quot;: &quot;item&quot;},\n            }\n        ]\n    },\n    &quot;selectedFields&quot;: [&quot;id&quot;, &quot;itemName&quot;, &quot;anotherItemProperty&quot;...]\n}\n</code></pre>\n<p>Basically I am able to construct the query using the JPA Criteria API but whats giving me headache is the selectedFields property. I want to return only the wanted fields of the entity and I am also able to do this, but since Java's limitations I must then map the result to <code>Object[]</code> currently the way I am doing it. I also know i can do the mapping in the DAO-layer like so that I map it to the corresponding entity and only populate the <code>selectedFields</code> and the rest of the fields will be populated as null.</p>\n<p>I am trying to figure out should I just handle the result of the query as an <code>Object[]</code> and just return it as the way it is. Should I perhaps just map it to the entity and populate the <code>selectedFields</code> of the entity and then maybe intercept the conversion to JSON to apply only the <code>selectedFields</code> in the response? Any advice is welcome.</p>\n"},{"last_activity_date":1684848789,"question_id":76314359,"body":"<p>Good Afternoon, Currently we have a springboot application including many third party itegrations, the passwords for which we handle in the following outdated? way:</p>\n<p>We encrypt the password locally, then store the encrypted version in our application.yml. When our application needs that password for authentication, we simply decrypt it and return the resolved password.</p>\n<p>This has been going on for some time, and it occurs to me, there must be a better way to avoid committing sensitive data to the git repo. All suggestions are welcome. Thanks, in advance.</p>\n"},{"answers":[{"comments":[{"comment_id":43456122,"body":"It seems thar that method (registerAuthentication(AuthenticationManagerBuilder auth))is not part of WebSecurityConfigurerAdapter. Wich class are you extending from?"},{"comment_id":43456766,"body":"I&#39;ve missed the version that you mentioned in the user, I believe that for 3.2.3 the config should be @Autowired \tpublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {, I&#39;ll edit in the question"},{"comment_id":43457089,"body":"You are totally right! In the meantime I googled that and I found in the Spring changelog for that version that the method has been renamed. I rewrote my code and now it works! Thank you very much for your help! Regards."}],"answer_id":27512275,"body":"<p>You should register your custom authentication in SecurityConfig class which have extended WebSecurityConfigureAdapter:</p>\n<pre><code>@Autowired\nprivate MyUserDetailsService userDetailsService;\n\n@Override\nprotected void configure(AuthenticationManagerBuilder auth) \n      throws Exception {\n    auth.userDetailsService(this.userDetailsService);\n}\n</code></pre>\n<p>for 3.2.3 the config should be</p>\n<pre><code>@Autowired\npublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n    auth.userDetailsService(this.userDetailsService);\n}\n</code></pre>\n"},{"comments":[{"comment_id":134575704,"body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/76315187/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"answer_id":76315187,"body":"<pre><code>@Component\npublic class JwtUtil {\n\n@Value(&quot;${jwt.secret}&quot;)\nprivate String secret;\n\n@Value(&quot;${jwt.expiration}&quot;)\nprivate Long expiration;\n\nDate now = new Date();\nDate ExpirationDate = new Date(now.getTime() + expiration * 1000);\n\npublic User getUser(final String token) {\n    Claims body = Jwts.parser()\n        .setSigningKey(secret)\n        .parseClaimsJws(token)\n        .getBody();\n\n    User u = new User();\n    u.setUsername(body.getSubject());\n    u.setUserId(Integer.parseInt((String) body.get(&quot;userId&quot;)));\n    Set &lt; Role &gt; roles = new HashSet &lt; &gt; ();\n    roles.add(Role.CONSUMER);\n    roles.add(Role.SELLER);\n    u.setRoles(roles);\n    return u;\n}\n\npublic String generateToken(String username) {\n    User u = new User();\n    Claims claims = Jwts.claims().setSubject(username);\n    claims.put(&quot;userId&quot;, u.getUserId());\n    Set &lt; Role &gt; roles = new HashSet &lt; &gt; ();\n    roles.add(Role.CONSUMER);\n    roles.add(Role.SELLER);\n    claims.put(&quot;role&quot;, roles);\n\n    return Jwts.builder()\n        .setClaims(claims)\n        .setIssuedAt(now)\n        .setExpiration(ExpirationDate)\n        .signWith(SignatureAlgorithm.HS512, secret)\n        .compact();\n\n}\n\npublic boolean validateToken(final String token) {\n    return getClaims(secret, token)\n        .getExpiration()\n        .after(new Date(System.currentTimeMillis()));\n}\n\npublic Claims getClaims(String secret, String token) {\n    return Jwts.parser()\n        .setSigningKey(secret)\n        .parseClaimsJws(token)\n        .getBody();\n}\npublic Boolean validateToken(String token, UserDetails userDetails) {\n\n    String username = extractUsername(token);\n\n    return (username.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token));\n\n}\n\n\npublic String extractUsername(String token) {\n\n    return extractClaim(token, Claims::getSubject);\n\n}\n\n\npublic String extractRole(String token) {\n\n    return (String) extractClaim(token, claims - &gt; claims.get(&quot;role&quot;));\n\n}\n\n\npublic Date extractExpiration(String token) {\n\n    return extractClaim(token, Claims::getExpiration);\n\n}\n\n\npublic &lt; T &gt; T extractClaim(String token, Function &lt; Claims, T &gt; claimsResolver) {\n\n    final Claims claims = extractAllClaims(token);\n\n    return claimsResolver.apply(claims);\n\n}\n\n\nprivate Claims extractAllClaims(String token) {\n\n    return Jwts.parser().setSigningKey(secret).parseClaimsJws(token).getBody();\n\n}\n\n\nprivate Boolean isTokenExpired(String token) {\n\n    final Date expiration = extractExpiration(token);\n\n    return expiration.before(new Date());\n\n}\n}\n\n\n@Component\npublic class JwtAuthenticationFilter extends OncePerRequestFilter {\n\n\n@Autowired\nprivate JwtUtil jwtTokenUtil;\n\n\n@Autowired\nprivate UserDetailsService userDetailsService;\n\n\n@Override\nprotected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws ServletException, IOException {\n\n    final String authorizationHeader = request.getHeader(&quot;Authorization&quot;);\n    String username = null;\n    String jwt = null;\n\n\n    if (authorizationHeader != null &amp;&amp; authorizationHeader.startsWith(&quot;JWT &quot;)) {\n\n        jwt = authorizationHeader.substring(7);\n        username = jwtTokenUtil.extractUsername(jwt);\n\n    }\n\n\n    if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\n\n        UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\n\n\n        if (jwtTokenUtil.validateToken(jwt, userDetails)) {\n\n            UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken = new UsernamePasswordAuthenticationToken(\n\n                userDetails, null, userDetails.getAuthorities());\n\n            usernamePasswordAuthenticationToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n\n            SecurityContextHolder.getContext().setAuthentication(usernamePasswordAuthenticationToken);\n\n        }\n\n    }\n\n    chain.doFilter(request, response);\n\n}\n\n}\n\n@Configuration\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true)\npublic class ApiSecurityConfig extends WebSecurityConfigurerAdapter {\n\n@Autowired\nprivate ApiAuthenticationEntryPoint jwtAuthenticationEntryPoint;\n\n\n@Autowired\nprivate JwtAuthenticationFilter jwtAuthorizationFilter;\n\n\n@Autowired\nprivate UserAuthService jwtUserDetailsService;\n\n\n\n@Bean\npublic PasswordEncoder passwordEncoder() {\n\n    return new BCryptPasswordEncoder();\n\n}\n\n@Autowired\npublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n\n    auth.userDetailsService(jwtUserDetailsService).passwordEncoder(passwordEncoder());\n\n}\n\n@Override\npublic void configure(WebSecurity web) throws Exception {\n\n}\n\n@Autowired\npublic void configure(AuthenticationManagerBuilder auth) throws Exception {\n    auth.userDetailsService(this.jwtUserDetailsService);\n}\n\n@Override\nprotected void configure(HttpSecurity http) throws Exception {\n    http.csrf().disable()\n        .authorizeRequests()\n        .antMatchers(HttpMethod.POST, &quot;/authenticate&quot;).permitAll()\n        .antMatchers(&quot;/api/public/**&quot;).permitAll()\n        .antMatchers(&quot;/api/auth/consumer/**&quot;).hasRole(&quot;CONSUMER&quot;)\n        .antMatchers(&quot;/api/auth/seller/**&quot;).hasRole(&quot;SELLER&quot;)\n        .anyRequest().authenticated()\n        .and()\n        .exceptionHandling().authenticationEntryPoint(jwtAuthenticationEntryPoint)\n        .and()\n        .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n\n\n    http.addFilterBefore(jwtAuthorizationFilter, UsernamePasswordAuthenticationFilter.class);\n\n}\n\n@Bean\npublic RegistrationBean jwtAuthFilterRegister(JwtAuthenticationFilter filter) {\n    FilterRegistrationBean registrationBean = new FilterRegistrationBean(filter);\n    registrationBean.setEnabled(false);\n    return registrationBean;\n}\n\n@Bean\n@Override\npublic AuthenticationManager authenticationManagerBean() throws Exception {\n    return super.authenticationManagerBean();\n}\n\n\n}\n\n\n@Component\npublic class ApiAuthenticationEntryPoint implements AuthenticationEntryPoint {\n@Override\npublic void commence(HttpServletRequest request, HttpServletResponse response,\n        AuthenticationException authException) throws IOException, ServletException {\n\n    response.sendError(HttpServletResponse.SC_UNAUTHORIZED, &quot;Unauthorized&quot;);\n}\n}\n\n@Service\npublic class AuthService {\n\n@Autowired\nprivate UserRepo userRepository;\n\n@Autowired\nprivate JwtUtil jwtutil;\n\n\npublic String authenticate(String username, String password) throws AuthenticationException {\n    Optional &lt; User &gt; user = userRepository.findByUsername(username);\n    if (user == null) {\n        throw new AuthenticationException(&quot;Invalid username or password&quot;);\n    }\n    return jwtutil.generateToken(username);\n}\n\n\n\n}\n\n@Service\npublic class ProductService {\n\n@Autowired\nprivate ProductRepo productRepository;\n\npublic List &lt; Product &gt; searchProducts(String keyword) {\n    return productRepository.findByProductNameContainingIgnoreCaseOrCategoryCategoryNameContainingIgnoreCase(keyword, keyword);\n}\n\n}\n\n@RestController\n@RequestMapping(&quot;/api/public&quot;)\npublic class PublicController {\n\n@Autowired\nprivate ProductService productService;\n\n@Autowired\nprivate AuthService authService;\n\n@GetMapping(&quot;/product/search&quot;)\npublic List &lt; Product &gt; searchProducts(@RequestParam(&quot;keyword&quot;) String keyword) {\n    return productService.searchProducts(keyword);\n}\n\n@PostMapping(&quot;/login&quot;)\npublic ResponseEntity &lt; String &gt; login(@RequestBody User credentials) {\n    try {\n        String token = null;\n        try {\n            token = authService.authenticate(credentials.getUsername(), credentials.getPassword());\n        } catch (javax.naming.AuthenticationException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        return ResponseEntity.ok(token);\n    } catch (AuthenticationException e) {\n        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).build();\n    }\n}\n\n}\n</code></pre>\n"}],"last_activity_date":1684848773,"question_id":27503285,"body":"<p>I'm trying to build a Java EE app prototype using different frameworks. Everything works fine except the security layer. I chose to use Spring Security configured with Spring configuration.</p>\n\n<p>The code is like this:</p>\n\n<p><strong>Spring Security Config</strong></p>\n\n<pre><code>@Configuration\n@EnableWebMvcSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter\n{\n    @Autowired\n    private MyUserDetailsService userDetailsService;\n\n    @Override\n    protected UserDetailsService userDetailsService () {\n        return this.userDetailsService;\n    }\n\n    @Override\n    public void configure(WebSecurity web) throws Exception {\n        web\n        .ignoring()\n        .antMatchers(\"/resources/**\");\n    }\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n        .formLogin()\n        .loginPage(\"/login\")\n        .loginProcessingUrl(\"/login/authenticate\")\n        .failureUrl(\"/login?error=bad_credentials\")\n        .and()\n        .logout()\n        .logoutUrl(\"/signout\")\n        .deleteCookies(\"JSESSIONID\")\n        .and()\n        .authorizeRequests()\n        .antMatchers(\"/admin/**\").hasRole(\"ADMIN\")\n        .antMatchers(\"/**\").permitAll()\n        .and()\n        .csrf();\n    }\n}\n</code></pre>\n\n<p><strong>User Detail Service</strong></p>\n\n<pre><code>@Service(\"myUserDetailsService\")\npublic class MyUserDetailsService implements UserDetailsService\n{\n    public static final Logger log = Logger.getLogger(MyUserDetailsService.class);\n\n    public MyUserDetailsService() {\n    }\n\n    @Autowired\n    private UserDao userDao;\n\n    @Override\n    public UserDetails loadUserByUsername(String userName) throws UsernameNotFoundException {\n        final User user = getSystemUser(userName);\n        final List&lt;GrantedAuthority&gt; authorities = getUserAuthorities(user);\n        return buildUserForAuthentication(user, authorities);\n    }\n\n    private User buildUserForAuthentication(User user, List&lt;GrantedAuthority&gt; authorities) {\n        //...\n    }\n\n    private User getSystemUser(String alias) {\n        //...\n    }\n\n    private List&lt;GrantedAuthority&gt; getUserAuthorities(User user) {\n        //...\n        return null;\n    }\n}\n</code></pre>\n\n<p>What I'm expecting this code to do is that when <code>/login/authenticate</code> is reached with the user &amp; pass params, the underlying spring code invokes my user service, but this never happens.</p>\n\n<p>What am I missing?</p>\n\n<p>I'm using spring-security 3.2.3.RELEASE.</p>\n"},{"comments":[{"comment_id":134575123,"body":"If it is a Java Web Application, is it available as a <code>.war</code> file under some application server like <code>tomcat&#47;webapps&#47;</code>?  If tomcat (or any other app server) is installed as a service, from laravel, you can just execute <code>$process = new Process([&#39;sudo&#39;, &#39;systemctl&#39;, &#39;start&#39;, &#39;tomcat&#39;]); $process-&gt;run();</code> Or any other command starts your Java application server.  If not as a service, then you may need to run the command like <code>&#47;opt&#47;tomcat&#47;bin&#47;startup.sh</code> or some such based on your app server&#39;s path and start-up script, but finally using <code>Process()</code>"},{"comment_id":134575184,"body":"So, depending upon what command is actually being used to start the Java web application server in your specific case in your server, you have to use <code>$process = new Process([....]); $process.run();</code>. The command may vary. It could also be <code>sudo service tomcat start</code> too, if <code>systemctl</code> is not set up."},{"comment_id":134575252,"body":"<code>Process::forever()-&gt;tty()-&gt;run(&#39;systemctl start tomcat&#39;);</code> - would be a correct choice. This should let that command run forever, without timeout as a separate process, I believe."}],"last_activity_date":1684848666,"question_id":76315368,"body":"<p>We've built a Java Web Application at a Linux server. At the same VPS a Laravel web app is on.<br />\nIs it possible to run/<strong>launch а Java Web Application [instance] from within Laravel ?</strong> If <em>yes</em>, <strong>how</strong>?</p>\n<p>Any hints, workarounds, etc. are welcomed.</p>\n"},{"last_activity_date":1684848380,"question_id":76315319,"body":"<p>I have a Java Filter that intercepts the request and changes a header based on certain condition:\npublic class MyFilter extends OncePerRequestFilter {</p>\n<pre><code>    ***protected void doFilterInternal(final HttpServletRequest request, final \n    HttpServletResponse response, final FilterChain chain) throws ServletException, \n    IOException {\n        if (condition) {\n           MyRequestWrapper newRequest = new MyRequest(MyRequestWrapper);\n       chain.doFilter(newRequest, response);\n    } else\n                chain.doFilter(request, response);\n}***\n\nThe RequestWrapper class simply replaces one header value and also keeps reference of original inputstream if it is available in original request.\n\nAfter this, I have implementation of Jetty's AsyncProxyServlet as follows:\n\npublic class AdminProxyServlet extends AsyncProxyServlet implements Watcher {\n\n@Override\nprotected String rewriteTarget(final HttpServletRequest request) {\n    //change URL and return true;\n}\n\nWhat I have observed is, the header that I have changed in request wrapper is correctly received in the rewriteTarget function. However, finally when the request gets redirected to the new URL in rewriteTarget function, it is the original request that is getting redirected instead of the wrapped request.\nAny suggestions on this?\n\nThanks\nSG\n</code></pre>\n"},{"answers":[{"comments":[{"comment_id":102846069,"body":"Thanks for an answer. Didn&#39;t know about container managed authentication, so now i&#39;m gonna read something about this. And another question then: is it a good idea to implement your own auth and use it instead of container managed auth?"},{"comment_id":102910621,"body":"Generally, rolling your own implementation of a security feature is a much high risk approach than using an existing implementation with a proven track record."}],"answer_id":58236041,"body":"<p><code>request.getUserPrincipal()</code> will be populated when you use container managed authentication. Since you have implemented your own authentication that method will return <code>null</code> and can be safely ignored.</p>\n"},{"answer_id":76315310,"body":"<p>Perhaps a little late to answer, just in case :</p>\n<p>In JEE servers, Principal and Subject objects are linked to your HttpRequest with JAAS login module. To implements your own authentication you have to implement your own JAAS login module.</p>\n<p>Then you will get naturally your own implementation of Principal.\nAnd then your authentication and authorisation to some pages or urls will be managed with configurations on your JEE Server. Example, you can add security contraints to your web.xml to allow or not somes urls like below :</p>\n<pre><code>&lt;security-constraint&gt;\n    &lt;web-resource-collection&gt;\n        &lt;web-resource-name&gt;admin&lt;/web-resource-name&gt;\n        &lt;url-pattern&gt;/admin/*&lt;/url-pattern&gt;\n    &lt;/web-resource-collection&gt;\n    &lt;auth-constraint&gt;\n        &lt;role-name&gt;admin&lt;/role-name&gt;\n    &lt;/auth-constraint&gt;\n&lt;/security-constraint&gt;\n</code></pre>\n<p>More about JAAS : <a href=\"https://docs.oracle.com/en/java/javase/20/security/jaas-tutorials.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/en/java/javase/20/security/jaas-tutorials.html</a></p>\n<p>This mecanism exists since the beggining of JEE, but few peoples knows how to use it.</p>\n"}],"last_activity_date":1684848319,"question_id":58234923,"body":"<p>I'm kinda new to Java EE and trying to learn it. So it's unclear to me how exactly <code>request.getUserPrincipal()</code> works. Where it gets Principal object? When and how this object is created? </p>\n\n<p>So let's assume I have a login form that passes user name and password in HTTP POST request. In my servlet I have to take this data and compare it to records in my database. If find one, create user object with his name and some other data. In this case, when do I need to call <code>getUserPrincipal()</code>? And do i really need to call it, because there's already some logic which return a user object? And how this method will get <code>Principal</code> object for me?</p>\n"},{"comments":[{"comment_id":110970953,"body":"Are you trying to run a new job instance or restart a failed one? Execution contexts that were serialized with 4.2.2 do not contain type informations (<code>@class</code>, <code>@property</code>, etc) that are required if deseriazlied with 4.2.4. If you run a new job with 4.2.4 and enable default typing, jackson will add type infos to the serialized execution context."},{"comment_id":110971015,"body":"@MahmoudBenHassine I am running a new one, but I want to read the last execution time of a previously successful instance. Do i understand correctly that this will not be possible having run the past jobs with 4.2.2?"},{"comment_id":110971251,"body":"You would need to add type infos (as you tried) to be able to deserialize the previous context (the one serialized with 4.2.2). I think your attempt to add <code>@class</code> in <code>&quot;{&quot;@class&quot;:&quot;java.util.HashMap&quot;}&quot;</code> is incorrect. Try to see how jackson serializes a new execution context and update your existing ones with a similar content."},{"comment_id":110972569,"body":"@MahmoudBenHassine Actually, <code>{&quot;@class&quot;:&quot;java.util.HashMap&quot;}</code> was correct, I had to add it to <code>batch_step_execution_context</code> as well as to <code>batch_job_execution_context</code>."},{"comment_id":110972713,"body":"ok good to know. Indeed, you need to make sure to update both job and step execution contexts obviously. Is your issue resolved now?"},{"comment_id":110972746,"body":"@MahmoudBenHassine yes, I posted an answer with a sample fix"},{"comment_id":116891353,"body":"I&#39;ve got the same issue with Spring batch 4.3.1 (spring boot 2.4.2). I&#39;ve downgraded the version spring batch to 4.2.2 to solve it."}],"answers":[{"comments":[{"comment_id":110973041,"body":"<code>The configuration overriding was not needed.</code>: which Jackson version do you have in your classpath? I&#39;m not sure there is a migration service we (should) can provide as users execution contexts can contain any sort of data. Your use case is specific since you need some info from the previous execution to run a new one, the problem should not happen for new job instances."},{"comment_id":110973139,"body":"@MahmoudBenHassine I have jackson version <code>2.11.0</code> after the upgrade to spring-boot <code>2.3.1.RELEASE</code> and had <code>2.10.2</code> before."},{"comment_id":110973314,"body":"That explains it. Spring Batch 4.2.x uses Jackson 2.10.x with which you would need the config override (The upcoming v4.3 will use Jackson 2.11), but it&#39;s ok and better that you have Jackson 2.11 (brought by Spring Boot 2.3). Glad you fixed you issue!"},{"comment_id":112617648,"body":"@MahmoudBenHassine Wouldn&#39;t hurt to put this somewhere in release notes? I checked and couldn&#39;t find anything, but that could just be me looking up wrong stuff."},{"comment_id":112618351,"body":"@Neikius It&#39;s in the release notes: <a href=\"https://github.com/spring-projects/spring-batch/releases/tag/4.2.4.RELEASE\" rel=\"nofollow noreferrer\">github.com/spring-projects/spring-batch/releases/tag/&hellip;</a> , issue 3729."},{"comment_id":126462862,"body":"There is a typo in the sql scripts. I suppose the first  tableName should be batch_job_execution_context instead of batch_step_execution_context"}],"answer_id":62753551,"body":"<p>Thanks to @MahmoudBenHassine for pointing me in the direction of the fix:</p>\n<p>My attempt to manually add the type information to the database values was correct, but I didn't take it far enough.</p>\n<p>There are 2 tables, whose values that needed updating:</p>\n<ul>\n<li>table <code>batch_job_execution_context</code>, column <code>short_context</code></li>\n<li>table <code>batch_step_execution_context</code>, column <code>short_context</code></li>\n</ul>\n<p>I did this with a liquibase script:</p>\n<pre><code>    &lt;changeSet id=&quot;update-job_execution_context-for-spring-batch-4.2.4&quot; author=&quot;kpentchev&quot;&gt;\n        &lt;update tableName=&quot;batch_step_execution_context&quot;&gt;\n            &lt;column name=&quot;short_context&quot; valueComputed=&quot;REPLACE(short_context, '{', '{&amp;quot;@class&amp;quot;:&amp;quot;java.util.HashMap&amp;quot;,')&quot; /&gt;\n        &lt;/update&gt;\n    &lt;/changeSet&gt;\n\n    &lt;changeSet id=&quot;update-step_execution_context-for-spring-batch-4.2.4&quot; author=&quot;kpentchev&quot;&gt;\n        &lt;update tableName=&quot;batch_step_execution_context&quot;&gt;\n            &lt;column name=&quot;short_context&quot; valueComputed=&quot;REPLACE(short_context, '{', '{&amp;quot;@class&amp;quot;:&amp;quot;java.util.HashMap&amp;quot;,')&quot; /&gt;\n        &lt;/update&gt;\n    &lt;/changeSet&gt;\n</code></pre>\n<p>The configuration overriding was not needed.</p>\n<p>It would have been nice to have a migration service as part of the <code>spring-batch</code> release, but here is a work-around.</p>\n"},{"answer_id":63383336,"body":"<p>I recently ran into a similar problem while upgrading from Spring Batch <code>4.2.1.RELEASE</code> to <code>4.2.4.RELEASE</code>.</p>\n<p>@kpentchev provides a good solution for this by directly modifying serialized execution context JSON in the database.</p>\n<p>Another solution is to extend <code>Jackson2ExecutionContextStringSerializer#deserialize(InputStream)</code>, catch the potential exception that's thrown deserializing the old JSON format, and use a second legacy <code>ObjectMapper</code>.</p>\n<p>I've provided one such implementation below.</p>\n<hr />\n<pre class=\"lang-java prettyprint-override\"><code>import com.fasterxml.jackson.annotation.JsonIgnore;\nimport com.fasterxml.jackson.core.JsonParser;\nimport com.fasterxml.jackson.core.type.TypeReference;\nimport com.fasterxml.jackson.databind.DeserializationContext;\nimport com.fasterxml.jackson.databind.DeserializationFeature;\nimport com.fasterxml.jackson.databind.JsonNode;\nimport com.fasterxml.jackson.databind.MapperFeature;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.deser.std.StdDeserializer;\nimport com.fasterxml.jackson.databind.exc.InvalidTypeIdException;\nimport com.fasterxml.jackson.databind.module.SimpleModule;\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.lang.reflect.Field;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Objects;\nimport javax.validation.constraints.NotNull;\nimport lombok.NonNull;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.batch.core.JobParameter;\nimport org.springframework.batch.core.JobParameters;\nimport org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer;\nimport org.springframework.util.ReflectionUtils;\n\n/**\n * Extends {@link Jackson2ExecutionContextStringSerializer} in order to support deserializing JSON\n * that was serialized using Spring Batch 4.2.1.RELEASE, and persisted in the database.\n *\n * &lt;p&gt;This class has been tested upgrading from Spring Batch 4.2.1.RELEASE to 4.2.4.RELEASE.\n */\n@Slf4j\npublic class BackwardsCompatibleSerializer extends Jackson2ExecutionContextStringSerializer {\n\n  private final ObjectMapper newObjectMapper;\n\n  private final ObjectMapper legacyObjectMapper;\n\n  public BackwardsCompatibleSerializer() {\n    newObjectMapper = getNewObjectMapper();\n    legacyObjectMapper = createLegacyObjectMapper();\n  }\n\n  /**\n   * Overrides the default deserialization method.  If an {@link InvalidTypeIdException} is thrown\n   * during deserialization, the exception is caught, and an attempt is made to deserialize the JSON\n   * using the legacy {@link ObjectMapper} instance.\n   */\n  @Override\n  public @NotNull Map&lt;String, Object&gt; deserialize(@NotNull InputStream in) throws IOException {\n    String json = inputStreamToString(in);\n    TypeReference&lt;HashMap&lt;String, Object&gt;&gt; typeRef = new TypeReference&lt;&gt;() {};\n    try {\n      return newObjectMapper.readValue(json, typeRef);\n    } catch (InvalidTypeIdException e) {\n      log.info(&quot;Couldn't deserialize JSON: will attempt to use legacy ObjectMapper&quot;);\n      log.debug(&quot;Stacktrace&quot;, e);\n      return legacyObjectMapper.readValue(json, typeRef);\n    }\n  }\n\n  /**\n   * Uses Java reflection to access the new {@link ObjectMapper} instance from the private\n   * superclass field.  This will be used to serialize and deserialize JSON created using Spring\n   * Batch 4.2.4.RELEASE.\n   *\n   * @return the new {@link ObjectMapper} instance\n   */\n  private ObjectMapper getNewObjectMapper() {\n    ObjectMapper newObjectMapper;\n    Field field = ReflectionUtils.findField(Jackson2ExecutionContextStringSerializer.class,\n        &quot;objectMapper&quot;, ObjectMapper.class);\n    Objects.requireNonNull(field, &quot;objectMapper field is null&quot;);\n    ReflectionUtils.makeAccessible(field);\n    newObjectMapper = (ObjectMapper) ReflectionUtils.getField(field, this);\n    return newObjectMapper;\n  }\n\n  /**\n   * Creates the {@link ObjectMapper} instance that can be used for deserializing JSON that was\n   * previously serialized using Spring Batch 4.2.1.RELEASE.  This instance is only used if an\n   * exception is thrown in {@link #deserialize(InputStream)} when using the new {@link\n   * ObjectMapper} instance.\n   *\n   * @return the {@link ObjectMapper} instance that can be used for deserializing legacy JSON\n   */\n  @SuppressWarnings(&quot;deprecation&quot;)\n  private ObjectMapper createLegacyObjectMapper() {\n    ObjectMapper legacyObjectMapper = new ObjectMapper();\n    legacyObjectMapper.configure(MapperFeature.DEFAULT_VIEW_INCLUSION, false);\n    legacyObjectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);\n    legacyObjectMapper.enableDefaultTyping();\n    legacyObjectMapper.registerModule(new JobParametersModule());\n    return legacyObjectMapper;\n  }\n\n  private static String inputStreamToString(@NonNull InputStream inputStream) throws IOException {\n    ByteArrayOutputStream result = new ByteArrayOutputStream();\n    byte[] buffer = new byte[1024];\n    int length;\n    while ((length = inputStream.read(buffer)) != -1) {\n      result.write(buffer, 0, length);\n    }\n    return result.toString(StandardCharsets.UTF_8);\n  }\n\n  /*\n   * The remainder of this file was copied from here:\n   *\n   * https://github.com/spring-projects/spring-batch/blob/4.2.1.RELEASE/spring-batch-core/src/main/java/org/springframework/batch/core/repository/dao/Jackson2ExecutionContextStringSerializer.java\n   */\n\n  // BATCH-2680\n\n  /**\n   * Custom Jackson module to support {@link JobParameter} and {@link JobParameters}\n   * deserialization.\n   */\n  private static class JobParametersModule extends SimpleModule {\n\n    private static final long serialVersionUID = 1L;\n\n    private JobParametersModule() {\n      super(&quot;Job parameters module&quot;);\n      setMixInAnnotation(JobParameters.class, JobParametersMixIn.class);\n      addDeserializer(JobParameter.class, new JobParameterDeserializer());\n    }\n\n    private abstract static class JobParametersMixIn {\n\n      @JsonIgnore\n      abstract boolean isEmpty();\n    }\n\n    private static class JobParameterDeserializer extends StdDeserializer&lt;JobParameter&gt; {\n\n      private static final long serialVersionUID = 1L;\n      private static final String IDENTIFYING_KEY_NAME = &quot;identifying&quot;;\n      private static final String TYPE_KEY_NAME = &quot;type&quot;;\n      private static final String VALUE_KEY_NAME = &quot;value&quot;;\n\n      JobParameterDeserializer() {\n        super(JobParameter.class);\n      }\n\n      @SuppressWarnings(&quot;checkstyle:all&quot;)\n      @Override\n      public JobParameter deserialize(JsonParser parser, DeserializationContext context)\n          throws IOException {\n        JsonNode node = parser.readValueAsTree();\n        boolean identifying = node.get(IDENTIFYING_KEY_NAME).asBoolean();\n        String type = node.get(TYPE_KEY_NAME).asText();\n        JsonNode value = node.get(VALUE_KEY_NAME);\n        Object parameterValue;\n        switch (JobParameter.ParameterType.valueOf(type)) {\n          case STRING: {\n            parameterValue = value.asText();\n            return new JobParameter((String) parameterValue, identifying);\n          }\n          case DATE: {\n            parameterValue = new Date(value.get(1).asLong());\n            return new JobParameter((Date) parameterValue, identifying);\n          }\n          case LONG: {\n            parameterValue = value.get(1).asLong();\n            return new JobParameter((Long) parameterValue, identifying);\n          }\n          case DOUBLE: {\n            parameterValue = value.asDouble();\n            return new JobParameter((Double) parameterValue, identifying);\n          }\n        }\n        return null;\n      }\n    }\n  }\n}\n</code></pre>\n"},{"answer_id":67335069,"body":"<p>I relied on @kpentchev's solution and used the following SQL commands:</p>\n<pre><code>update BATCH_JOB_EXECUTION_CONTEXT\nset SHORT_CONTEXT = replace(SHORT_CONTEXT, '{&quot;map&quot;', '{&quot;@class&quot;:&quot;java.util.HashMap&quot;,&quot;map&quot;')\nWHERE SHORT_CONTEXT LIKE '{&quot;map&quot;:%';\n\nupdate BATCH_STEP_EXECUTION_CONTEXT\nset SHORT_CONTEXT = replace(SHORT_CONTEXT, '{&quot;map&quot;','{&quot;@class&quot;:&quot;java.util.HashMap&quot;,&quot;map&quot;')\nWHERE SHORT_CONTEXT LIKE '{&quot;map&quot;:%';\n\ncommit;\n</code></pre>\n"},{"answer_id":76315268,"body":"<p>An alternate solution can be to cleanup the database.</p>\n<p><code>DELETE FROM BATCH_JOB_EXECUTION_CONTEXT WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob'))</code></p>\n<p><code>DELETE FROM BATCH_STEP_EXECUTION_CONTEXT WHERE STEP_EXECUTION_ID IN  (SELECT STEP_EXECUTION_ID FROM BATCH_STEP_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob'))</code></p>\n<p><code>DELETE FROM BATCH_STEP_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob')</code></p>\n<p><code>DELETE FROM BATCH_JOB_EXECUTION_PARAMS WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob')</code></p>\n<p><code>DELETE FROM BATCH_JOB_EXECUTION WHERE JOB_EXECUTION_ID IN (SELECT JOB_EXECUTION_ID FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob')</code></p>\n<p><code>DELETE FROM BATCH_JOB_INSTANCE WHERE JOB_NAME = 'myJob'</code></p>\n"}],"last_activity_date":1684848020,"question_id":62718203,"body":"<p>I was using <code>spring-batch:4.2.2.RELEASE</code> as part of <code>spring-boot-starter-batch:2.2.4.RELEASE</code>.\nAfter upgrading the latter to version <code>2.3.1.RELEASE</code>, I get the following exception when starting a job:</p>\n<pre><code>java.lang.IllegalArgumentException: Unable to deserialize the execution context\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:328)\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:312)\n    at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:94)\n    at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:61)\n    at org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:679)\n    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:617)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:669)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:700)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:712)\n    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:768)\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao.getExecutionContext(JdbcExecutionContextDao.java:129)\n    at org.springframework.batch.core.explore.support.SimpleJobExplorer.getStepExecutionDependencies(SimpleJobExplorer.java:238)\n    at org.springframework.batch.core.explore.support.SimpleJobExplorer.getJobExecutions(SimpleJobExplorer.java:87)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)\n    at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:127)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)\n    at com.sun.proxy.$Proxy145.getJobExecutions(Unknown Source)\n...\nCaused by: com.fasterxml.jackson.databind.exc.InvalidTypeIdException: Missing type id when trying to resolve subtype of [map type; class java.util.HashMap, [simple type, class java.lang.String] -&gt; [simple type, class java.lang.Object]]: missing type id property '@class'\n at [Source: (ByteArrayInputStream); line: 1, column: 192]\n    at com.fasterxml.jackson.databind.exc.InvalidTypeIdException.from(InvalidTypeIdException.java:43)\n    at com.fasterxml.jackson.databind.DeserializationContext.missingTypeIdException(DeserializationContext.java:1790)\n    at com.fasterxml.jackson.databind.DeserializationContext.handleMissingTypeId(DeserializationContext.java:1319)\n    at com.fasterxml.jackson.databind.jsontype.impl.TypeDeserializerBase._handleMissingTypeId(TypeDeserializerBase.java:303)\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer._deserializeTypedUsingDefaultImpl(AsPropertyTypeDeserializer.java:166)\n    at com.fasterxml.jackson.databind.jsontype.impl.AsPropertyTypeDeserializer.deserializeTypedFromObject(AsPropertyTypeDeserializer.java:107)\n    at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserializeWithType(MapDeserializer.java:400)\n    at com.fasterxml.jackson.databind.deser.impl.TypeWrappedDeserializer.deserialize(TypeWrappedDeserializer.java:68)\n    at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4482)\n    at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3479)\n    at org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer.deserialize(Jackson2ExecutionContextStringSerializer.java:123)\n    at org.springframework.batch.core.repository.dao.Jackson2ExecutionContextStringSerializer.deserialize(Jackson2ExecutionContextStringSerializer.java:102)\n    at org.springframework.batch.core.repository.dao.JdbcExecutionContextDao$ExecutionContextRowMapper.mapRow(JdbcExecutionContextDao.java:325)\n    ... 45 common frames omitted\n\n\n</code></pre>\n<p>I understand that the new version has a restricted handling of JSON deserialization and attempted to implement the suggested fix from the <code>Jackson2ExecutionContextStringSerializer</code> javadoc, however the problem persists:</p>\n<pre><code>@EnableBatchProcessing\n@Configuration\nclass BatchConfig(\n\n    val properties: BatchProperties,\n    val dataSource: DataSource,\n    val transactionManagerCustomizers: TransactionManagerCustomizers,\n    val entityManagerFactory: EntityManagerFactory\n) : JpaBatchConfigurer(properties, dataSource, transactionManagerCustomizers, entityManagerFactory) {\n\n    override fun createJobRepository(): JobRepository {\n        val factory = JobRepositoryFactoryBean()\n        val map = PropertyMapper.get()\n        map.from(dataSource).to { dataSource: DataSource? -&gt; factory.setDataSource(dataSource!!) }\n        map.from { determineIsolationLevel() }.whenNonNull().to { isolationLevelForCreate: String? -&gt; factory.setIsolationLevelForCreate(isolationLevelForCreate!!) }\n        map.from { properties.tablePrefix }.whenHasText().to { tablePrefix: String? -&gt; factory.setTablePrefix(tablePrefix!!) }\n        map.from { transactionManager }.to { transactionManager: PlatformTransactionManager? -&gt; factory.transactionManager = transactionManager!! }\n        factory.afterPropertiesSet()\n\n        val serializer = configureContextSerializer()\n        factory.setSerializer(serializer)\n\n        return factory.getObject()\n    }\n\n    private fun configureContextSerializer(): Jackson2ExecutionContextStringSerializer {\n        val polymorphicTypeValidator = LaissezFaireSubTypeValidator()\n        objectMapper.activateDefaultTyping(polymorphicTypeValidator)\n        val serializer = Jackson2ExecutionContextStringSerializer()\n        serializer.setObjectMapper(objectMapper)\n        return serializer\n    }\n</code></pre>\n<p>The craziest part is that the execution context is actually empty, the database value is always <code>&quot;{}&quot;</code>. I even tried changing all values in the DB to <code>&quot;{&quot;@class&quot;:&quot;java.util.HashMap&quot;}&quot;</code>, but I still get the same exception.</p>\n<p>Does anyone have an idea how to fix this? Is the configuration from my fix attempt wrong?</p>\n"},{"comments":[{"comment_id":134568730,"body":"Hint: Compare the Java versions on the working and non-working computers."}],"last_activity_date":1684847930,"question_id":76311412,"body":"<p>I am trying to host a Minecraft server and I'm getting errors whenever I run the .bat for the server.</p>\n<p>Here is the contents of the .bat file that starts the server</p>\n<pre><code>@ECHO OFF\n\n:: When setting the memory below make sure to include the amount of ram letter. M = MB, G = GB. Don't use 1GB for example, it's 1G ::\n\n:: This is 64-bit memory ::\nset memsixtyfour=4G\n\n:: This is 32-bit memory - maximum 1.2G ish::\nset memthirtytwo=1G\n\n:: The path to the Java to use. Wrap in double quotes (&quot;C:\\Path\\To\\Java\\bin\\java&quot;). Use &quot;java&quot; to point to system default install.\nset javapath=&quot;java&quot;\n\n:: Any additional arguments to pass to Java such as Metaspace, GC or anything else\nset jvmargs=&quot;&quot;\n\n:: Don't edit past this point ::\n\nif $SYSTEM_os_arch==x86 (\n    echo OS is 32\n    set mem=%memthirtytwo%\n) else (\n    echo OS is 64\n    set mem=%memsixtyfour%\n)\n\n%javapath% -version\n\necho Launching forge-1.12.2-14.23.5.2860.jar with '%mem%' max memory, jvm args '%jvmargs%' and arguments '%*'\n\n:: add nogui to the end of this line to disable the gui ::\n%javapath% -Xmx%mem% %jvm_args%  -Dlog4j2.formatMsgNoLookups=true -Dlog4j.configurationFile=log4j2.xml -jar forge-1.12.2-14.23.5.2860.jar %*\nPAUSE\n</code></pre>\n<p>This code is supposed to get the proper version of java, which is a variation of 1.8, and start the server startup but when it runs all I get is this error</p>\n<pre><code>OS is 64\njava version &quot;19.0.1&quot; 2022-10-18\nJava(TM) SE Runtime Environment (build 19.0.1+10-21)\nJava HotSpot(TM) 64-Bit Server VM (build 19.0.1+10-21, mixed mode, sharing)\nLaunching forge-1.12.2-14.23.5.2860.jar with '4G' max memory, jvm args '&quot;&quot;' and arguments ''\nA problem occurred running the Server launcher.java.lang.reflect.InvocationTargetException\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:110)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:578)\n        at net.minecraftforge.fml.relauncher.ServerLaunchWrapper.run(ServerLaunchWrapper.java:70)\n        at net.minecraftforge.fml.relauncher.ServerLaunchWrapper.main(ServerLaunchWrapper.java:34)\nCaused by: java.lang.ClassCastException: class jdk.internal.loader.ClassLoaders$AppClassLoader cannot be cast to class java.net.URLClassLoader (jdk.internal.loader.ClassLoaders$AppClassLoader and java.net.URLClassLoader are in module java.base of loader 'bootstrap')\n        at net.minecraft.launchwrapper.Launch.&lt;init&gt;(Launch.java:34)\n        at net.minecraft.launchwrapper.Launch.main(Launch.java:28)\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n        ... 3 more\nPress any key to continue . . .\n</code></pre>\n<p>I have no clue what is going on as I have tried the exact same thing on my desktop and it works.\nAll help is appreciated.</p>\n<p>--- Update 5/23/2023 9:11am ---\nI have tried to force the .bat file to use the proper version of java from a fresh install of jdk-8u351 and directing (used the file path to the bin directory which holds the java executable) the file to where &quot;java&quot; is when it set.</p>\n<pre><code>:: The path to the Java to use. Wrap in double quotes (&quot;C:\\Path\\To\\Java\\bin\\java&quot;). Use &quot;java&quot; to point to system default install.\nset javapath=&quot;java&quot;\n\n</code></pre>\n"},{"last_activity_date":1684847669,"question_id":76315207,"body":"<p>I want to have a textview with a double stroke in Android, which is not natively supported (not even a single stroke). Following <a href=\"https://stackoverflow.com/questions/3182393/android-textview-outline-text/31945164?r=Saves_UserSavesList#31945164\">Android textview outline text</a> it can be easily achieved.</p>\n<pre><code>public class StrokedTextView extends androidx.appcompat.widget.AppCompatTextView {\n\n// fields\nprivate int strokeColorW, strokeColorB;\nprivate float strokeWidthW, strokeWidthB;\n\n// constructors\npublic StrokedTextView(Context context) {\n    this(context, null, 0);\n}\n\npublic StrokedTextView(Context context, AttributeSet attrs) {\n    this(context, attrs, 0);\n}\n\npublic StrokedTextView(Context context, AttributeSet attrs, int defStyle) {\n    super(context, attrs, defStyle);\n\n    strokeColorW = context.getColor(R.color.white);\n    strokeWidthW = dpToPx(context, 2);\n    strokeColorB = context.getColor(R.color.main_color_dark);\n    strokeWidthB = dpToPx(context, 3);\n}\n\n// overridden methods\n@Override\nprotected void onDraw(Canvas canvas) {\n    //set paint to fill mode\n    Paint p = getPaint();\n    p.setStyle(Paint.Style.FILL);\n    //draw the fill part of text\n    super.onDraw(canvas);\n    //save the text color\n    int currentTextColor = getCurrentTextColor();\n    //set paint to stroke mode and specify\n    //stroke 1 color and width\n    p.setStyle(Paint.Style.STROKE);\n    p.setStrokeWidth(strokeWidthB);\n    setTextColor(strokeColorB);\n    //draw text stroke\n    super.onDraw(canvas);\n    //set paint to stroke mode and specify\n    //stroke 2 color and width\n    p.setStyle(Paint.Style.STROKE);\n    p.setStrokeWidth(strokeWidthW);\n    setTextColor(strokeColorW);\n    //draw text stroke\n    super.onDraw(canvas);\n    //revert the color back to the one\n    //initially specified\n    setTextColor(currentTextColor);\n}\n\npublic static int dpToPx(Context context, float dp)\n{\n    final float scale= context.getResources().getDisplayMetrics().density;\n    return (int) (dp * scale + 0.5f);\n}\n</code></pre>\n<p>}</p>\n<p>The problem is that <code>setTextColor</code> calls invalidate, so this falls into infinite calls of onDraw. As some suggest, I've tried to control it with a flag, that indicates whether the invalidate is caused by the setTextColor or not. But it still calls onDraw infinitely</p>\n<pre><code>private boolean isDrawing = false;\n\n@Override\npublic void invalidate() {\n    if(isDrawing) return;\n    super.invalidate();\n}\n\n@Override\nprotected void onDraw(Canvas canvas) {\n    isDrawing = true;\n\n    Paint p = getPaint();\n    p.setStyle(Paint.Style.FILL);\n    super.onDraw(canvas);\n    int currentTextColor = getCurrentTextColor();\n\n    p.setStyle(Paint.Style.STROKE);\n    p.setStrokeWidth(strokeWidthB);\n    setTextColor(strokeColorB);\n    super.onDraw(canvas);\n\n    p.setStyle(Paint.Style.STROKE);\n    p.setStrokeWidth(strokeWidthW);\n    setTextColor(strokeColorW);\n    super.onDraw(canvas);\n\n    setTextColor(currentTextColor);\n\n    isDrawing = false;\n}\n</code></pre>\n<p>As other user states in that question, I've also tried using Reflection to access the private field of the TextView and brute-forcely set it:</p>\n<pre><code>private void setColor(int color){\n    Field field = TextView.class.getDeclaredField(&quot;mCurTextColor&quot;);\n    field.setAccessible(true);\n    field.set(this, color);\n}\n</code></pre>\n<p>However, it states <code>Reflective access to mCurTextColor will throw an Exception when targeting API 33 and above</code></p>\n<p>So I'm asking if someone sees a way to overcome this issue different from the ones I've already tried and failed at.</p>\n"},{"comments":[{"comment_id":39185046,"body":"Why don&#39;t you try with <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html\" rel=\"nofollow noreferrer\"><code>AtomicInteger</code></a>?"},{"comment_id":39185510,"body":"See also: <a href=\"http://stackoverflow.com/questions/7640533/is-the-pre-incriment-operator-thread-safe-java\">another SO question</a>, <a href=\"http://madbean.com/2003/mb2003-44/\" rel=\"nofollow noreferrer\">++ not considered atomic</a>, <a href=\"http://www.informit.com/articles/article.aspx?p=31682&amp;seqNum=3\" rel=\"nofollow noreferrer\">Concurrency in Java</a>."},{"comment_id":39189739,"body":"@user2864740, why do you say AtomicInteger is not atomic? You can use the <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html#getAndIncrement()\" rel=\"nofollow noreferrer\">getAndIncrement</a> method to do this. It is atomic."},{"comment_id":39189786,"body":"the JVM has an <code>iinc</code> operation for incrementing integers, but that only works for local variables, where concurrency is not a concern. For fields, the compiler generates read-modify-write commands separately."},{"comment_id":39190685,"body":"Why would you even expect it to be atomic?"},{"comment_id":39194465,"body":"Even on hardware that implements an &quot;increment storage location&quot; instruction, there&#39;s no guarantee that that&#39;s thread-safe.  Just because an operation can be represented as a single operator says nothing about it&#39;s thread-safety."},{"comment_id":39207037,"body":"@Silly Freak: even if there was an <code>iinc</code> instruction for fields, having a single instruction does not guarantee atomicity, e.g. non-<code>volatile</code> <code>long</code> and <code>double</code> field access in not guaranteed to be atomic regardless of the fact that it is performed by a single bytecode instruction."},{"comment_id":106035594,"body":"This question highlights the usefulness of learning assembly language."}],"answers":[{"answer_id":25168103,"body":"<p>In the JVM, an increment involves a read and a write, so it's not atomic. </p>\n"},{"comments":[{"comment_id":39185180,"body":"(Even if <code>i++</code> <i>was</i> atomic, it would not be well-defined/thread-safe behavior.)"},{"comment_id":39185473,"body":"+1, but &quot;1. A, 2. B and C&quot; sounds like three operations, not two. :)"},{"comment_id":39194506,"body":"Note that even if the operation were implemented with a single machine instruction that incremented a storage location in place, there is no guarantee it would be thread-safe.  The machine still needs to fetch the value, increment it, and store it back, <i>plus</i> there may be multiple cache copies of that storage location."},{"comment_id":39202596,"body":"@HotLicks Not necessarily.  If the fetch, increment and store are done atomically, or in one single &quot;transaction&quot; (on the CPU level), then it&#39;s presumably thread-safe.  Although, yes, there may be cached copies, but that&#39;s a different story.  I think the only possible contention would be if the incrementing thread were paused (due to kernel scheduling) before the increment operation completed, possibly allowing another thread to read the variable.  I would think it depends upon the threading implementation, OS, and CPU."},{"comment_id":39209964,"body":"@Aquarelle - If two processors execute the same operation against the same storage location simultaneously, and there is no &quot;reserve&quot; broadcast on the location, then they will almost certainly interfere and produce bogus results.  Yes, it is possible for this operation to be &quot;safe&quot;, but it takes special effort, even at the hardware level."},{"comment_id":39240369,"body":"But I think the question was &quot;Why&quot; and not &quot;What happens&quot;."},{"comment_id":39250673,"body":"@phresnel I interpreted the question differently,  since if the op wanted to know why java creators chose not to make ++ atomic, there was no need for all the code posted. The code implied they asked why the code behaves the way it does. Based on the accepted answer I may have been wrong."},{"comment_id":75939384,"body":"Thank you; however, I think, that 1) read current; 2)increment; 3) assign it back is still three operations :)"}],"answer_id":25168105,"body":"<p><code>i++</code> involves two operations :</p>\n\n<ol>\n<li>read the current value of <code>i</code></li>\n<li>increment the value and assign it to <code>i</code></li>\n</ol>\n\n<p>When two threads perform <code>i++</code> on the same variable at the same time, they may both get the same current value of <code>i</code>, and then increment and set it to <code>i+1</code>, so you'll get a single incrementation instead of two.</p>\n\n<p>Example :</p>\n\n<pre><code>int i = 5;\nThread 1 : i++;\n           // reads value 5\nThread 2 : i++;\n           // reads value 5\nThread 1 : // increments i to 6\nThread 2 : // increments i to 6\n           // i == 6 instead of 7\n</code></pre>\n"},{"comments":[{"comment_id":39217236,"body":"I don&#39;t get how this should be an answer to the question. A language can define any feature as atomic, be it increments or unicorns. You just exemplify a consequence of not being atomic."},{"comment_id":39220980,"body":"Yes a language can define any feature as atomic but as far as java is considered increment operator(which is the question posted by OP) is not atomic and my answer states the reasons."},{"comment_id":39221347,"body":"(sorry for my harsh tone in first comment) But then, the reason seems to be &quot;because if it would be atomic, then there would be no race conditions&quot;. I.e., it sounds as if a race condition is desirable."},{"comment_id":39238421,"body":"@phresnel  the overhead introduced to keep an increment atomic is huge and rarely desired, keeping the operation cheap and as a result non atomic is desirable most of the time."},{"comment_id":39240143,"body":"@josefx: Note that I am not questioning the facts, but the reasoning in this answer. It basically says <i>&quot;i++ is not atomic in Java because of the race conditions it has&quot;</i>, which is like saying <i>&quot;a car has no airbag because of the crashes that can happen&quot;</i> or <i>&quot;you get no knife with your currywurst-order because the wurst may need to be cut&quot;</i>. Thus, I don&#39;t think this is an answer. The question was not <i>&quot;What does i++ do?&quot;</i> or <i>&quot;What is the consequence of i++ not being synced?&quot;</i>."}],"answer_id":25168135,"body":"<blockquote>\n  <p>Why is i++ not atomic in Java?</p>\n</blockquote>\n\n<p>Let's break the increment operation into multiple statements:</p>\n\n<p>Thread 1 &amp; 2 :</p>\n\n<ol>\n<li>Fetch value of total from memory</li>\n<li>Add 1 to the value</li>\n<li>Write back to the memory</li>\n</ol>\n\n<p>If there is no synchronization then let's say Thread one has read the value 3 and incremented it to 4, but has not written it back. At this point, the context switch happens. Thread two reads the value 3, increments it and the context switch happens. Though both threads have incremented the total value, it will still be 4 - race condition.</p>\n"},{"comments":[{"comment_id":39190058,"body":"-1 &quot;public class Thread ... Since: JDK1.0&quot; Source: <a href=\"http://docs.oracle.com/javase/7/docs/api/index.html?java/lang/Thread.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/api/index.html?java/lang/&hellip;</a>"},{"comment_id":39190212,"body":"The version doesn&#39;t matter so much as the fact that it was still implemented before the Thread class and was not changed because of it, but I&#39;ve edited my answer to please you."},{"comment_id":39190286,"body":"What matters is that your claim &quot;it was still implemented before the Thread class&quot; is not backed by sources. <code>i++</code> not being atomic is a design decision, not an oversight in a growing system."},{"comment_id":39218137,"body":"Lol that&#39;s cute. i++ was defined well before Threads, simply because there were languages that existed before Java. The creators of Java used those other languages as a base instead of redefining a well accepted procedure. Where did I ever say it was an oversight?"},{"comment_id":39218413,"body":"@SillyFreak Here&#39;s some sources that show how old ++ is: <a href=\"http://en.wikipedia.org/wiki/Increment_and_decrement_operators\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Increment_and_decrement_operators</a> <a href=\"http://en.wikipedia.org/wiki/B_(programming_language)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/B_(programming_language)</a>"},{"comment_id":39222298,"body":"Just because a language feature is borrowed from or inspired by a corresponding feature in other languages doesn&#39;t mean it necessarily keeps the exact same underlying characteristics. Consider, for instance, the variety of <code>lambda</code> functions in different languages (e.g. the weakness of Python&#39;s <code>lambda</code> compared to true Lisp lambdas <a href=\"http://symbo1ics.com/blog/?p=1292\" rel=\"nofollow noreferrer\">symbo1ics.com/blog/?p=1292</a>). Even in C++, certain features taken from C aren&#39;t quite identical to their C counterparts, <i>despite</i> the fact that C++ is often thought to be backwards-compatible with C (<a href=\"http://www.cprogramming.com/tutorial/c-vs-c++.html\" rel=\"nofollow noreferrer\">cprogramming.com/tutorial/c-vs-c++.html</a>)."},{"comment_id":39240353,"body":"@TheBat: But many borrowed keywords and operators <b>are not</b> implemented like in the language/s they were borrowed from. E.g., <code>class</code> and <code>operator.</code> in C++ are totally orthogonal to their Java &quot;equivalents&quot;."}],"answer_id":25168153,"body":"<p>Concurrency (the <code>Thread</code> class and such) is an added feature in v1.0 of <a href=\"http://en.wikipedia.org/wiki/Java_%28programming_language%29\" rel=\"nofollow\">Java</a>. <code>i++</code> was added in the beta before that, and as such is it still more than likely in its (more or less) original implementation.</p>\n\n<p>It is up to the programmer to synchronize variables. Check out <a href=\"http://docs.oracle.com/javase/tutorial/essential/concurrency/\" rel=\"nofollow\">Oracle's tutorial on this</a>.</p>\n\n<p>Edit: To clarify, i++ is a well defined procedure that predates Java, and as such the designers of Java decided to keep the original functionality of that procedure.</p>\n\n<p>The ++ operator was defined in B (1969) which predates java and threading by just a tad.</p>\n"},{"answer_id":25168841,"body":"<h1>Java specification</h1>\n<p>The important thing is the <a href=\"https://docs.oracle.com/javase/specs/\" rel=\"nofollow noreferrer\">JLS (Java Language Specification)</a> rather than how various implementations of the JVM may or may not have implemented a certain feature of the language.</p>\n<p>The JLS defines the ++ postfix operator in clause 15.14.2 which says i.a. &quot;the value 1 is added to the value of the variable and the sum is stored back into the variable&quot;. Nowhere does it mention or hint at multithreading or atomicity.</p>\n<p>For multithreading or atomicity, the JLS provides <em>volatile</em> and <em>synchronized</em>. Additionally, there are the <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/atomic/package-summary.html\" rel=\"nofollow noreferrer\"><code>Atomic…</code></a> classes.</p>\n"},{"comments":[{"comment_id":39191223,"body":"as java has no pointers, incrementing local variables is inherently thread save, so with loops the problem mostly wouldn&#39;t be so bad. your point about least surprise stands, of course.  also, as it is, <code>i = i + 1</code> would be a translation for <code>++i</code>, not <code>i++</code>"},{"comment_id":39194375,"body":"The first word of the question is &quot;why&quot;.  As of now, this is the only answer to address the issue of &quot;why&quot;.  The other answers really just re-state the question.  So +1."},{"comment_id":39207330,"body":"It might be worth noting that an atomicity guaranty would not solve the visibility issue for updates of non-<code>volatile</code> fields. So unless you will treat every field as implicitly <code>volatile</code> once one thread has used the <code>++</code> operator on it, such an atomicity guaranty would not solve concurrent update issues. So why potentially wasting performance for something if it doesn’t solve the problem."},{"comment_id":39467310,"body":"@DavidWallace don&#39;t you mean <code>++</code>? ;)"}],"answer_id":25171089,"body":"<p><code>i++</code> is probably not atomic in Java because atomicity is a special requirement which is not present in the majority of the uses of <code>i++</code>. That requirement has a significant overhead: there is a large cost in making an increment operation atomic; it involves synchronization at both the software and hardware levels that need not be present in an ordinary increment.</p>\n\n<p>You could make the argument that <code>i++</code> should have been designed and documented as specifically performing an atomic increment, so that a non-atomic increment is performed using <code>i = i + 1</code>.  However, this would break the \"cultural compatibility\" between Java, and C and C++. As well, it would take away a convenient notation which programmers familiar with C-like languages take for granted, giving it a special meaning that applies only in limited circumstances.</p>\n\n<p>Basic C or C++ code like <code>for (i = 0; i &lt; LIMIT; i++)</code> would translate into Java as <code>for (i = 0; i &lt; LIMIT; i = i + 1)</code>; because it would be inappropriate to use the atomic <code>i++</code>. What's worse, programmers coming from C or other C-like languages to Java would use <code>i++</code> anyway, resulting in unnecessary use of atomic instructions.</p>\n\n<p>Even at the machine instruction set level, an increment type operation is usually not atomic for performance reasons. In x86, a special instruction \"lock prefix\" must be used to make the <code>inc</code> instruction atomic: for the same reasons as above.  If <code>inc</code> were always atomic, it would never be used when a non-atomic inc is required; programmers and compilers would generate code that loads, adds 1 and stores, because it would be way faster.</p>\n\n<p>In some instruction set architectures, there is no atomic <code>inc</code> or perhaps no <code>inc</code> at all; to do an atomic inc on MIPS, you have to write a software loop which uses the <code>ll</code> and <code>sc</code>: load-linked, and store-conditional. Load-linked reads the word, and store-conditional stores the new value if the word has not changed, or else it fails (which is detected and causes a re-try).</p>\n"},{"comments":[{"comment_id":39217327,"body":"This is misleading. You have to separate execution and getting the result, otherwise you couldn&#39;t get values from <i>any</i> atomic operation."},{"comment_id":39225814,"body":"No it isn&#39;t, that is why Java&#39;s AtomicInteger has a get(), getAndIncrement(), getAndDecrement(), incrementAndGet(), decrementAndGet() etc."},{"comment_id":39228524,"body":"And the Java-language could have defined <code>i++</code> to be expanded to <code>i.getAndIncrement()</code>. Such expanding isn&#39;t new. E.g., lambdas in C++ are expanded to anonymous class definitions in C++."},{"comment_id":55545112,"body":"Given an atomic <code>i++</code> one can trivially create an atomic <code>++i</code> or vice-versa. One is equivalent to the other plus one."}],"answer_id":25178383,"body":"<p>If the operation <code>i++</code> would be atomic you wouldn't have the chance to read the value from it. This is exactly what you want to do using <code>i++</code> (instead of using <code>++i</code>).</p>\n\n<p>For example look at the following code:</p>\n\n<pre><code>public static void main(final String[] args) {\n    int i = 0;\n    System.out.println(i++);\n}\n</code></pre>\n\n<p>In this case we expect the output to be: <code>0</code>\n(because we post increment, e.g. first read, then update)</p>\n\n<p>This is one of the reasons the operation can't be atomic, because you need to read the value (and do something with it) and <strong>then</strong> update the value.</p>\n\n<p>The other important reason is that doing something atomically <em>usually</em> takes more time because of locking. It would be silly to have all the operations on primitives take a little bit longer for the rare cases when people want to have atomic operations. That is why they've added <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html\" rel=\"nofollow\"><code>AtomicInteger</code></a> and <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/package-summary.html\" rel=\"nofollow\">other</a> atomic classes to the language.</p>\n"},{"comments":[{"comment_id":39217265,"body":"Hmm. A language can define any feature as atomic, be it increments or unicorns. You just exemplify a consequence of not being atomic."},{"comment_id":39218326,"body":"@phresnel Exactly. But I also point out that it&#39;s not a single operation which by extension implies that the computational cost for turning multiple such operations into atomic ones is much more expensive which in turn -partially- justifies why <code>i++</code> is not atomic."},{"comment_id":39218470,"body":"While I get your point, your answer is a bit confusing to the learning. I see an example, and a conclusion that says &quot;because of the situation in the example&quot;; imho this is an incomplete reasoning :("},{"comment_id":39218740,"body":"@phresnel Maybe not the most pedagogical answer but it&#39;s the best I can currently offer. Hopefully it will help people and not confuse them. Thanks for critisism however. I &#39;ll try to be more precise in my future posts."}],"answer_id":25181723,"body":"<p><code>i++</code> is a statement which simply involves 3 operations:</p>\n\n<ol>\n<li>Read current value</li>\n<li>Write new value</li>\n<li>Store new value</li>\n</ol>\n\n<p>These three operations are not meant to be executed in a single step or in other words <code>i++</code> is not a  <strong>compound</strong> operation. As a result all sorts of things can go wrong when more than one threads are involved in a single but non-compound operation.</p>\n\n<p>Consider the following scenario:</p>\n\n<p><strong>Time 1</strong>:</p>\n\n<pre><code>Thread A fetches i\nThread B fetches i\n</code></pre>\n\n<p><strong>Time 2</strong>:</p>\n\n<pre><code>Thread A overwrites i with a new value say -foo-\nThread B overwrites i with a new value say -bar-\nThread B stores -bar- in i\n\n// At this time thread B seems to be more 'active'. Not only does it overwrite \n// its local copy of i but also makes it in time to store -bar- back to \n// 'main' memory (i)\n</code></pre>\n\n<p><strong>Time 3</strong>:</p>\n\n<pre><code>Thread A attempts to store -foo- in memory effectively overwriting the -bar- \nvalue (in i) which was just stored by thread B in Time 2.\n\nThread B has nothing to do here. Its work was done by Time 2. However it was \nall for nothing as -bar- was eventually overwritten by another thread.\n</code></pre>\n\n<p>And there you have it. A race condition.</p>\n\n<hr>\n\n<p>That's why <code>i++</code> is not atomic. If it was, none of this would have happened and each <code>fetch-update-store</code> would happen atomically. That's exactly what <code>AtomicInteger</code> is for and in your case it would probably fit right in.</p>\n\n<p>P.S.</p>\n\n<p>An excellent book covering all of those issues and then some is this:\n<a href=\"https://rads.stackoverflow.com/amzn/click/com/0321349601\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Java Concurrency in Practice</a></p>\n"},{"answer_id":25276937,"body":"<p>There are two steps:</p>\n\n<ol>\n<li>fetch i from memory</li>\n<li>set i+1 to i</li>\n</ol>\n\n<p>so it's not atomic operation.\nWhen thread1 executes i++, and thread2 executes i++, the final value of i may be i+1.</p>\n"},{"comments":[{"comment_id":125502412,"body":"That is <i>how</i> it is non-atomic, not <i>why</i>, as so many of the other answers and comments have covered."}],"answer_id":66290441,"body":"<p>In JVM or any VM, the <code>i++</code> is equivalent to the following:</p>\n<pre><code>int temp = i;     // 1. read\ni = temp + 1;    // 2. increment the value then 3. write it back\n</code></pre>\n<p>that is why i++ is non-atomic.</p>\n"},{"answer_id":76315195,"body":"<p>In Java, the i++ operation is not atomic because it is actually a combination of multiple steps that can be interrupted by other threads. The i++ operation consists of three distinct steps: reading the current value of i, incrementing the value by 1, and storing the updated value back into i. Each of these steps is a separate operation and can be interleaved with operations from other threads, leading to potential race conditions.</p>\n<p>A race condition occurs when multiple threads access a shared resource concurrently, and the result of the operation depends on the specific order of execution. In the case of i++, if two or more threads attempt to increment i at the same time, they may read the same initial value of i, increment it separately, and then store their individual results back into i. This can lead to lost updates, where one or more increments are overwritten, resulting in an incorrect final value of i.</p>\n<p>To ensure atomicity and avoid race conditions, Java provides the AtomicInteger class, which encapsulates an integer value and provides atomic operations on that value. Instead of using int i, you can use AtomicInteger i and perform atomic increments using the incrementAndGet() method. This method guarantees that the increment operation is performed atomically and eliminates the possibility of race conditions.</p>\n<p>Here's an example that demonstrates the atomic increment using AtomicInteger:</p>\n<pre><code>import java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.atomic.AtomicInteger;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\npublic class Test {\n\n    private static AtomicInteger total = new AtomicInteger(0);\n    private static AtomicInteger countT1 = new AtomicInteger(0);\n    private static AtomicInteger countT2 = new AtomicInteger(0);\n    private boolean run = true;\n\n    public Test() {\n        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\n        newCachedThreadPool.execute(t1);\n        newCachedThreadPool.execute(t2);\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        run = false;\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        System.out.println((countT1.get() + countT2.get() + &quot; == &quot; + total.get()));\n    }\n\n    private Runnable t1 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total.incrementAndGet();\n                countT1.incrementAndGet();\n                System.out.println(&quot;Hello #&quot; + countT1.get() + &quot; from Thread 1! Total hello: &quot; + total.get());\n            }\n        }\n    };\n\n    private Runnable t2 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total.incrementAndGet();\n                countT2.incrementAndGet();\n                System.out.println(&quot;Hello #&quot; + countT2.get() + &quot; from Thread 2! Total hello: &quot; + total.get());\n            }\n        }\n    };\n\n    public static void main(String[] args) {\n        new Test();\n    }\n}\n</code></pre>\n"}],"last_activity_date":1684847572,"question_id":25168062,"body":"<p>Why is <code>i++</code> not atomic in Java?</p>\n<p>To get a bit deeper in Java I tried to count how often the loop in threads are executed.</p>\n<p>So I used a</p>\n<pre><code>private static int total = 0;\n</code></pre>\n<p>in the main class.</p>\n<p>I have two threads.</p>\n<ul>\n<li>Thread 1: Prints <code>System.out.println(&quot;Hello from Thread 1!&quot;);</code></li>\n<li>Thread 2: Prints <code>System.out.println(&quot;Hello from Thread 2!&quot;);</code></li>\n</ul>\n<p>And I count the lines printed by thread 1 and thread 2. But the lines of thread 1 + lines of thread 2 don't match the total number of lines printed out.</p>\n<p>Here is my code:</p>\n<pre><code>import java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\npublic class Test {\n\n    private static int total = 0;\n    private static int countT1 = 0;\n    private static int countT2 = 0;\n    private boolean run = true;\n\n    public Test() {\n        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\n        newCachedThreadPool.execute(t1);\n        newCachedThreadPool.execute(t2);\n        try {\n            Thread.sleep(1000);\n        }\n        catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        run = false;\n        try {\n            Thread.sleep(1000);\n        }\n        catch (InterruptedException ex) {\n            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);\n        }\n        System.out.println((countT1 + countT2 + &quot; == &quot; + total));\n    }\n\n    private Runnable t1 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total++;\n                countT1++;\n                System.out.println(&quot;Hello #&quot; + countT1 + &quot; from Thread 1! Total hello: &quot; + total);\n            }\n        }\n    };\n\n    private Runnable t2 = new Runnable() {\n        @Override\n        public void run() {\n            while (run) {\n                total++;\n                countT2++;\n                System.out.println(&quot;Hello #&quot; + countT2 + &quot; from Thread 2! Total hello: &quot; + total);\n            }\n        }\n    };\n\n    public static void main(String[] args) {\n        new Test();\n    }\n}\n</code></pre>\n"},{"comments":[{"comment_id":134574143,"body":"Please disable the automated translator in your browser or post this on <a href=\"https://es.stackoverflow.com\">Stack Overflow en español</a>."},{"comment_id":134574601,"body":"Please don&#39;t use IDE tags for general programming problems."}],"last_activity_date":1684847434,"question_id":76314831,"body":"<p>soy nuevo en Java y estoy teniendo unos problemas con los ciclos.\nresulta que creé una matriz de 5,3 la cual se supone que tiene dptos., sus costos y su estado (vendido, disponible).\nen si no tengo problemas con la matriz, pero si cuando quiero volver a preguntar al usuario si quiere seguir &quot;comprando&quot;</p>\n<p>tengo un ciclo DO WHILE el cual se supone que realiza la condición, he intentado de muchas formas pero nada me funciona.\nA continuación, dejo el código</p>\n<p>public static void main(String[] args) {</p>\n<pre><code>    int s;\n    String d=&quot;&quot;;\n    String estado = &quot;DISPONIBLE&quot;;\n    String deptos[][] = new String[5][3];\n    Scanner leer = new Scanner(System.in);\n\n    \n    \n       do{\n        //se llena matriz con deptos,costos y disponibilidad; dos deptos por piso\n        deptos[0][0] = &quot;DEPTO&quot;;\n        deptos[0][1] = &quot;VALOR&quot;;\n        deptos[0][2] = &quot;DSIPONIBILIDAD&quot;;\n        deptos[1][0] = &quot;101&quot;;\n        deptos[1][1] = &quot;1000&quot;;\n        deptos[1][2] = estado;\n        deptos[2][0] = &quot;102&quot;;\n        deptos[2][1] = &quot;2000&quot;;\n        deptos[2][2] = estado;\n        deptos[3][0] = &quot;201&quot;;\n        deptos[3][1] = &quot;3000&quot;;\n        deptos[3][2] = estado;\n        deptos[4][0] = &quot;202&quot;;\n        deptos[4][1] = &quot;4000&quot;;\n        deptos[4][2] = estado;\n\n        //recorrido de matriz e impresión\n        for (String[] depto : deptos) {\n\n            System.out.println(&quot;\\n&quot;);\n\n            for (String depto1 : depto) {\n                System.out.print(&quot;|&quot; + depto1 + &quot;|&quot; + &quot;\\t&quot;);\n            }\n        }//fin ciclo for \n        \n        //eleccion de depto\n        System.out.println(&quot;&quot;&quot;\n    \\n\n    Favor seleccione un numero de DPTO para comprarlo:\n    1.- 101 \n    2.- 102 \n    3.- 201 \n    4.- 202 \n     \\n&quot;&quot;&quot;);\n\n        //se lee la seleccion del dpto\n        d = leer.nextLine();\n           System.out.println(&quot;Usted seleccionó&quot; + d);\n      \n        \n        \n        \n        System.out.println(&quot;\\n Seguir?&quot;);\n        s = leer.nextInt();\n       }while(s==1);    \n    }\n</code></pre>\n"},{"comments":[{"comment_id":134575315,"body":"<code>.jmod</code> files are not <code>.jar</code> files. This <code>java-rt-jar-stubs-1.5.0.jar</code> file is not a standard artifact, so we can’t say anything about it…"}],"last_activity_date":1684847241,"question_id":76315135,"body":"<p>I am using openjdk-11 and proguard version is 7.3.2 and while build one of the module i am getting many warnings as below:</p>\n<pre><code>[javac] Reading library jmod [/opt/jdk-11/jmods/java.base.jmod] (filtered)\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileStore]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtDirectoryStream]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtUtils]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileAttributeView$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileSystemProvider]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileAttributeView]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.ExplodedImage]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileSystem]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtPath$2]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.SystemImage$2]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtPath]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtPath$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.ExplodedImage$PathNode]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileSystemProvider$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtDirectoryStream$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileSystem$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileAttributes]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.SystemImage]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileSystemProvider$JrtFsLoader]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.JrtFileAttributeView$AttrID]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jrtfs.SystemImage$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageBufferCache$BufferReference]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageBufferCache$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageStrings]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReader$Resource]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReaderFactory$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.NativeImageBuffer]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReader$SharedImageReader]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.StringSharingDecompressorFactory]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.CompressIndexes]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.CompressedResourceHeader]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.SignatureParser$ParseResult]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.ResourceDecompressor]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.ResourceDecompressorFactory]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.StringSharingDecompressor]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.SignatureParser]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.ZipDecompressorFactory]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.ZipDecompressor]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.ResourceDecompressorRepository]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.ResourceDecompressor$StringsProvider]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.decompressor.Decompressor]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageStringsReader]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageBufferCache$2]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.BasicImageReader]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReader$Directory]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReader$SharedImageReader$LocationVisitor]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.BasicImageReader$2]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.BasicImageReader$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageBufferCache]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReader]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageHeader]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageLocation]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReaderFactory]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReader$LinkNode]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.NativeImageBuffer$1]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageReader$Node]\n17:33:35     [javac] Note: duplicate definition of library class [jdk.internal.jimage.ImageStream]\n17:33:35     [javac] Note: there were 57 duplicate class definitions.\n17:33:35     [javac]       (https://www.guardsquare.com/proguard/manual/troubleshooting#duplicateclass)\n17:33:35     [javac] Initializing...\ncom.test.UtilPanel: can't find superclass or interface javax.swing.JFrame\ncom.test.UtilPanel: can't find superclass or interface javax.swing.event.DocumentListener\ncom.test.UtilPanel: find referenced class com.test.StringUtils\ncom.test.UtilPanel: can't find referenced class javax.swing.JFrame\ncom.test.UtilPanel: can't find referenced method 'java.awt.Container getContentPane()' in program class com.test.UtilPanel\ncom.test.UtilPanel: can't find referenced class java.awt.Container\ncom.test.UtilPanel: can't find referenced method 'void pack()' in program class com.test.UtilPanel\ncom.test.UtilPanel: can't find referenced class java.awt.Toolkit\ncom.test.UtilPanel: can't find referenced class java.awt.Toolkit\ncom.test.UtilPanel: can't find referenced method 'java.awt.Dimension getPreferredSize()' in program class com.test.UtilPanel\ncom.test.UtilPanel: can't find referenced class java.awt.Dimension\ncom.test.UtilPanel: can't find referenced class java.awt.Dimension\ncom.test.UtilPanel: can't find referenced method 'void setLocation(int,int)' in program class com.test.UtilPanel\ncom.test.UtilPanel: can't find referenced method 'void setVisible(boolean)' in program class com.test.UtilPanel\ncom.test.UtilPanel: can't find referenced class javax.swing.JFrame\ncom.test.UtilPanel: can't find referenced method 'void setDefaultCloseOperation(int)' in program class com.test.UtilPanel\ncom.test.UtilPanel: can't find referenced class javax.swing.JPanel\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagLayout\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagLayout\ncom.test.UtilPanel: can't find referenced class javax.swing.JPanel\ncom.test.UtilPanel: can't find referenced class javax.swing.BorderFactory\ncom.test.UtilPanel: can't find referenced class javax.swing.BorderFactory\ncom.test.UtilPanel: can't find referenced class javax.swing.BorderFactory\ncom.test.UtilPanel: can't find referenced class javax.swing.JPanel\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagConstraints\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagConstraints\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagConstraints\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagConstraints\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagConstraints\ncom.test.UtilPanel: can't find referenced class java.awt.GridBagConstraints\ncom.test.UtilPanel: can't find referenced class javax.swing.JLabel\ncom.test.UtilPanel: can't find referenced class javax.swing.JLabel\ncom.test.UtilPanel: can't find referenced class javax.swing.JLabel\ncom.test.UtilPanel: can't find referenced class javax.swing.JPanel\ncom.test.UtilPanel: can't find referenced class javax.swing.JTextField\ncom.test.Utils: can't find referenced class javax.swing.JTextField\ncom.test.Utils: can't find referenced class javax.swing.JTextField\ncom.test.Utils: can't find referenced class javax.swing.text.Document\ncom.test.Utils: can't find referenced class java.awt.GridBagConstraints\ncom.test.Utils: can't find referenced class javax.swing.JTextArea\ncom.test.Utils: can't find referenced class javax.swing.JTextArea\ncom.test.Utils: can't find referenced class javax.swing.JTextArea\ncom.test.Utils: can't find referenced class javax.swing.JTextArea\ncom.test.Utils: can't find referenced class javax.swing.JTextArea\ncom.test.Utils: can't find referenced class javax.swing.JTextArea\ncom.test.Utils: can't find referenced class javax.swing.JScrollPane\ncom.test.Utils: can't find referenced class javax.swing.JScrollPane\ncom.test.Utils: can't find referenced class javax.swing.JScrollPane\ncom.test.Utils: can't find referenced class java.awt.Dimension\ncom.test.Utils: can't find referenced class java.awt.Dimension\ncom.test.Utils: can't find referenced class javax.swing.JScrollPane\ncom.test.Utils: can't find referenced class java.awt.Container\ncom.test.Utils: can't find referenced class java.awt.Toolkit\ncom.test.Utils: can't find referenced class javax.swing.BorderFactory\ncom.test.Utils: can't find referenced class javax.swing.text.Document\ncom.test.Utils: can't find referenced class javax.swing.JPanel\ncom.test.Utils: can't find referenced class javax.swing.JTextField\ncom.test.Utils: can't find referenced class javax.swing.JTextArea\ncom.test.Utils: can't find referenced class java.awt.Dimension\ncom.test.Utils: can't find referenced class java.awt.Dimension\ncom.test.Utils: can't find referenced class java.awt.GridBagConstraints\ncom.test.Utils: can't find referenced class javax.swing.JLabel\ncom.test.Utils: can't find referenced class javax.swing.JScrollPane\ncom.test.Utils: : can't find referenced class javax.swing.JTextArea\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\ncom.test.Utils: : can't find referenced class javax.swing.text.Document\ncom.test.Utils: : can't find referenced class javax.swing.text.Document\ncom.test.Utils: : can't find referenced class javax.swing.text.BadLocationException\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentListener\ncom.test.Utils: : can't find referenced class javax.swing.JTextArea\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\ncom.test.Utils: : can't find referenced class javax.swing.text.Document\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\ncom.test.Utils: : can't find referenced class javax.swing.event.DocumentEvent\n</code></pre>\n<p>Though i have added all the required JMODS in ant build file as below</p>\n<p>option:1</p>\n<pre><code>&lt;libraryjar file=&quot;/opt/jdk-11/jmods/java.base.jmod&quot; jarfilter=&quot;!**.jar&quot; filter=&quot;!module-info.class&quot; /&gt;\n            &lt;libraryjar file=&quot;/opt/jdk-11/jmods/java.desktop.jmod&quot; jarfilter=&quot;!**.jar&quot; filter=&quot;!module-info.class&quot; /&gt;\n            &lt;libraryjar file=&quot;/opt/jdk-11/jmods/java.management.jmod&quot; jarfilter=&quot;!**.jar&quot; filter=&quot;!module-info.class&quot; /&gt;\n</code></pre>\n<p>Option 2:\nEven tried adding</p>\n<pre><code>&lt;libraryjar file=&quot;${libs.dir}/java-rt-jar-stubs-1.5.0.jar&quot; /&gt;\n</code></pre>\n<p>which has all the required file but still same error</p>\n<p>Can anyone please assist on what can be the issue?</p>\n"},{"comments":[{"comment_id":134569756,"body":"Try to find out how to copy <i>one</i> file. Then expand the solution to handle multiple files."}],"answers":[{"comments":[{"comment_id":134570314,"body":"the compiler swears at (this::getline)"},{"comment_id":134570460,"body":"@RZav Your code is in <code>public static void main(String[] args) {...}</code> ?"},{"comment_id":134571285,"body":"If you don’t care about performance, you can call <code>Files.writeString</code> for every line. But the minimum you have to do to make this useful, is to specify the <code>StandardOpenOption.APPEND</code> option."}],"answer_id":76312041,"body":"<p>You can use something like this:</p>\n<pre><code>    // ....\n\n    Path path = Paths.get(&quot;files_STREAM_Lesson7&quot;);\n    try (Stream&lt;Path&gt; walk = Files.walk(path)) {\n        walk.filter(Files::isRegularFile)\n                .flatMap(this::getLines)\n                .forEach(this::fillOutputFile);\n    }\n\n}\n\nprivate Stream&lt;String&gt; getLines(Path path) {\n    try {\n        return Files.lines(path);\n    } catch (IOException e) {\n        throw new UncheckedIOException(e);\n    }\n}\n\nprivate void fillOutputFile(String line) {\n    Path outputFile = Path.of(&quot;outputFile.txt&quot;);\n\n    try {\n        Files.writeString(\n                outputFile,\n                line + System.lineSeparator(),\n                StandardOpenOption.APPEND\n        );\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>\n"},{"answer_id":76315138,"body":"<p>You could also use a <code>SequenceInputStream</code>. Generally speaking, when you're copying text files (in this case we all find all.txt files in the tree [narrow the pattern as necessary] from the directory given as the argument to the app and write them into one file), you often don't need to invoke ops that will parse them into lines, as that's a needless inefficiency.</p>\n<pre><code>import java.util.List;\nimport java.util.Collections;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.util.stream.Collectors;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport java.io.SequenceInputStream;\n\npublic class Finder {\n    public static void main(String[] args) {\n        try {\n            List&lt;InputStream&gt; allTextStreams = Files.find(Path.of(args[0]), Integer.MAX_VALUE, (p,a) -&gt;p.toString().endsWith(&quot;.txt&quot;)).\n                map(Finder::mapPathToInputStream).\n                collect(Collectors.toList());\n            try (SequenceInputStream seqIn = new SequenceInputStream(Collections.enumeration(allTextStreams));\n                OutputStream out = Files.newOutputStream(Path.of(&quot;all-files.text&quot;))) {\n                seqIn.transferTo(out);\n            }\n        }\n        catch(Throwable t) {\n            t.printStackTrace();\n        }\n    }\n\n    public static InputStream mapPathToInputStream(Path p) {\n        InputStream result = null;\n        try {\n            result = Files.newInputStream(p);\n        }\n        catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n        return result;\n    }\n\n}\n</code></pre>\n"}],"last_activity_date":1684847213,"question_id":76311594,"body":"<p>How do I read all the files and write their contents into one file?\nIs it possible to do this using Files.walk?</p>\n<pre><code>Path pathDir = Path.of(&quot;files_STREAM_Lesson7&quot;);\n    if (!Files.exists(pathDir)) {\n        Files.createDirectory(pathDir);\n    }\n    Path pathDir1 = Path.of(&quot;files_STREAM_Lesson7/newDIR&quot;);\n    if (!Files.exists(pathDir1)) {\n        Files.createDirectory(pathDir1);\n    }\n\n\n    Path pathFile1 = Path.of(&quot;files_STREAM_Lesson7/Lesson7NIO1.txt&quot;);\n    if (!Files.exists(pathFile1)) {\n        Files.createFile(pathFile1);\n    }\n    Path pathFile2 = Path.of(&quot;files_STREAM_Lesson7/newDIR/Lesson7NIO2.txt&quot;);\n    if (!Files.exists(pathFile2)) {\n        Files.createFile(pathFile2);\n    }\n    Path pathFile3 = Path.of(&quot;files_STREAM_Lesson7/newDIR/Lesson7NIO3.txt&quot;);\n    if (!Files.exists(pathFile3)) {\n        Files.createFile(pathFile3);\n    }\n\n    Path path = Paths.get(&quot;files_STREAM_Lesson7&quot;);\n</code></pre>\n<p>//       Stream walk = Files.walk(path).filter(Files::isRegularFile).map(Files::readAllLines);</p>\n"},{"last_activity_date":1684847024,"question_id":76314355,"body":"<p>I am pretty new to authenticating web services using Java.</p>\n<p>I have started working on a task wherein I am supposed to upload a document to a server using POST request. I did that task.</p>\n<p>Another requirement is to use x.509 certificate for authentication as a client <strong>(not server)</strong>. This is where I am getting a bit confused.</p>\n<p>I did some research on google. Here is what I could found</p>\n<ol>\n<li><a href=\"https://www.geeksforgeeks.org/x-509-authentication-service/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/x-509-authentication-service/</a></li>\n<li><a href=\"https://stackoverflow.com/questions/11477011/where-do-i-get-an-x509-certificate-from\">Where do I get an x509 certificate from?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/45713593/what-is-the-right-way-to-send-a-client-certificate-with-every-request-made-by-th\">What is the right way to send a client certificate with every request made by the resttemplate in spring?</a></li>\n</ol>\n<p>I Found multiple things but could <strong>not</strong> link these together. So coming here to link the dots. Here's what I could gather</p>\n<ol>\n<li>x.509 certificates is used to authenticate the client itself</li>\n<li>It contains key value pairs such as public key information, subject name, issuer name</li>\n<li>There is JKS file(.jks) file which also contains some public and private key information</li>\n</ol>\n<p>Here are my questions:</p>\n<ol>\n<li>How x.509 certificate and JKS file are related?</li>\n<li>Is it mandatory to have jks file for x509 authentication?</li>\n<li>How public and private keys are stored as far as x509 authentication is concerned?</li>\n<li>Where do I get x509 certificates? If I can generate, do I need to generate two of them - one having public key and the other having private key</li>\n<li>Once I have the certificates, where should I store the certificates for a real world application?</li>\n<li>Can someone share some code or point me to some code which can be a sample program explaining the concepts?</li>\n</ol>\n<p>Basically the working of x509 authentication</p>\n<ol>\n<li><a href=\"https://www.geeksforgeeks.org/x-509-authentication-service/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/x-509-authentication-service/</a></li>\n<li><a href=\"https://stackoverflow.com/questions/11477011/where-do-i-get-an-x509-certificate-from\">Where do I get an x509 certificate from?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/45713593/what-is-the-right-way-to-send-a-client-certificate-with-every-request-made-by-th\">What is the right way to send a client certificate with every request made by the resttemplate in spring?</a></li>\n</ol>\n"},{"comments":[{"comment_id":45824082,"body":"Where is this happening? Stack traces? Sample code?"}],"last_activity_date":1684846647,"question_id":28772059,"body":"<p>Has anyone encountered this issue?</p>\n\n<p><code>java.io.IOException: null: NIOFSIndexInput</code></p>\n\n<p>It is happening intermittently for me and despite the suggestion that it might be a corrupted index, the index checks out with no problems.</p>\n"},{"comments":[{"comment_id":134561094,"body":"There is no way to &quot;delete&quot; a value. You need to rewrite the entire file. Or, maybe, if all your data is in fixed length rows of data you might be able to use a RandomAccesFile. Try both approaches."},{"comment_id":134561163,"body":"You should include relevant code."}],"answers":[{"answer_id":76307667,"body":"<p>One way of deleting the content of a text file in java could be to have it write nothing instead of what's already written. One could do that with the FileWriter class from java.io:</p>\n<pre><code>import java.io.FileWriter;\nimport java.io.IOException;\n\npublic class MyClass {\n    public static void main(String[] args) throws IOException {\n        String filePath;\n        boolean appendText = false; // will replace what's already here\n        try {\n             FileWriter filewriter = new FileWriter(filePath, appendText);\n             filewriter.close();\n        } \n        catch (IOException e) {\n             System.out.println(e);\n        }\n    }\n}\n</code></pre>\n<p>Hope this helps!</p>\n"},{"answer_id":76308216,"body":"<p>What you can do is store your values within a <code>List</code> or array.<br />\nAdd and remove the values as needed.<br />\nThen, use a write method to write the contents to a file.<br />\nAdditionally, use a read method to retrieve the values.</p>\n<p>Consider the following two methods.</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;String&gt; read(String path) throws IOException {\n    try (BufferedReader reader = new BufferedReader(new FileReader(path))) {\n        List&lt;String&gt; lines = new ArrayList&lt;&gt;();\n        String line;\n        while ((line = reader.readLine()) != null)\n            lines.add(line);\n        return lines;\n    }\n}\n\nvoid write(String path, List&lt;String&gt; list) throws FileNotFoundException {\n    try (PrintWriter writer = new PrintWriter(new File(path))) {\n        for (String string : list)\n            writer.println(string);\n        writer.flush();\n    }\n}\n</code></pre>\n<p>Here is an demonstration of it's functionality.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String path = &quot;values.txt&quot;;\nList&lt;String&gt; values = new ArrayList&lt;&gt;(Arrays.asList(&quot;$100&quot;, &quot;$50&quot;, &quot;$1.25&quot;));\nwrite(path, values);\nSystem.out.println(read(path));\nvalues.remove(1);\nwrite(path, values);\nSystem.out.println(read(path));\n</code></pre>\n<p>Output</p>\n<pre class=\"lang-none prettyprint-override\"><code>[$100, $50, $1.25]\n[$100, $1.25]\n</code></pre>\n"}],"last_activity_date":1684846536,"question_id":76307408,"body":"<p>me and my friends have a project to do as an assessment.\nso we are coding in Java using eclipse , (swing). We are making small  ATM that convert from different currency , now we need to make a file that store each value of the currency from $ .\nThe problem is that we need a way to reed from a file and write to it while if we write we need to delete the old currency value .</p>\n<p>I tried to make a file reed from it and write on it ,but I do not know how to delete the old value in this file</p>\n"},{"answers":[{"answer_id":76314979,"body":"<p>The error message indicates that the interface <a href=\"https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/core/interceptor/ExecutionInterceptor.html\" rel=\"nofollow noreferrer\">ExecutionInterceptor</a> cannot be found, which is part of the <a href=\"https://github.com/aws/aws-sdk-java-v2\" rel=\"nofollow noreferrer\">AWS SDK for Java 2.0</a> library. This library is a dependency of <code>aws-encryption-sdk-java</code>, which you have already included.</p>\n<p>There may be a conflict with another version of the <code>aws-sdk-java</code> library. To resolve this issue, you can try excluding it from the <code>aws-encryption-sdk-java</code> dependency and add it explicitly to your project.</p>\n<p>Here's an example of how to do this in Maven:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\n    &lt;artifactId&gt;aws-encryption-sdk-java&lt;/artifactId&gt;\n    &lt;version&gt;2.4.0&lt;/version&gt;\n    &lt;exclusions&gt;\n        &lt;exclusion&gt;\n            &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n            &lt;artifactId&gt;aws-sdk-java&lt;/artifactId&gt;\n        &lt;/exclusion&gt;\n    &lt;/exclusions&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n    &lt;artifactId&gt;aws-sdk-java&lt;/artifactId&gt;\n    &lt;version&gt;2.20.70&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>You can also try cleaning and rebuilding your project to ensure all the dependencies are resolved correctly.</p>\n"}],"last_activity_date":1684846447,"question_id":76263243,"body":"<p>I am working with this example: <a href=\"https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/java-example-code.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/java-example-code.html</a></p>\n<p>There is some strange error when I call code from the example:</p>\n<blockquote>\n<p>org.springframework.web.util.NestedServletException: Handler dispatch\nfailed; nested exception is java.lang.NoClassDefFoundError:\nsoftware/amazon/awssdk/core/interceptor/ExecutionInterceptor  at\norg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1087)\nat\norg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)\nat\norg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)\nat\norg.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)</p>\n</blockquote>\n<p>...</p>\n<blockquote>\n<p>Caused by: java.lang.NoClassDefFoundError:\nsoftware/amazon/awssdk/core/interceptor/ExecutionInterceptor  at\ncom.amazonaws.encryptionsdk.kmssdkv2.KmsMasterKeyProvider.builder(KmsMasterKeyProvider.java:243)</p>\n</blockquote>\n<p>I have installed this dependency:</p>\n<pre><code>   &lt;dependency&gt;\n        &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;\n        &lt;artifactId&gt;aws-encryption-sdk-java&lt;/artifactId&gt;\n        &lt;version&gt;2.4.0&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>Version <code>2.4.0</code> is current version, I tried <code>2.3.3</code> but the problem is same.</p>\n<p>And when I go into class <code>KmsMasterKeyProvider</code> (that causes the problem) IntelliJ IDEA show this error. I reinstalled all Maven dependencies but with no luck. What is wrong?</p>\n<p><a href=\"https://i.stack.imgur.com/yOX4I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yOX4I.png\" alt=\"enter image description here\" /></a></p>\n"},{"comments":[{"comment_id":134573819,"body":"1. Did you check <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/LinkedList.html#:~:text=The%20iterators%20returned,will%20throw%20a%20ConcurrentModificationException.\" rel=\"nofollow noreferrer\">the documentation</a>? 2. Why do you keep iterating after you removed the one element you were looking for? 3. What do you mean with “by-pass this exception”? According to your own statement at the end, putting the enhanced for loop inside a synchronized block had no effect at all. Which is expected."}],"answers":[{"answer_id":76314737,"body":"<p>According to the docs for ConcurrentModificationException,</p>\n<blockquote>\n<p>[I]f a thread modifies a collection directly while it is iterating\nover the collection with a fail-fast iterator, the iterator will throw\nthis exception.</p>\n</blockquote>\n<p>I'm sure you can answer all 3 of your questions by just reading the docs yourself: <a href=\"https://docs.oracle.com/javase/8/docs/api/?java/util/ConcurrentModificationException.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/8/docs/api/?java/util/ConcurrentModificationException.html</a></p>\n"},{"answer_id":76314935,"body":"<p>even though the exception name is <code>ConcurrentModificationException</code> , it is has nothing to do with concurrent executions in your case.</p>\n<p>the code you posted will never throw this <code>ConcurrentModificationException</code> exception. instead of indexed for loop in the &quot;remove&quot; method, if you use enhanced for loop, it will throw this exception.</p>\n<p>once iterator is created , you can not modify the list , if it happens iterator <code>modcount</code> and list <code>modcount</code> will differ, so in next usage of the iterator will throw this exception.</p>\n<p>Ex:  this kind of code will throw this exception</p>\n<pre><code>for (Object o : list) \n{\n  list.remove(o);\n}\n</code></pre>\n"}],"last_activity_date":1684846107,"question_id":76314439,"body":"<p>Iterating over a list of user defined class using Iterator class of enhanced for loop gives <strong>java.util.ConcurrentModificationException exception</strong> but when using the traditional for loop it runs just fine.</p>\n<p>Actually I am trying to implement my own hashmap using Java.\nCode below:</p>\n<pre><code>class MyHashMap {\n    public final int MAX_VALUE = 1009; // any big prime number\n    LinkedList&lt;Node&gt; buckets[];\n    public MyHashMap() {\n        buckets = new LinkedList[MAX_VALUE];\n        for (int i = 0;i&lt;buckets.length;i++)\n            buckets[i] = new LinkedList&lt;Node&gt;();\n    }\n    \n    public void put(int key, int value) {\n        int index = key % MAX_VALUE;\n        LinkedList&lt;Node&gt; list = buckets[index];\n        if (get(key) != -1) remove(key);   // if the key is available then remove it // same as update\n        Node entry = new Node(key, value); //otherwise\n        list.add(entry);  \n        \n    }\n    \n    public int get(int key) {\n        int index = key % MAX_VALUE;\n        List&lt;Node&gt; list = buckets[index];\n        if(list==null)return -1;\n        for(Node n : list){\n            if(n.key == key)return n.val;\n        }\n        return -1;\n    }\n    \n    public void remove(int key) {\n        int index = key % MAX_VALUE;\n        LinkedList&lt;Node&gt; list = buckets[index];\n        if(list == null)return;\n       ** //synchronized(this){\n        for(int i=0;i&lt;list.size();i++){\n            Node n = list.get(i);\n            if(n.key == key){\n                list.remove(n);\n            }**\n        }\n    //}\n    }\n}\nclass Node{\n    public int key;\n    public int val;\n    public Node(int key, int val){\n        this.key=key;\n        this.val=val;\n    }\n}\n/**\n * Your MyHashMap object will be instantiated and called as such:\n * MyHashMap obj = new MyHashMap();\n * obj.put(key,value);\n * int param_2 = obj.get(key);\n * obj.remove(key);\n */\n</code></pre>\n<p>I also tried using the enhanced loop inside a synchronized block to no avail.</p>\n<p>I have 3 questions for this behaviour:</p>\n<ol>\n<li>Why does the traditional loop works and enhanced loop and iterator does'nt?</li>\n<li>What exactly does the java.util.ConcurrentModificationException exception signify?</li>\n<li>Why did using the enhanced loop within a synchronized by-pass this exception?</li>\n</ol>\n<ul>\n<li>I am trying to implement my own hashmap using Java.</li>\n<li>I tried using iterator in place of enhanced for loop but it does'nt works.</li>\n<li>I also tried putting the enhanced for loop inside a synchronized block as you can see in the code but still no luck.</li>\n</ul>\n"},{"comments":[{"comment_id":134568866,"body":"You need to include the quote in the column name something like <code>name=&quot;&#39;\\&quot;alId\\&quot;&#39;&quot;</code> as you probably need to quote the name as well. Or <code>name=&quot;\\&quot;alId\\&quot;</code> and add <code>spring.jpa.properties.hibernate.globally_quoted_identifiers=&zwnj;&#8203;true</code> to the <code>application.properties</code>."},{"comment_id":134571675,"body":"I have tried to write name=&quot;\\&quot;alId\\&quot;&quot; before but it didn&#39;t work. I also already try to put back  &#39;name&#39; again together with the property you suggest to application.properties but still doesn&#39;t make any difference."},{"comment_id":134573299,"body":"You should use <code>&quot;\\&quot;alId\\&quot;&quot;</code> with the property else include it in backticks (not single quotes) in the name (cannot do that here because that will quote it in the comments."},{"comment_id":134574343,"body":"Ya, i have tried all of these <code>name=&quot;\\&quot;alId\\&quot;&quot;</code> for <code>alID</code>, <code>name=&quot;\\&quot;alName\\&quot;&quot;</code> for <code>alName</code>, and <code>name=&quot;\\&quot;alPoints\\&quot;&quot;</code> for <code>alPoints</code>. I even use your suggestion to use this <code>spring.jpa.properties.hibernate.globally_quoted_identifiers=&zwnj;&#8203;true</code> in <code>application.properties</code> but still does not work.  Is there anything that I miss?"},{"comment_id":134574887,"body":"Try including backticks <code>`</code> in the column names next to the quotes."},{"comment_id":134575318,"body":"Then I&#39;m out of ideas. Adding the quotes and quoting it as an identifier should make it work."},{"comment_id":134575390,"body":"Done that. Get this error instead <code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;entityManagerFactory&#39; defined in class path resource [org&#47;springframework&#47;boot&#47;autoconfigure&#47;orm&#47;jpa&#47;HibernateJpa&zwnj;&#8203;Configuration.class]&zwnj;&#8203;: Identifier text should not contain quote markers (</code> or &quot;)`"},{"comment_id":134575412,"body":"well, thanks anyway"}],"last_activity_date":1684846076,"question_id":76311717,"body":"<p>I was trying to create an API but Java Spring Boot can not read postgresql table column's name with sign double quotes on it. It throws error 'SQLState: 42703' and 'ERROR: Column a1_0.xx does not exist'. In Postman it threw '500 Internal Server Error'</p>\n<p>So, the case is I was trying to create an API with Java Spring Boot.</p>\n<p>I have two tables. Both was created with postgresql. Both also has a structure like this:</p>\n<pre><code>------------+-------------------+----------+\nalId        | alName            | alPoints |\n[PK] bigint | character varying | bigint   |\n------------+-------------------+----------+\n101         | Name 1            | 70       |\n102         | Name 2            | 80       |\n103         | Name 3            | 90       |\n------------+-------------------+----------+\n</code></pre>\n<p>First table's name is 'alien_rest'.  Second table's name is 'alien_rest3'. I created the second one to check what is wrong with first one.</p>\n<p>Because whenever I try to execute 'select * from public.alien_rest' for first table through method '.findAll()', it threw errors like below. What confuse me, somehow everything works fine when I execute 'select * from public.alien_rest3' for second table.</p>\n<p>While in Postman, it threw error message '500 Internal Server Error'</p>\n<pre><code>2023-05-23T12:02:31.301+07:00[0;39m [33m WARN[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.h.engine.jdbc.spi.SqlExceptionHelper  [0;39m [2m:[0;39m SQL Error: 0, SQLState: 42703\n[2m2023-05-23T12:02:31.302+07:00[0;39m [31mERROR[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.h.engine.jdbc.spi.SqlExceptionHelper  [0;39m [2m:[0;39m ERROR: column a1_0.al_id does not exist\n  Hint: Perhaps you meant to reference the column &quot;a1_0.alId&quot;.\n  Position: 8\n[2m2023-05-23T12:02:31.323+07:00[0;39m [31mERROR[0;39m [35m7520[0;39m [2m---[0;39m [2m[nio-8080-exec-2][0;39m [36mo.a.c.c.C.[.[.[/].[dispatcherServlet]   [0;39m [2m:[0;39m Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select a1_0.al_id,a1_0.al_name,a1_0.al_points from alien_rest a1_0] [ERROR: column a1_0.al_id does not exist\n  Hint: Perhaps you meant to reference the column &quot;a1_0.alId&quot;.\n  Position: 8] [n/a]; SQL [n/a]] with root cause\n</code></pre>\n<p>I check through pgAdmin (mine is pgAdmin 4 version 7.1), turn out there is a difference with format of both column's name. 'alien_rest' use sign &quot;&quot; for its columns'name while alien_rest3 does not use sign &quot;&quot; for its columns'name.</p>\n<p>For first table or 'alien_rest', it has format like this:</p>\n<pre><code>CREATE TABLE IF NOT EXISTS public.alien_rest\n(\n    &quot;alId&quot; bigint NOT NULL,\n    &quot;alName&quot; character varying(20) COLLATE pg_catalog.&quot;default&quot;,\n    &quot;alPoints&quot; bigint,\n    CONSTRAINT alien_rest_pkey PRIMARY KEY (&quot;alId&quot;)\n)\n\nTABLESPACE pg_default;\n</code></pre>\n<p>while for the second table or 'alien_rest3', is has format like this:</p>\n<pre><code>CREATE TABLE IF NOT EXISTS public.alien_rest3\n(\n    alid bigint NOT NULL,\n    alname character varying COLLATE pg_catalog.&quot;default&quot;,\n    alpoints bigint,\n    CONSTRAINT alien_rest3_pkey PRIMARY KEY (alid)\n)\n\nTABLESPACE pg_default;\n</code></pre>\n<p>I am not sure what I did that cause table 'alien_rest' use sign double quotes for its column's name.</p>\n<p>It seems like the sign double quotes (or &quot;&quot;) in the column's name is the one who give problem to the Spring Boot to read the first table or 'alien_rest'.</p>\n<p>So, what is going on here? What can I do to fix the problem. Thank you for any help ;)</p>\n<p>To make things clear, here is my codes in my Spring Boot project:</p>\n<p>AlienResource.java</p>\n<pre><code>package com.kastamer;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController //DEFINE that THIS CLASS is TECHNICALLY now A CONTROLLER FOR the APP 'SpringBootRest'\npublic class AlienResource {\n\n    @Autowired\n    AlienRepositoryDAO ard;\n    \n    @GetMapping(&quot;aliens&quot;)\n    public List&lt;Alien&gt; getAliens() {\n        \n        List&lt;Alien&gt; aliens = (List&lt;Alien&gt;) ard.findAll();\n        return aliens;\n    }\n}\n</code></pre>\n<p>Alien.java</p>\n<pre><code>package com.kastamer;\n\nimport jakarta.persistence.Column;\nimport jakarta.persistence.Entity;\nimport jakarta.persistence.EntityResult;\nimport jakarta.persistence.FieldResult;\nimport jakarta.persistence.Id;\nimport jakarta.persistence.SqlResultSetMapping;\nimport jakarta.persistence.Table;\n\n@Entity\n@Table(name = &quot;alien_rest&quot;)//, schema = &quot;public&quot;) //THIS is NOT WORKING with/without 'schema' for TABLE alien_rest\n/* --&gt; THIS is NOT WORKING for TABLE alien_rest\n@SqlResultSetMapping(name = &quot;AlienMapping&quot;, entities = @EntityResult(entityClass = Alien.class, \n        fields = {\n                @FieldResult(name = &quot;alId&quot;, column = &quot;alId&quot;),\n                @FieldResult(name = &quot;alName&quot;, column = &quot;alName&quot;),\n                @FieldResult(name = &quot;alPoints&quot;, column = &quot;alPoints&quot;)\n        })) */\npublic class Alien {\n\n    @Id\n    //Column(name = &quot;\\&quot;alId\\&quot;&quot;) --&gt; PUT SIGN '\\&quot;' to VALUE does NOT HELP ANY\n    @Column(name = &quot;alId&quot;) //THIS is NOT WORKING for TABLE alien_rest\n    private int alId;\n    //Column(name &quot;\\&quot;alName\\&quot;&quot;) --&gt; PUT SIGN '\\&quot;' to VALUE does NOT HELP ANY\n    @Column(name = &quot;alName&quot;) //THIS is NOT WORKING for TABLE alien_rest\n    private String alName;\n    //Column(name &quot;\\&quot;alPoints\\&quot;&quot;) --&gt; PUT SIGN '\\&quot;' to VALUE does NOT HELP ANY\n    @Column(name = &quot;alPoints&quot;) //THIS is NOT WORKING for TABLE alien_rest\n    private int alPoints;\n    \n    public int getAlId() {\n        return alId;\n    }\n    public void setAlId(int alId) {\n        this.alId = alId;\n    }\n    public String getAlName() {\n        return alName;\n    }\n    public void setAlName(String alName) {\n        this.alName = alName;\n    }\n    public int getAlPoints() {\n        return alPoints;\n    }\n    public void setAlPoints(int alPoints) {\n        this.alPoints = alPoints;\n    }\n    \n    @Override\n    public String toString() {\n        return &quot;Alien [alName=&quot; + alName + &quot;, alPoints=&quot; + alPoints + &quot;, alId=&quot; + alId + &quot;]&quot;;\n    }   \n}\n\n</code></pre>\n<p>AlienRepositoryDAO.java</p>\n<pre><code>package com.kastamer;\n\nimport java.util.List;\n\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.data.jpa.repository.Query;\nimport org.springframework.data.repository.CrudRepository;\n\npublic interface AlienRepositoryDAO extends CrudRepository&lt;Alien, Integer&gt;{\n\n}\n</code></pre>\n<p>pom.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.1.0&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.kastamer&lt;/groupId&gt;\n    &lt;artifactId&gt;SpringBootRest&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;SpringBootRest&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        \n        &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-jpa --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n            &lt;version&gt;3.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        &lt;!-- https://mvnrepository.com/artifact/org.postgresql/postgresql --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;version&gt;42.6.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n\n</code></pre>\n"},{"last_activity_date":1684846016,"question_id":76314854,"body":"<p>Let's say a request landed at the backend and we got the traceid. Now for some reasons, we need to push a message to the rabbit and that message will be read after a few minutes. How can I do that processing in that same traceid.</p>\n<p>That message sent has a field in which we preserved the previous trace and span id.</p>\n<p>We are using Spring 3 with micrometer.</p>\n<p>POM:</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n        &lt;artifactId&gt;micrometer-tracing&lt;/artifactId&gt;\n        &lt;version&gt;1.0.3&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n        &lt;artifactId&gt;micrometer-tracing-bridge-brave&lt;/artifactId&gt;\n        &lt;version&gt;1.0.3&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"},{"comments":[{"comment_id":134570602,"body":"I suspect you need to use the <code>LocalTemporaryTableMutationStrategy</code> which implements the correct interface instead of the <code>LocalTemporaryTableStrategy</code> which looks like a helper class for the former mentioned class."},{"comment_id":134573069,"body":"Unfortunately, this is not working :  <code>Cannot instantiate the class [org.hibernate.query.sqm.mutation.internal.temptable.LocalTe&zwnj;&#8203;mporaryTableMutation&zwnj;&#8203;Strategy] because it does not have a constructor that accepts a dialect or an empty constructor</code>.  App starts if I use <code>org.hibernate.query.sqm.mutation.internal.inline.InlineMutat&zwnj;&#8203;ionStrategy</code>  but global temporary table are still created..."},{"comment_id":134573203,"body":"Try <code>local_temporary</code> as the full name (that seems to be the shortcut for it). If it doesn&#39;t implement the interface/appropriate strategy it will do the default (which is global tables, judging from the source code)."},{"comment_id":134573467,"body":"Next to <code>mutation_strategy</code> you probably also want to set the <code>insert_strategy</code> to the same. <code>spring.jpa.properties.hibernate.query.mutation_strategy= local_temporary</code> and <code>spring.jpa.properties.hibernate.query.insert_strategy= local_temporary</code>"},{"comment_id":134573571,"body":"With the <code>mutation_strategy</code> and <code>insert_strategy</code>set, I still have the <code>Cannot instantiate the class [org.hibernate.query.sqm.mutation.internal.temptable.LocalTe&zwnj;&#8203;mporaryTableMutation&zwnj;&#8203;Strategy] because it does not have a constructor that accepts a dialect or an empty constructor</code> exception."},{"comment_id":134573678,"body":"You are setting it with <code>local_temporary</code>? Or still the full classname?"},{"comment_id":134573736,"body":"I tried both, but the last try was with the short name <code>local_temporary</code> as in your comment."},{"comment_id":134573859,"body":"Feels like this is broken by design or something. Only the <code>InlineMutationStrategy</code> has a constructor that satisfies the constructor with a <code>Dialect</code>. All others have other constructors, not satisfying the constraint. I would register a ticket with Hibernate for t his."},{"comment_id":134573978,"body":"You&#39;re right, and I can&#39;t use this strategy for the <code>insert_strategy</code> because it does not exist (strategies implementing <code>SqmMultiTableInsertStrategy</code> are only cte/global/local/persistent-table` strategies `. Thanks for your time and help, I will keep digging..."},{"comment_id":134574049,"body":"And yes you can use the <code>local_temporary</code> strategy as that maps to the local one. Check the code. Your initial class <code>LocalTemporaryTableStrategy</code> serves as a base class to both of those and the static name is used for the different strategies. (I did check on 6.2.2 I just noticed, not 6.1)"},{"comment_id":134575249,"body":"I tried to ignore the fact that I can&#39;t create global temporary tables and I ran my app without any properties configuring this aspect. The app starts and I can do everything, even if the <code>HTE_</code> tables are not present... I&#39;m really confused."}],"last_activity_date":1684845650,"question_id":76312361,"body":"<p>Hibernate creates temporary tables for bulk operations.</p>\n<p>We're using Oracle (<em>v19.0.0.0.0</em>) and our user won't have the privilege to create temporary table.</p>\n<p>I've tried a lot of different configurations, but <code>HTE_</code> tables are still created on startup :</p>\n<pre><code>09:07:43.658 INFO  [com.zaxxer.hikari.HikariDataSource      ] HikariPool-1 - Starting...\n09:07:44.285 INFO  [com.zaxxer.hikari.pool.HikariPool       ] HikariPool-1 - Added connection oracle.jdbc.driver.T4CConnection@6dc5e857\n09:07:44.286 INFO  [com.zaxxer.hikari.HikariDataSource      ] HikariPool-1 - Start completed.\n09:07:44.596 INFO  [SQL dialect                             ] HHH000400: Using dialect: org.hibernate.dialect.Oracle12cDialect\nHibernate: create global temporary table HTE_xxxxx(...) on commit delete rows\nHibernate: create global temporary table HTE_yyyyy(...) on commit delete rows\n09:07:45.551 INFO  [j.LocalContainerEntityManagerFactoryBean] Initialized JPA EntityManagerFactory for persistence unit 'default'\n</code></pre>\n<p>These configurations don't work :</p>\n<pre><code>spring.jpa.properties.hibernate.query.mutation_strategy=org.hibernate.query.sqm.mutation.internal.temptable.LocalTemporaryTableMutationStrategy\n\nOR \n\nspring.jpa.properties.hibernate.query.mutation_strategy=org.hibernate.query.sqm.mutation.internal.inline.InlineMutationStrategy\nspring.jpa.properties.hibernate.query.insert_strategy=org.hibernate.query.sqm.mutation.internal.temptable.LocalTemporaryTableInsertStrategy\n</code></pre>\n<p>I'm using <strong>Hibernate 6.1.7.Final</strong> and <strong>Spring Boot 3.0.6</strong>.</p>\n<p>I did not find other ways in the documentation : <a href=\"https://docs.jboss.org/hibernate/stable/orm/userguide/html_single/Hibernate_User_Guide.html\" rel=\"nofollow noreferrer\">https://docs.jboss.org/hibernate/stable/orm/userguide/html_single/Hibernate_User_Guide.html</a></p>\n"},{"last_activity_date":1684845453,"question_id":76314835,"body":"<p>With Processing 4, I can save my data in PDF format. But it doesn't happen when I try to add an image behind the PDF output. I have to use beginRecord() function because I need to record data continuously.</p>\n<pre><code>public void setup() \n{  \n  GPointsArray pointsECG = new GPointsArray(nPoints1);\n \n  size(1024, 600, JAVA2D);\n  backgroundImage = loadImage(ecgeniyi.png);\n  heightHeader=100;\n  println(&quot;Height:&quot;+height);\n\n  totalPlotsHeight=height-heightHeader;\n  \n  makeGUI();\n  surface.setTitle(&quot;Healthy Race&quot;);\n  PImage icon = loadImage(&quot;hr.png&quot;);\n  surface.setIcon(icon);\n  \n  plot1 = new GPlot(this);\n  plot1.setPos(20,200);\n  plot1.setDim(width-40, (totalPlotsHeight/3)-10);\n  plot1.setBgColor(0);\n  plot1.setBoxBgColor(0);\n  plot1.setLineColor(color(255, 255, 255));\n  plot1.setLineWidth(1);\n  plot1.setMar(0,0,0,0);\n\n  for (int i = 0; i &lt; nPoints1; i++) \n  {\n \n    pointsECG.add(i,0);\n\n  }\n  \n  plot1.setPoints(pointsECG);\n\n  for (int i=0; i&lt;windowSize; i++) \n  {\n\n    ch1Data[i] = 0;\n    ch2Data[i] = 0;\n    \n  }\n\n}\n\n\npublic void draw() \n{\n  background(255);\n // background(19,75,102);\n\n  GPointsArray pointsPlot1 = new GPointsArray(nPoints1);\n\n\n  if (startPlot)                             // If the condition is true, then the plotting is done\n  {\n    for(int i=0; i&lt;nPoints1;i++)\n    {    \n      pointsPlot1.add(i,ch1Data[i]);\n    }\n  } \n  else                                     // Default value is set\n  {\n  }\n\n  plot1.setPoints(pointsPlot1);\n\n  \n  plot1.beginDraw();\n  plot1.drawBackground();\n  plot1.drawLines();\n  plot1.endDraw();\n\nif(c == true){\nif(f == true){\n  pdf.nextPage();\n  f = false;\n}}\n\n  \n}\n\npublic void RecordData()\n{\n      c = true;\n\n  pdf = (PGraphicsPDF)beginRecord(PDF, &quot;Lines.pdf&quot;);\n  pdf.beginDraw();\n  pdf.background(255);\n  pdf.image(backgroundImage, 0, 0, pdf.width, pdf.height); \n  pdf.endDraw();\n\n  pdf.dispose();\n}\n\n\npublic void EndRecord()\n{\n    c = false;\n\n  endRecord();\n}\n</code></pre>\n<p>Here RecordData(); I want to see an image in the background while drawing PDF lines in the function.</p>\n"},{"last_activity_date":1684845438,"question_id":76314833,"body":"<p>I have a method in Java which gets the contents of a build.gradle file in String format as an argument. The method should be able to parse the content and read plugins and dependencies from it. The end-goal is to check whether a particular plugin/dependency is added in build.gradle file. Can someone suggest an efficient way of doing this in Java?</p>\n<p>Here is a snippet of build.gradle file content (Actual content will be given as String):</p>\n<pre><code>plugins {\n    id &quot;org.jetbrains.kotlin.jvm&quot; apply false\n    id &quot;org.sonarqube&quot;\n    id &quot;org.jlleitschuh.gradle.ktlint&quot;\n}\ndependencies {\n    implementation &quot;joda-time:joda-time:2.2&quot;\n    testImplementation &quot;junit:junit:4.12&quot;\n}\napply plugin: 'java'\napply plugin: 'eclipse'\napply plugin: 'application'\n\nmainClassName = 'hello.HelloWorld'\n\n// tag::repositories[]\nrepositories { \n    mavenCentral() \n}\n// end::repositories[]\n\n// tag::jar[]\njar {\n    archiveBaseName = 'gs-gradle'\n    archiveVersion =  '0.1.0'\n}\n\n</code></pre>\n"},{"last_activity_date":1684845343,"question_id":76314794,"body":"<p><a href=\"https://i.stack.imgur.com/bGNys.png\" rel=\"nofollow noreferrer\">my module project</a></p>\n<p>As I understand non modular jar is a file without module-info declaration in its directory<br> My problem is I don't know how put module-info.class in junit-3.8.1.jar to make its packages accessible <a href=\"https://i.stack.imgur.com/x02cM.png\" rel=\"nofollow noreferrer\">my module project module-info</a><br>\nHow can I do it ?</p>\n"},{"comments":[{"comment_id":134519274,"body":"Please share an example signed PDF to reproduce the issue, and indicate the Adobe Reader version you use.  That being asked for, please have a look at <a href=\"https://stackoverflow.com/a/16711745/1729265\">this stack overflow answer</a> about the original allowed and disallowed changes to signed documents. You will in particular see the difference that in certified documents, <i>adding form fields</i> always is disallowed, so to sign you needed an empty signature field. IIRC that concept was changed slightly over time to allow adding signature fields for P=1 and P=2 but maybe in your case that is suppressed."}],"last_activity_date":1684845218,"question_id":76274739,"body":"<p>We are trying to add certification signature to avoid further modifications on the document after the first signature. But whenever we set DocMDP tranform with the value 2 (that should allow new signatures) Adobe reader disables the option to digitally sign the document although on the secutity properties it shows that signatures are allowed. Is that a bug in Adobe Reader or are we doing something wrong on our code?</p>\n<p>PDFBox version:</p>\n<pre><code>       try (PDDocument document = PDDocument.load(conteudoStream, MemoryUsageSetting.setupTempFileOnly())) {\n                PDSignature signature = new PDSignature();\n\n                signature.setFilter(PDSignature.FILTER_ADOBE_PPKLITE); \n                signature.setSubFilter(PDSignature.SUBFILTER_ADBE_PKCS7_DETACHED);\n                signature.setName(&quot;My System&quot;);\n                signature.setLocation(SOURCE_LOCATION);\n                signature.setReason(&quot;Assinatura Digital de documento.&quot;);\n\n\n                boolean isFirst = document.getSignatureDictionaries().isEmpty();\n                document.addSignature(signature);\n\n                if (isFirst) {\n                    SigUtils.setMDPPermission(document, signature, 3);\n                }\n\n\n                ExternalSigningSupport externalSign = PdfBoxHelper.saveIncrementalForExternalSigning(document, output);              \n                    externalSign.setSignature(signature);\n               \n             \n            }\n\n        }\n</code></pre>\n<p>Itext version:</p>\n<pre><code>    Rectangle rect = new Rectangle(36, 748, 144, 780);\n        PdfSigner signer = new PdfSigner(new PdfReader(inputPath), new FileOutputStream(outputPath), false);\n        signer.setFieldName(&quot;signature&quot;);\n        signer.setCertificationLevel(PdfSigner.CERTIFIED_FORM_FILLING);\n        System.out.println(&quot;provider: &quot;+Util.getProvedor().getName());\n        signer.signDetached(new BouncyCastleDigest(), new PrivateKeySignature(key), DigestAlgorithms.SHA512, &quot;SunMSCAPI&quot;), chain, null, null, null, 0, PdfSigner.CryptoStandard.CMS);\n</code></pre>\n<p>Security properties:</p>\n<p><a href=\"https://i.stack.imgur.com/HC1NF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HC1NF.png\" alt=\"security properties\" /></a></p>\n<p>Signature disabled:</p>\n<p><a href=\"https://i.stack.imgur.com/QYn7O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QYn7O.png\" alt=\"Signature disabled\" /></a></p>\n<p>We expected that modifications on the document would be forbidden but new signatures would be allowed as the description for DocMDP should allow &quot;Form fill-in and digital signatures&quot; and Adobe Reader list signatures as allowed although it greys out the option to sign.</p>\n<p>Edit: As requested I've included a sample certified PDF. We are using Adobe Reader version 2023.001.20143. It's certifies with DocMPD transform P=2. Adobe Reader show signatures as allowed but Digitally Sign button is disabled.\n<a href=\"https://drive.google.com/file/d/1gW-odTFjEcc0DcKQe71Nh5dlNA5GG945/view?usp=sharing\" rel=\"nofollow noreferrer\">Sample certified PDF</a></p>\n"},{"comments":[{"comment_id":119749124,"body":"Not solving your problem, but you can&#39;t use batik-script on the module path because the JAR declares a service that it doesn&#39;t contain itself and the module system fobids that - see <a href=\"https://issues.apache.org/jira/browse/BATIK-1260\" rel=\"nofollow noreferrer\">this issue</a>."},{"comment_id":119749176,"body":"Probably the quickest fix is not to use the module system for your application, you should be able to launch it from the class path with <code>-cp target&#47;rutil-0.0.1-SNAPSHOT.jar;&quot;target&#47;lib&#47;*&quot;</code> instead of <code>-p ...</code>."},{"comment_id":119751767,"body":"@NicolaiParlog moving everything to the classpath would mean getting rid of the <code>module-info</code>(not modularising one&#39;s app), right? In the hope of moving forward, I had <a href=\"https://stackoverflow.com/a/67743247/1746118\">tried executing</a> the linked project in the question with absolutely minimal dependencies required on the modulepath and still being able to execute with the rest of those in the classpath. I was able to see a successful execution for the shared sample.  Any caveats you might find in the suggested approach?"}],"answers":[{"comments":[{"comment_id":119754547,"body":"Works for me, adding the star /* at the end of the --class-path."}],"answer_id":67743247,"body":"<p>You can put all your non modularised artifacts on the classpath and not support deriving their module information. These would be primarily treated as an <a href=\"http://openjdk.java.net/projects/jigsaw/spec/sotms/#unnamed-modules\" rel=\"nofollow noreferrer\">unnamed module</a>.</p>\n<pre><code>java --module-path target/rutil-0.0.1-SNAPSHOT.jar;target/lib/fop-2.6.jar \\\n     --class-path target/lib \\\n     --module eu.ngong.rutil/eu.ngong.rutil.App\n</code></pre>\n<p>I have provided an explanation in <a href=\"https://stackoverflow.com/a/54682966/1746118\">this answer</a> to the error that you are facing. The immediate way to solve it while using all other artifacts on modulepath as well could be hacking the jar to remove the entry from the <code>MANIFEST.MF</code>.</p>\n"},{"answer_id":76314789,"body":"<p>In Naman's solution FOP is placed on the class-path, instead on on the module path. This has some disadvantages.</p>\n<p>You can also get FOP to work on the module-path of your application.</p>\n<ul>\n<li><p>Use FOP 2.8, which doesn't have the error in the question.</p>\n</li>\n<li><p>Use the separate FOP artifacts, instead of the one that includes everything: <code>fop-core</code>, <code>fop-events</code> and <code>fop-util</code>. (This is the <a href=\"https://issues.apache.org/jira/browse/FOP-3088\" rel=\"nofollow noreferrer\">recommenced</a> way anyway.)</p>\n</li>\n<li><p>In your module, declare <code>requires fop-core</code>.</p>\n</li>\n<li><p>Patch <code>fop-core</code> with the other modules: <code>--patch-module fop.core=fop-events-2.8.jar;fop-util-2.8.jar</code>.</p>\n<ul>\n<li>Patching must be done both for compiling and running the application.</li>\n</ul>\n</li>\n<li><p>Start your application with <code>--module</code> and <code>--module-path</code>.</p>\n</li>\n</ul>\n<p>Done. :)</p>\n"}],"last_activity_date":1684845087,"question_id":67742834,"body":"<p>Using fop and Java11 with Maven and Eclipse I can create PDF documents from an xsl-fo input.</p>\n<p>But only if I start the program from within Eclipse.</p>\n<p>My pom.xml advises Maven to copy all jar files used for dependencies, to a lib folder. Preparing to run from command line.</p>\n<p>When I try to start the program from command line like</p>\n<pre><code>java -p target/rutil-0.0.1-SNAPSHOT.jar;target/lib -m eu.ngong.rutil/eu.ngong.rutil.App\n</code></pre>\n<p>I get this error:</p>\n<blockquote>\n<p>Error occurred during initialization of boot layer\njava.lang.module.FindException: Unable to derive module descriptor for target\\lib\\batik-script-1.14.jar.</p>\n</blockquote>\n<p>I can add exclusions to the fop dependency entry in pom.xml, but only to see the next failure message (same package in two modules) and so on.</p>\n<p>How can I start my program from command line like Eclipse is doing?</p>\n<p>My goal is to use fop in a nightly build batch run.</p>\n<p>You may find an absolute minimal version of my program <a href=\"https://owncloud.august.de/index.php/s/5AEDpZBgRuD8PRb/download\" rel=\"nofollow noreferrer\">here</a>.</p>\n"},{"comments":[{"comment_id":134573999,"body":"<i>Help gives incorrect results on the ECDSA algorithm. How to fix and where is the error?</i> - not sure what that means, please clarify"}],"last_activity_date":1684844956,"question_id":76311720,"body":"<p>Help gives incorrect results on the ECDSA algorithm.\nHow to fix and where is the error? I need the results to match (r and r_).\nI need exactly the algorithm with calculations.</p>\n<pre><code>public class SecrActivity extends AppCompatActivity {\n\n    public SharedPreferences cookies;\n    public Button but_tnew0;\n    public TextView tnew0;\n    \n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        requestWindowFeature(Window.FEATURE_NO_TITLE);\n        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,      WindowManager.LayoutParams.FLAG_FULLSCREEN);\n\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_sec);\n\n        getSupportActionBar().setTitle(&quot;ghgh&quot;);\n        getSupportActionBar().setDisplayHomeAsUpEnabled(true);\n        getSupportActionBar().setBackgroundDrawable(new ColorDrawable(Color.parseColor(&quot;#522874&quot;)));\n\n        cookies = getSharedPreferences(&quot;cookies&quot;, MODE_PRIVATE);\n\n        tnew0 = findViewById(R.id.tnew0);\n        but_tnew0 = findViewById(R.id.but_tnew0);\n        \n        but_tnew0.setOnClickListener(new View.OnClickListener() {\n\n            @Override\n            public void onClick(View view) {\n\n                new Thread(new Runnable() {\n\n                    String tt = &quot;&quot;;\n                  \n                    @Override\n                    public void run() {\n\n                        String m = &quot;Hello world!&quot;;\n                        BigInteger e = new BigInteger(&quot;1789679805&quot;);\n\n                        tt += &quot;e = &quot;+e+&quot;\\n\\n&quot;;\n\n                        BigInteger p = new BigInteger(&quot;114973&quot;);\n\n                        Random t = new Random();\n                        Random t0 = new Random();\n\n                        BigInteger d = new BigInteger(&quot;86109&quot;);\n\n                        BigInteger xs0 = new BigInteger(&quot;11570&quot;);\n                        BigInteger ys0 = new BigInteger(&quot;42257&quot;);\n                        ECPoint G = new ECPoint(xs0, ys0);\n                        ScalarMultiply.p = p;\n                        ScalarMultiply.a = new BigInteger(&quot;-3&quot;);\n\n                        ECPoint G0 = ScalarMultiply.scalmult(G, d);\n\n                        tt += &quot;Q = dG = (&quot; + G0.getAffineX()+&quot;, &quot; + G0.getAffineY()+&quot;)\\n\\n&quot;;\n\n                        //-----------------------------------\n\n                        BigInteger k = new BigInteger(&quot;84430&quot;);\n\n                        BigInteger xs = new BigInteger(&quot;11570&quot;);\n                        BigInteger ys = new BigInteger(&quot;42257&quot;);\n                        ECPoint G00 = new ECPoint(xs, ys);\n                        ScalarMultiply.p = p;\n                        ScalarMultiply.a = new BigInteger(&quot;-3&quot;);\n\n                        ECPoint G000 = ScalarMultiply.scalmult(G00, k);\n\n                        tt += &quot;R = kG = (&quot; + G000.getAffineX()+&quot;, &quot; + G000.getAffineY()+&quot;)\\n\\n&quot;;\n\n                        //-------------------------\n\n                        BigInteger l0 = new BigInteger(&quot;&quot;+G000.getAffineX()+&quot;&quot;);\n                        BigInteger r = l0;\n\n                        tt += &quot;r = &quot; +r+&quot;\\n\\n&quot;;\n\n                        BigInteger k_1 = k.modInverse(p);\n                       // BigInteger k_2 = inv(k, p);\n\n                        tt += &quot;k_1 = &quot; +k_1+&quot;\\n\\n&quot;;\n                      //  tt += &quot;k_2 = &quot; +k_2+&quot;\\n\\n&quot;;\n\n                        BigInteger s = k_1.multiply(e.add(r.multiply(d))).mod(p);\n\n                        tt += &quot;s = &quot; +s+&quot;\\n\\n&quot;;\n\n                        //------------------------------------------------\n                        BigInteger c = s.modInverse(p);\n                        tt += &quot;c = &quot; +c+&quot;\\n\\n&quot;;\n\n                        BigInteger u1 = e.multiply(c).mod(p);\n                        BigInteger u2 = r.multiply(c).mod(p);\n\n                        tt += &quot;u1 = &quot; +u1+&quot;\\n\\n&quot;;\n                        tt += &quot;u2 = &quot; +u2+&quot;\\n\\n&quot;;\n\n                        //-----------------------------------\n                        ECPoint v1 = new ECPoint(xs, ys);\n                        ScalarMultiply.p = p;\n                        ScalarMultiply.a = new BigInteger(&quot;-3&quot;);\n                        ECPoint W1 = ScalarMultiply.scalmult(v1, u1);\n\n                        ECPoint v2 = new ECPoint(G0.getAffineX(), G0.getAffineY());\n                        ScalarMultiply.p = p;\n                        ScalarMultiply.a = new BigInteger(&quot;-3&quot;);\n                        ECPoint W2 = ScalarMultiply.scalmult(v2, u2);\n\n                        tt += &quot;W1 = (&quot;+W1.getAffineX()+&quot;, &quot;+W1.getAffineY()+&quot;)\\n\\n&quot;;\n                        tt += &quot;W2 = (&quot;+W2.getAffineX()+&quot;, &quot;+W2.getAffineY()+&quot;)\\n\\n&quot;;\n\n                        ECPoint W3 = ScalarMultiply.addPoint(W1, W2);\n\n                        tt += &quot;W3 = (&quot;+W3.getAffineX()+&quot;, &quot;+W3.getAffineY()+&quot;)\\n\\n&quot;;\n\n                        BigInteger l1 = new BigInteger(&quot;&quot;+W3.getAffineX()+&quot;&quot;);\n                        BigInteger r0_ = l1;\n\n                        tt += &quot;r_ = &quot;+r0_+&quot;\\n\\n&quot;;\n\n                       \n                        tnew0.post(new Runnable() {\n                            \n                            @Override\n                            public void run() {\n                                tnew0.setText(tt);\n                            }\n                        });\n                    }\n                }).start();\n            }\n        });\n    }\n}\n</code></pre>\n"},{"comments":[{"comment_id":134538859,"body":"The log is just by running the application or after hitting the controller?"},{"comment_id":134546868,"body":"It&#39;s after hitting the controller."},{"comment_id":134546917,"body":"ok. can you add to the question the annotations you have on top of the class."},{"comment_id":134557773,"body":"Have you added something like <code>@RequestMapping(&quot;api&quot;)</code> to the top of the class?"}],"answers":[{"answer_id":76314761,"body":"<p>You have multiple calls to <code>authorizeHttpRequests()</code> thus causing the security rules to be applied separately for each call and resulting in the filter chain being processed twice. You can combine the rules into a single request within the config as seen below;</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\nSecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    return http.csrf().disable()\n            .authorizeHttpRequests()\n                .requestMatchers(HttpMethod.PUT, &quot;/api/login&quot;).permitAll()\n                .requestMatchers(&quot;/api/prometheus/**&quot;).hasRole(&quot;MONITORING&quot;)\n                .anyRequest().authenticated()\n            .and()\n            .httpBasic()\n            .and()\n            .oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt)\n            .sessionManagement()\n                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n            .and()\n            .exceptionHandling((exceptions) -&gt; exceptions\n                .authenticationEntryPoint(new BearerTokenAuthenticationEntryPoint())\n                .accessDeniedHandler(new BearerTokenAccessDeniedHandler()))\n            .build();\n}\n</code></pre>\n"}],"last_activity_date":1684844882,"question_id":76203747,"body":"<p>I'm following this <a href=\"https://github.com/spring-projects/spring-security-samples/blob/main/servlet/spring-boot/java/jwt/login/src/main/java/example/RestConfig.java\" rel=\"nofollow noreferrer\">code sample</a> and this <a href=\"https://www.toptal.com/spring/spring-security-tutorial\" rel=\"nofollow noreferrer\">guide</a> to implement a simple, stateless authentication for a REST API via Spring Boot + Security.</p>\n<p>When firing a request to <code>/api/login</code>, I can see and trace that my controller method is properly invoked, the authentication is successful, and a token gets generated. However, the filter is then invoked a second time for <code>/api/api/login</code> which obviously fails and then fails the whole chain.</p>\n<p>The controller method:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@PutMapping(&quot;/api/login&quot;)\npublic LoginUserOutput loginUser(@Valid @RequestBody LoginUserInput loginUserInput) {\n    final var authentication = authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(loginUserInput.username(), loginUserInput.password()));\n    final var user = (User) authentication.getPrincipal();\n\n    final var claims = JwtClaimsSet.builder().subject(user.getUsername()).build();\n    final var header = JwsHeader.with(MacAlgorithm.HS256).build();\n    final var token = jwtEncoder.encode(JwtEncoderParameters.from(header, claims));\n\n    return new LoginUserOutput(token.getTokenValue());\n}\n</code></pre>\n<p>And my security filter chain:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\nSecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    return http.csrf().disable()\n            .authorizeHttpRequests().requestMatchers(&quot;/api/prometheus/**&quot;).hasRole(&quot;MONITORING&quot;).and().httpBasic()\n            .and()\n            .authorizeHttpRequests().requestMatchers(HttpMethod.PUT, &quot;/api/login&quot;).permitAll()\n            .and()\n            .authorizeHttpRequests().anyRequest().authenticated()\n            .and()\n            .oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt)\n            .sessionManagement()\n            .sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()\n            .exceptionHandling((exceptions) -&gt; exceptions.authenticationEntryPoint(new BearerTokenAuthenticationEntryPoint())\n                    .accessDeniedHandler(new BearerTokenAccessDeniedHandler()))\n            .build();\n}\n</code></pre>\n<p>I've tried the endpoint both with Postman and the IntelliJ HTTP client.</p>\n<p>This is the log output when running with Spring Security on DEBUG:</p>\n<pre><code>2023-05-08T21:18:42.121+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Securing PUT /api/login\n2023-05-08T21:18:42.122+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext\n2023-05-08T21:18:42.123+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Secured PUT /api/login\nHibernate: select u1_0.id,u1_0.hashed_password,u1_0.roles,u1_0.username from users u1_0 where u1_0.username=?\n2023-05-08T21:18:42.234+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.s.a.dao.DaoAuthenticationProvider    : Authenticated user\n2023-05-08T21:18:42.235+02:00 DEBUG 32155 --- [io-28080-exec-3] o.s.security.web.FilterChainProxy        : Securing PUT /api/api/login\n</code></pre>\n"},{"last_activity_date":1684844802,"question_id":76314651,"body":"<p>I have a regex in Java that matches zero or more whitespace characters, followed by a comma, followed by zero or more whitespace characters. To clean up the <code>String</code>s I use the following:</p>\n<pre><code>String new1 = test1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;);\n</code></pre>\n<p>If I understand correctly, this regex will backtrack if there is no comma in a given string. Say we have <code>String s = &quot;Hello    World&quot;;</code> (4 spaces between words, no comma), then:</p>\n<ol>\n<li>The regex will start by trying to match the first <code>\\\\s*</code>, which succeeds by matching the four spaces after <code>&quot;Hello&quot;</code>.</li>\n<li>Then it tries to match the comma, which fails because there is no comma.</li>\n<li>The regex backtracks to the first <code>\\\\s*</code> and decides to match three spaces, leaving one space for the comma. It tries to match the comma again, which fails because there is still no comma.</li>\n<li>It continues the process of and tries again until it has exhausted all possibilities. In the end, the match fails as there is no comma in the string.</li>\n</ol>\n<p>I'm looking for a version of this pattern that will prevent the backtracking. My idea was to use atomic groups, i.e.:</p>\n<pre><code>String new1 = test1.replaceAll(&quot;(?&gt;\\\\s*),(?&gt;\\\\s*)&quot;, &quot;,&quot;);\n</code></pre>\n<p>To test the approach, I wrote a simple JMH benchmark using a <code>String</code> that has 50000 spaces between <code>Hello</code> and <code>World</code>, and no comma. On average, the approach with the atomic groups is 2x faster. This is of course better, but still unsatisfactory.</p>\n<p>Bench result (see below for setup):</p>\n<pre><code>Benchmark                    Mode  Cnt  Score   Error  Units\nRegexBench.atomicGroup      thrpt       0,387          ops/s\nRegexBench.replaceAll       thrpt       0,162          ops/s\nRegexBench.replaceExtended  thrpt       0,248          ops/s\n</code></pre>\n<p>EDIT: Oddly enough, according to the <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">https://regex101.com/</a> debugger, the pattern <code>\\s*,\\s*</code> needs 86 steps to decide that there is no match, whereas the one that uses atomic groups 172. Consequently, the former shall be faster, so I'm perplexed why the latter is quicker in Java.</p>\n<hr />\n<p>Here's the bench setup:</p>\n<pre><code>@State(Scope.Thread)\n@BenchmarkMode(Mode.Throughput)\n@OutputTimeUnit(TimeUnit.SECONDS)\n@Warmup(iterations = 1)\n@Measurement(iterations = 1)\n@Fork(1)\npublic class RegexBench {\n\n    final static String s1 = divideTwoWordsByNumberOfSpaces(&quot;hello&quot;, &quot;world&quot;, 50000);\n\n    public static void main(final String[] args) throws IOException {\n        org.openjdk.jmh.Main.main(args);\n    }\n\n    static String divideTwoWordsByNumberOfSpaces(final String word1, final String word2, final int numberOfSpaces) {\n        final StringBuilder sb = new StringBuilder();\n        sb.append(word1);\n        for (int i = 0; i &lt; numberOfSpaces; i++) {\n            sb.append(&quot; &quot;);\n        }\n        sb.append(word2);\n        return sb.toString();\n    }\n\n    @Benchmark\n    public void replaceAll(final Blackhole blackhole) {\n        String new1 = s1.replaceAll(&quot;\\\\s*,\\\\s*&quot;, &quot;,&quot;);\n    }\n\n    @Benchmark\n    public void replaceExtended(final Blackhole blackhole) {\n        String new1 = s1.replaceAll(&quot;\\\\s*+,\\\\s*+&quot;, &quot;,&quot;);\n    }\n\n    @Benchmark\n    public void atomicGroup(final Blackhole blackhole){\n        String new1 = s1.replaceAll(&quot;(?&gt;\\\\s*),(?&gt;\\\\s*)&quot;, &quot;,&quot;);\n    }\n}\n</code></pre>\n<p>And these dependencies to pom.xml:</p>\n<pre><code> &lt;!-- https://mvnrepository.com/artifact/org.openjdk.jmh/jmh-core --&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.openjdk.jmh&lt;/groupId&gt;\n      &lt;artifactId&gt;jmh-core&lt;/artifactId&gt;\n      &lt;version&gt;1.36&lt;/version&gt;\n\n    &lt;/dependency&gt;\n\n    &lt;!-- https://mvnrepository.com/artifact/org.openjdk.jmh/jmh-generator-annprocess --&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.openjdk.jmh&lt;/groupId&gt;\n      &lt;artifactId&gt;jmh-generator-annprocess&lt;/artifactId&gt;\n      &lt;version&gt;1.36&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"},{"comments":[{"comment_id":134570872,"body":"What exactly do you mean by &quot;doesn&#39;t get executed&quot;? Are you getting an error? Something else?"},{"comment_id":134570898,"body":"Yes, i am getting exit code as -1,  exitCode = p.waitFor();"},{"comment_id":134571009,"body":"one possible problem: <code>Runtime</code> is known for <i>messing up</i>  the arguments of the command line if these are given as a single <code>String</code> - specially since the argument contains spaces (also used to split the arguments) and quotes - at very least use the call that takes <code>String[]</code>, even better (IMHO), use <code>ProcessBuilder</code> (with a <code>String[]</code> or <code>List&lt;String&gt;</code>) -- BTW <code>Runtime.exec(String)</code> is deprecated!"},{"comment_id":134571100,"body":"<a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Runtime.html#exec(java.lang.String)\" rel=\"nofollow noreferrer\">documentation</a>: &quot;<b>Deprecated.</b>  <i>This method is error-prone and should not be used, the corresponding method <code>exec(String[], String[])</code> or <code>ProcessBuilder</code> should be used instead. The command string is broken into tokens using only whitespace characters. For an argument with an embedded space, such as a filename, this can cause problems as the token does not include the full filename.</i>&quot;"},{"comment_id":134571385,"body":"<code>...&quot;isValidUser:&quot;true&quot;...</code>  is missing a double quote (probably an {additional?main?} cause for nothing being called at all)"},{"comment_id":134573262,"body":"You haven&#39;t read stderr to see the details, which is likely to be the path for python3 or improper splitting parameters as noted by  user16320675. You should use <code>ProcessBuilder</code> and see more info here but note that the accepted answer isn&#39;t safe way to read from stdout+error <a href=\"https://stackoverflow.com/questions/5711084/java-runtime-getruntime-getting-output-from-executing-a-command-line-program\">Java Runtime.getRuntime(): getting output from executing a command line program</a>"}],"last_activity_date":1684844762,"question_id":76312869,"body":"<p>Iam trying to execute a python file via Java process which takes input</p>\n<pre><code>String cmd  = &quot;python3 generatedetails.py &quot; + data ;\nProcess p = Runtime.getRuntime().exec(cmd);\n</code></pre>\n<p>The data is passed as a string -</p>\n<pre><code> {&quot;Role&quot;:&quot;Designer&quot;,&quot;User&quot;:&quot;VBlah&quot;, &quot;DOB&quot;: &quot;12-12-12&quot;, &quot;isValidUser&quot;:&quot;true&quot;,&quot;sommore&quot;:&quot;&quot;}\n</code></pre>\n<p>In java this piece of code the python file doesn't get executed,  but when i run this directly from cli it gets executed</p>\n<p>python3 generatedetails.py {&quot;Role&quot;:&quot;Designer&quot;,&quot;User&quot;:&quot;VBlah&quot;, &quot;DOB&quot;: &quot;12-12-12&quot;,&quot;isValidUser:&quot;true&quot; , &quot;sommore&quot;:&quot;&quot;}</p>\n<p>The file(generatedetails.py) is in executable format</p>\n"},{"comments":[{"comment_id":134573983,"body":"What specific issue(s) did you have?"},{"comment_id":134574061,"body":"I can not build the body as it described in the question."},{"comment_id":134575224,"body":"Ok; what does your current code look like, and what is the <b>specific</b> issue? Please see the <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> page."}],"last_activity_date":1684844658,"question_id":76314727,"body":"<p>I tried to send a request to xmlRpc based server by using the XmpRpcClient but I couldn't build the request body which is :</p>\n<pre><code>&lt;methodCall&gt;\n    &lt;methodName&gt;method-name&lt;/methodName&gt;\n    &lt;params&gt;\n        &lt;param&gt;\n            &lt;value&gt;\n                &lt;struct&gt;\n                    &lt;member&gt;\n                        &lt;name&gt;originHostName&lt;/name&gt;\n                        &lt;value&gt;\n                            &lt;string&gt;Test&lt;/string&gt;\n                        &lt;/value&gt;\n                    &lt;/member&gt;\n                    &lt;member&gt;\n                        &lt;name&gt;originNodeType&lt;/name&gt;\n                        &lt;value&gt;\n                            &lt;string&gt;EXT&lt;/string&gt;\n                        &lt;/value&gt;\n                    &lt;/member&gt;\n                &lt;/struct&gt;\n            &lt;/value&gt;\n        &lt;/param&gt;\n    &lt;/params&gt;\n&lt;/methodCall&gt;\n</code></pre>\n<p>how should I build this body in the xmlRpcClient lib ?</p>\n"},{"answers":[{"comments":[{"comment_id":54516942,"body":"thnx for the reply , i have already mentioned that may be I am taking this wrong, so as you said I have two things to ask, 1# Do I need to save my keys in SP as I am doing or only keystore is enough? 2# Where to save this file so that nobody else can access it?"},{"comment_id":54522888,"body":"thnx again , testing with this, will accept your answer once i&#39;ll get success"},{"comment_id":54523478,"body":"Nikolay Elenkov blog is great source of information for all things related to Security in Android. I recommend to look through all his blog posts to get a lot of knowledge about that. You can checkout his book as well: <a href=\"http://nelenkov.blogspot.com/2014/04/android-security-internals.html\" rel=\"nofollow noreferrer\">nelenkov.blogspot.com/2014/04/android-security-internals.htm&zwnj;&#8203;l</a>"}],"answer_id":33346934,"body":"<p>I don't know why you want to keep your credentials in shared preferences when you have <code>Keystore</code>. Once you load your keystore file to memory you can add/retrieve keys anytime you want. And when you finished with just save it in file by calling:</p>\n\n<pre><code>FileOutputStream out = new FileOutputStream(keystoreFile);\n    keystore.store(out, password);\n    out.close();\n</code></pre>\n\n<p>load from file:</p>\n\n<pre><code>keystore.load(new FileInputStream(keystoreFile, password);\n</code></pre>\n\n<p>@answer to comment</p>\n\n<p>You should only use <code>Keystore</code>. Data from shared preferences are not secured and it's very easy to retrieve private key from it. You did not use any kind of encryption so your key is stored in plain PEM text. But if you use <code>Keystore</code> your key is password protected (on key level and on keystore level) so if anybody gets the <code>Keystore</code> file without passwords it will be much harder for him to break it. Best place to keep <code>Keystore</code> file is your app internal space disk which cannot be accessed without rooted phone (<code>Context.MODE_PRIVATE</code> when creating file).</p>\n"},{"answer_id":33363957,"body":"<p>You've answered your own question. Save them in a <code>KeyStore</code>, <em>not</em> in a preferences file.</p>\n"},{"answer_id":76314703,"body":"<p>The KeyStore get saved by itself unless it is being recreated. We can always extract the keys using <code>getKeys()</code> from the key store even after restarting the app. To do this first check if any of the <code>privateKey</code> or <code>secretKey</code> is already present or not. If present don't recreate the <code>KeyPair</code>(which indiretly creates a new KeyStore).\n<strong>Notice</strong>:The way I implemented the keyStore gets deleted after the app gets uninstalled.</p>\n<pre><code>public KeyStore createKeyStore(){\n        try {\n            KeyStore ks = KeyStore.getInstance(ANDROID_KEYSTORE);\n            ks.load(null);\n            return ks;\n        }\n        catch (KeyStoreException e){}\n        return  null;\n    }\n\npublic KeyPair getAsymmetricKeyPair() throws NoSuchPaddingException, NoSuchAlgorithmException, UnrecoverableKeyException, KeyStoreException {\n             KeyStore ks=createKeyStore();\n             KeyPair keyPair;\n             try {\n                  PrivateKey privateKey= (PrivateKey) ks.getKey(KEY_ALIAS, null);\n                 //privateKey is null it means that there is no keyStore Available   \n                  if(privateKey==null){\n       \n                  //Creating a new KeyStore while creating a KeyPair using keyPairGenerator\n                     keyPair=this.createAsymmetricKeyPair();\n                     return keyPair;\n                  }\n                  else //When the keyStore is already available\n                  {\n                      PublicKey publicKey=(PublicKey) ks.getCertificate(KEY_ALIAS).getPublicKey();\n                 //Creating a KeyPair After retrieving them from KeyStore\n                      return new KeyPair(publicKey,privateKey);\n                  }\n             }\n             catch (UnrecoverableEntryException e){}\n        return null;\n    }\n public KeyPair createAsymmetricKeyPair(){\n    try {\n        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\n                KeyProperties.KEY_ALGORITHM_RSA, ANDROID_KEYSTORE);\n\n        keyPairGenerator.initialize(\n                new KeyGenParameterSpec.Builder(\n                        KEY_ALIAS,\n                        KeyProperties.PURPOSE_DECRYPT|KeyProperties.PURPOSE_ENCRYPT)\n                        .setDigests(KeyProperties.DIGEST_SHA256, KeyProperties.DIGEST_SHA512)\n                        .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_RSA_PKCS1)\n                        .setBlockModes(KeyProperties.BLOCK_MODE_ECB)\n                        .build());\n        KeyPair keyPair = keyPairGenerator.generateKeyPair();\n        return keyPair;\n    }\n    catch(Exception e){}\n    return null;\n}\n</code></pre>\n"}],"last_activity_date":1684844508,"question_id":33346429,"body":"<p>I have written an API so that my different apps can use it.It simply checks whether app is registered with the server or not.If not then it generates Public/Private keypair,and got a signed certificate by sending CSR to my server. The next time it uses the signed certificate and private key. Initially I have default keystore file in raw ( b/c all my communication is over SSL i.e. initially with default keystore and after registration with user generated keystore)</p>\n\n<p>My API is working fine. The issues I am having are somewhat related to my lack of knowledge or wrong approach and hence I need assistance.</p>\n\n<p>I am using the following class to save/retrieve my Keypair</p>\n\n<pre><code>public class KeyIOHandler {\n\n\n    public static void writePublicKeyToPreferences(KeyPair key, Context context) {\n        StringWriter publicStringWriter = new StringWriter();\n        try {\n            PemWriter pemWriter = new PemWriter(publicStringWriter);\n            pemWriter.writeObject(new PemObject(\"myapp.PUBLIC KEY\", key.getPublic().getEncoded()));\n            pemWriter.flush();\n            pemWriter.close();\n            SharedPreferences preferences = context.getSharedPreferences(\"SHARED_PREFERENCES\",0);\n            preferences.edit().putString(\"RSA_PUBLIC_KEY\", publicStringWriter.toString()).commit();\n            Log.e(\"Public  Key\", publicStringWriter.toString());\n        } catch (IOException e) {\n            Log.e(\"RSA\", e.getMessage());\n            e.printStackTrace();\n        }\n    }\n\n    public static void writePrivateKeyToPreferences(KeyPair keyPair, Context context) {\n        StringWriter privateStringWriter = new StringWriter();\n        try {\n            PemWriter pemWriter = new PemWriter(privateStringWriter);\n            pemWriter.writeObject(new PemObject(\"myapp.PRIVATE KEY\", keyPair.getPrivate().getEncoded()));\n            pemWriter.flush();\n            pemWriter.close();\n            SharedPreferences preferences = context.getSharedPreferences(\"SHARED_PREFERENCES\",0);\n            preferences.edit().putString(\"RSA_PRIVATE_KEY\", privateStringWriter.toString()).commit();\n            Log.e(\"Private Key\",privateStringWriter.toString());\n        } catch (IOException e) {\n            Log.e(\"RSA\", e.getMessage());\n            e.printStackTrace();\n        }\n    }\n\n    public static PublicKey getRSAPublicKeyFromString(String publicKeyPEM) throws Exception {\n        publicKeyPEM = stripPublicKeyHeaders(publicKeyPEM);\n        KeyFactory keyFactory = KeyFactory.getInstance(\"RSA\", \"SC\");\n        byte[] publicKeyBytes = Base64.decode(publicKeyPEM.getBytes(\"UTF-8\"));\n        X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(publicKeyBytes);\n        return keyFactory.generatePublic(x509KeySpec);\n    }\n\n    public static PrivateKey getRSAPrivateKeyFromString(String privateKeyPEM) throws Exception {\n        privateKeyPEM = stripPrivateKeyHeaders(privateKeyPEM);\n        KeyFactory fact = KeyFactory.getInstance(\"RSA\", \"SC\");\n        byte[] clear = Base64.decode(privateKeyPEM);\n        PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(clear);\n        PrivateKey priv = fact.generatePrivate(keySpec);\n        Arrays.fill(clear, (byte) 0);\n        return priv;\n    }\n\n    public static String stripPublicKeyHeaders(String key) {\n        //strip the headers from the key string\n        StringBuilder strippedKey = new StringBuilder();\n        String lines[] = key.split(\"\\n\");\n        for (String line : lines) {\n            if (!line.contains(\"BEGIN PUBLIC KEY\") &amp;&amp; !line.contains(\"END PUBLIC KEY\") &amp;&amp; !isNullOrEmpty(line.trim())) {\n                strippedKey.append(line.trim());\n            }\n        }\n        return strippedKey.toString().trim();\n    }\n\n    public static String stripPrivateKeyHeaders(String key) {\n        StringBuilder strippedKey = new StringBuilder();\n        String lines[] = key.split(\"\\n\");\n        for (String line : lines) {\n            if (!line.contains(\"BEGIN PRIVATE KEY\") &amp;&amp; !line.contains(\"END PRIVATE KEY\") &amp;&amp; !isNullOrEmpty(line.trim())) {\n                strippedKey.append(line.trim());\n            }\n        }\n        return strippedKey.toString().trim();\n    }\n\n    public static boolean isNullOrEmpty(String str) {\n        return str == null || str.isEmpty();\n    }\n}\n</code></pre>\n\n<p>and by using the following method I am generating my keystore but I am confuse how and where I can store this keystore securely so that i can use it for the rest of app's life.(unless key is stolen). As in shared preferences I cannot store any object, so where to save this keystore.Right now I have static keystore object in my class.(which is worst I know but just to make it working i have made it static)</p>\n\n<pre><code>private boolean  addToStore(){\n        try {\n            Security.insertProviderAt(new org.spongycastle.jce.provider.BouncyCastleProvider(), 1);\n            clientPkcs12 = KeyStore.getInstance(\"PKCS12\");\n            clientPkcs12.load(null, null);\n            clientPkcs12.setKeyEntry(\"clientCert\", keyPair.getPrivate(), \"123456\".toCharArray(), chain);\n        }\n        catch(Exception ex){\n            Log.e(\"\",ex.getCause().getMessage());\n        }\n        return false;\n    }\n</code></pre>\n\n<p>I have gone through few posts,among them this is noticeable one <a href=\"http://nelenkov.blogspot.fr/2012/05/storing-application-secrets-in-androids.html\" rel=\"nofollow\">nelenkov.blogspot</a> but not getting how can I achieve my target or am I wrong at saving keystore? I mean do I have to create keystore every time? </p>\n"},{"answers":[{"answer_id":76271438,"body":"<p>I figured it out.</p>\n<p>I solved the warnings for my methods (isPresent and isEmpty) by adding the following annotation to each method\n<code>com.google.cloud.firestore.annotation.Exclude</code>.</p>\n<p>As for the nested the other warning for the other field, it's not really related to any of this.\nBefore, I was storing my <code>Foo</code> object directly in the database, however I updated it to be a <code>MyOptional&lt;Foo&gt;</code> instead. I noticed that when fetching the object the first time I see all the warnings for each field, however, once the object is updated to the new type, I no longer see the warnings.</p>\n"}],"last_activity_date":1684843983,"question_id":76270754,"body":"<p>I have a class, <code>MyOptional</code>, that contains a generic object, in this case <code>Foo</code>.\nI can see that I am seeing the following warnings in the logs</p>\n<pre><code>No setter/field for present found on class MyOptional (fields/setters are case sensitive!)\nNo setter/field for empty found on class MyOptional (fields/setters are case sensitive!)\n//The above two are static methods, and the below ones are fields in Foo\nNo setter/field for f1 found on class MyOptional\nNo setter/field for f2 found on class MyOptional\n...as well as for all other fields\n</code></pre>\n<p>The classes look like so:</p>\n<pre><code>@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@JsonIgnoreProperties(ignoreUnknown = true)\npublic class MyOptional&lt;T&gt; {\n\n  private static final FSOptional&lt;?&gt; EMPTY = new FSOptional&lt;&gt;(null);\n\n  private T value;\n\n  public static &lt;T&gt; FSOptional&lt;T&gt; empty() {\n    return (FSOptional&lt;T&gt;) EMPTY;\n  }\n\n  public static &lt;T&gt; FSOptional&lt;T&gt; of(T t) {\n    return new FSOptional&lt;&gt;(t);\n  }\n\n  public boolean isPresent() {\n    return value != null;\n  }\n\n  public boolean isEmpty() {\n    return value == null;\n  }\n}\n</code></pre>\n<p>and</p>\n<pre><code>@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\n@JsonIgnoreProperties(ignoreUnknown = true)\npublic class Foo {\n  private String f1;\n  private String f2;\n  ...\n}\n</code></pre>\n<p>I can see in the db that the data is being saved, however it does show the results/values of my two static methods (<code>isEmpty()</code> and <code>isPresent()</code> for <code>MyOptional</code>).\nHOWEVER, I do notice that the base object of the db is Foo instead of MyOptional...</p>\n<p><a href=\"https://i.stack.imgur.com/zAuOa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zAuOa.png\" alt=\"DB result\" /></a></p>\n<p>I DO have the default constructor and the setters and getters via <code>@NoArgsConstructor</code> and <code>@Data</code>, for both objects, so I am confused why I am still seeing this warning...any idea why and how to fix it?</p>\n"},{"answers":[{"answer_id":11731512,"body":"<h1>Introduction</h1>\n<p>This can have a lot of causes which are broken down in following sections:</p>\n<ul>\n<li>Put servlet class in a <code>package</code></li>\n<li>Set servlet URL in <code>url-pattern</code></li>\n<li><code>@WebServlet</code> works only on Servlet 3.0 or newer</li>\n<li><code>javax.servlet.*</code> doesn't work anymore in Servlet 5.0 or newer</li>\n<li>Make sure compiled <code>*.class</code> file is present in built WAR</li>\n<li>Test the servlet individually without any JSP/HTML page</li>\n<li>Use domain-relative URL to reference servlet from HTML</li>\n<li>Use straight quotes in HTML attributes</li>\n</ul>\n<h2>Put servlet class in a <code>package</code></h2>\n<p>First of all, put the servlet class in a Java <code>package</code>. You should <em>always</em> put publicly reuseable Java classes in a package, otherwise they are invisible to classes which are in a package, such as the source code of the server itself. This way you eliminate potential environment-specific problems. Packageless servlets work only in specific Tomcat+JDK combinations and this should never be relied upon. In case you are clueless which package to pick, start with <code>com.example</code>.</p>\n<p>In case of a &quot;plain&quot; IDE project, the class needs to be placed in its package structure inside the &quot;Java Sources&quot; folder, <em>not</em> inside &quot;Web Content&quot; folder, which is for web files such as JSP. Below is an example of the folder structure of a default Eclipse <em>Dynamic Web Project</em> as seen in <em>Navigator</em> view (the &quot;Java Sources&quot; folder is in such project by default represented by <code>src</code> folder):</p>\n<pre class=\"lang-none prettyprint-override\"><code>EclipseProjectName\n |-- src\n |    `-- com\n |         `-- example\n |              `-- YourServlet.java\n |-- WebContent\n |    |-- WEB-INF\n |    |    `-- web.xml\n |    `-- jsps\n |         `-- page.jsp\n :\n</code></pre>\n<p>In case of a Maven project, the class needs to be placed in its package structure inside <code>main/java</code> and thus <em>not</em> <code>main/resources</code>, <a href=\"https://stackoverflow.com/questions/31051494/how-to-link-a-css-resource-file-in-main-resources-in-jsp/\">this is for non-class files</a> and absolutely also <em>not</em> <code>main/webapp</code>, this is for web files. Below is an example of the folder structure of a default Maven webapp project as seen in Eclipse's <em>Navigator</em> view:</p>\n<pre class=\"lang-none prettyprint-override\"><code>MavenProjectName\n |-- src\n |    `-- main\n |         |-- java\n |         |    `-- com\n |         |         `-- example\n |         |              `-- YourServlet.java\n |         |-- resources\n |         `-- webapp\n |              |-- WEB-INF\n |              |    `-- web.xml\n |              `-- jsps\n |                   `-- page.jsp\n :\n</code></pre>\n<p>Note that the <code>/jsps</code> subfolder is not strictly necessary. You can even do without it and put the JSP file directly in webcontent/webapp root, but I'm just taking over this from your question.</p>\n<h2>Set servlet URL in <code>url-pattern</code></h2>\n<p>The servlet URL is specified as the &quot;URL pattern&quot; of the servlet mapping. It's absolutely not per definition the classname/filename of the servlet class. The URL pattern is to be specified as value of <code>@WebServlet</code> annotation.</p>\n<pre><code>package com.example; // Use a package!\n\nimport jakarta.servlet.annotation.WebServlet; // or javax.*\nimport jakarta.servlet.http.HttpServlet; // or javax.*\n\n@WebServlet(&quot;/servlet&quot;) // This is the URL of the servlet.\npublic class YourServlet extends HttpServlet { // Must be public and extend HttpServlet.\n    // ...\n}\n</code></pre>\n<p>In case you want to support path parameters like <code>/servlet/foo/bar</code>, then use an URL pattern of <code>/servlet/*</code> instead. See also <a href=\"https://stackoverflow.com/questions/8715474/servlet-and-path-parameters-like-xyz-value-test-how-to-map-in-web-xml\">Servlet and path parameters like /xyz/{value}/test, how to map in web.xml?</a></p>\n<p>Do note that it's considered a bad practice to use a Servlet URL pattern of <code>/*</code> or <code>/</code> in an attempt to have a &quot;front controller&quot;. So do not abuse these URL patterns in an attempt to try to catch all URLs. For an in depth explanation see also <a href=\"https://stackoverflow.com/questions/4140448/difference-between-and-in-servlet-mapping-url-pattern\">Difference between / and /* in servlet mapping url pattern</a>.</p>\n<h2><code>@WebServlet</code> works only on Servlet 3.0 or newer</h2>\n<p>In order to use <code>@WebServlet</code>, you need to make sure that your <code>web.xml</code> file, if any (it's optional since Servlet 3.0), is declared conform Servlet 3.0+ version <a href=\"https://stackoverflow.com/questions/6535676/webservlet-annotation-with-tomcat-7\">and thus <em>not</em> conform e.g. 2.5 version or lower</a>. It should absolutely also not have any <code>&lt;!DOCTYPE&gt;</code> line. Below is a Servlet 6.0 compatible one (which matches Tomcat 10.1+, WildFly 27+ (Preview), GlassFish/Payara 7+, etc) in its entirety:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;web-app \n    xmlns=&quot;https://jakarta.ee/xml/ns/jakartaee&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_6_0.xsd&quot;\n    version=&quot;6.0&quot;\n&gt;\n    &lt;!-- Config here. --&gt;\n&lt;/web-app&gt;\n</code></pre>\n<p>And below is a Servlet 5.0 compatible one (which matches Tomcat 10.0+, WildFly 22+ (Preview), GlassFish/Payara 6+, etc).</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;web-app \n    xmlns=&quot;https://jakarta.ee/xml/ns/jakartaee&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd&quot;\n    version=&quot;5.0&quot;\n&gt;\n    &lt;!-- Config here. --&gt;\n&lt;/web-app&gt;\n</code></pre>\n<p>And below is a Servlet 4.0 compatible one (which matches Tomcat 9+, WildFly 11+, GlassFish/Payara 5+, etc).</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;web-app\n    xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;\n    version=&quot;4.0&quot;\n&gt;\n    &lt;!-- Config here. --&gt;\n&lt;/web-app&gt;\n</code></pre>\n<p>Or, in case you're not on Servlet 3.0+ yet (e.g. Tomcat 6 or older), then remove the <code>@WebServlet</code> annotation (and make sure you also remove all the wrong JAR files or Maven dependencies which incorrectly made it possible for you to successfully compile the code):</p>\n<pre><code>package com.example;\n\nimport javax.servlet.http.HttpServlet;\n\npublic class YourServlet extends HttpServlet {\n    // ...\n}\n</code></pre>\n<p>And register the servlet instead in <code>web.xml</code> like this:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;servlet&gt;\n    &lt;servlet-name&gt;yourServlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;com.example.YourServlet&lt;/servlet-class&gt; &lt;!-- Including the package thus --&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;yourServlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/servlet&lt;/url-pattern&gt;  &lt;!-- This is the URL of the servlet. --&gt;\n&lt;/servlet-mapping&gt;\n</code></pre>\n<p>Note thus that you should <strong>not</strong> use <em>both</em> ways. Use <em>either</em> annotation based configuarion <em>or</em> XML based configuration. When you have both, then XML based configuration will override annotation based configuration.</p>\n<h2><code>javax.servlet.*</code> doesn't work anymore in Servlet 5.0 or newer</h2>\n<p>Since Jakarta EE 9 / Servlet 5.0 (Tomcat 10, TomEE 9, WildFly 22 Preview, GlassFish 6, Payara 6, Liberty 22, etc), the <code>javax.*</code> package has been renamed to <code>jakarta.*</code> package.</p>\n<p>In other words, please make absolutely sure that you don't randomly put JAR files of a different server in your WAR project such as tomcat-servlet-api-9.x.x.jar merely in order to get the <code>javax.*</code> package to compile. This will only cause trouble. Remove it altogether and edit the imports of your servlet class from</p>\n<pre class=\"lang-java prettyprint-override\"><code>import javax.servlet.*;\nimport javax.servlet.annotation.*;\nimport javax.servlet.http.*;\n</code></pre>\n<p>to</p>\n<pre class=\"lang-java prettyprint-override\"><code>import jakarta.servlet.*;\nimport jakarta.servlet.annotation.*;\nimport jakarta.servlet.http.*;\n</code></pre>\n<p>In case you're using Maven, you can find examples of proper <code>pom.xml</code> declarations for Tomcat 10+, Tomcat 9-, JEE 9+ and JEE 8- in this answer: <a href=\"https://stackoverflow.com/questions/65703840/how-to-properly-configure-jakarta-ee-libraries-in-maven-pom-xml-for-tomcat/65704617#65704617\">How to properly configure Jakarta EE libraries in Maven pom.xml for Tomcat?</a> The alternative is to downgrade the server to an older version, e.g. from Tomcat 10 back to Tomcat 9 or older, but this is clearly not the recommended way to go.</p>\n<p>In case you're using Spring instead of Jakarta EE, Spring 6 and Spring Boot 3 are the first versions to target Servlet 5.0 and therefore also the first versions to use the <code>jakarta.*</code> package. Older versions still use the <code>javax.*</code> package. Adjust your imports accordingly and make absolutely sure that you don't have any conflicting libraries in your dependencies which incorrectly make it possible to still successfully compile against <code>javax.servlet.*</code>. Using <code>javax.servlet.*</code> must give a compilation error in projects targeted at at least Servlet 5.0+ (so, either Jakarta EE 9+ or Spring 6+ or Spring Boot 3+).</p>\n<h2>Make sure compiled <code>*.class</code> file is present in built WAR</h2>\n<p>In case you're using a build tool such as Eclipse and/or Maven, then you need to make absolutely sure that the compiled servlet class file resides in its package structure in <code>/WEB-INF/classes</code> folder of the produced WAR file. In case of <code>package com.example; public class YourServlet</code>, it must be located in <code>/WEB-INF/classes/com/example/YourServlet.class</code>. Otherwise you will face in case of <code>@WebServlet</code> also a 404 error, or in case of <code>&lt;servlet&gt;</code> a HTTP 500 error like below:</p>\n<blockquote>\n<h1>HTTP Status 500</h1>\n<p>Error instantiating servlet class com.example.YourServlet</p>\n</blockquote>\n<p>And find in the server log a <code>java.lang.ClassNotFoundException: com.example.YourServlet</code>, followed by a <code>java.lang.NoClassDefFoundError: com.example.YourServlet</code>, in turn followed by <code>jakarta.servlet.ServletException: Error instantiating servlet class com.example.YourServlet</code>.</p>\n<p>An easy way to verify if the servlet is correctly compiled and placed in classpath is to let the build tool produce a WAR file (e.g. rightclick project, <em>Export &gt; WAR file</em> in Eclipse) and then inspect its contents with a ZIP tool. If the servlet class is missing in <code>/WEB-INF/classes</code>, or if the export causes an error, then the project is badly configured or some IDE/project configuration defaults have been mistakenly reverted (e.g. <em>Project &gt; Build Automatically</em> has been disabled in Eclipse).</p>\n<p>You also need to make sure that the project icon has no red cross indicating a build error. You can find the exact error in <em>Problems</em>  view (<em>Window &gt; Show View &gt; Other...</em>). Usually the error message is fine Googlable. In case you have no clue, best is to restart from scratch and do not touch any IDE/project configuration defaults. In case you're using Eclipse, you can find instructions in <a href=\"https://stackoverflow.com/questions/4076601/how-do-i-import-the-javax-servlet-api-in-my-eclipse-project\">How do I import the javax.servlet / jakarta.servlet API in my Eclipse project?</a></p>\n<h2>Test the servlet individually without any JSP/HTML page</h2>\n<p>Provided that the server runs on <code>localhost:8080</code>, and that the WAR is successfully deployed on a context path of <code>/contextname</code> (which defaults to the IDE project name or the Maven build artifact file name, case sensitive!), and the servlet hasn't failed its initialization (read server logs for any deploy/servlet success/fail messages and the actual context path and servlet mapping), then a servlet with URL pattern of <code>/servlet</code> is available at <code>http://localhost:8080/contextname/servlet</code>.</p>\n<p>You can just enter it straight in browser's address bar to test it invidivually. If its <code>doGet()</code> is properly overriden and implemented, then you will see its output in browser. Or if you don't have any <code>doGet()</code> or if it incorrectly calls <code>super.doGet()</code>, then a &quot;<a href=\"https://stackoverflow.com/questions/5370633/405-http-method-get-is-not-supported-by-this-url\">HTTP 405: HTTP method GET is not supported by this URL</a>&quot; error will be shown (which is still better than a 404 as a 405 is evidence that the servlet itself is actually found).</p>\n<p>Overriding <code>service()</code> is a bad practice, unless you're reinventing a MVC framework — which is very unlikely if you're just starting out with servlets and are clueless as to the problem described in the current question ;) See also <a href=\"https://stackoverflow.com/questions/3541077/design-patterns-web-based-applications\">Design Patterns web based applications</a>.</p>\n<p>Regardless, if the servlet already returns 404 when tested invidivually, then it's entirely pointless to try with a HTML form instead. Logically, it's therefore also entirely pointless to include any HTML form in questions about 404 errors from a servlet.</p>\n<h2>Use domain-relative URL to reference servlet from HTML</h2>\n<p>Once you've verified that the servlet works fine when invoked individually, then you can advance to HTML. As to your concrete problem with the HTML form, the <code>&lt;form action&gt;</code> value needs to be a valid URL. The same applies to <code>&lt;a href&gt;</code>, <code>&lt;img src&gt;</code>, <code>&lt;script src&gt;</code>, etc. You need to understand how absolute/relative URLs work. You know, an URL is a web address as you can enter/see in the webbrowser's address bar. If you're specifying a relative URL as form action, i.e. without the <code>http://</code> scheme, then it becomes relative to the <em>current</em> URL as you see in your webbrowser's address bar. It's thus absolutely not relative to the JSP/HTML file location in server's WAR folder structure as many starters seem to think.</p>\n<p>So, assuming that the JSP page with the HTML form is opened by <code>http://localhost:8080/contextname/jsps/page.jsp</code> (and thus <strong>not</strong> by <code>file://...</code>), and you need to submit to a servlet located in <code>http://localhost:8080/contextname/servlet</code>, here are several cases (note that you can here safely substitute <code>&lt;form action&gt;</code> with <code>&lt;a href&gt;</code>, <code>&lt;img src&gt;</code>, <code>&lt;script src&gt;</code>, etc):</p>\n<ul>\n<li><p>Form action submits to an URL with a leading slash.</p>\n  <pre class=\"lang-html prettyprint-override\"><code>  &lt;form action=&quot;/servlet&quot;&gt;\n</code></pre>\n<p>The leading slash <code>/</code> makes the URL relative to the domain, thus the form will submit to</p>\n  <pre class=\"lang-none prettyprint-override\"><code>  http://localhost:8080/servlet\n</code></pre>\n<p>But this will likely result in a 404 as it's in the wrong context.</p>\n<hr />\n</li>\n<li><p>Form action submits to an URL without a leading slash.</p>\n  <pre class=\"lang-html prettyprint-override\"><code>  &lt;form action=&quot;servlet&quot;&gt;\n</code></pre>\n<p>This makes the URL relative to the current folder of the current URL, thus the form will submit to</p>\n  <pre class=\"lang-none prettyprint-override\"><code>  http://localhost:8080/contextname/jsps/servlet\n</code></pre>\n<p>But this will likely result in a 404 as it's in the wrong folder.</p>\n<hr />\n</li>\n<li><p>Form action submits to an URL which goes one folder up.</p>\n  <pre class=\"lang-html prettyprint-override\"><code>  &lt;form action=&quot;../servlet&quot;&gt;\n</code></pre>\n<p>This will go one folder up (exactly like as in local disk file system paths!), thus the form will submit to</p>\n  <pre class=\"lang-none prettyprint-override\"><code>  http://localhost:8080/contextname/servlet\n</code></pre>\n<p>This one must work!</p>\n<hr />\n</li>\n<li><p>The canonical approach, however, is to make the URL domain-relative so that you don't need to fix the URLs once again when you happen to move the JSP files around into another folder.</p>\n  <pre class=\"lang-html prettyprint-override\"><code>  &lt;form action=&quot;${pageContext.request.contextPath}/servlet&quot;&gt;\n</code></pre>\n<p>This will generate</p>\n  <pre class=\"lang-html prettyprint-override\"><code>  &lt;form action=&quot;/contextname/servlet&quot;&gt;\n</code></pre>\n<p>Which will thus always submit to the right URL.</p>\n<hr />\n</li>\n</ul>\n<h2>Use straight quotes in HTML attributes</h2>\n<p>You need to make absolutely sure you're using straight quotes in HTML attributes like <code>action=&quot;...&quot;</code> or <code>action='...'</code> and thus <em>not</em> curly quotes like <code>action=”...”</code> or <code>action=’...’</code>. Curly quotes are not supported in HTML and they will simply become part of the value. Watch out when copy-pasting code snippets from blogs! Some blog engines, notably Wordpress, are known to by default use so-called &quot;smart quotes&quot; which thus also corrupts the quotes in code snippets this way. On the other hand, instead of copy-pasting code, try simply typing over the code yourself. Additional advantage of actually getting the code through your brain and fingers is that it will make you to remember and understand the code much better in long term and also make you a better developer.</p>\n<h2>See also:</h2>\n<ul>\n<li><a href=\"https://stackoverflow.com/tags/servlets/info\">Our servlets wiki page</a> - Contains some hello world examples</li>\n<li><a href=\"https://stackoverflow.com/questions/2395251/how-to-call-servlet-class-from-html-file\">How to call servlet class from HTML form</a></li>\n<li><a href=\"https://stackoverflow.com/questions/2349633/doget-and-dopost-in-servlets\">doGet and doPost in Servlets</a></li>\n<li><a href=\"https://stackoverflow.com/questions/3078701/how-do-i-pass-current-item-to-java-method-by-clicking-a-hyperlink-or-button-in-j\">How do I pass current item to Java method by clicking a hyperlink or button in JSP page?</a></li>\n</ul>\n<h3>Other cases of HTTP Status 404 error:</h3>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/11293325\">HTTP Status 404 - Servlet [ServletName] is not available</a></li>\n<li><a href=\"https://stackoverflow.com/questions/7798953\">HTTP Status 404 - The requested resource (/ProjectName/) is not available</a></li>\n<li><a href=\"https://stackoverflow.com/questions/8520267\">HTTP Status 404 - The requested resource (/) is not available</a></li>\n<li><a href=\"https://stackoverflow.com/questions/2386031\">JSP in /WEB-INF returns &quot;HTTP Status 404 The requested resource is not available&quot;</a></li>\n<li><a href=\"https://stackoverflow.com/questions/5752246\">Referencing a resource placed in WEB-INF folder in JSP file returns HTTP 404 on resource</a></li>\n<li><a href=\"https://stackoverflow.com/questions/3655316\">Browser can&#39;t access/find relative resources like CSS, images and links when calling a Servlet which forwards to a JSP</a></li>\n</ul>\n"},{"answer_id":51022386,"body":"<p>Solution for <code>HTTP Status 404</code> in NetBeans IDE:\nRight click on your project and go to your project properties, then click on run, then input your project relative URL like <code>index.jsp</code>.</p>\n<ol>\n<li>Project-&gt;Properties</li>\n<li>Click on Run</li>\n<li>Relative URL:/index.jsp (Select your project root URL)</li>\n</ol>\n<p><img src=\"https://i.stack.imgur.com/7hKaO.png\" alt=\"enter image description here\" /></p>\n"},{"comments":[{"comment_id":93047020,"body":"Your AppName.war and thus the exploded folder name doesn&#39;t match your expected name, for example when your war file is versioned like AppName-1.0-SNAPSHOT.war and you&#39;re trying /AppName/."}],"answer_id":51355521,"body":"<p><strong>Scenario #1:</strong> You <strong>accidentially re-deployed</strong> from the command line while tomcat was <strong>already running</strong>.</p>\n\n<p><strong>Short Answer:</strong> Stop Tomcat, <strong>delete target folder</strong>, mvn package, then re-deploy</p>\n\n<hr>\n\n<p><strong>Scenario #2:</strong> request.getRequestDispatcher(\"<strong>MIS_SPELLED_FILE_NAME</strong>.jsp\")</p>\n\n<p><strong>Short Answer:</strong> Check file name <strong>spelling</strong>, make sure <strong>case</strong> is correct.</p>\n\n<hr>\n\n<p><strong>Scenario #3: Class Not Found Exceptions</strong>\n(Answer put here because: Question# 17982240  )\n(<a href=\"https://stackoverflow.com/questions/17982240\">java.lang.ClassNotFoundException for servlet in tomcat with eclipse</a> )\n(was marked as duplicate and directed me here )</p>\n\n<p>Short Answer #3.1: web.xml has wrong package path in servlet-class tag.</p>\n\n<p>Short Answer #3.2: java file has wrong import statement.</p>\n\n<hr>\n\n<h2>Below is further details for Scenario #1:</h2>\n\n<hr>\n\n<p>1: Stop Tomcat</p>\n\n<ul>\n<li>Option 1: Via CTRL+C in terminal.</li>\n<li>Option 2: (terminal closed while tomcat still running)</li>\n<li>------------ 2.1: press:<strong>Windows+R</strong> --> type:\"<strong>services.msc</strong>\"</li>\n<li>------------ 2.2: Find \"Apache Tomcat #.# Tomcat#\" in Name column of list.</li>\n<li>------------ 2.3: Right Click --> \"<strong>stop</strong>\"</li>\n</ul>\n\n<p>2: Delete the \"target\" folder.\n<strong>(mvn clean will not help you here)</strong></p>\n\n<p>3: mvn package</p>\n\n<p>4: <em>YOUR_DEPLOYMENT_COMMAND_HERE</em></p>\n\n<p>(Mine: java -jar target/dependency/webapp-runner.jar --port 5190 target/*.war )</p>\n\n<p><strong>Full Back Story:</strong></p>\n\n<hr>\n\n<p>Accidentially opened a new git-bash window and\ntried to deploy a .war file for my heroku project via:</p>\n\n<p>java -jar target/dependency/webapp-runner.jar --port 5190 target/*.war</p>\n\n<p>After a failure to deploy, I realized I had two git-bash windows open,\nand <strong>had not used CTLR+C to stop the previous deployment</strong>.</p>\n\n<p>I was met with:</p>\n\n<blockquote>\n  <p>HTTP Status 404 – Not Found Type Status Report</p>\n  \n  <p>Message /if-student-test.jsp</p>\n  \n  <p>Description The origin server  did not find a current representation\n  for  the target resource or is not willing  to disclose that one\n  exists.</p>\n  \n  <p>Apache Tomcat/8.5.31</p>\n</blockquote>\n\n<h2>Below is further details for Scenario #3:</h2>\n\n<hr>\n\n<p>SCENARIO 3.1:\n   The servlet-class package path is wrong \n   in your web.xml file.</p>\n\n<p>It should MATCH the package statement at top\n   of your java servlet class.</p>\n\n<p>File: my_stuff/<strong>MyClass.java</strong>:</p>\n\n<pre><code>   package my_stuff;\n</code></pre>\n\n<p>File: PRJ_ROOT/src/main/webapp/WEB-INF/<strong>web.xml</strong></p>\n\n<pre><code>   &lt;servlet-class&gt;\n   my_stuff.MyClass\n   &lt;/servlet-class&gt;\n</code></pre>\n\n<p>SCENARIO 3.2:</p>\n\n<p>You put the wrong \"<strong>package</strong>\" statement\n   at top of your myClass.java file.</p>\n\n<p>For example:</p>\n\n<p>File is in: \"<strong>/my_stuff</strong>\" folder</p>\n\n<p>You mistakenly write:</p>\n\n<pre><code>package com.my_stuff\n</code></pre>\n\n<p>This is tricky because:</p>\n\n<p>1: The maven build (mvn package) will not report any errors here.</p>\n\n<p>2: servlet-class line in web.xml can have CORRECT package path. E.g:</p>\n\n<pre><code>&lt;servlet-class&gt;\nmy_stuff.MyClass\n&lt;/servlet-class&gt;\n</code></pre>\n\n<hr>\n\n<p>Stack Used:\n<strong>Notepad++</strong> + <strong>GitBash</strong> + <strong>Maven</strong> + <strong>Heroku Web App Runner</strong> + <strong>Tomcat9</strong> + <strong>Windows10</strong>:</p>\n"},{"answer_id":54043491,"body":"<p>My issue was that my method was missing the @RequestBody annotation. After adding the annotation I no longer received the 404 exception.</p>\n"},{"answer_id":55271111,"body":"<p>Do the following two steps. I hope, it will solve the \"404 not found\" issue in tomcat server during the development of java servlet application.</p>\n\n<p>Step 1: <code>Right click on the server(in the server explorer tab)-&gt;Properties-&gt;Switch Location from workspace metadata to tomcat server</code></p>\n\n<p>Step 2: <code>Double Click on the server(in the server explorer tab)-&gt;Select Use tomcat installation option inside server location menu</code></p>\n"},{"answer_id":55332075,"body":"<p>I removed the old web library such that are spring framework libraries. And build a new path of the libraries. Then it works.</p>\n"},{"answer_id":56221728,"body":"<p>Please check <strong>context root cannot be empty</strong>.</p>\n\n<p>If you're using eclipse:<br>\n<strong>right click</strong>, select <strong>properties</strong>, then <strong>web project settings</strong>. Check <strong>the context root cannot be empty</strong></p>\n"},{"answer_id":57288622,"body":"<p>An old thread, but since I didn't find it elsewhere, here is one more possibility:</p>\n\n<p>If you're using <strong>servlet-api 3.0+</strong>, then your web.xml must <strong>NOT</strong> include <code>metadata-complete=\"true\"</code> attribute</p>\n\n<p><a href=\"https://i.stack.imgur.com/yqGgjl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yqGgjl.png\" alt=\"enter image description here\"></a></p>\n\n<p>This tells tomcat to map the servlets using data given in <code>web.xml</code> instead of using the <code>@WebServlet</code> annotation.</p>\n"},{"answer_id":58078924,"body":"<p>First of all, run your IDE as Admin. After that, right click the project folder -> Project Facets and make sure that the Java Version is set correct. On my PC. (For Example 1.8) Now it should work. </p>\n\n<p>Don't just start your server, for example Wildfly, using the cmd. It has to be launched within the IDE and now visit your localhost URL. Example: <a href=\"http://localhost:8080/HelloWorldServlet/HelloWorld\" rel=\"nofollow noreferrer\">http://localhost:8080/HelloWorldServlet/HelloWorld</a></p>\n"},{"answer_id":59232706,"body":"<p>The fix that worked for me is(if you are using Maven): Rightclick your project, Maven -> Update project. This might give you some other error with the JDK and other Libraries(in my case, MySQL connector), but once you fix them, your original problem should be fixed!</p>\n"},{"answer_id":60798353,"body":"<p>If you would like to open a servlet with javascript without using 'form' and 'submit' button, here is the following code:</p>\n\n<pre><code>var button = document.getElementById(\"&lt;&lt;button-id&gt;&gt;\");\nbutton.addEventListener(\"click\", function() {\n  window.location.href= \"&lt;&lt;full-servlet-path&gt;&gt;\" (eg. http://localhost:8086/xyz/servlet)\n});\n</code></pre>\n\n<p>Key:</p>\n\n<p>1) button-id : The 'id' tag you give to your button in your html/jsp file.</p>\n\n<p>2) full-servlet-path: The path that shows in the browser when you run the servlet alone</p>\n"},{"answer_id":63451016,"body":"<p>Mapping in web.xml is what i have done :-</p>\n<ol>\n<li>If there's another package made for new program then we must mention :-</li>\n</ol>\n<p>packagename.filename between opening and closing of servlet-class tag in xml file.</p>\n<ol start=\"2\">\n<li>If you are mapping your files in xml and they are not working or showing errors , then comment on the annotation line of code in the respective files.</li>\n</ol>\n<p>Both methods dont work with one another , so either i use annotation method of files mentioned when we create servlet or the way of mapping , then i delete or comment the annotation line. Eg:</p>\n<pre><code> &lt;servlet&gt;\n   &lt;servlet-name&gt;s1&lt;/servlet-name&gt;\n   &lt;servlet-class&gt;performance.FirstServ&lt;/servlet-class&gt;\n   &lt;/servlet&gt;    \n   \n   &lt;servlet-mapping&gt;\n   &lt;servlet-name&gt;s1&lt;/servlet-name&gt;\n   &lt;url-pattern&gt;/FirstServ&lt;/url-pattern&gt;\n   &lt;/servlet-mapping&gt;\n   \n   &lt;servlet&gt;\n   &lt;servlet-name&gt;s2&lt;/servlet-name&gt;\n   &lt;servlet-class&gt;performance.SecondServ&lt;/servlet-class&gt;\n   &lt;/servlet&gt;\n   \n   &lt;servlet-mapping&gt;\n   &lt;servlet-name&gt;s2&lt;/servlet-name&gt;\n   &lt;url-pattern&gt;/SecondServ&lt;/url-pattern&gt;\n   &lt;/servlet-mapping&gt;\n</code></pre>\n<hr />\n<p>Commenting the annotation line of code in the respective file,if mapping in xml is done.</p>\n<pre><code>//@WebServlet(&quot;/FirstServ&quot;)\n//@WebServlet(&quot;/SecondServ&quot;)\n</code></pre>\n"},{"answer_id":64180694,"body":"<p>If someone is here who is using MySQL and felt that the code was working the previous day and now it doesn't, then I guess you must open MySQL CLI or MySQL Workbench and just make the connection to the database once. Once it gets connected, then the database also gets connected to the Java Application. I used to get the Hibernate Dialect error stating something wrong with com.mysql.jdbc.Driver. I think MySQL in some computers has a startup problem. This solved for me.</p>\n"},{"answer_id":64726639,"body":"<p>If you are a student and new to Java there might be some issue going on with your web.xml file.</p>\n<blockquote>\n<ol>\n<li>Try removing the web.xml file.</li>\n<li>Secondly check that your path variables are properly  set or not.</li>\n<li>Restart tomcat server Or your PC.</li>\n</ol>\n</blockquote>\n<p>Your problem will be surely solved.</p>\n"},{"answer_id":64800007,"body":"<p>Check if you have entered the correct URL Mapping as specified in the Web.xml</p>\n<p>For example:</p>\n<p>In the web.xml, your servlet declaration maybe:</p>\n<pre><code>&lt;servlet&gt;\n        &lt;servlet-name&gt;ControllerA&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;PackageName.ControllerA&lt;/servlet-class&gt;\n&lt;/servlet&gt;\n\n&lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;ControllerA&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/theController&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n</code></pre>\n<p>What this snippet does is <code>&lt;url-pattern&gt;/theController&lt;/url-pattern&gt;</code>will set the name that will be used to call the servlet from the front end (eg: form) through the URL. Therefore when you reference the servlet in the front end, in order to ensure that the request goes to the servlet &quot;ControllerA&quot;, it should refer the specified URL Pattern &quot;theController&quot; from the form.</p>\n<p>eg:</p>\n<pre><code>&lt;form action=&quot;theController&quot; method=&quot;POST&quot;&gt;\n&lt;/form&gt;\n</code></pre>\n"},{"answer_id":64954675,"body":"<p>I was facing this issue too, I was receiving a 404 when accessing a URL pattern that I knew was linked to a Servlet. The reason is because I had 2 Servlets with their @WebServlet <code>name</code> parameter set as the same string.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@WebServlet(name = &quot;ServletName&quot;, urlPatterns = {&quot;/path&quot;})\npublic class ServletName extends HttpServlet {}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@WebServlet(name = &quot;ServletName&quot;, urlPatterns = {&quot;/other-path&quot;})\npublic class OtherServletName extends HttpServlet {}\n</code></pre>\n<p>Both of the <code>name</code> parameters are the same. If you're using the name parameter, make sure they are unique compared to all other Servlets on your application.</p>\n"},{"answer_id":67629129,"body":"<p>I had the same issue. Tried all of this but didn't help. I managed to solve this issue by adding element tags to beginning and end of the xml file. ill leave my xml file below for reference.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;element&gt;\n\n&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee\n         http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;\n         version=&quot;3.1&quot;&gt;\n     \n&lt;servlet&gt; \n    &lt;servlet-name&gt;InsertServlet&lt;/servlet-name&gt; \n    &lt;servlet-class&gt;com.worklog.InsertServlet&lt;/servlet-class&gt; \n&lt;/servlet&gt; \n&lt;servlet-mapping&gt; \n    &lt;servlet-name&gt;InsertServlet&lt;/servlet-name&gt; \n    &lt;url-pattern&gt;/insert&lt;/url-pattern&gt; \n&lt;/servlet-mapping&gt;\n\n&lt;/web-app&gt;\n\n&lt;/element&gt;\n</code></pre>\n"},{"answer_id":68655244,"body":"<p>If you're using IntelliJ, this is what fixed it for me:</p>\n<p>Go to the Tomcat configuration:\n<a href=\"https://i.stack.imgur.com/flFCk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/flFCk.png\" alt=\"enter image description here\" /></a></p>\n<p>Configuration &gt; Deployment Tab\n<a href=\"https://i.stack.imgur.com/J3nA6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J3nA6.png\" alt=\"enter image description here\" /></a></p>\n<p>Scroll down and add <code>/</code> to the Application Context dropdown\n<a href=\"https://i.stack.imgur.com/4tHpi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4tHpi.png\" alt=\"enter image description here\" /></a></p>\n"},{"answer_id":69131080,"body":"<p>I was having the same issue. I was developing a mvc based REST API where there was no explicit html configuration or files. The API was using Swagger to generate a user interface. The problem started when I introduced Swagger version &quot;3.0.0&quot;. I reverted back to Swagger &quot;2.9.2&quot; This solved my problem.</p>\n<pre><code>&lt;!-- Swagger --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n        &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;\n        &lt;version&gt;2.9.2&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n        &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;\n        &lt;version&gt;2.9.2&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"}],"last_activity_date":1684843681,"question_id":11731377,"body":"<p>I have an HTML form in a JSP file in my <code>WebContent/jsps</code> folder. I have a servlet class <code>servlet.java</code> in my default package in <code>src</code> folder. In my <code>web.xml</code> it is mapped as <code>/servlet</code>.</p>\n<p>I have tried several URLs in <code>action</code> attribute of the HTML form:</p>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;form action=&quot;/servlet&quot;&gt;\n</code></pre>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;form action=&quot;/servlet.java&quot;&gt;\n</code></pre>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;form action=&quot;/src/servlet.java&quot;&gt;\n</code></pre>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;form action=&quot;../servlet.java&quot;&gt;\n</code></pre>\n<p>But none of those work. They all keep returning a HTTP 404 error like below in Tomcat 6/7/8:</p>\n<blockquote>\n<h3>HTTP Status 404 — /servlet</h3>\n<p><em>Description</em>: The requested resource (/servlet) is not available.</p>\n</blockquote>\n<p>Or as below in Tomcat 8.5/9:</p>\n<blockquote>\n<h3>HTTP Status 404 — Not Found</h3>\n<p><em>Message</em>: /servlet</p>\n<p><em>Description</em>: The origin server did not find a current representation for the target resource or is not willing to disclose that one exists</p>\n</blockquote>\n<p>Or as below in Tomcat 10:</p>\n<blockquote>\n<h3>HTTP Status 404 — Not Found</h3>\n<p><em>Type</em>: Status Report</p>\n<p><em>Message</em>: The requested resource (/servlet) is not available</p>\n<p><em>Description</em>: The origin server did not find a current representation for the target resource or is not willing to disclose that one exists</p>\n</blockquote>\n<p>Why is it not working?</p>\n"},{"comments":[{"comment_id":61868587,"body":"Did you find solution/exmaple for this? I am looking for the same...!"}],"answers":[{"comments":[{"comment_id":8132774,"body":"Thanks for the tips, I will try to avoid such designs in future. I cant use the tools you mentioned in your post - cant it be done with axis 2 only ?"},{"comment_id":8133423,"body":"According  to the Axis 2 web site it can be done, but I failed to find any examples."},{"comment_id":62364732,"body":"Are they any open source platform supporting WS-Atomic transactions? Are they any replacement propose for WS-Atomic transaction?"}],"answer_id":6840524,"body":"<p>You may do better to use a JAX/WS implementation provided by a particular application server vendor. You can see tutorials such as <a href=\"http://www.ibm.com/developerworks/websphere/library/techarticles/0707_lo/0707_lo.html\" rel=\"nofollow\">this</a>.</p>\n\n<p>One thing to be aware of is that distributed transactions may seem very attractive but they do add considerable operational complexity, especially in failure scenarios. </p>\n\n<ol>\n<li>The Transaction manager's transaction logs become critical to managing consistency between systems. Lose those logs and you have the potential to lose knowledge of the outcome of a transaction.</li>\n<li>You introduce coupling between systems that may have different availability characteristics. A system failure at just the right (or rather wrong) time will cause database locks to be held in one system until all systems are restored to service. To be specific, in the two-phase  protocol, after a resource (eg. Database) has \"voted\" in phase 1, it cannot resolve the transaction until the transaction manager decides the overall fate of the transaction by collecting votes from all participants. If one participant cannot be restored for a time then all locks held by that transaction are kept for that time. The only workaround is manual intervention (operational complexity) and potential inconsistency.</li>\n</ol>\n\n<p>In summary, I would be reluctant to recommend the use of distributed transactions between systems that are in different operational domains (eg. different companies, or different geographies).</p>\n"},{"answer_id":76314490,"body":"<p>Seem they tried to developpe WS-AT... but fail ?\nthe apache project seem implementing this are kandula2 at axis 2...\n<a href=\"https://svn.apache.org/repos/asf/axis/axis2/java/kandula/site/2/index.html\" rel=\"nofollow noreferrer\">https://svn.apache.org/repos/asf/axis/axis2/java/kandula/site/2/index.html</a></p>\n"}],"last_activity_date":1684843071,"question_id":6840272,"body":"<p>I have been using Axis2 to genarate my web services. Some of my services are a part of transaction - i.e, either all or none of them have to be executed.</p>\n\n<p>To solve my problem, I have been reading about the WS-AT specs over the web. But I am unable to figure out how to configure and use this feature with Axis2. Can anyone please share how to start off ? Any supporting code will be good.</p>\n\n<p>Thanks!</p>\n"},{"comments":[{"comment_id":40194076,"body":"Java uses Classes ..."}],"answers":[{"comments":[{"comment_id":40194134,"body":"#ErstwhileIII, did you mean to close the bracket in the end ?"},{"comment_id":40194494,"body":"Yes, I thought this was the case;  my final question would be do I need to add this in a new Class file?  I am just thinking that If I need to include another Class (e.g. vector is one with direction/value held separately), do I need a new class file?  I am be talking complete nonsense here..."}],"answer_id":25712743,"body":"<p>If you are asking what the <code>Java</code> class definition would look like, then consider the following:</p>\n\n<pre><code>public class CustomPoint {\n    // Object fields\n    float dX;\n    float dY;\n    float dZ;\n    float vector;\n    public CustomPoint() {}\n\n//// CustomPoint methods\n}\n</code></pre>\n"},{"comments":[{"comment_id":40194136,"body":"Java requires types also in ct."},{"comment_id":40194183,"body":"public CustomPoint(float x, float y, float z, float v) { ... }"}],"answer_id":25712756,"body":"<p>Visual basic Types can be seen more as C's structs, in java (since is OOP) you can create a class to do same, something like this:</p>\n\n<pre><code>class CustomPoint{\n    float Dx;\n    float Dy;\n    float Dz;\n    float vector;\n\n    public CustomPoint(float x, float y, float z, float v){\n        Dx = x;\n        Dy = y;\n        Dz = z;\n        vector = v;\n    }\n\n}\n</code></pre>\n"},{"answer_id":76314475,"body":"<pre><code>public class CustomPoint {\n    private float dx;\n    private float dy;\n    private float dz;\n    private float vector;\n    \n    public CustomPoint(float dx, float dy, float dz, float vector) {\n        this.dx = dx;\n        this.dy = dy;\n        this.dz = dz;\n        this.vector = vector;\n    }\n    \n    public float getDx() {\n        return dx;\n    }\n    \n    public void setDx(float dx) {\n        this.dx = dx;\n    }\n    \n    public float getDy() {\n        return dy;\n    }\n    \n    public void setDy(float dy) {\n        this.dy = dy;\n    }\n    \n    public float getDz() {\n        return dz;\n    }\n    \n    public void setDz(float dz) {\n        this.dz = dz;\n    }\n    \n    public float getVector() {\n        return vector;\n    }\n    \n    public void setVector(float vector) {\n        this.vector = vector;\n    }\n}\n</code></pre>\n"}],"last_activity_date":1684842961,"question_id":25712690,"body":"<p>This has to the simplest question on stackOverflow, but I am a complete beginner; sorry.</p>\n\n<p>Can anyone tell me how to declare a custom Type.</p>\n\n<p>In VB, I would do:</p>\n\n<pre><code>Private Type CustomPoint\n    Dx as Single\n    Dy as Single\n    Dz as Single\n    Vector as Single\nEnd Type\n</code></pre>\n\n<p>How would I do the same on Eclipse?  Do I need to create a new class for this?</p>\n\n<p>Thank a lot for helping!</p>\n"},{"last_activity_date":1684842803,"question_id":76314452,"body":"<p>Is it possible to receive an <em>event</em> from <code>keycloak</code> regarding the login/logout of a user? if so, how can I do this?</p>\n"},{"comments":[{"comment_id":134573499,"body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/69930012/exception-java-lang-noclassdeffounderror-javax-activation-datasource-when-send\">Exception: java.lang.NoClassDefFoundError: javax/activation/DataSource when sending mail</a>"},{"comment_id":134573826,"body":"I tried adding jakarta-activation libs as well. But it did not help."}],"last_activity_date":1684842636,"question_id":76314435,"body":"<p>I am getting the following errors while starting the application. I am using JDK 17.</p>\n<pre><code>Exception. :\\njava.lang.NoClassDefFoundError: javax/activation/DataSource\\n\\tat com.sun.xml.bind.v2.model.impl.RuntimeBuiltinLeafInfoImpl.&lt;clinit&gt;(RuntimeBuiltinLeafInfoImpl.java:478)\\n\\tat com.sun.xml.bind.v2.model.impl.RuntimeTypeInfoSetImpl.&lt;init&gt;(RuntimeTypeInfoSetImpl.java:63)\\n\\tat com.sun.xml.bind.v2.model.impl.RuntimeModelBuilder.createTypeInfoSet(RuntimeModelBuilder.java:128)\\n\\tat com.sun.xml.bind.v2.model.impl.RuntimeModelBuilder.createTypeInfoSet(RuntimeModelBuilder.java:84)\\n\\tat com.sun.xml.bind.v2.model.impl.ModelBuilder.&lt;init&gt;(ModelBuilder.java:162)\\n\\tat com.sun.xml.bind.v2.model.impl.RuntimeModelBuilder.&lt;init&gt;(RuntimeModelBuilder.java:92)\\n\\tat com.sun.xml.bind.v2.runtime.JAXBContextImpl.getTypeInfoSet(JAXBContextImpl.java:455)\\n\\tat com.sun.xml.bind.v2.runtime.JAXBContextImpl.&lt;init&gt;(JAXBContextImpl.java:303)\\n\\tat com.sun.xml.bind.v2.runtime.JAXBContextImpl.&lt;init&gt;(JAXBContextImpl.java:139)\\n\\tat com.sun.xml.bind.v2.runtime.JAXBContextImpl$JAXBContextBuilder.build(JAXBContextImpl.java:1156)\\n\\tat com.sun.xml.bind.v2.ContextFactory.createContext(ContextFactory.java:165)\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\\n\\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\\n\\tat javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:297)\\n\\tat javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:286)\\n\\tat javax.xml.bind.ContextFinder.find(ContextFinder.java:409)\\n\\tat javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:721)\\n\\tat javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:662)\\n\\tat\n</code></pre>\n<p>I have included the following libraries in my pom.xml</p>\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;\n        &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;\n        &lt;version&gt;2.3.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n    &lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;\n    &lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;\n    &lt;version&gt;2.3.2&lt;/version&gt;\n&lt;/dependency&gt;\n    \n    &lt;dependency&gt;\n        &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;\n        &lt;artifactId&gt;jaxb-core&lt;/artifactId&gt;\n        &lt;version&gt;2.3.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;\n        &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt;\n        &lt;version&gt;2.3.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n&lt;dependency&gt;\n        &lt;groupId&gt;javax.activation&lt;/groupId&gt;\n        &lt;artifactId&gt;activation&lt;/artifactId&gt;\n        &lt;version&gt;1.1.1&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>Still it throws the error</p>\n"},{"comments":[{"comment_id":61605631,"body":"Will you have <code>CUSTOMER1</code> and <code>CUSTOMER2</code> in a single query, or are those mutually exclusive tenants that appear only once per query?"},{"comment_id":61615897,"body":"@Lukas Eder: thanks, I updated the question."}],"answers":[{"comments":[{"comment_id":61621801,"body":"Thanks Lukas. Knowing that <code>Table.rename()</code> will come in 3.9, I will go with the reflection hack for now, since it is easier to migrate later on."},{"comment_id":127460832,"body":"I really like the &quot;the answer to your question&quot; and &quot;the answer to your problem&quot; approach taken here. :) Sometimes, you simply don&#39;t know what you are doing well enough to be able to ask the right question..."},{"comment_id":127461874,"body":"@PerLundberg: It has a name: <a href=\"https://xyproblem.info\" rel=\"nofollow noreferrer\">xyproblem.info</a>. It&#39;s still a useful question, though. People will find the <code>rename()</code> method and think &quot;this is for me&quot;. But then, it doesn&#39;t do exactly what they want, so they google <code>rename()</code> to see what options they have. It&#39;s one way of discovering the feature whose name they didn&#39;t know, &quot;schema mapping.&quot;"},{"comment_id":127464155,"body":"Yeah, good points. As for myself, I stumbled upon the <code>rename()</code> method by coincidence when I was in fact looking for table-aliasing using <code>as()</code>....:-D"},{"comment_id":127467496,"body":"@PerLundberg: And then, you came here, in awe of what&#39;s possible :) (or, wondering, what you were originally looking for before all of this distraction)"},{"comment_id":127534564,"body":"@LukasEder Something like that yes. :)"}],"answer_id":37033418,"body":"<h3>The answer to your question</h3>\n<p>The question being in the title:</p>\n<blockquote>\n<p>why is there no Table.rename(String)?</p>\n</blockquote>\n<p>The feature was implemented in jOOQ 3.3 (<a href=\"https://github.com/jOOQ/jOOQ/issues/2921\" rel=\"nofollow noreferrer\">#2921</a>). The issue reads:</p>\n<blockquote>\n<p>As table renaming is not really a SQL DSL feature, the rename() method should be generated onto generated tables only, instead of being declared in org.jooq.Table</p>\n</blockquote>\n<p>In fact, this argument doesn't really make much sense. There are other &quot;non-DSL&quot; utilities on the DSL types. I don't see why <code>rename()</code> is special. The method should be declared on <code>Table</code> as you suggested. This might be done in the future (<a href=\"https://github.com/jOOQ/jOOQ/issues/13937\" rel=\"nofollow noreferrer\">#13937</a>).</p>\n<h3>The answer to your problem</h3>\n<p>From the update of your question, I understand that you don't really need that fine-grained renaming control. jOOQ's out of the box multi-tenancy feature will do. This is called &quot;table mapping&quot; in the manual:</p>\n<p><a href=\"http://www.jooq.org/doc/latest/manual/sql-building/dsl-context/runtime-schema-mapping\" rel=\"nofollow noreferrer\">http://www.jooq.org/doc/latest/manual/sql-building/dsl-context/runtime-schema-mapping</a></p>\n<p>For the scope of a <code>Configuration</code> (most fine-grained scope: per-query level), you can rewrite any matching table name as such:</p>\n<pre><code>Settings settings = new Settings()\n    .withRenderMapping(new RenderMapping()\n    .withSchemata(\n        new MappedSchema().withInput(&quot;MY_SCHEMA&quot;)\n                          .withOutput(&quot;MY_SCHEMA&quot;)\n                          .withTables(\n         new MappedTable().withInput(&quot;CUSTOMER&quot;)\n                          .withOutput(&quot;CUSTOMER1&quot;))));\n</code></pre>\n"}],"last_activity_date":1684842585,"question_id":37021579,"body":"<p>I am dynamically creating and using physical DB tables for which I only have one metamodel object. An example: I have one JOOQ class <code>Customer</code> in my metamodel, but I have <code>CUSTOMER1</code>, <code>CUSTOMER2</code>, etc. at runtime. I'd like to write strongly typed JOOQ queries for these dynamic tables. The following seems to do the trick:</p>\n\n<pre><code>Customer CUSTOMER1 = Customer.rename(\"CUSTOMER1\")\n</code></pre>\n\n<p>Of course, there's a whole bunch of tables for which I need to do this. Unfortunately, I cannot leverage the <code>rename</code> method generically, because it is not part of the <code>Table&lt;R&gt;</code> interface. Is this an oversight or a deliberate measure against something I am missing?</p>\n\n<p>Is there a robust and elegant way to achieve what I want, i.e. without resorting to reflection?</p>\n\n<p><em>EDIT</em>: the two tables are never used jointly in the same query. Concrete usage pattern is the following: At any given moment, a DB synonym <code>CUSTOMER</code> will point to one (the active), while the other is being modified (the shadow copy). Once the modification is complete, roles are swapped by pointing the synonym at the other one, and we start over. We do this to minimize \"downtime\" of heavy reporting result tables. </p>\n"},{"comments":[{"comment_id":41967341,"body":"The type signature kinda tells the whole story. <code>map :: Stream T -&gt; (T -&gt; R) -&gt; Stream R</code>, <code>flatMap :: Stream T -&gt; (T -&gt; Stream R) -&gt; Stream R</code>."},{"comment_id":77267808,"body":"fwiw, those type signatures don&#39;t even look like Java. (I know, I know -- but to say it tells &quot;the whole story&quot; wrt map/flatMap assumes a lot of knowledge about the new &amp; improved &quot;Java++&quot;)"},{"comment_id":77374110,"body":"@michael That type signature looks like Haskell, not Java. But it&#39;s not clear whether the actual Java signature is any more readable: <code>&lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T,? extends Stream&lt;? extends R&gt;&gt; mapper)</code>."},{"comment_id":77397998,"body":"Ha, yeah, I was referring to the &quot;actual Java&quot;. Like C++, modern Java is almost unrecognizable to anyone who started using it in the 90s (like I did, both languages). Just replying to the comment, that method signatures hardly tell a &quot;whole story&quot;, at least not anymore, not without additional exposition (or in that commenters case, translation)."},{"comment_id":85324611,"body":"Which is to say, a <code>map</code>&#39;s mapper lambda returns <code>R</code>, a <code>flatMap</code>&#39;s mapper lambda returns a <code>Stream</code> of <code>R</code> (<code>Stream&lt;R&gt;</code>). The streams returned by the <code>flatMap</code>&#39;s mapper are effectively concatenated. Otherwise, both <code>map</code> and <code>flatMap</code> return <code>Stream&lt;R&gt;</code>; the difference is what the mapper lambdas return, <code>R</code> vs. <code>Stream&lt;R&gt;</code>."},{"comment_id":99686124,"body":"Use <code>map</code> if each element is transformed into a single value. Use <code>flatMap</code> if each element will be transformed to multiple values and the resulting stream needs to be flattened."}],"answers":[{"comments":[{"comment_id":101731155,"body":"Haha, to be fair I&#39;m still surprised to see how much traffic this question gets. Another funny observation is that it&#39;s been almost 5 years I wrote this answer and there&#39;s been a fairly consistent pattern of upvoting where the accepted answer gets roughly two upvotes for every one my answer gets. It&#39;s surprisingly consistent."},{"comment_id":103671439,"body":"how is this not the accepted answer, thank for getting straight to the point and putting a very simple example"},{"comment_id":112134471,"body":"I believe this answer is concise and logically better explained than the accepted one."},{"comment_id":114104414,"body":"This answer is short and practical. The accepted (Stuart&#39;s) answer added an explanation on <i>why is that kind of method (<code>flatMap</code>) needed?</i> Each answer cater for different types of answer that the community may seek."},{"comment_id":120622950,"body":"sleek way of explaining"},{"comment_id":133666932,"body":"What is the use case of the flatMap? At the end I just want to collect it so I do not see why flatten it if at the end it will be a list or another collection, performance? map.collect vs flatMap.collect"},{"comment_id":133684635,"body":"If you collect it without flattening you&#39;ll get a list of lists (for example), which is not as easy to manipulate if all you care about are the values in the lists. If each list represents stronger concept like a cart of items or something like that, then keeping the items grouped in separate collections can make sense."}],"answer_id":26684582,"body":"<p><code>Stream.flatMap</code>, as it can be guessed by its name, is the combination of a <code>map</code> and a <code>flat</code> operation. That means that you first apply a function to your elements, and then flatten it. <code>Stream.map</code> only applies a function to the stream without flattening the stream.</p>\n\n<p>To understand what <em>flattening</em> a stream consists in, consider a structure like <code>[ [1,2,3],[4,5,6],[7,8,9] ]</code> which has \"two levels\". Flattening this means transforming it in a \"one level\" structure : <code>[ 1,2,3,4,5,6,7,8,9 ]</code>.</p>\n"},{"comments":[{"comment_id":94345771,"body":"Why would you want to &quot;return any number of objects for each input object (including none)&quot;?"},{"comment_id":94346580,"body":"@DerekMahar There would be plenty of use-cases for this. For example, let&#39;s say you have a stream of <code>Department</code>s in your organization. Each department has between 0 and n <code>Employee</code>s. What you need is a stream of all employees. So what do you do? You write a flatMap method which takes a department and returns a stream of its employees."},{"comment_id":94348722,"body":"Philipp, does your example illustrate the main reason to use <code>flatMap</code>?  I suspect that it may be incidental and doesn&#39;t illustrate the key use case or reason why <code>flatMap</code> exists.  (Continued below...)"},{"comment_id":94348739,"body":"After reading <a href=\"https://dzone.com/articles/understanding-flatmap\" rel=\"nofollow noreferrer\">dzone.com/articles/understanding-flatmap</a>, I think the main motivation behind <code>flatMap</code> is to accommodate errors that would be present when using <code>map</code>.  How do you handle cases where one or more items in the original set cannot be mapped to an output item?  By introducing an intermediate set (say an <code>Optional</code> or <code>Stream</code>) for each input object, <code>flatMap</code> allows you to exclude the &quot;invalid&quot; input objects (or the so called &quot;bad apples&quot; in the spirit of <a href=\"https://stackoverflow.com/a/52248643/107158\">stackoverflow.com/a/52248643/107158</a>) from the final set."},{"comment_id":94348866,"body":"@DerekMahar Yes, stuations where each input-object might or might not return an output-object is another good use-case for flat-map."}],"answer_id":26684611,"body":"<p>The function you pass to <code>stream.map</code> has to return one object. That means each object in the input stream results in exactly one object in the output stream.</p>\n\n<p>The function you pass to <code>stream.flatMap</code> returns a stream for each object. That means the function can return any number of objects for each input object (including none). The resulting streams are then concatenated to one output stream.</p>\n"},{"comments":[{"comment_id":75109489,"body":"Sounds to me like the <code>flatMap</code> operation is the exact opposite of flat. Yet again, leave it to Computer Scientists to turn a term on it&#39;s head. Like a function being &quot;transparent&quot; meaning you can&#39;t see anything it does, just the results, while colloquially saying you want a process to be transparent means you want every part of it to be seen."},{"comment_id":75834342,"body":"@coladict Try viewing it from a different perspective: it&#39;s not a transparent case where you can see the inner workings through, but the whole function itself is transparent, i.e. invisible, to you - while still doing their work and letting you see what you&#39;re working with. In this case, &quot;flat&quot; refers to the opposite of &quot;nested&quot;, flatmap removes one nesting level by flattening."},{"comment_id":77367054,"body":"@coladict The &quot;transparent&quot; thing has been eating my head for years. Glad to know at least one other person feels the same way."},{"comment_id":77867792,"body":"@coladict: i was just thinking along the same line where does the flat part in the name come from?"},{"comment_id":83544338,"body":"Flattening comes from turning 2-level structure into single level structure, see Dici&#39;s answer for an example <a href=\"https://stackoverflow.com/a/26684582/6012102\">stackoverflow.com/a/26684582/6012102</a>"},{"comment_id":85298810,"body":"This is the best explanation of <b>flatMap</b>. This is what makes it all clicked: <i>The values from the stream returned by the mapper are drained from the stream and are passed to the output stream. The &quot;clumps&quot; of values returned by each call to the mapper function are not distinguished at all in the output stream, thus the output is said to have been &quot;flattened&quot;</i>. Thank you!"},{"comment_id":89133363,"body":"@coladict @markus  If you provided the same transformer method to <code>map</code> instead of <code>flatMap</code>, you would have a <code>Stream&lt;Stream&lt;R&gt;&gt;</code> instead of just a <code>Stream&lt;R&gt;</code>  <a href=\"https://gist.github.com/bradynpoulsen/f3f5458d718a996c5b3dec9decefb6d2\" rel=\"nofollow noreferrer\">gist.github.com/bradynpoulsen/f3f5458d718a996c5b3dec9decefb6&zwnj;&#8203;d2</a>"},{"comment_id":113636612,"body":"@Zefiro would not the work &quot;opaque&quot; that better then?"},{"comment_id":113682381,"body":"@P&#229;lOliver Possibly. But people seem to like transparency, so the same word is used for two different meanings, depending on whether you&#39;re interested in seeing the inner mechanism (so the box around it is transparent for it to be seen) or don&#39;t want their view blocked by those details (so the whole mechanism is see-through)."},{"comment_id":117880283,"body":"I would rather say  FlatMap == Map+FaltteningTheResults"},{"comment_id":122556237,"body":"Great answer, another typical usage would be using flatMap on an Optional, if the passed lambda returns an Optional too."},{"comment_id":124570622,"body":"Another advantage of using streams within the result: they can be lazily calculated, in case of large or expensive to compute streams.  So if each item of the initial stream returns, say, a million records that are easily calculated, you don&#39;t need to have all million records in memory at once: the stream function can generate them as they are processed."}],"answer_id":26684710,"body":"<p>Both <code>map</code> and <code>flatMap</code> can be applied to a <code>Stream&lt;T&gt;</code> and they both return a <code>Stream&lt;R&gt;</code>. The difference is that the <code>map</code> operation produces one output value for each input value, whereas the <code>flatMap</code> operation produces an arbitrary number (zero or more) values for each input value.</p>\n\n<p>This is reflected in the arguments to each operation.</p>\n\n<p>The <code>map</code> operation takes a <code>Function</code>, which is called for each value in the input stream and produces one result value, which is sent to the output stream.</p>\n\n<p>The <code>flatMap</code> operation takes a function that conceptually wants to consume one value and produce an arbitrary number of values. However, in Java, it's cumbersome for a method to return an arbitrary number of values, since methods can return only zero or one value. One could imagine an API where the mapper function for <code>flatMap</code> takes a value and returns an array or a <code>List</code> of values, which are then sent to the output. Given that this is the streams library, a particularly apt way to represent an arbitrary number of return values is for the mapper function itself to return a stream! The values from the stream returned by the mapper are drained from the stream and are passed to the output stream. The \"clumps\" of values returned by each call to the mapper function are not distinguished at all in the output stream, thus the output is said to have been \"flattened.\"</p>\n\n<p>Typical use is for the mapper function of <code>flatMap</code> to return <code>Stream.empty()</code> if it wants to send zero values, or something like <code>Stream.of(a, b, c)</code> if it wants to return several values. But of course any stream can be returned.</p>\n"},{"comments":[{"comment_id":104382873,"body":"@PrashanthDebbadwar I think you would end up with a Stream of <code>Stream&lt;Integer&gt;</code> rather than a Stream of <code>Integer</code>."}],"answer_id":34332065,"body":"<p>I would like to give 2 examples to get a <em>more</em> practical point of view:\n<BR>First example making usage of <code>map</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic void convertStringToUpperCaseStreams() {\n    List&lt;String&gt; collected = Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;hello&quot;) // Stream of String \n            .map(String::toUpperCase) // Returns a stream consisting of the results of applying the given function to the elements of this stream.\n            .collect(Collectors.toList());\n    assertEquals(asList(&quot;A&quot;, &quot;B&quot;, &quot;HELLO&quot;), collected);\n}\n</code></pre>\n<p>Nothing special in the first example, a <code>Function</code> is applied to return the <code>String</code> in uppercase.</p>\n<p>Second example making usage of <code>flatMap</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic void testflatMap() throws Exception {\n    List&lt;Integer&gt; together = Stream.of(asList(1, 2), asList(3, 4)) // Stream of List&lt;Integer&gt;\n            .flatMap(List::stream)\n            .map(integer -&gt; integer + 1)\n            .collect(Collectors.toList());\n    assertEquals(asList(2, 3, 4, 5), together);\n}\n</code></pre>\n<p>In the second example, a Stream of List is passed. <strong>It is NOT a Stream of Integer!</strong>\n<BR><em><strong>If a transformation Function has to be used (through map), then first the Stream has to be flattened to something else (a Stream of Integer).</strong></em>\n<BR>If <code>flatMap</code> is removed then the following error is returned: <strong>The operator + is undefined for the argument type(s) List, int.</strong>\n<BR>It is NOT possible to apply + 1 on a <code>List</code> of Integers!</p>\n"},{"comments":[{"comment_id":96245786,"body":"Nice diagrammatic explanation."},{"comment_id":111655166,"body":"@TechDog I appreciate your example. I was stuck trying to find how to split up lines into words and stream them."},{"comment_id":122454573,"body":"Thank you for your explanation based on practical examples with illustrations. It&#39;s very helpful for understanding."}],"answer_id":37120688,"body":"<p><strong><em>Please go through the post fully to get a clear idea,</em></strong></p>\n\n<p><strong>map vs flatMap:</strong></p>\n\n<p>To return a length  of each word from a list, we would do something like below..<br></p>\n\n<h2>Short Version given below</h2>\n\n<p><strong>When we collect two lists, given below</strong> </p>\n\n<p><strong><em>Without</strong> flat map</em> => <strong>[1,2],[1,1]</strong> => <strong>[[1,2],[1,1]]</strong> Here two lists are placed inside a list, so the output will be list containing lists</p>\n\n<p><strong><em>With</strong> flat map</em> => <strong>[1,2],[1,1]</strong> => <strong>[1,2,1,1]</strong> Here two lists are flattened and only the values are placed in list, so the output will be list containing only elements </p>\n\n<p><strong>Basically it merges all the objects in to one</strong></p>\n\n<p>## Detailed Version has been given below:-</p>\n\n<p><strong>For example:-</strong> <br>Consider a list <strong>[“STACK”, ”OOOVVVER”]</strong> and we are trying to return a list like <strong>[“STACKOVER”]</strong>(returning only unique letters from that list)\nInitially, we would do something like below to return a list  <strong>[“STACKOVER”]</strong>  from  <strong>[“STACK”, ”OOOVVVER”]</strong></p>\n\n<pre><code>public class WordMap {\n  public static void main(String[] args) {\n    List&lt;String&gt; lst = Arrays.asList(\"STACK\",\"OOOVER\");\n    lst.stream().map(w-&gt;w.split(\"\")).distinct().collect(Collectors.toList());\n  }\n}\n</code></pre>\n\n<p>Here the issue is, Lambda passed to the map method returns a String array for each word, So the stream returned by the map method is actually of type Stream, But what we need is Stream to represent a stream of characters, below image illustrates the problem.<br></p>\n\n<p><strong>Figure A:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/0GRsT.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/0GRsT.png\" alt=\"enter image description here\"></a></p>\n\n<p>You might think that, We can resolve this problem using flatmap,<br> OK, let us see how to solve this by using <em>map</em> and <em>Arrays.stream</em>\nFirst of all you gonna need a stream of characters instead of a stream of arrays. There is a method called Arrays.stream() that would take an array and produces a stream, for example:</p>\n\n<pre><code>String[] arrayOfWords = {\"STACK\", \"OOOVVVER\"};\nStream&lt;String&gt; streamOfWords = Arrays.stream(arrayOfWords);\nstreamOfWords.map(s-&gt;s.split(\"\")) //Converting word in to array of letters\n    .map(Arrays::stream).distinct() //Make array in to separate stream\n    .collect(Collectors.toList());\n</code></pre>\n\n<p>The above still does not work, because we now end up with a list of streams (more precisely, Stream>), Instead, we must first convert each word into an array of individual letters and then make each array into a separate stream</p>\n\n<p><strong>By using flatMap we should be able to fix this problem as below:</strong></p>\n\n<pre><code>String[] arrayOfWords = {\"STACK\", \"OOOVVVER\"};\nStream&lt;String&gt; streamOfWords = Arrays.stream(arrayOfWords);\nstreamOfWords.map(s-&gt;s.split(\"\")) //Converting word in to array of letters\n    .flatMap(Arrays::stream).distinct() //flattens each generated stream in to a single stream\n    .collect(Collectors.toList());\n</code></pre>\n\n<p>flatMap would perform mapping each array not with stream but with the contents of that stream. All of the individual streams that would get generated while using map(Arrays::stream) get merged into a single stream. Figure B illustrates the effect of using the flatMap method. Compare it with what map does in figure A.\n<strong>Figure B</strong>\n<a href=\"https://i.stack.imgur.com/yf3vz.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/yf3vz.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>The flatMap method lets you replace each value of a stream with another stream and then joins all the generated streams into a single stream.</strong></p>\n"},{"comments":[{"comment_id":71480743,"body":"could make a difference if you provide code instead of just provinding doc link"},{"comment_id":129564879,"body":"you type is incorrect right?   Set&lt;Student&gt; courses = studentList.stream().flatMap( e -&gt; e.getCourse().stream()).collect(Collectors.toSet());  should be a set of string here?"}],"answer_id":42157396,"body":"<p>Map:- \nThis method takes one Function as an argument and returns a new stream consisting of the results generated by applying the passed function to all the elements of the stream.</p>\n\n<p>Let's imagine, I have a list of integer values ( 1,2,3,4,5 ) and one function interface whose logic is square of the passed integer. ( e -> e * e ). </p>\n\n<pre><code>List&lt;Integer&gt; intList = Arrays.asList(1, 2, 3, 4, 5);\n\nList&lt;Integer&gt; newList = intList.stream().map( e -&gt; e * e ).collect(Collectors.toList());\n\nSystem.out.println(newList);\n</code></pre>\n\n<p>output:- </p>\n\n<pre><code>[1, 4, 9, 16, 25]\n</code></pre>\n\n<p>As you can see, an output is a new stream whose values are square of values of the input stream.</p>\n\n<pre><code>[1, 2, 3, 4, 5] -&gt; apply e -&gt; e * e -&gt; [ 1*1, 2*2, 3*3, 4*4, 5*5 ] -&gt; [1, 4, 9, 16, 25 ]\n</code></pre>\n\n<p><a href=\"http://codedestine.com/java-8-stream-map-method/\" rel=\"noreferrer\">http://codedestine.com/java-8-stream-map-method/</a></p>\n\n<p>FlatMap :- \nThis method takes one Function as an argument, this function accepts one parameter T as an input argument and returns one stream of parameter R as a return value. When this function is applied to each element of this stream, it produces a stream of new values. All the elements of these new streams generated by each element are then copied to a new stream, which will be a return value of this method. </p>\n\n<p>Let's image, I have a list of student objects, where each student can opt for multiple subjects.</p>\n\n<pre><code>List&lt;Student&gt; studentList = new ArrayList&lt;Student&gt;();\n\n  studentList.add(new Student(\"Robert\",\"5st grade\", Arrays.asList(new String[]{\"history\",\"math\",\"geography\"})));\n  studentList.add(new Student(\"Martin\",\"8st grade\", Arrays.asList(new String[]{\"economics\",\"biology\"})));\n  studentList.add(new Student(\"Robert\",\"9st grade\", Arrays.asList(new String[]{\"science\",\"math\"})));\n\n  Set&lt;Student&gt; courses = studentList.stream().flatMap( e -&gt; e.getCourse().stream()).collect(Collectors.toSet());\n\n  System.out.println(courses);\n</code></pre>\n\n<p>output:- </p>\n\n<pre><code>[economics, biology, geography, science, history, math]\n</code></pre>\n\n<p>As you can see, an output is a new stream whose values are a collection of all the elements of the streams return by each element of the input stream.</p>\n\n<p>[ S1 , S2 , S3 ]  ->\n[ {\"history\",\"math\",\"geography\"}, {\"economics\",\"biology\"}, {\"science\",\"math\"} ] -> take unique subjects ->\n[economics, biology, geography, science, history, math]</p>\n\n<p><a href=\"http://codedestine.com/java-8-stream-flatmap-method/\" rel=\"noreferrer\">http://codedestine.com/java-8-stream-flatmap-method/</a></p>\n"},{"comments":[{"comment_id":76045560,"body":"the question was about Stream.map and Stream.flatMap &amp; not about Optional.map anfd Optional.flatMap"},{"comment_id":76065956,"body":"But it helped me a lot to understand my problems with optional and flatmap, thanks a lot!"},{"comment_id":79582907,"body":"@djames, it&#39;s a perfectly valid answer, read it starting from paragraph &quot;With streams, the flatMap method takes a function as an argument...&quot; :)"},{"comment_id":90909100,"body":"flatMap() version also throws nullpointerexception if soundCard is null. So where&#39;s the promised benefit of Optional?"},{"comment_id":93762284,"body":"@Ekaterina, that&#39;s the pointer of working with <code>Optional</code>s, if the <code>getter</code>s return <code>Optional</code>s, then now <code>NullPointerException</code> will be thrown."}],"answer_id":42447211,"body":"<p>Oracle's article on Optional highlights this difference between map and flatmap: </p>\n\n<pre><code>String version = computer.map(Computer::getSoundcard)\n                  .map(Soundcard::getUSB)\n                  .map(USB::getVersion)\n                  .orElse(\"UNKNOWN\");\n</code></pre>\n\n<blockquote>\n  <p>Unfortunately, this code doesn't compile. Why? The variable computer\n  is of type <code>Optional&lt;Computer&gt;</code>, so it is perfectly correct to call the\n  map method. However, getSoundcard() returns an object of type\n  Optional. This means the result of the map operation is an\n  object of type <code>Optional&lt;Optional&lt;Soundcard&gt;&gt;</code>. As a result, the call to\n  getUSB() is invalid because the outermost Optional contains as its\n  value another Optional, which of course doesn't support the getUSB()\n  method.</p>\n  \n  <p>With streams, the flatMap method takes a function as an argument,\n  which returns another stream. This function is applied to each element\n  of a stream, which would result in a stream of streams. However,\n  flatMap has the effect of replacing each generated stream by the\n  contents of that stream. In other words, all the separate streams that\n  are generated by the function get amalgamated or \"flattened\" into one\n  single stream. What we want here is something similar, but <strong>we want to\n  \"flatten\" a two-level Optional into one</strong>.</p>\n  \n  <p>Optional also supports a flatMap method. Its purpose is to apply\n  the transformation function on the value of an Optional (just like the map\n  operation does) and then <strong>flatten the resulting two-level Optional into\n  a single one</strong>.</p>\n  \n  <p>So, to make our code correct, we need to rewrite it as follows using\n  flatMap:</p>\n</blockquote>\n\n<pre><code>String version = computer.flatMap(Computer::getSoundcard)\n                   .flatMap(Soundcard::getUSB)\n                   .map(USB::getVersion)\n                   .orElse(\"UNKNOWN\");\n</code></pre>\n\n<blockquote>\n  <p>The first flatMap ensures that an <code>Optional&lt;Soundcard&gt;</code> is returned\n  instead of an <code>Optional&lt;Optional&lt;Soundcard&gt;&gt;</code>, and the second flatMap\n  achieves the same purpose to return an <code>Optional&lt;USB&gt;</code>. Note that the\n  third call just needs to be a map() because getVersion() returns a\n  String rather than an Optional object.</p>\n</blockquote>\n\n<p><a href=\"http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html\" rel=\"noreferrer\">http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html</a></p>\n"},{"answer_id":44535287,"body":"<p>Also good analogy can be with C# if you familiar with. Basically C# <code>Select</code> similar to java <code>map</code> and C# <code>SelectMany</code> java <code>flatMap</code>. Same applies to Kotlin for collections.</p>\n"},{"comments":[{"comment_id":85529886,"body":"sorry but the 2nd snippet from point 1 is not compiling instead of  <code>List&lt;Integer&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))   .flatMap(i -&gt; i)   .collect(Collectors.toList());</code> . It is should be <code>Stream.of(Arrays.asList(1), Arrays.asList(2, 3)) \t\t\t\t  .flatMap(List::stream) \t\t\t\t  .collect(Collectors.toList());</code>"},{"comment_id":85546014,"body":"@arthur I think I used Vavr&#39;s Stream and List here - but I agree that it might be confusing a bit - I will change that to standard Java"},{"comment_id":91445270,"body":"@GrzegorzPiwowarek  <a href=\"https://stackoverflow.com/a/52248643/1059372\">how about this simple explanation</a> ?"}],"answer_id":45310257,"body":"<p>I have a feeling that most answers here overcomplicate the simple problem. If you already understand how the <code>map</code> works that should be fairly easy to grasp.</p>\n\n<p>There are cases where we can end up with unwanted nested structures when using <code>map()</code>, the <code>flatMap()</code> method is designed to overcome this by avoiding wrapping.</p>\n\n<hr>\n\n<p>Examples:</p>\n\n<h1>1</h1>\n\n<pre><code>List&lt;List&lt;Integer&gt;&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\n  .collect(Collectors.toList());\n</code></pre>\n\n<p>We can avoid having nested lists by using <code>flatMap</code>:</p>\n\n<pre><code>List&lt;Integer&gt; result = Stream.of(Arrays.asList(1), Arrays.asList(2, 3))\n  .flatMap(i -&gt; i.stream())\n  .collect(Collectors.toList());\n</code></pre>\n\n<h1>2</h1>\n\n<pre><code>Optional&lt;Optional&lt;String&gt;&gt; result = Optional.of(42)\n      .map(id -&gt; findById(id));\n\nOptional&lt;String&gt; result = Optional.of(42)\n      .flatMap(id -&gt; findById(id));\n</code></pre>\n\n<p>where:</p>\n\n<pre><code>private Optional&lt;String&gt; findById(Integer id)\n</code></pre>\n"},{"answer_id":46627214,"body":"<p>for a Map we have a list of elements and a (function,action) f so :</p>\n\n<pre><code>[a,b,c] f(x) =&gt; [f(a),f(b),f(c)]\n</code></pre>\n\n<p>and for the flat map we have a list of elements list and we have a (function,action) f and we want the result to be flattened :</p>\n\n<pre><code>[[a,b],[c,d,e]] f(x) =&gt;[f(a),f(b),f(c),f(d),f(e)]\n</code></pre>\n"},{"comments":[{"comment_id":91445260,"body":"<a href=\"https://stackoverflow.com/a/52248643/1059372\">how about this simple explanation</a> ?"}],"answer_id":46969926,"body":"<p>This is very confusing for beginners. The basic difference is <code>map</code> emits one item for each entry in the list and <code>flatMap</code> is basically a <code>map</code> + <code>flatten</code> operation. To be more clear, use flatMap when you require more than one value, eg when you are expecting a loop to return arrays, flatMap will be really helpful in this case.</p>\n\n<p>I have written a blog about this, you can check it out <a href=\"https://blog.expert-talks.in/rx-java/difference-between-map-and-flatmap-rxjava/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"},{"answer_id":49297863,"body":"<p><strong>map() and flatMap()</strong></p>\n<ol>\n<li><code>map()</code></li>\n</ol>\n<p>Just takes a Function &lt;T, R&gt; a lambda param where T is element and R the return element built using T. At the end we'll have a Stream with objects of Type R. A simple example can be:</p>\n<pre><code>Stream\n  .of(1,2,3,4,5)\n  .map(myInt -&gt; &quot;preFix_&quot;+myInt)\n  .forEach(System.out::println);\n</code></pre>\n<p>It simply takes elements 1 to 5 of Type <code>Integer</code>, uses each element to build a new element from type <code>String</code> with value <code>&quot;prefix_&quot;+integer_value</code> and prints it out.</p>\n<ol start=\"2\">\n<li><code>flatMap()</code></li>\n</ol>\n<p>It is useful to know that flatMap() takes a function <code>F&lt;T, R&gt;</code> where</p>\n<ul>\n<li><p>T is a type from <em>which a Stream can be built from/with</em>. It can be a List (T.stream()), an array (Arrays.stream(someArray)), etc.. anything that from which a Stream can be with/or form. in the example below each dev has many languages, so dev. Languages is a List and will use a lambda parameter.</p>\n</li>\n<li><p>R is the resulting Stream that will be built using T. Knowing that we have many instances of T, we will naturally have many Streams from R. All these Streams from Type R will <strong>now be combined into one</strong> single 'flat' Stream from Type R.</p>\n</li>\n</ul>\n<p><strong>Example</strong></p>\n<p>The examples of Bachiri Taoufiq  [see its answer here] <a href=\"https://stackoverflow.com/a/46627214/755401\">1</a> are simple and easy to understanding. Just for clarity, let just say we have a team of developers:</p>\n<pre><code>dev_team = {dev_1,dev_2,dev_3}\n</code></pre>\n<p>, with each developer knowing  many languages:</p>\n<pre><code>dev_1 = {lang_a,lang_b,lang_c},\ndev_2 = {lang_d},\ndev_3 = {lang_e,lang_f}\n</code></pre>\n<p>Applying  <em>Stream.map()</em> on dev_team to get the languages of each dev:</p>\n<pre><code>dev_team.map(dev -&gt; dev.getLanguages())\n</code></pre>\n<p>will give you this structure:</p>\n<pre><code>{ \n  {lang_a,lang_b,lang_c},\n  {lang_d},\n  {lang_e,lang_f}\n}\n</code></pre>\n<p>which is basically a <code>List&lt;List&lt;Languages&gt;&gt; /Object[Languages[]]</code>. Not so very pretty, nor Java8-like!!</p>\n<p>with <code>Stream.flatMap()</code> you can 'flatten' things out as it takes the above structure<br />\nand turns it into <code>{lang_a, lang_b, lang_c, lang_d, lang_e, lang_f}</code>, which can basically used as <code>List&lt;Languages&gt;/Language[]/etc</code>...</p>\n<p>so in the end, your code would make more sense like this:</p>\n<pre><code>dev_team\n   .stream()    /* {dev_1,dev_2,dev_3} */\n   .map(dev -&gt; dev.getLanguages()) /* {{lang_a,...,lang_c},{lang_d}{lang_e,lang_f}}} */\n   .flatMap(languages -&gt;  languages.stream()) /* {lang_a,...,lang_d, lang_e, lang_f} */\n   .doWhateverWithYourNewStreamHere();\n</code></pre>\n<p>or simply:</p>\n<pre><code>dev_team\n       .stream()    /* {dev_1,dev_2,dev_3} */\n       .flatMap(dev -&gt; dev.getLanguages().stream()) /* {lang_a,...,lang_d, lang_e, lang_f} */\n       .doWhateverWithYourNewStreamHere();\n</code></pre>\n<p><strong>When to use map() and use flatMap()</strong>:</p>\n<ul>\n<li><p>Use <code>map()</code> when each element of type T from your stream is supposed to be mapped/transformed to a <em>single</em> element of type R. The result is a mapping of type <em>(1 start element -&gt; 1 end element)</em> and new stream of elements of type R is returned.</p>\n</li>\n<li><p>Use <code>flatMap()</code> when each element of type T from your stream is supposed to mapped/transformed to a <em>Collections</em> of elements of type R. The result is a mapping of type <em>(1 start element -&gt; n end elements)</em>. These Collections are then <em>merged</em> (or <em>flattened</em>) to a new stream of elements of type R. This is useful for example to represent <strong>nested loops</strong>.</p>\n</li>\n</ul>\n<p>Pre Java 8:</p>\n<pre><code>List&lt;Foo&gt; myFoos = new ArrayList&lt;Foo&gt;();\n    for(Foo foo: myFoos){\n        for(Bar bar:  foo.getMyBars()){\n            System.out.println(bar.getMyName());\n        }\n    }\n</code></pre>\n<p>Post Java 8</p>\n<pre><code>myFoos\n    .stream()\n    .flatMap(foo -&gt; foo.getMyBars().stream())\n    .forEach(bar -&gt; System.out.println(bar.getMyName()));\n</code></pre>\n"},{"answer_id":51278088,"body":"<p>Stream operations <code>flatMap</code> and <code>map</code> accept a function as input. </p>\n\n<p><code>flatMap</code> expects the function to return a new stream for each element of the stream and returns a stream which combines all the elements of the streams returned by the function for each element. In other words, with <code>flatMap</code>, for each element from the source, multiple elements will be created by the function. <a href=\"http://www.zoftino.com/java-stream-examples#flatmap-operation\" rel=\"nofollow noreferrer\">http://www.zoftino.com/java-stream-examples#flatmap-operation</a></p>\n\n<p><code>map</code> expects the function to return a transformed value and returns a new stream containing the transformed elements. In other words, with <code>map</code>, for each element from the source, one transformed element will be created by the function.\n<a href=\"http://www.zoftino.com/java-stream-examples#map-operation\" rel=\"nofollow noreferrer\">http://www.zoftino.com/java-stream-examples#map-operation</a></p>\n"},{"comments":[{"comment_id":97762313,"body":"Very crisp example.., Wouldn&#39;t take more than few secs to understand the concept with your example..."},{"comment_id":118894318,"body":"Thanks for mentioning that Optional&lt;Optional&lt;T&gt;&gt;  to Optional&lt;T&gt;. Otherwise, it would&#39;ve been answer by me!"}],"answer_id":51360374,"body":"<p><strong>One line answer: <code>flatMap</code> helps to flatten a <code>Collection&lt;Collection&lt;T&gt;&gt;</code> into a <code>Collection&lt;T&gt;</code></strong>. In the same way, it will also flatten an <strong><code>Optional&lt;Optional&lt;T&gt;&gt;</code></strong> into <strong><code>Optional&lt;T&gt;</code></strong>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7e1tY.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/7e1tY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, with <strong><code>map()</code></strong> only:</p>\n\n<ul>\n<li>The intermediate type is <code>Stream&lt;List&lt;Item&gt;&gt;</code></li>\n<li>The return type is <code>List&lt;List&lt;Item&gt;&gt;</code></li>\n</ul>\n\n<p>and with <strong><code>flatMap()</code></strong>:</p>\n\n<ul>\n<li>The intermediate type is <code>Stream&lt;Item&gt;</code></li>\n<li>The return type is <code>List&lt;Item&gt;</code></li>\n</ul>\n\n<p>This is the <strong>test result</strong> from the code used right below: </p>\n\n<pre><code>-------- Without flatMap() -------------------------------\n     collect() returns: [[Laptop, Phone], [Mouse, Keyboard]]\n\n-------- With flatMap() ----------------------------------\n     collect() returns: [Laptop, Phone, Mouse, Keyboard]\n</code></pre>\n\n<p><strong>Code used</strong>:</p>\n\n<pre><code>import java.util.Arrays;\nimport java.util.Collection;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\npublic class Parcel {\n  String name;\n  List&lt;String&gt; items;\n\n  public Parcel(String name, String... items) {\n    this.name = name;\n    this.items = Arrays.asList(items);\n  }\n\n  public List&lt;String&gt; getItems() {\n    return items;\n  }\n\n  public static void main(String[] args) {\n    Parcel amazon = new Parcel(\"amazon\", \"Laptop\", \"Phone\");\n    Parcel ebay = new Parcel(\"ebay\", \"Mouse\", \"Keyboard\");\n    List&lt;Parcel&gt; parcels = Arrays.asList(amazon, ebay);\n\n    System.out.println(\"-------- Without flatMap() ---------------------------\");\n    List&lt;List&lt;String&gt;&gt; mapReturn = parcels.stream()\n      .map(Parcel::getItems)\n      .collect(Collectors.toList());\n    System.out.println(\"\\t collect() returns: \" + mapReturn);\n\n    System.out.println(\"\\n-------- With flatMap() ------------------------------\");\n    List&lt;String&gt; flatMapReturn = parcels.stream()\n      .map(Parcel::getItems)\n      .flatMap(Collection::stream)\n      .collect(Collectors.toList());\n    System.out.println(\"\\t collect() returns: \" + flatMapReturn);\n  }\n}\n</code></pre>\n"},{"comments":[{"comment_id":94346347,"body":"For the <code>flatMap</code> case, do you first collect the seeds from each apple in separate bags, one bag per apple, before you pour all of the bags into a single bag?"},{"comment_id":94346483,"body":"@DerekMahar it used to be a poor into a single bag before java-10, meaning <code>flatmap</code> was not really lazy, but since java-10 it is lazy"},{"comment_id":98237414,"body":"@Eugene please explain a little more lazy concept which you are trying to explain not clear to me.i understood what derkerMahar explained in comment is it that what happening before java10?"},{"comment_id":100553801,"body":"@JAVA just search <code>flatMap + lazy</code>, I bet there will be some answers."},{"comment_id":107099884,"body":"@Eugene - The flatMap will take one apple at a time, extract its seeds and throw it into a bag/collection/array until all the apples seeds have been extracted. Right ? Is that how streams work ?"},{"comment_id":107099988,"body":"@MasterJoe2 it depends on the java version, really."},{"comment_id":107109384,"body":"@MasterJoe2 it seems like you have a specific question in mind, why not post it?"},{"comment_id":107124872,"body":"@Eugene - I have posted it here <a href=\"https://stackoverflow.com/questions/60539486/is-my-understanding-of-java-stream-flatmap-correct\" title=\"is my understanding of java stream flatmap correct\">stackoverflow.com/questions/60539486/&hellip;</a>"},{"comment_id":111641242,"body":"@Eugene I don&#39;t understand. seeds are different from juice. As I understand, flat map is supposed to reduce multiple streams to a single stream. I wonder if your analogy is incorrect."}],"answer_id":52248643,"body":"<p>I am not very sure I am supposed to answer this, but every time I face someone that does not understand this, I use the same example. </p>\n\n<p>Imagine you have an apple. A <code>map</code> is transforming that apple to <code>apple-juice</code> for example or a <em>one-to-one</em> mapping. </p>\n\n<p>Take that same apple and get only the seeds out of it, that is what <code>flatMap</code> does, or a <em>one to many</em>, one apple as input, many seeds as output. </p>\n"},{"answer_id":52484577,"body":"<p><code>flatMap()</code> also takes advantage of partial lazy evaluation of streams. It will read the fist stream and only when required, will go to the next stream. The behaviour is explained in detail here: <a href=\"https://stackoverflow.com/questions/46288915/is-flatmap-guaranteed-to-be-lazy\">Is flatMap guaranteed to be lazy?</a></p>\n"},{"answer_id":55185129,"body":"<p>Simple answer.</p>\n\n<p>The <code>map</code> operation can produce a <code>Stream</code> of <code>Stream</code>.EX <code>Stream&lt;Stream&lt;Integer&gt;&gt;</code></p>\n\n<p><code>flatMap</code> operation will only produce <code>Stream</code> of something. EX <code>Stream&lt;Integer&gt;</code></p>\n"},{"answer_id":59105341,"body":"<p>If you think <code>map()</code> as an iteration(one level <code>for</code> loop), <code>flatmap()</code> is a two-level iteration(like a nested <code>for</code> loop). (Enter each iterated element <code>foo</code>, and do <code>foo.getBarList()</code> and iterate in that <code>barList</code> again)</p>\n\n<hr>\n\n<p><code>map()</code>: take a stream, do something to every element, collect the single result of every process, output another stream. The definition of \"do something function\" is implicit. If the processment of any element results in <code>null</code>, <code>null</code> is used to compose the final stream. So, the number of elements in the resulting stream will be equal to number of input stream.</p>\n\n<p><code>flatmap()</code>: take a stream of <em>elements/streams</em> and a function(explicit definition), apply the function to each element of each stream, and collect all the intermediate resulting stream to be a greater stream(\"flattening\"). If the processment of any element results in <code>null</code>, empty stream is provided to the final step of \"flattening\". The number of elements in the resulting stream, is the total of all participating elements in all inputs, if the input is several streams. </p>\n"},{"comments":[{"comment_id":125827955,"body":"just replace with toCharArray and make your post shorter."}],"answer_id":59834135,"body":"<h2><strong>.map</strong> is for <em><strong><code>A -&gt; B</code></strong></em> mapping</h2>\n<pre><code>Stream.of(&quot;dog&quot;, &quot;cat&quot;)              // stream of 2 Strings\n    .map(s -&gt; s.length())            // stream of 2 Integers: [3, 3]\n</code></pre>\n<p><em>it converts any item <code>A</code> to any item <code>B</code>. <a href=\"https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/stream/Stream.html#map(java.util.function.Function)\" rel=\"noreferrer\">Javadoc</a></em></p>\n<hr />\n<h2><strong>.flatMap</strong> is for <em><strong><code>A -&gt; Stream&lt; B&gt;</code></strong></em> concatinating</h2>\n<pre><code>Stream.of(&quot;dog&quot;, &quot;cat&quot;)             // stream of 2 Strings\n    .flatMapToInt(s -&gt; s.chars())   // stream of 6 ints:      [d, o, g, c, a, t]\n</code></pre>\n<p><em>it --1 converts any item <code>A</code> into <code>Stream&lt; B&gt;</code>, then --2 concatenates all the streams into one (flat) stream. <a href=\"https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/stream/Stream.html#flatMap(java.util.function.Function)\" rel=\"noreferrer\">Javadoc</a></em></p>\n<hr />\n<p>Note 1: Although the latter example flats to a stream of primitives (IntStream) instead of a stream of objects (Stream), it still illustrates the idea of the <code>.flatMap</code>.</p>\n<p>Note 2: Despite the name, String.chars() method returns ints. So the actual collection will be: <code>[100, 111, 103, 99, 97, 116]</code>\n, where <code>100</code> is the code of <code>'d'</code>, <code>111</code> is the code of <code>'o'</code> etc. Again, for illustrative purposes, it's presented as [d, o, g, c, a, t].</p>\n"},{"answer_id":70585039,"body":"<p>By reading all the messages, the simple way to understand is :</p>\n<ul>\n<li>use <code>map</code> if you have a <code>flat</code> list of elements: [0, 1, 2, 3, 4, 5]</li>\n<li>use <code>flatMap</code> if you have a list of list of elements: [[1, 3, 5], [2, 4, 6]]. This means that, your list need to be <strong>flattened</strong> before the <strong>map</strong> operation can be applied to each elements</li>\n</ul>\n"},{"answer_id":74329177,"body":"<p>map() takes a Stream and transform it to another Stream. It applies a function on each element of Stream and store return value into new Stream. It does not flatten the stream. But flatMap() is the combination of a map and a flat operation i.e, it applies a function to elements as well as flatten them.\n2) map() is used for transformation only, but flatMap() is used for both transformation and flattening.\nplease read more here.\n<a href=\"https://javaint4bytes.blogspot.com/2022/11/stream-flatmap-in-java-with-examples.html\" rel=\"nofollow noreferrer\">https://javaint4bytes.blogspot.com/2022/11/stream-flatmap-in-java-with-examples.html</a></p>\n"},{"answer_id":76314417,"body":"<p>Definitions of these Stream API methods:</p>\n<p><strong>map</strong>(Function mapper) is an intermediate operation which returns a stream consisting of the results of applying the given function to the elements of this stream.</p>\n<p><strong>flatMap</strong>(Function mapper) is an intermediate operation which returns a stream consisting of the results of replacing each element of this stream with the contents of a mapped stream produced by applying the provided mapping function to each element. In short, it is used to convert a Stream of Stream into a list of values.</p>\n<p>Take a look at example:</p>\n<pre><code>List&lt;String&gt; myList = Stream.of(&quot;Apple&quot;, &quot;Orange&quot;)\n       .map(String::toUpperCase)\n       .collect(Collectors.toList());\nSystem.out.println(myList);\n</code></pre>\n<p>It prints: <code>[APPLE, ORANGE]</code></p>\n<p>Can we just change <code>map()</code> to <code>flatMap()</code>?</p>\n<pre><code>List&lt;String&gt; myListFlat = Stream.of(&quot;Apple&quot;, &quot;Orange&quot;)\n       .flatMap(String::toUpperCase)\n       .collect(Collectors.toList());\nSystem.out.println(myListFlat);\n</code></pre>\n<p>No, we can see an error now:</p>\n<pre><code>java: incompatible types: cannot infer type-variable(s) R\n    (argument mismatch; bad return type in method reference\n      java.lang.String cannot be converted to java.util.stream.Stream&lt;? extends R&gt;)\n</code></pre>\n<p>Why is that? Take a look at methods signatures:</p>\n<pre><code>&lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);\n&lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);\n</code></pre>\n<p>The reason why the code doesn’t work is that the <code>flatMap()</code> method expects a function that returns a Stream. In second example, I am passing a method reference to <code>String.toUpperCase()</code> which returns a String. Therefore, I am trying to apply <code>flatMap()</code> on a Stream of characters instead of a Stream of Strings.</p>\n<p>Ok, so now we can have an idea for what <code>flatMap()</code> is used.\nLet's build a list of lists:</p>\n<pre><code>List&lt;List&lt;String&gt;&gt; list = Arrays.asList(\n            Arrays.asList(&quot;Apple&quot;),\n            Arrays.asList(&quot;Orange&quot;));\nSystem.out.println(list);\n</code></pre>\n<p>and it prints: <code>[[Apple], [Orange]]</code>. If we want to have it flatten let's use <code>flatMap()</code>:</p>\n<pre><code>List&lt;String&gt; flattedList = list\n                .stream()\n                .flatMap(Collection::stream)\n                .collect(Collectors.toList());\n\nSystem.out.println(flattedList);\n</code></pre>\n<p>and now it prints: <code>[Apple, Orange]</code></p>\n<p>Sources:\n<a href=\"https://www.geeksforgeeks.org/stream-flatmap-java-examples/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/stream-flatmap-java-examples/</a></p>\n<p><a href=\"https://www.javatpoint.com/flatmap-method-in-java-8\" rel=\"nofollow noreferrer\">https://www.javatpoint.com/flatmap-method-in-java-8</a></p>\n<p><a href=\"https://www.baeldung.com/java-difference-map-and-flatmap\" rel=\"nofollow noreferrer\">https://www.baeldung.com/java-difference-map-and-flatmap</a></p>\n"}],"last_activity_date":1684842529,"question_id":26684562,"body":"<p>In Java 8, what's the difference between <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#map-java.util.function.Function-\" rel=\"noreferrer\"><code>Stream.map()</code></a> and <a href=\"http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#flatMap-java.util.function.Function-\" rel=\"noreferrer\"><code>Stream.flatMap()</code></a> methods?</p>\n"},{"comments":[{"comment_id":134573824,"body":"Have you checked the <a href=\"https://github.com/vladmihalcea/hypersistence-utils/blob/20e64bb04257364db3446148d7ad6fe8739579a6/hypersistence-utils-hibernate-62/src/main/java/io/hypersistence/utils/hibernate/query/SQLExtractor.java\" rel=\"nofollow noreferrer\"><code>SQLExtractor</code></a> from <a href=\"https://vladmihalcea.com/get-sql-from-jpql-or-criteria/\" rel=\"nofollow noreferrer\">this article</a>? It has a hibernate 6 as well as 6.2 version."}],"last_activity_date":1684842482,"question_id":76314412,"body":"<p>I'd like to get the sql string from a <a href=\"https://jakarta.ee/specifications/persistence/2.2/apidocs/javax/persistence/criteria/criteriaquery\" rel=\"nofollow noreferrer\">CriteriaQuery</a> using Hibernate 6.</p>\n<ul>\n<li><a href=\"https://docs.jboss.org/hibernate/orm/6.0/javadocs/org/hibernate/query/Query.html#getQueryString()\" rel=\"nofollow noreferrer\">Query.getQueryString()</a> does no longer work in Hibernate 6 for <code>CriteriaQuery</code>.</li>\n<li><a href=\"https://stackoverflow.com/questions/554481/how-to-get-sql-from-hibernate-criteria-api-not-for-logging#3888873\">How to get SQL from Hibernate Criteria API (*not* for logging)</a> only works for hibernate versions up to 5.</li>\n<li>logging the sql statements is not enough in my use case. I need to store them in a string for processing.</li>\n</ul>\n<p>Any ideas?</p>\n"},{"last_activity_date":1684842403,"question_id":76314403,"body":"<p>I want to open my app on android boot in Android api 31 or above.</p>\n<p>I have a bootbroadcast reciever and it successfully received the broadcast.\nBut it does not open my app.</p>\n<p>Here is AndroidManifest\nI add queries for my app to be open.</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n\n    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;/&gt;\n    &lt;uses-permission android:name=&quot;android.permission.REQUEST_BACKGROUND_LOCATION&quot; /&gt;\n\n    &lt;queries&gt;\n        &lt;package android:name=&quot;com.example.bootopen&quot; /&gt;\n    &lt;/queries&gt;\n\n    &lt;application\n        android:allowBackup=&quot;true&quot;\n        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;\n        android:fullBackupContent=&quot;@xml/backup_rules&quot;\n        android:icon=&quot;@mipmap/ic_launcher&quot;\n        android:label=&quot;@string/app_name&quot;\n        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;\n        android:supportsRtl=&quot;true&quot;\n        android:theme=&quot;@style/Theme.bootopen&quot;\n        tools:targetApi=&quot;31&quot;&gt;\n        &lt;activity\n            android:name=&quot;.MainActivity&quot;\n            android:exported=&quot;true&quot;\n            android:enabled=&quot;true&quot;&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;\n\n                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;\n            &lt;/intent-filter&gt;\n            &lt;meta-data\n                android:name=&quot;android.app.lib_name&quot;\n                android:value=&quot;&quot; /&gt;\n        &lt;/activity&gt;\n\n        &lt;receiver android:name=&quot;.BootReceiver&quot;\n            android:exported=&quot;false&quot; &gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;android.intent.action.BOOT_COMPLETED&quot; /&gt;\n                &lt;action android:name=&quot;android.intent.action.REBOOT&quot; /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/receiver&gt;\n\n    &lt;/application&gt;\n\n&lt;/manifest&gt;\n\n</code></pre>\n<p>Here is BootReceiver\nBy using i checked boot completed or not and i got boot completed log.\nI use intent flags.</p>\n<pre><code>public class BootReceiver extends BroadcastReceiver {\n    @Override\n    public void onReceive(Context context, Intent intent) {\n        if((intent.getAction() == Intent.ACTION_BOOT_COMPLETED) || (intent.getAction() == Intent.ACTION_REBOOT)) {\n            Log.v(&quot;Tag&quot;,&quot;Boot Completed&quot;);\n            Intent openIntent = context.getPackageManager().getLaunchIntentForPackage(&quot;com.example.bootopen&quot;);\n            openIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_NEW_DOCUMENT);\n            context.startActivity(openIntent);\n        }\n    }\n}\n</code></pre>\n<p>I wanna open my app after boot</p>\n"},{"last_activity_date":1684842307,"question_id":76314389,"body":"<p>I added dependency to use ffmpeg on Android.</p>\n<pre><code>implementation &quot;com.arthenica:mobile-ffmpeg-full:4.4&quot;\n</code></pre>\n<p>And I wanted to combine the videos from the gallery, so I temporarily saved the imported video in the cache directory in the app.</p>\n<p>After that, I wrote the following function to take the saved images and merge them using ffmpeg:</p>\n<pre><code>\nfun mergeVideos(videoPaths: List\\&lt;String\\&gt;): Int {\n        val cacheDirectory = this.externalCacheDir\n        mergedVideoFile = File(cacheDirectory, &quot;merged_video.mp4&quot;).absolutePath\n\n        val command = StringBuilder()\n        command.append(&quot;ffmpeg&quot;)\n        for (videoPath in videoPaths) {\n            command.append(&quot; -i &quot;).append(videoPath)\n        }\n\n        command.append(&quot; -filter_complex &quot;).append(&quot;\\&quot;&quot;)\n        for (i in videoPaths.indices) {\n            command.append(&quot;[$i:v] &quot;).append(&quot;[$i:a] &quot;)\n        }\n\n        command.append(&quot;concat=n=&quot;).append(videoPaths.size).append(&quot;:v=1:a=1 [v] [a]&quot;).append(&quot;\\&quot;&quot;)\n        command.append(&quot; -map \\&quot;[v]\\&quot; -map \\&quot;[a]\\&quot; &quot;).append(mergedVideoFile)\n    \n        return FFmpeg.execute(command.toString())\n    }\n</code></pre>\n<p>I wanted to temporarily save the merged video in the &quot;mergedVideoFile&quot; so that I could save them in the cache directory, and videoPaths would get the Urls of the videos I wanted to merge into the list.</p>\n<p>The command verified through Log.d :</p>\n<pre><code>\nffmpeg -i /storage/emulated/0/Android/data/&quot;project name&quot;/files/Movies/VIDEO1.mp4 -i /storage/emulated/0/Android/data/&quot;project name&quot;/files/Movies/VIDEO2.mp4 -filter_complex &quot;\\[0:v\\] \\[0:a\\] \\[1:v\\] \\[1:a\\] concat=n=2:v=1:a=1 \\[v\\] \\[a\\]&quot; -map &quot;\\[v\\]&quot; -map &quot;\\[a\\]&quot; /storage/emulated/0/Android/data/&quot;project name&quot;/cache/merged_video.mp4\n</code></pre>\n<p>result of mergeVideos execution:</p>\n<pre><code>\nLoading mobile-ffmpeg.\nLoaded mobile-ffmpeg-full-arm64-v8a-4.4-20210207.\nCallback thread started.\nffmpeg version v4.4-dev-416\nCopyright (c) 2000-2020 the FFmpeg developers\nbuilt with Android (6454773 based on r365631c2) clang version 9.0.8 (https://android.googlesource.com/toolchain/llvm-project 98c855489587874b2a325e7a516b99d838599c6f) (based on LLVM 9.0.8svn)\n\nconfiguration: --cross-prefix=aarch64-linux-android- --sysroot=/files/android-sdk/ndk/21.3.6528147/toolchains/llvm/prebuilt/linux-x86_64/sysroot --prefix=/home/taner/Projects/mobile-ffmpeg/prebuilt/android-arm64/ffmpeg --pkg-config=/usr/bin/pkg-config --enable-version3 --arch=aarch64 --cpu=armv8-a --cc=aarch64-linux-android24-clang --cxx=aarch64-linux-android24-clang++ --extra-libs='-L/home/taner/Projects/mobile-ffmpeg/prebuilt/android-arm64/cpu-features/lib -lndk_compat' --target-os=android --enable-neon --enable-asm --enable-inline-asm --enable-cross-compile --enable-pic --enable-jni --enable-optimizations --enable-swscale --enable-shared --enable-v4l2-m2m --disable-outdev=fbdev --disable-indev=fbdev --enable-small --disable-openssl --disable-xmm-clobber-test --disable-debug --enable-lto --disable-neon-clobber-test --disable-programs --disable-postproc --disable-doc --disable-htmlpages --disable-manpages --disable-podpages --disable-txtpages --disable-static --disable-sndio --disable-schannel --disable-securetransport --disable-xlib --disable-cuda --disable-cuvid --disable-nvenc --disable-vaapi --disable-vdpau --disable-videotoolbox --disable-audiotoolbox --disable-appkit --disable-alsa --disable-cuda --disable-cuvid --disable-nvenc --disable-vaapi --disable-vdpau --enable-libfontconfig --enable-libfreetype --enable-libfribidi --enable-gmp --enable-gnutls --enable-libmp3lame --enable-libass --enable-iconv --enable-libtheora --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libxml2 --enable-libopencore-amrnb --enable-libshine --enable-libspeex --enable-libwavpack --enable-libkvazaar --enable-libilbc --enable-libopus --enable-libsnappy --enable-libsoxr --enable-libaom --enable-libtwolame --disable-sdl2 --enable-libvo-amrwbenc --enable-zlib --enable-mediacodec\n\nlibavutil      56. 55.100 / 56. 55.100\nlibavcodec     58. 96.100 / 58. 96.100\nlibavformat    58. 48.100 / 58. 48.100\nlibavdevice    58. 11.101 / 58. 11.101\nlibavfilter     7. 87.100 /  7. 87.100\nlibswscale      5.  8.100 /  5.  8.100\nlibswresample   3.  8.100 /  3.  8.100\n\nInput #0, mov,mp4,m4a,3gp,3g2,mj2, from '/storage/emulated/0/Android/data/&quot;project name&quot;/files/Movies/VIDEO1.mp4':\n\nMetadata:\nmajor_brand     :   mp42\nminor_version   :   0\ncompatible_brands:  isommp42\ncreation_time   :   2023-05-02T12:22:45.000000Z\ncom.android.version:  11\ncom.android.capture.fps:  30.000000\nDuration:  00:00:02.51  , start:   0.000000  , bitrate:  14232 kb/s\n\n      Stream #0:0\n\n(eng)\n: Video: h264 (avc1 / 0x31637661), yuv420p(tv, bt709), 1920x1080, 14022 kb/s\n, SAR 1:1 DAR 16:9 ,  30 fps, 30 tbr,  90k tbn,  180k tbc   (default)\n\nMetadata:\nrotate          :  90\ncreation_time   : 2023-05-02T12:22:45.000000Z\nhandler_name    :  VideoHandle\nSide data:\ndisplaymatrix: rotation of -90.00 degrees\n\n      Stream #0:1\n\n(eng)\n: Audio: aac (mp4a / 0x6134706D), 48000 Hz, stereo, fltp, 256 kb/s   (default)\n\n     Metadata:\n        creation_time   :   2023-05-02T12:22:45.000000Z\n        handler_name    :   SoundHandle\n\nInput #1, mov,mp4,m4a,3gp,3g2,mj2, from '/storage/emulated/0/Android/data/&quot;project name&quot;/files/Movies/VIDEO2.mp4':\n\n... Input #1's video metadatas ...\n\n\\[NULL @ 0x78367662e0\\] Unable to find a suitable output format for 'ffmpeg'\nffmpeg: Invalid argument\n</code></pre>\n<p>I don't know what is the problem in my code.\nPlease help me.</p>\n"},{"last_activity_date":1684842224,"question_id":73925061,"body":"<p>I’ve made a new installation of WSO2 API Manager 4.1.0 “all in one” + reverse proxy (Apache) on Windows.\nI’ve configured the keystores with CA-signed TLS-cert and the default wso2 self-signed for internal. Tried different alternatives for primary (none, default/self-signed, CA-signed)\nI’ve configured the server.hostname with the name of the proxy server.</p>\n<p>When I start the server I’ve got lots of error messages like:</p>\n<p>Error deploying APIs to the Gateway org.wso2.carbon.apimgt.impl.gatewayartifactsynchronizer.exception.ArtifactSynchronizerException: Error while executing the http client\nCaused by: javax.net.ssl.SSLPeerUnverifiedException: Certificate for  doesn't match any of the subject alternative names: [*.xxx.xx, xxx.xx]</p>\n<p>Error in retrieving throttle policies org.wso2.carbon.apimgt.throttle.policy.deployer.exception.ThrottlePolicyDeployerException: Error while executing the http client\nCaused by: javax.net.ssl.SSLPeerUnverifiedException: Certificate for  doesn't match any of the subject alternative names: [*.xxx.xx, xxx.xx]</p>\n<p>etc…</p>\n<p>So, it seems that calls are done to localhost but since a cert issued for the server name is in place those calls fails?\nHostname verification is disabled (disableHostnameVerification=true, also changed hostnameVerifier from DefaultAndLocalhost to AllowAll )</p>\n<p>I tried to replace all instances of “localhost” in deployment.toml with the server name which matches the cert but it didn’t make any difference.\nI suppose there may be more references to localhost in various config files but it really shouldn’t be needed to replace them…</p>\n<p>Also added 127.0.0.1 server name mapping to the hosts file. And tested to add the server name as an alias to localhost.\nAnd tried to set server.hostname to the name of the wso2 server instead of the proxy server name in deployment.toml</p>\n<p>I also have problems accessing pages via the proxy but it seems to work if I use the default cert/keystore. So probably due to things not working because of the localhost vs cert issue.</p>\n<p>The cert/keystore it self is used for other functions on the same server without problem.</p>\n<p>Same problem described for 3.2 here <a href=\"https://stackoverflow.com/questions/64466107/ssl-certificate-configuration-for-wso2-api-3-2\">SSL Certificate configuration for WSO2 API 3.2</a> (no solution)</p>\n<p>Any ideas what I’m missing/doing wrong?</p>\n<hr />\n<p>Update:</p>\n<ul>\n<li><p>Tried updating callback via admin app without effect: <a href=\"https://apim.docs.wso2.com/en/latest/troubleshooting/troubleshooting-invalid-callback-error/\" rel=\"nofollow noreferrer\">https://apim.docs.wso2.com/en/latest/troubleshooting/troubleshooting-invalid-callback-error/</a></p>\n</li>\n<li><p>Found the &quot;Change the hostname&quot; page for WSO2 IS where this problem is kind of covered: <a href=\"https://is.docs.wso2.com/en/latest/deploy/change-the-hostname/\" rel=\"nofollow noreferrer\">https://is.docs.wso2.com/en/latest/deploy/change-the-hostname/</a></p>\n</li>\n</ul>\n<p>Two options are given</p>\n<ol>\n<li><p>Adding SAN to the cert (not an option really in my case)</p>\n</li>\n<li><p>Adding setting &quot;internal_hostname&quot; which I tried without success</p>\n</li>\n</ol>\n<p>Setting not mentioned here: <a href=\"https://apim.docs.wso2.com/en/latest/reference/config-catalog/#server\" rel=\"nofollow noreferrer\">https://apim.docs.wso2.com/en/latest/reference/config-catalog/#server</a></p>\n<p>Also added server ip - server name to hosts file</p>\n"},{"comments":[{"comment_id":94091462,"body":"Can you post the pom.xml?"},{"comment_id":94114626,"body":"@EugenCovaci Could you please see above in the post ,I have already provided the pom.xml.."},{"comment_id":94114908,"body":"If &quot;cmd.exe is restricted&quot; how can you run any Maven command?"},{"comment_id":94115631,"body":"@EugenCovaci  we use eclipse and m2e plugin for that.."},{"comment_id":94115861,"body":"It seems to me you won&#39;t be able to do any serious development work on this machine. (I can&#39;t live without the command line)."}],"answers":[{"answer_id":76314372,"body":"<p>Try setting the forkCount to 0</p>\n"}],"last_activity_date":1684842186,"question_id":53615326,"body":"<p>I am using maven-fail-safe plugin and maven-surefire-plugin to run my tests.\nbut surefire plugin calls cmd.exe for forking command line and fails to execute the goals as cmd.exe is restricted to use in my organization.</p>\n\n<h2>Errors from Eclipse  console ##</h2>\n\n<h3>The forked VM terminated without properly saying goodbye. VM crash or System.exit called?</h3>\n\n<pre><code>[ERROR] Failed to execute goal org.apache.maven.plugins:maven-failsafe- \nplugin:2.18.1:integration-test (default) on project bdd-test: Execution \ndefault of goal org.apache.maven.plugins:maven-failsafe- \nplugin:2.18.1:integration-test failed: The forked VM terminated without \nproperly saying goodbye. VM crash or System.exit called?\n[ERROR] Command was cmd.exe /X /C \"\"C:\\Program \nFiles\\Java\\jre1.8.0_151\\bin\\java\" -Xmx512m -jar C:\\Users\\ar11495\\Serenity- \nworkspace\\bdd-test\\target\\surefire\\surefirebooter3944168471238729169.jar \nC:\\Users\\ar11495\\Serenity-workspace\\bdd- \ntest\\target\\surefire\\surefire3290184423596544348tmp \nC:\\Users\\ar11495\\Serenity-workspace\\bdd- \ntest\\target\\surefire\\surefire_0917807971278197542tmp\"\n</code></pre>\n\n<h3>below is my pom.xml</h3>\n\n<pre><code>&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;firstSerenity&lt;/groupId&gt;\n    &lt;artifactId&gt;bdd-test&lt;/artifactId&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;name&gt;Sample Serenity project using JBehave and WebDriver&lt;/name&gt;\n\n    &lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;serenity.version&gt;1.8.21&lt;/serenity.version&gt;\n        &lt;serenity.jbehave.version&gt;1.34.0&lt;/serenity.jbehave.version&gt;\n        &lt;webdriver.driver&gt;firefox&lt;/webdriver.driver&gt;\n    &lt;/properties&gt;\n\n    &lt;repositories&gt;\n        &lt;repository&gt;\n            &lt;snapshots&gt;\n                &lt;enabled&gt;false&lt;/enabled&gt;\n            &lt;/snapshots&gt;\n            &lt;id&gt;central&lt;/id&gt;\n            &lt;name&gt;bintray&lt;/name&gt;\n            &lt;url&gt;http://jcenter.bintray.com&lt;/url&gt;\n        &lt;/repository&gt;\n    &lt;/repositories&gt;\n    &lt;pluginRepositories&gt;\n        &lt;pluginRepository&gt;\n            &lt;snapshots&gt;\n                &lt;enabled&gt;false&lt;/enabled&gt;\n            &lt;/snapshots&gt;\n            &lt;id&gt;central&lt;/id&gt;\n            &lt;name&gt;bintray-plugins&lt;/name&gt;\n            &lt;url&gt;http://jcenter.bintray.com&lt;/url&gt;\n        &lt;/pluginRepository&gt;\n    &lt;/pluginRepositories&gt;\n\n    &lt;dependencies&gt;\n\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n    &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;\n    &lt;version&gt;2.53.1&lt;/version&gt;\n&lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.serenity-bdd&lt;/groupId&gt;\n            &lt;artifactId&gt;serenity-core&lt;/artifactId&gt;\n            &lt;version&gt;${serenity.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.serenity-bdd&lt;/groupId&gt;\n            &lt;artifactId&gt;serenity-jbehave&lt;/artifactId&gt;\n            &lt;version&gt;${serenity.jbehave.version}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;\n            &lt;version&gt;1.7.7&lt;/version&gt;\n        &lt;/dependency&gt;\n\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;\n    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;\n    &lt;version&gt;3.17&lt;/version&gt;\n&lt;/dependency&gt; \n\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;4.12&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.22.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;skip&gt;true&lt;/skip&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.22.0&lt;/version&gt;\n                &lt;configuration&gt;\n\n                    &lt;includes&gt;\n                        &lt;include&gt;**/*Test.java&lt;/include&gt;\n                        &lt;include&gt;**/*TestSuite.java&lt;/include&gt;\n                        &lt;include&gt;**/Test*.java&lt;/include&gt;\n                        &lt;include&gt;**/When*.java&lt;/include&gt;\n                    &lt;/includes&gt;\n                    &lt;argLine&gt;-Xmx512m&lt;/argLine&gt;\n                    &lt;systemPropertyVariables&gt;\n                        &lt;webdriver.driver&gt;${webdriver.driver}&lt;/webdriver.driver&gt;\n                    &lt;/systemPropertyVariables&gt;\n                &lt;/configuration&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;integration-test&lt;/goal&gt;\n                            &lt;goal&gt;verify&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.2&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;1.8&lt;/source&gt;\n                    &lt;target&gt;1.8&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;net.serenity-bdd.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;serenity-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;1.8.21&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;serenity-reports&lt;/id&gt;\n                        &lt;phase&gt;post-integration-test&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;aggregate&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n"},{"last_activity_date":1684842008,"question_id":76314347,"body":"<p>I need to create a database-driven Spring PropertySource that will read properties that would normally be in <code>application.properties</code> or an externalized property file defined with <code>@PropertySource</code>. Before anyone asks, the &quot;why&quot; is because that's how I've been told to do it.</p>\n<p>It seems like the best way to do this is to create an <code>ApplicationContextInitializer</code> that creates the <code>PropertySource</code> and adds it to the Environment:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    environment.getPropertySources().addFirst(source);\n</code></pre>\n<p>At this point, beans have not been loaded into the application context. This means I can't just grab the DataSource bean from said context.</p>\n<p>Unfortunately, the datasource configuration is in application.properties (the file isn't going away, but MOST properties are moving to the database. Datasource configuration stays.). So, somehow I need to configure a datasource for one-time use.</p>\n<p>Oracle provides the UCPDataSource class specifically for Spring Boot, but somehow I need to manually bind an instance of it to values in the Environment (a task that is normally done in a BeanPostProcessor).</p>\n<p>Anyone have any ideas?</p>\n"},{"last_activity_date":1684841959,"question_id":76314335,"body":"<p>i'm currently upgrading my application,\ndependency use</p>\n<pre><code>spring-core: - 5.3.27\nspring-security: - 5.8.3\nhibernate-core: - 5.3.1.Final\nhibernate-search-orm:- 5.10.2.Final\nhibernate-entitymanager: - 5.3.1.Final\nhibernate-jpa-2.1-api\nhibernate-validator: - 6.1.6.Final\nvalidation-api:- 2.0.0.Final\nslf4j: -1.6.1\nquerydsl-apt:- 2.1.1\n</code></pre>\n<p>error code:-</p>\n<pre><code>extends JpaRepository&lt;AssignmentBO, Long&gt;, QueryDslPredicateExecutor&lt;AssignmentBO&gt;\nimport org.springframework.data.jpa.repository.QueryDslPredicateExecutor;\n</code></pre>\n<p>eclipse suggestion: -</p>\n<pre><code>QueryDslPredicateExecutor cannot be resolved to a type\nThe import org.springframework.data.jpa.repository.QueryDslPredicateExecutor cannot be resolved\n</code></pre>\n<p>I tried changing the code(capital D and small d difference) to:-</p>\n<pre><code>extends JpaRepository&lt;AssignmentBO, Long&gt;, QuerydslPredicateExecutor&lt;AssignmentBO&gt;\nimport org.springframework.data.querydsl.QuerydslPredicateExecutor;\n</code></pre>\n<p>but then my package starts give error</p>\n<pre><code>Multiple markers at this line\n    - The type com.querydsl.core.types.OrderSpecifier cannot be resolved. It is indirectly referenced from required .class files\n    - The type com.querydsl.core.types.Predicate cannot be resolved. It is indirectly referenced from required .class files\n</code></pre>\n<p>error line:-</p>\n<pre><code>package com.demo.backend.repository;\n</code></pre>\n"},{"last_activity_date":1684841889,"question_id":76314324,"body":"<p>I have base class in contractTest/java/.. and contracts in contractTest/resources/..\nI have ContractFields.java:</p>\n<pre><code>public class ContractFields {\n    public static final String betId = &quot;2140&quot;;\n}\n</code></pre>\n<p>And use betId in contract:</p>\n<pre><code>...\nbody (betId: ContractFields.betId)\n</code></pre>\n<p>I get error when run contractTest task:</p>\n<pre><code>unable to resolve class ...ContractFields\n</code></pre>\n<p>How i can i do create field in somewhere and import it in groovy contracts and java base class?</p>\n"},{"comments":[{"comment_id":134548418,"body":"What are the input, actual output and expected output?"},{"comment_id":134548576,"body":"I can&#39;t directly compare them because in this website: <a href=\"https://www.dynamicmath.xyz/fourier-epicycles/\" rel=\"nofollow noreferrer\">dynamicmath.xyz/fourier-epicycles</a> I can not directly input the sample points (as x and y coordinates) so I have to draw a new input. However if I draw similar inputs, for example a rectangle, I can see that the demo in the website has lesser amplitudes as frequency increases. In my function, the amplitude generally continues to decrease but at the end it increases again. I know the points being inputted are correct, I have checked those. If you have any particular inputs, I can run and tell you my results."},{"comment_id":134548682,"body":"Questions in Stackoverlow should be self contained."},{"comment_id":134548905,"body":"Could you then guide me to a forum where this would be acceptable? I am really stuck here and I need help."},{"comment_id":134555061,"body":"first check your DFT correctness (if you do iDFT you should get the original signal) and only then move on. See <a href=\"https://stackoverflow.com/a/26355569/2521214\">How to compute Discrete Fourier Transform?</a> and its sublinks so you have something for cross-comparison"},{"comment_id":134563570,"body":"Ahmed, it looks like you have made a good attempt. Problems like this can be approached in a fairly systematic way. First try some cases for which you can predict the results from mathematical identities. For example, what is the expected output for input which is all 0? What about all 0, except one 1? What about all 1? What about replacing every nonzero value with the negative of that value? What about a single value? two values? four? ten? etc. If you get past those cases, try other identities. When you get cases based on identities working, then try your &quot;real&quot; input. Good luck."}],"answers":[{"answer_id":76312721,"body":"<p>not coding in JAVA but I was curious so I tried it in C++/VCL</p>\n<ol>\n<li><p><strong>load some 2D polygon data</strong></p>\n<p>I used SVG hand-drawed image (in my SVG editor):</p>\n<pre><code> &lt;svg width=&quot;512&quot; height=&quot;512&quot; viewBox=&quot;7.16534 14.370463 81.713727 78.871962&quot; &gt;\n  &lt;g fill=&quot;none&quot; stroke=&quot;blue&quot; stroke-width=&quot;1px&quot; data-tool=&quot;-1&quot; data-cfg=&quot;-1&quot; data-group=&quot;-1&quot; data-hair=&quot;0&quot; data-dir=&quot;0&quot; transform=&quot;matrix(1,0,0,1,0,0&quot;&gt;\n   &lt;path d=&quot;M 48.516651 35.319958 c -0.219755 -0.329888 -0.879021 -1.319554 -1.318532 -1.979331 c -0.43951 -0.659777 -0.824082 -1.209591 -1.318532 -1.979331 c -0.494449 -0.76974 -1.153715 -1.979331 -1.648165 -2.639108 c -0.494449 -0.659777 -0.879021 -0.824721 -1.318532 -1.319554 c -0.43951 -0.494832 -0.824082 -1.209591 -1.318532 -1.649442 c -0.494449 -0.439851 -0.879021 -0.714758 -1.648165 -0.989665 c -0.769143 -0.274907 -2.142614 -0.439851 -2.966697 -0.659777 c -0.824082 -0.219925 -1.208654 -0.549814 -1.977798 -0.659777 c -0.769143 -0.109962 -1.758042 0 -2.637064 0 c -0.879021 0 -1.758042 0 -2.637064 0 c -0.879021 0 -1.703103 0 -2.637064 0 c -0.93396 0 -2.197553 -0.054981 -2.966697 0 c -0.769143 0.054981 -1.098776 0.109962 -1.648165 0.329888 c -0.549388 0.219925 -0.9889 0.549814 -1.648165 0.989665 c -0.659266 0.439851 -1.593226 1.15461 -2.307431 1.649442 c -0.714204 0.494832 -1.483348 0.76974 -1.977798 1.319554 c -0.494449 0.549814 -0.714204 1.319554 -0.9889 1.979331 c -0.274694 0.659777 -0.43951 1.264572 -0.659266 1.979331 c -0.219755 0.714758 -0.494449 1.484498 -0.659266 2.30922 c -0.164816 0.824721 -0.274694 1.979331 -0.329633 2.639108 c -0.054938 0.659777 0 0.659777 0 1.319554 c 0 0.659777 0 1.869368 0 2.639108 c 0 0.76974 0 1.209591 0 1.979331 c 0 0.76974 -0.109877 1.979331 0 2.639108 c 0.109877 0.659777 0.274694 0.659777 0.659266 1.319554 c 0.384571 0.659777 1.208654 1.92435 1.648165 2.639108 c 0.43951 0.714758 0.494449 1.044647 0.9889 1.649442 c 0.494449 0.604795 1.483348 1.374535 1.977798 1.979331 c 0.494449 0.604795 0.604327 1.099628 0.9889 1.649442 c 0.384571 0.549814 0.93396 1.209591 1.318532 1.649442 c 0.384571 0.439851 0.494449 0.549814 0.9889 0.989665 c 0.494449 0.439851 1.37347 1.209591 1.977798 1.649442 c 0.604327 0.439851 1.043837 0.494832 1.648165 0.989665 c 0.604327 0.494832 1.428409 1.53948 1.977798 1.979331 c 0.549388 0.439851 0.824082 0.439851 1.318532 0.659777 c 0.494449 0.219925 1.043837 0.439851 1.648165 0.659777 c 0.604327 0.219925 1.318532 0.329888 1.977798 0.659777 c 0.659266 0.329888 1.318532 0.934684 1.977798 1.319554 c 0.659266 0.38487 1.428409 0.604795 1.977798 0.989665 c 0.549388 0.38487 0.769143 0.934684 1.318532 1.319554 c 0.549388 0.38487 1.318532 0.604795 1.977798 0.989665 c 0.659266 0.38487 1.37347 0.824721 1.977798 1.319554 c 0.604327 0.494832 1.098776 1.15461 1.648165 1.649442 c 0.549388 0.494832 1.043837 0.824721 1.648165 1.319554 c 0.604327 0.494832 1.428409 1.099628 1.977798 1.649442 c 0.549388 0.549814 0.879021 0.989665 1.318532 1.649442 c 0.43951 0.659777 0.9889 1.649442 1.318532 2.30922 c 0.329633 0.659777 0.329633 1.044647 0.659266 1.649442 c 0.329633 0.604795 0.9889 1.319554 1.318532 1.979331 c 0.329633 0.659777 0.43951 1.209591 0.659266 1.979331 c 0.219755 0.76974 0.549388 2.30922 0.659266 2.639108 c 0.109877 0.329888 0 -0.219925 0 -0.659777 c 0 -0.439851 -0.054938 -1.209591 0 -1.979331 c 0.054938 -0.76974 0.219755 -1.814387 0.329633 -2.639108 c 0.109877 -0.824721 0.164816 -1.594461 0.329633 -2.30922 c 0.164816 -0.714758 0.549388 -1.319554 0.659266 -1.979331 c 0.109877 -0.659777 -0.109877 -1.209591 0 -1.979331 c 0.109877 -0.76974 0.384571 -1.869368 0.659266 -2.639108 c 0.274694 -0.76974 0.769143 -1.264572 0.9889 -1.979331 c 0.219755 -0.714758 0.164816 -1.649442 0.329633 -2.30922 c 0.164816 -0.659777 0.329633 -0.879702 0.659266 -1.649442 c 0.329633 -0.76974 0.9889 -2.144275 1.318532 -2.968997 c 0.329633 -0.824721 0.43951 -1.484498 0.659266 -1.979331 c 0.219755 -0.494832 0.43951 -0.604795 0.659266 -0.989665 c 0.219755 -0.38487 0.384571 -0.824721 0.659266 -1.319554 c 0.274694 -0.494832 0.659266 -1.044647 0.9889 -1.649442 c 0.329633 -0.604795 0.604327 -1.319554 0.9889 -1.979331 c 0.384571 -0.659777 0.769143 -1.319554 1.318532 -1.979331 c 0.549388 -0.659777 1.318532 -1.429517 1.977798 -1.979331 c 0.659266 -0.549814 1.37347 -0.824721 1.977798 -1.319554 c 0.604327 -0.494832 1.098776 -1.209591 1.648165 -1.649442 c 0.549388 -0.439851 0.9889 -0.604795 1.648165 -0.989665 c 0.659266 -0.38487 1.648165 -0.879702 2.307431 -1.319554 c 0.659266 -0.439851 1.098776 -0.879702 1.648165 -1.319554 c 0.549388 -0.439851 1.043837 -0.824721 1.648165 -1.319554 c 0.604327 -0.494832 1.37347 -1.099628 1.977798 -1.649442 c 0.604327 -0.549814 1.208654 -1.099628 1.648165 -1.649442 c 0.43951 -0.549814 0.714204 -0.934684 0.9889 -1.649442 c 0.274694 -0.714758 0.549388 -1.704424 0.659266 -2.639108 c 0.109877 -0.934684 0 -2.199257 0 -2.968997 c 0 -0.76974 0.109877 -1.044647 0 -1.649442 c -0.109877 -0.604795 -0.274694 -1.209591 -0.659266 -1.979331 c -0.384571 -0.76974 -1.043837 -1.869368 -1.648165 -2.639108 c -0.604327 -0.76974 -1.428409 -1.484498 -1.977798 -1.979331 c -0.549388 -0.494832 -0.769143 -0.76974 -1.318532 -0.989665 c -0.549388 -0.219925 -1.37347 -0.164944 -1.977798 -0.329888 c -0.604327 -0.164944 -1.043837 -0.439851 -1.648165 -0.659777 c -0.604327 -0.219925 -1.37347 -0.549814 -1.977798 -0.659777 c -0.604327 -0.109962 -1.153715 0.054981 -1.648165 0 c -0.494449 -0.054981 -0.659266 -0.219925 -1.318532 -0.329888 c -0.659266 -0.109962 -1.922859 -0.274907 -2.637064 -0.329888 c -0.714204 -0.054981 -1.098776 0.054981 -1.648165 0 c -0.549388 -0.054981 -0.93396 -0.274907 -1.648165 -0.329888 c -0.714204 -0.054981 -1.86792 0 -2.637064 0 c -0.769143 0 -1.208654 0 -1.977798 0 c -0.769143 0 -1.922859 -0.164944 -2.637064 0 c -0.714204 0.164944 -0.9889 0.604795 -1.648165 0.989665 c -0.659266 0.38487 -1.703103 0.879702 -2.307431 1.319554 c -0.604327 0.439851 -0.879021 0.879702 -1.318532 1.319554 c -0.43951 0.439851 -1.043837 0.824721 -1.318532 1.319554 c -0.274694 0.494832 -0.109877 0.879702 -0.329633 1.649442 c -0.219755 0.76974 -0.824082 2.034312 -0.9889 2.968997 c -0.164816 0.934684 -0.054938 2.034312 0 2.639108 c 0.054938 0.604795 0.274694 0.824721 0.329633 0.989665 &quot;/&gt;\n  &lt;/g&gt;\n &lt;/svg&gt;\n</code></pre>\n<p>and stored the data as set of 2D points (see <code>pic[]</code> in data.h below)</p>\n</li>\n<li><p><strong>do 1D DFFT on input polygon (complex input and output)</strong></p>\n<p>each 2D point is represented as single complex number. As I used DFFT (DFT was ~1sec too slow to my taste) the input data must be power of 2 size so &quot;pad&quot; themissing data (I duplicated last point).</p>\n</li>\n<li><p><strong>during rendering do iDFT  (complex input and output) and render line/circle in each inner loop iteration</strong></p>\n<p>however this step is different from iDFT as we do not use the outer loop and instead we select only single output (not computing whole array). The selected index is like animation time/parameter. However the change must be discrete (you can not interpolate between 2 values without more heavy computations).</p>\n</li>\n</ol>\n<p>Here simplified (without SVG importer, with fixed size and static data and removed all unimportant stuff) C++/VCL example:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>//---------------------------------------------------------------------------\n#include &lt;math.h&gt;\n#include &quot;data.h&quot;\n//---------------------------------------------------------------------------\nint tepi=0;             // animation time &lt;0,N)\n//---------------------------------------------------------------------------\nvoid DFFTcc(float *dst,float *src,int n)    // n must be power of 2 !!!\n    {\n    // precompute sin,cos LUTs if not computed yet\n    static float _cos[N]={0.0},_sin[N];\n    if (_cos[0]&lt;=0.9)\n        {\n        float a,da; int i;\n        da=2.0*M_PI/float(N);\n        for (a=0.0,i=0;i&lt;N;i++,a+=da) { _cos[i]=cos(a); _sin[i]=sin(a); }\n        }\n    // DFFT\n    if (n&lt;=1) { if (n==1) { dst[0]=src[0]*2.0; dst[1]=src[1]*2.0; } return; }\n    int i,j,n2=n&gt;&gt;1,q,dq=+N/n,mq=N-1;\n    // reorder even,odd (buterfly)\n    for (j=0,i=0;i&lt;n+n;) { dst[j]=src[i]; i++; j++; dst[j]=src[i]; i+=3; j++; }\n    for (    i=2;i&lt;n+n;) { dst[j]=src[i]; i++; j++; dst[j]=src[i]; i+=3; j++; }\n    // recursion\n    float tmp[N2];\n    DFFTcc(tmp  ,dst  ,n2); // even\n    DFFTcc(tmp+n,dst+n,n2); // odd\n    // reorder and weight back (buterfly)\n    float a0,a1,b0,b1,a,b;\n    for (q=0,i=0,j=n;i&lt;n;i+=2,j+=2,q=(q+dq)&amp;mq)\n        {\n        a0=tmp[j  ]; a1=+_cos[q];\n        b0=tmp[j+1]; b1=+_sin[q];\n        a=(a0*a1)-(b0*b1);\n        b=(a0*b1)+(a1*b0);\n        a0=tmp[i  ]; a1=a;\n        b0=tmp[i+1]; b1=b;\n        dst[i  ]=(a0+a1)*0.5;\n        dst[i+1]=(b0+b1)*0.5;\n        dst[j  ]=(a0-a1)*0.5;\n        dst[j+1]=(b0-b1)*0.5;\n        }\n    }\n//---------------------------------------------------------------------------\nvoid draw(TCanvas *scr,int xs,int ys) // target canvas, resolution\n    {\n    int xs2,ys2;\n    Graphics::TBitmap *bmp;\n    xs2=xs&gt;&gt;1;\n    ys2=ys&gt;&gt;1;\n    bmp=new Graphics::TBitmap;\n    bmp-&gt;HandleType=bmDIB;\n    bmp-&gt;PixelFormat=pf32bit;\n    bmp-&gt;Width=xs;\n    bmp-&gt;Height=ys;\n    bmp-&gt;Canvas-&gt;Brush-&gt;Color=0x00000000;\n    bmp-&gt;Canvas-&gt;FillRect(TRect(0,0,xs,ys));\n\n    int i;\n    float x,y,scale=float(ys)/100.0;\n\n    // render image\n    bmp-&gt;Canvas-&gt;Pen-&gt;Color=0x00204080;\n                      i=0;      // DC offset\n    x=pic[i]*scale; i++;\n    y=pic[i]*scale; i++;\n    bmp-&gt;Canvas-&gt;MoveTo(x,y);\n    for (;i&lt;N2;)\n        {\n        x=pic[i]*scale; i++;\n        y=pic[i]*scale; i++;\n        bmp-&gt;Canvas-&gt;LineTo(x,y);\n        }\n\n    // render epicycles\n    bmp-&gt;Canvas-&gt;Pen-&gt;Color=0x00804020;\n    bmp-&gt;Canvas-&gt;Brush-&gt;Style=bsClear;\n\n    // iDFTcc src,dst\n    float dx,dy,a0,a1,b0,b1,q,qq,r,m;\n    q=+2.0*M_PI*tepi/float(N); x=0.0; y=0.0; m=0.5*scale;\n    for (qq=0.0,i=0;i&lt;N;i++,qq+=q)\n        {\n        a0=epi[i+i  ]; a1=+cos(qq);\n        b0=epi[i+i+1]; b1=-sin(qq);\n        dx=(a0*a1)-(b0*b1);\n        dy=(a0*b1)+(b0*a1);\n        r=sqrt((dx*dx)+(dy*dy));\n        bmp-&gt;Canvas-&gt;Ellipse((x-r)*m,(y-r)*m,(x+r)*m,(y+r)*m);\n        bmp-&gt;Canvas-&gt;MoveTo(x*m,y*m);\n        x+=dx; y+=dy;\n        bmp-&gt;Canvas-&gt;LineTo(x*m,y*m);\n        }\n    bmp-&gt;Canvas-&gt;Brush-&gt;Style=bsSolid;\n\n    scr-&gt;Draw(0,0,bmp);\n    delete bmp;\n    }\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner):TForm(Owner) // window init\n    {\n    // polygon -&gt; epicycles\n    DFFTcc(epi,pic,N);      // epi = DFFT(pic)\n    }\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Timer1Timer(TObject *Sender) // animation timer\n    {\n    tepi++; if (tepi&gt;=N) tepi=0;\n    draw(Canvas,ClientWidth,ClientHeight);\n    }\n//---------------------------------------------------------------------------\n</code></pre>\n<p>here the <strong>data.h</strong> (both input and output so you can cross compare):</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>const int N=256;        // max num of points\nconst int N2=N+N;\nfloat pic[N2]=\n    {48.096,34.688,47.443,33.708,46.917,32.922,46.362,32.097,45.831,31.285,45.305,30.419,44.749,29.497,44.231,28.722,\n    43.585,28.030,42.913,27.403,42.365,26.683,41.731,25.885,41.067,25.326,40.175,24.850,39.323,24.587,38.265,24.372,\n    37.240,24.168,36.361,23.896,35.495,23.555,34.632,23.408,33.618,23.406,32.567,23.442,31.654,23.444,30.639,23.444,\n    29.728,23.444,28.727,23.444,27.720,23.444,26.791,23.442,25.709,23.426,24.655,23.423,23.733,23.476,22.765,23.667,\n    21.977,24.015,21.123,24.564,20.370,25.080,19.519,25.696,18.674,26.305,17.889,26.802,17.035,27.310,16.414,27.888,\n    15.924,28.776,15.553,29.712,15.234,30.585,14.926,31.587,14.662,32.425,14.376,33.394,14.180,34.298,14.029,35.383,\n    13.926,36.395,13.883,37.262,13.905,38.121,13.905,39.128,13.905,40.218,13.905,41.150,13.905,42.131,13.895,43.064,\n    13.859,44.161,13.894,45.140,14.153,45.910,14.644,46.671,15.162,47.508,15.754,48.444,16.213,49.175,16.708,50.081,\n    17.202,50.825,17.876,51.522,18.659,52.254,19.254,52.899,19.780,53.777,20.224,54.533,20.862,55.361,21.487,56.103,\n    22.064,56.718,22.740,57.327,23.554,58.027,24.381,58.689,25.154,59.155,26.009,59.658,26.662,60.264,27.410,61.062,\n    28.079,61.711,28.879,62.171,29.665,62.487,30.630,62.876,31.495,63.174,32.451,63.454,33.282,63.833,34.143,64.425,\n    35.002,65.010,35.844,65.422,36.745,65.851,37.423,66.404,38.061,67.127,38.790,67.604,39.720,68.025,40.537,68.462,\n    41.418,69.015,42.254,69.628,42.923,70.266,43.621,71.008,44.287,71.608,45.056,72.207,45.776,72.780,46.603,73.436,\n    47.393,74.115,48.017,74.773,48.606,75.542,49.110,76.309,49.654,77.242,50.127,78.130,50.467,78.966,50.824,79.855,\n    51.324,80.606,51.945,81.488,52.354,82.314,52.653,83.274,52.906,84.200,53.187,85.357,53.417,86.302,53.505,86.444,\n    53.460,85.643,53.437,84.646,53.476,83.631,53.591,82.619,53.737,81.567,53.856,80.644,53.982,79.630,54.145,78.764,\n    54.490,77.808,54.780,76.886,54.788,76.031,54.766,75.018,54.917,74.152,55.171,73.121,55.439,72.267,55.904,71.341,\n    56.362,70.476,56.566,69.588,56.665,68.541,56.846,67.665,57.210,66.793,57.593,65.928,58.030,64.966,58.480,63.966,\n    58.828,63.118,59.163,62.053,59.450,61.265,59.999,60.481,60.408,59.677,60.851,58.833,61.379,57.978,61.834,57.169,\n    62.263,56.268,62.691,55.443,63.207,54.582,63.804,53.720,64.390,53.027,65.106,52.285,65.846,51.604,66.575,51.061,\n    67.414,50.553,68.120,50.031,68.845,49.280,69.543,48.573,70.274,48.069,71.161,47.584,71.945,47.144,72.887,46.622,\n    73.662,46.143,74.472,45.514,75.217,44.887,75.907,44.338,76.697,43.704,77.405,43.129,78.224,42.456,78.922,41.846,\n    79.693,41.128,80.374,40.410,80.918,39.702,81.394,38.832,81.691,38.013,81.958,37.022,82.139,35.980,82.188,35.038,\n    82.165,33.948,82.139,33.011,82.185,32.034,82.106,31.188,81.866,30.293,81.480,29.382,81.033,28.555,80.480,27.656,\n    79.889,26.816,79.271,26.100,78.524,25.369,77.854,24.764,77.122,24.107,76.363,23.716,75.355,23.568,74.453,23.414,\n    73.501,23.030,72.627,22.679,71.611,22.306,70.707,22.095,69.663,22.132,68.812,22.021,67.886,21.782,66.890,21.638,\n    65.791,21.507,64.846,21.449,63.878,21.478,63.050,21.336,62.032,21.135,61.165,21.110,60.081,21.126,59.162,21.135,\n    58.164,21.135,57.233,21.132,56.186,21.078,55.135,21.080,54.313,21.305,53.566,21.831,52.803,22.309,51.859,22.817,\n    50.969,23.343,50.239,23.958,49.576,24.691,48.899,25.303,48.232,26.007,48.005,26.761,47.857,27.733,47.552,28.605,\n    47.172,29.621,46.885,30.613,46.785,31.593,46.812,32.663,46.890,33.511,47.198,34.330,47.198,34.330,47.198,34.330,\n    47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,\n    47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,47.198,34.330,\n    };\nfloat epi[N2]=\n    {95.280,89.953,-17.550,-49.533,6.344,7.333,6.259,7.659,4.980,2.621,-0.481,-0.499,0.779,0.595,0.154,-0.154,\n    0.239,-0.574,-0.535,0.244,-0.004,0.195,-0.152,0.501,0.046,0.143,-0.059,0.386,-0.024,-0.042,0.122,0.147,\n    0.034,0.009,0.129,0.086,-0.032,-0.036,0.101,0.007,0.018,-0.023,0.051,-0.006,-0.078,0.053,-0.004,0.016,\n    -0.010,0.063,0.000,0.028,-0.022,0.076,0.057,0.007,0.028,0.068,0.020,0.020,0.074,0.051,-0.024,0.018,\n    0.034,0.037,-0.050,-0.034,0.039,-0.006,-0.038,0.012,-0.003,0.010,-0.023,0.024,0.014,0.029,-0.012,0.007,\n    0.015,0.020,0.042,0.019,0.014,-0.022,0.045,0.015,-0.016,0.021,0.015,0.017,0.017,0.005,0.034,-0.001,\n    -0.018,0.013,-0.003,0.013,-0.014,0.033,0.017,0.016,0.017,0.023,-0.005,-0.015,0.020,0.022,-0.004,0.018,\n    0.009,0.008,0.009,0.001,0.012,0.025,-0.008,0.018,0.017,0.001,0.003,0.003,0.008,0.005,-0.003,0.001,\n    -0.006,0.015,-0.011,0.004,0.006,0.010,0.005,0.016,0.016,0.008,0.014,0.006,0.006,0.008,0.014,0.002,\n    -0.002,0.005,0.011,0.002,0.002,0.002,0.006,0.009,0.005,0.009,0.004,0.010,-0.001,0.012,0.004,0.005,\n    0.005,0.018,0.005,0.001,0.009,0.006,0.005,0.001,0.004,0.009,0.008,0.010,0.006,0.002,0.004,0.002,\n    0.002,0.002,0.002,0.007,0.005,0.005,0.001,0.002,0.004,0.001,0.005,0.007,0.005,0.011,0.004,0.008,\n    0.011,0.005,0.006,0.006,0.005,0.004,0.007,0.000,0.003,0.001,0.007,0.005,0.002,-0.000,0.006,0.002,\n    0.008,-0.003,0.002,0.013,0.018,0.010,-0.003,0.004,0.010,0.011,0.003,0.013,0.004,0.002,0.001,0.003,\n    0.013,0.009,0.014,-0.000,0.001,0.009,-0.003,-0.003,0.001,-0.003,0.002,0.006,0.002,0.008,0.002,0.005,\n    0.011,0.009,0.003,0.004,0.009,0.000,0.003,0.004,0.009,0.006,0.005,0.003,0.011,-0.001,0.006,-0.002,\n    -0.002,-0.001,0.005,0.007,0.007,0.010,0.010,0.006,-0.000,-0.001,0.002,0.006,-0.000,0.009,0.009,0.003,\n    0.007,0.005,0.004,0.004,0.005,0.002,0.009,0.001,0.004,0.006,0.004,-0.007,0.007,0.002,0.005,0.006,\n    -0.002,-0.005,0.005,0.002,0.003,0.005,0.013,0.012,-0.001,0.013,0.016,0.003,0.008,-0.006,0.007,0.007,\n    0.013,-0.000,0.003,0.001,0.004,0.007,0.004,0.009,-0.003,0.002,-0.002,0.002,0.001,0.001,0.008,0.005,\n    0.007,-0.000,0.005,0.005,0.008,0.004,0.011,0.003,0.005,0.000,0.007,-0.003,0.004,0.004,0.004,0.007,\n    0.002,0.001,0.010,-0.001,0.002,0.001,0.001,0.005,0.006,0.005,0.008,0.001,0.005,0.004,0.005,0.004,\n    0.002,0.004,0.008,0.004,0.009,0.004,0.014,-0.009,0.004,-0.000,0.000,0.005,0.002,-0.005,0.008,0.006,\n    0.005,-0.006,0.001,0.007,0.012,-0.004,0.007,0.011,0.012,-0.002,0.002,0.017,0.019,-0.017,0.020,0.004,\n    0.004,0.008,-0.002,0.006,0.002,0.005,0.012,0.011,-0.003,-0.001,0.025,-0.001,0.000,0.005,-0.001,-0.015,\n    0.010,0.000,-0.003,-0.001,0.003,0.031,0.004,0.014,0.020,0.006,0.012,-0.005,0.024,0.003,0.003,0.016,\n    0.009,-0.019,-0.019,-0.006,-0.010,-0.015,0.010,0.024,-0.003,-0.008,0.003,-0.002,0.023,-0.022,-0.007,0.038,\n    0.017,-0.027,0.042,0.010,0.032,-0.022,0.051,0.029,0.002,0.003,0.005,0.016,0.003,-0.014,-0.000,0.009,\n    -0.013,0.038,0.028,-0.008,0.031,0.017,0.055,-0.033,-0.053,0.073,-0.053,-0.032,0.074,0.053,-0.060,-0.058,\n    0.121,0.042,0.051,0.008,0.122,0.034,-0.051,-0.036,0.103,-0.025,-0.055,0.073,0.016,-0.064,-0.052,0.111,\n    0.085,-0.081,0.008,0.202,0.077,0.025,0.065,0.290,-0.002,-0.096,0.331,0.331,-0.079,0.070,0.467,0.246,\n    -0.526,-0.281,0.451,-0.037,-0.880,0.214,0.847,-0.670,-0.752,2.921,2.253,-4.359,-4.025,8.680,0.724,1.383,\n    };\n</code></pre>\n<p>and preview:</p>\n<p><a href=\"https://i.stack.imgur.com/kVjeT.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVjeT.gif\" alt=\"heart animation\" /></a></p>\n<p>Now you just add the sorting of circles by radius if you want (now they are sorted by frequency)...</p>\n"},{"comments":[{"comment_id":134572520,"body":"Yes you are absolutely correct. I was viewing a preview sorted by amplitude instead of frequency but I didn&#39;t realize it then. Thank you!"},{"comment_id":134573243,"body":"@MominAhmed this is true only for real input ... however for 2D real input you have to do both DFT/iDFT twice ... if you do this in complex domain from the start (almost no performance hit) then you need just single DFT/iDFT ..."}],"answer_id":76313406,"body":"<p>As far as I remember, this is absolutely normal with DFT - the frequency domain values are basically mirrored thru the middle - amplitude of the <code>i</code>-th element is equal to the amplitude of the <code>N-i</code>th element (they are complex conjugates of each other). See the examples in <a href=\"https://en.wikipedia.org/wiki/Discrete_Fourier_transform\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Discrete_Fourier_transform</a></p>\n<p>From back then when I was actually using it, we stored the data just up to N/2.</p>\n"}],"last_activity_date":1684841780,"question_id":76299934,"body":"<p>I am working on a project to draw a given figure using epicycles (by DFT). I am following this website: <a href=\"https://www.instructables.com/Drawing-With-Discrete-Fourier-Transform/\" rel=\"nofollow noreferrer\">https://www.instructables.com/Drawing-With-Discrete-Fourier-Transform/</a> but I don't seem to be getting correct values for the amplitudes because for any sample of points, the amplitude increases in the end (at higher frequencies) while I don't think it should - at least not according to the examples in the website.</p>\n<p>The function takes a double[][] as input containing x and y coordinates of sample points and Points.n is the number of sample points. Here is my DFT function:</p>\n<pre><code>public class Dft {\n    public static double[][] dft(double[][] psamples){\n        double[][] result = new double[Points.n][2];\n        for (int i = 0; i &lt; Points.n; i++){\n            Complex x_i = new Complex(0, 0);\n            for (int j = 0; j &lt; Points.n; j++){\n                Complex sample = new Complex(psamples[j][0], psamples[j][1]);\n                double root = Math.PI*2*i*j/Points.n;\n                Complex unity = new Complex(Math.cos(root), -Math.sin(root));\n                x_i = Complex.add(x_i, Complex.multiply(sample, unity));\n            }\n            result[i][0] = x_i.amp()/Points.n; //amplitude\n            result[i][1] = x_i.angle(); //phase change\n            //frequency is equal to the index number i\n            System.out.println(i + &quot; amp: &quot; + result[i][0] + &quot; phase change: &quot; + result[i][1]);\n        }\n        return result;\n    } \n}\n\n</code></pre>\n<p>The Complex class is :</p>\n<pre><code>public class Complex {\n    double[] num = {0,0};\n    public Complex(double a, double b){\n        num[0] = a;\n        num[1] = b;\n    }\n    public void setReal(double a){\n        num[0] = a;\n    }\n    public void setImaginary(double b){\n        num[1] = b;\n    }\n    public double getReal(){\n        return num[0];\n    }\n    public double getImaginary(){\n        return num[1];\n    }\n    public static Complex add(Complex a, Complex b){\n        Complex result = new Complex(a.getReal()+b.getReal(), a.getImaginary() + b.getImaginary());\n        return result;\n    }\n    public static Complex euler(double r, double theta){\n        Complex result = new Complex(r*Math.cos(theta), r*Math.sin(theta));\n        return result;\n    }\n    public static Complex multiply(Complex a, Complex b){\n        Complex result = new Complex(a.getReal()*b.getReal() - a.getImaginary()*b.getImaginary(), a.getReal()*b.getImaginary() + a.getImaginary()*b.getReal());\n        return result;\n    }\n    public double amp(){\n        double result = Math.sqrt(num[0]*num[0] + num[1]*num[1]);\n        return result;\n    }\n    public double angle(){\n        if (num[0] == 0){\n            if (num[1]&gt;0) return Math.PI/2;\n            else if (num[1]&lt;0) return -Math.PI/2;\n            else return 0;\n        }\n        else {\n        double result = Math.atan2(num[1],num[0]);\n        return result;\n        }\n    }\n} \n\n</code></pre>\n"},{"comments":[{"comment_id":109306129,"body":"Hello! Podr&#237;as agregar la clase de tu activity y de tu xml para poder ayudarte :)"},{"comment_id":109307288,"body":"added layout and fragment code"}],"answers":[{"comments":[{"comment_id":109512459,"body":"Changed my import to specify the import [root-package].BR, and I don&#39;t see errors in the IDE, but at compilation, it fails to find the Br class. I also moved my @Bindable as you suggested."}],"answer_id":61800643,"body":"<p>The <code>BR</code> class that is generated should be at the root package of your project, you're importing the wrong one. Also the <code>@Bindable</code> annotation should go on the public getter, not the private backing field. </p>\n"},{"comments":[{"comment_id":134574669,"body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/76314296/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"answer_id":76314296,"body":"<p><strong>Just restart the android studio, it would work.</strong></p>\n"}],"last_activity_date":1684841706,"question_id":61796884,"body":"<p>I'm using android databinding, using [this post][1] as a guide. I realize it's not targeting androidx databinding, but I'm not using androidx on my project yet, but am using the latest android support libraries.</p>\n\n<p>Anyways, I have my ViewModel extending BaseObservable. The BR class is being generated and appears correct. e.g. I can ctrl-click on BR.stateText and I'm navigated to teh genreated class which is in <code>[app]\\build\\generated\\ap_generated_sources\\debug\\com.android.databinding.library.baseAdapters\\BR</code>. But, IntelliJ seems to not understand that the class acutally exists when I go to compile it.</p>\n\n<pre><code>import android.databinding.BaseObservable;\nimport android.databinding.Bindable;\nimport com.android.databinding.library.baseAdapters.BR;\n\npublic class MyViewModel extends BaseObservable {\n\n    public MyViewModel() {\n        mStateText = \"DEFAULT_TEXT_123\";\n    }\n\n    @Bindable\n    private String mStateText = null;\n\n    public String getStateText() {\n        return mStateText;\n    }\n\n    public void setStateText(String stateText) {\n        mStateText = stateText;\n        notifyPropertyChanged(BR.stateText);\n    }\n}\n\n</code></pre>\n\n<p>layout:</p>\n\n<pre><code>\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;layout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n        xmlns:bind=\"http://schemas.android.com/tools\"&gt;\n\n    &lt;data&gt;\n        &lt;variable\n                name=\"viewModel\"\n                type=\"my.org.MyViewModel \"/&gt;\n    &lt;/data&gt;\n\n...\n\n\n        &lt;Button\n                android:layout_width=\"200dp\" android:layout_height=\"wrap_content\"\n                android:layout_row=\"1\" android:layout_column=\"1\"\n                android:id=\"@+id/system_state_btn\"\n                android:text=\"@{viewModel.stateText}\"/&gt;\n</code></pre>\n\n<p>Fragment:</p>\n\n<pre><code>    @Override\n    public View onCreateView(LayoutInflater inflater, ViewGroup container,\n                             Bundle savedInstanceState) {\n\n        MainStatusBinding activityMainBinding = DataBindingUtil.setContentView(getActivity(), R.layout.main_status);\n        activityMainBinding.setViewModel(new MyViewModel());\n        activityMainBinding.executePendingBindings();\n\n        View rootView = inflater.inflate(R.layout.main_status, container, false);\n    ...\n    ```\n.\n\n</code></pre>\n\n<p>error: cannot find symbol\nimport com.android.databinding.library.baseAdapters.BR;\n                                                   ^\n  symbol:   class BR\n  location: package com.android.databinding.library.baseAdapters</p>\n\n<pre><code>\nWhat is wrong with my setup that's causing IntelliJ to not recognize the class exists? Note, this fails for me when building on the commandline, so it's not specific to IntelliJ.\n\nIntelliJ: 2020.1\n\nGradle wrapper: 6.3\n\nandroid build tools: 28.0.3\n\nandroid gradle plugin: 3.5.0\n\n  [1]: https://www.journaldev.com/20292/android-mvvm-design-pattern\n</code></pre>\n"},{"comments":[{"comment_id":134572897,"body":"Postman doesn&#39;t download anything, it&#39;s not a browser."},{"comment_id":134573005,"body":"@AbhijitSarkar if i try to downloading from swagger, it is saying <code>Unable to open file. The file may corrupted</code>. But the file downloaded through postman is working fine. Is there anything i need to handle in code for that ?"},{"comment_id":134573075,"body":"<code>File file = &#47;*assigning&#47;creating my file here*&#47;</code> doesn&#39;t create a file, whatever may be in this initializer. Unclear what you&#39;re asking."}],"answers":[{"answer_id":76314279,"body":"<p>You are setting the wrong content type in the response. You are setting in to a binary (<code>MediaType.APPLICATION_OCTET_STREAM</code>), so it is interpreted as a binary file by the browser. You should set it to what you already said in the <code>produces</code> attribute it returns, an Excel file: <code>application/vnd.ms-excel</code>.</p>\n"},{"answer_id":76314290,"body":"<p>No, what you send over HTTP is binary information, so you receive it as BLOB. It is up to a convention between the server and client to know that the information that you download is a file of a particular type. So, say if I am a server-side developer and I developed an end-point that reads and returns say a document in format PDF I should provide the information to a client that return type is file of type PDF. This could be done with headers but also as documentation. So, when a client invokes my end-point (s)he will receive a BLOB that the client needs to save as a file with .pdf extension.</p>\n"}],"last_activity_date":1684841691,"question_id":76314044,"body":"<p>I'm trying to download excel in java, but instead of downloading as File, it is returning as blob type.</p>\n<p>I tried the below code to download the excel in java8.</p>\n<pre><code>import java.io.File;\nimport java.io.FileInputStream;\n\nimport org.springframework.core.io.InputStreamResource;\nimport org.springframework.core.io.Resource;\nimport org.springframework.http.HttpHeaders;\nimport org.springframework.http.MediaType;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.RequestParam;\n\n@PostMapping(value = &quot;/download-report&quot;, produces = &quot;application/vnd.ms-excel&quot;)\npublic ResponseEntity&lt;Resource&gt; getSrmTallyReportInExcel() {\n    try {\n        File file = /*assigning/creating my file here*/;\n        InputStreamResource resource = new InputStreamResource(new FileInputStream(file));\n        \n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);\n        headers.setContentDispositionFormData(&quot;attachment&quot;, &quot;report.xlsx&quot;);\n        \n        return ResponseEntity.ok().headers(headers).body(resource);\n    catch (Exception e) {}\n}\n</code></pre>\n<p>When i run in postman, instead of downloading file directly, it is returning the response in this format(�L������Pk�&quot;�W��9�˰�) which i can download as excel file by clicking on Save as File.\nBut i wish to download directly without click that Save as File option. is there any way to do that?</p>\n"},{"answers":[{"answer_id":76314262,"body":"<p>Check your log pattern in logback.xml.\nThere will be <code>logger</code> pattern inside it like <code>%logger{30}</code>\n<br/> You can specify the length limit in curly braces. If the fully qualified class name is bigger than this length, it will be shortened. Only the last part i.e. classname will not be shortened. <br> If you don't want any limit and always want to print the Fully qualified class name, mention <code>%logger</code> without any curly braces. <br/> You can check official documentation for more details at <a href=\"https://logback.qos.ch/manual/layouts.html#conversionWord\" rel=\"nofollow noreferrer\" title=\"Layout\">Layout</a></p>\n"}],"last_activity_date":1684841535,"question_id":76310764,"body":"<p>I am new to spring and now checking a large code base, so I want to enable detailed logs. Now I got some logs like</p>\n<pre><code>2023-05-22 13:21:20.504  INFO 76276 --- [           main] com.zaxxer.hikari.HikariDataSource       : DatebookHikariCP - Starting...\n2023-05-22 13:21:20.716  INFO 76276 --- [           main] com.zaxxer.hikari.HikariDataSource       : DatebookHikariCP - Start completed.\n2023-05-22 13:21:20.721 DEBUG 76276 --- [           main] c.w.d.S.selectAllProperties              : ==&gt;  Preparing: SELECT SKEY, SDATA FROM SYS_PROPERTY \n2023-05-22 13:21:20.734 DEBUG 76276 --- [           main] c.w.d.S.selectAllProperties              : ==&gt; Parameters\n</code></pre>\n<p>From the log, it seems when the package name is large, it will be shortened gracefully. I hope I can configure the maximum allowed length of the field, so that I can see the full name of the package for most cases.\nIs there any config item for it? Or any other way for the purpose?</p>\n"},{"last_activity_date":1684841173,"question_id":76314211,"body":"<p>I am loading SVG animations in the android WebView using Java.\nMy WebView code in XML is:</p>\n<pre><code>        &lt;WebView\n        android:id=&quot;@+id/animationView&quot;\n        android:layout_width=&quot;135dp&quot;\n        android:layout_height=&quot;135dp&quot;\n        android:adjustViewBounds=&quot;false&quot;/&gt;\n</code></pre>\n<p>To load SVG:</p>\n<pre><code>        webView.getSettings().setCacheMode(WebSettings.LOAD_NO_CACHE);\n        webView.clearCache(true);\n        webView.getSettings().setLoadWithOverviewMode(true);\n        webView.getSettings().setUseWideViewPort(true);\n        webView.getSettings().setJavaScriptEnabled(true);\n\n        webView.setPadding(0, 0, 0, 0);\n        webView.setInitialScale(1);\n        webView.getSettings().setBuiltInZoomControls(false);\n\n        webView.loadUrl(&quot;file:///android_asset/xyz.svg&quot;);\n        webView.setBackgroundColor(Color.TRANSPARENT);\n        webView.setVisibility(View.VISIBLE);\n</code></pre>\n<p>This is working fine. It is fitting SVG in the web view by zooming out.\nBut sometimes, it is loading SVG by doing too much Zoom In. Sometimes SVG is too much zoomed, unable to resolve it.\nThis issue is happening once within 10 attempts.</p>\n"},{"comments":[{"comment_id":122190837,"body":"Your token does not contain a username, so focus your effort to the creation part."},{"comment_id":122191038,"body":"Couldn&#39;t find any user related data in your token. Paste your JWT token <a href=\"https://jwt.io/\" rel=\"nofollow noreferrer\">here</a>. You need to add user related data inside your token when you crates them."},{"comment_id":122224693,"body":"As indicated by sam and ray, your token does not contain any user information (if you copy and paste the token in jet.io, for instance, it will provide no <code>sub</code> value in the payload). The create <code>createAuthenticationToken</code> method looks fine as well as <code>generateToken</code>. Please, try debugging your &#217;serDetails` instance before this line: <code>final String token = jwtTokenUtil.generateToken(userDetails);</code>. Also, be sure that your <code>UserDetails</code> correctly implements the <code>getUsername</code> method, sometimes we derived it from the database and we didn&#39;t implement it correctly. Try debugging the method ..."},{"comment_id":122224696,"body":"<code>doGenerateToken</code> as well, and see the value of the <code>subject</code> variable. I hope I helps."},{"comment_id":122226991,"body":"Sorry, I want to say <a href=\"https://jwt.io\" rel=\"nofollow noreferrer\">jwt.io</a>, not jet.io. My computer translator."},{"comment_id":122350493,"body":"@Value(&quot;${jwt.header}&quot;)     private String tokenHeader;  in AuthenticationRestController,  you are bringing the header part only.. trying using jwt.payload instead jwt.header of  to get Subject Details"},{"comment_id":122353587,"body":"@Nunyet what is the <code>UserSecurityService</code>? Is it your own implementation?"}],"answers":[{"answer_id":69232482,"body":"<p>Double check your jwt token. I think it miss sub attribute( subject or username here).</p>\n<p>I also highly recommend you write the few unit test for few class such as JwtTokenUtil to make sure your code working as expected. You can use spring-test to do it easily.</p>\n<p>It help you discover the bug easier and sooner.</p>\n<p>Here is few test which i used to test the commands &quot;jwt generate&quot; and &quot;jwt parse&quot;</p>\n<pre><code>@Test\n  public void testInvalidKey() {\n    String result = execute(&quot;jwt generate &quot;);\n    Assertions.assertEquals(JsonWebToken.ERR_LOAD_PRIVATE_KEY, result);\n  }\n\n  @Test\n  public void testInvalidExpiredDate() {\n    String result = execute(\n        &quot;jwt generate -exp \\&quot;12-12-2020\\&quot;&quot;);\n    Assertions.assertEquals(JsonWebToken.ERR_INVALID_EXPIRED_DATE, result);\n  }\n\n  @Test\n  public void testGenerateOk() {\n    String result = execute(\n        &quot;jwt generate&quot;);\n    Assertions.assertNotNull(result);\n    Assertions.assertTrue(result.length() &gt; 100);\n  }\n\n  @Test\n  public void testParseToken() {\n    String result = execute(\n        &quot;jwt generate -sub designer&quot;);\n    Assertions.assertNotNull(result);\n    String parse = execute(&quot;jwt parse -token &quot; + result);    \n    Assertions.assertTrue(parse.contains(&quot;sub:designer&quot;));\n  }\n</code></pre>\n<p>And here is few other test which i used to check the controller and filter.</p>\n<pre><code>@Test\n  public void testInValidToken() throws Exception{\n    Map&lt;String, Object&gt; map = new LinkedHashMap&lt;&gt;(reqObj);\n      mockMvc.perform(postWithTokenAndData(getUrlProvider(), map)\n          .header(HEADER_AUTHORIZATION, String.format(&quot;Bearer %s&quot;, INVALID_JWT))\n          .contentType(MediaType.APPLICATION_JSON))\n          .andExpect(MockMvcResultMatchers.status().is4xxClientError());\n  }\n  \n  @Test\n  public void testExpired() throws Exception{\n    Date exp = Date.from(Instant.now().minusSeconds(3600));\n      Map&lt;String, Object&gt; map = new LinkedHashMap&lt;&gt;(reqObj);\n      mockMvc.perform(postWithTokenAndData(getUrlProvider(), map)\n          .header(HEADER_AUTHORIZATION, String.format(&quot;Bearer %s&quot;, JwtHelperTest.getJwtToken(exp,\n              &quot;designer&quot;)))\n          .contentType(MediaType.APPLICATION_JSON))\n          .andExpect(MockMvcResultMatchers.status().is4xxClientError());\n  }\n</code></pre>\n"},{"answer_id":76287985,"body":"<p><code>enter code here</code>@Component\npublic class JwtUtil {</p>\n<pre><code> @Value(&quot;${jwt.secret}&quot;)\n    private String secret;\n\n @Value(&quot;${jwt.expiration}&quot;) \n private Long expiration;\n \n Date now =new Date();\n Date ExpirationDate =new Date(now.getTime()+ expiration*1000);\n\npublic User getUser(final String token) {\n    Claims body = Jwts.parser()\n            .setSigningKey(secret)\n            .parseClaimsJws(token)\n            .getBody();\n\n    User u = new User();\n    u.setUsername(body.getSubject());\n    u.setUserId(Integer.parseInt((String) body.get(&quot;userId&quot;)));\n    Set&lt;Role&gt; roles =new HashSet&lt;&gt;(); \n    roles.add(Role.CONSUMER);\n    roles.add(Role.SELLER);\n    u.setRoles(roles);\n    return u;\n}\n\npublic String generateToken(String username) {\n       User u = new User();\n      Claims claims = Jwts.claims().setSubject(username);\n        claims.put(&quot;userId&quot;, u.getUserId());\n        Set&lt;Role&gt; roles =new HashSet&lt;&gt;(); \n        roles.add(Role.CONSUMER);\n        roles.add(Role.SELLER);\n        claims.put(&quot;role&quot;,roles );\n\n        return Jwts.builder()\n                .setClaims(claims)\n                .setIssuedAt(now)\n                .setExpiration( ExpirationDate)\n                .signWith(SignatureAlgorithm.HS512, secret)\n                .compact();\n    \n}\n\npublic boolean validateToken(final String token) {\n    return getClaims(secret,token)\n            .getExpiration()\n            .after(new Date (System.currentTimeMillis()));\n}\n\npublic Claims getClaims(String secret ,String token) {\n    return Jwts.parser()\n            .setSigningKey(secret)\n            .parseClaimsJws(token)\n            .getBody();\n}\n</code></pre>\n<p>}</p>\n"},{"answer_id":76288162,"body":"<pre><code>[1:25 PM] Prateek Upadhyay\n</code></pre>\n<p>Here is an example of implementing JWT authentication with roles to protect consumer and seller specific endpoints in Java using the Spring Security framework:</p>\n<ol>\n<li>Add the following dependencies to your project's pom.xml file:</li>\n</ol>\n<pre><code>\n&lt;dependency&gt;\n\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\n    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n\n&lt;/dependency&gt;\n\n\n&lt;dependency&gt;\n\n    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;\n\n    &lt;artifactId&gt;jjwt&lt;/artifactId&gt;\n\n    &lt;version&gt;0.9.1&lt;/version&gt;\n\n&lt;/dependency&gt;\n\n</code></pre>\n<ol start=\"2\">\n<li>Create a class named JwtTokenUtil that will handle the creation and validation of JWT tokens:</li>\n</ol>\n<pre><code>\nimport io.jsonwebtoken.Claims;\n\nimport io.jsonwebtoken.Jwts;\n\nimport io.jsonwebtoken.SignatureAlgorithm;\n\nimport org.springframework.beans.factory.annotation.Value;\n\nimport org.springframework.security.core.userdetails.UserDetails;\n\nimport org.springframework.stereotype.Component;\n\n\nimport java.util.Date;\n\nimport java.util.HashMap;\n\nimport java.util.Map;\n\nimport java.util.function.Function;\n\n\n@Component\n\npublic class JwtTokenUtil {\n\n\n    @Value(&quot;${jwt.secret}&quot;)\n\n    private String secret;\n\n\n    @Value(&quot;${jwt.expiration}&quot;)\n\n    private Long expiration;\n\n\n    public String generateToken(UserDetails userDetails, String role) {\n\n        Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();\n\n        claims.put(&quot;role&quot;, role);\n\n        return createToken(claims, userDetails.getUsername());\n\n    }\n\n\n    private String createToken(Map&lt;String, Object&gt; claims, String subject) {\n\n        Date now = new Date();\n\n        Date expirationDate = new Date(now.getTime() + expiration * 1000);\n\n\n        return Jwts.builder()\n\n                .setClaims(claims)\n\n                .setSubject(subject)\n\n                .setIssuedAt(now)\n\n                .setExpiration(expirationDate)\n\n                .signWith(SignatureAlgorithm.HS256, secret)\n\n                .compact();\n\n    }\n\n\n    public Boolean validateToken(String token, UserDetails userDetails) {\n\n        String username = extractUsername(token);\n\n        return (username.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token));\n\n    }\n\n\n    public String extractUsername(String token) {\n\n        return extractClaim(token, Claims::getSubject);\n\n    }\n\n\n    public String extractRole(String token) {\n\n        return (String) extractClaim(token, claims -&gt; claims.get(&quot;role&quot;));\n\n    }\n\n\n    public Date extractExpiration(String token) {\n\n        return extractClaim(token, Claims::getExpiration);\n\n    }\n\n\n    public &lt;T&gt; T extractClaim(String token, Function&lt;Claims, T&gt; claimsResolver) {\n\n        final Claims claims = extractAllClaims(token);\n\n        return claimsResolver.apply(claims);\n\n    }\n\n\n    private Claims extractAllClaims(String token) {\n\n        return Jwts.parser().setSigningKey(secret).parseClaimsJws(token).getBody();\n\n    }\n\n\n    private Boolean isTokenExpired(String token) {\n\n        final Date expiration = extractExpiration(token);\n\n        return expiration.before(new Date());\n\n    }\n\n}\n\n</code></pre>\n<ol start=\"3\">\n<li>Create a class named JwtUserDetailsService that will load user details from the database:</li>\n</ol>\n<pre><code>\nimport org.springframework.beans.factory.annotation.Autowired;\n\nimport org.springframework.security.core.userdetails.User;\n\nimport org.springframework.security.core.userdetails.UserDetails;\n\nimport org.springframework.security.core.userdetails.UserDetailsService;\n\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\n\nimport org.springframework.stereotype.Service;\n\n\n@Service\n\npublic class JwtUserDetailsService implements UserDetailsService {\n\n\n    @Autowired\n\n    private UserRepository userRepository;\n\n\n    @Override\n\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n\n        UserEntity userEntity = userRepository.findByUsername(username);\n\n        if (userEntity == null) {\n\n            throw new UsernameNotFoundException(&quot;User not found with username: &quot; + username);\n\n        }\n\n        return new User(userEntity.getUsername(), userEntity.getPassword(), userEntity.getRoles());\n\n    }\n\n}\n\n</code></pre>\n<ol start=\"4\">\n<li>Create a class named JwtAuthenticationEntryPoint that will handle authentication errors:</li>\n</ol>\n<pre><code>\nimport org.springframework.security.core.AuthenticationException;\n\nimport org.springframework.security.web.AuthenticationEntryPoint;\n\nimport org.springframework.stereotype.Component;\n\n\nimport javax.servlet.ServletException;\n\nimport javax.servlet.http.HttpServletRequest;\n\nimport javax.servlet.http.HttpServletResponse;\n\nimport java.io.IOException;\n\n\n@Component\n\npublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint {\n\n\n    @Override\n\n    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {\n\n        response.sendError(HttpServletResponse.SC_UNAUTHORIZED, &quot;Unauthorized&quot;);\n\n    }\n\n}\n\n</code></pre>\n<ol start=\"5\">\n<li>Create a class named JwtAuthorizationFilter that will handle authorization:</li>\n</ol>\n<pre><code>\nimport org.springframework.beans.factory.annotation.Autowired;\n\nimport org.springframework.security.authentication.UsernamePasswordAuthenticationToken;\n\nimport org.springframework.security.core.context.SecurityContextHolder;\n\nimport org.springframework.security.core.userdetails.UserDetails;\n\nimport org.springframework.security.core.userdetails.UserDetailsService;\n\nimport org.springframework.security.web.authentication.WebAuthenticationDetailsSource;\n\nimport org.springframework.stereotype.Component;\n\nimport org.springframework.web.filter.OncePerRequestFilter;\n\n\nimport javax.servlet.FilterChain;\n\nimport javax.servlet.ServletException;\n\nimport javax.servlet.http.HttpServletRequest;\n\nimport javax.servlet.http.HttpServletResponse;\n\nimport java.io.IOException;\n\n\n@Component\n\npublic class JwtAuthorizationFilter extends OncePerRequestFilter {\n\n\n    @Autowired\n\n    private JwtTokenUtil jwtTokenUtil;\n\n\n    @Autowired\n\n    private UserDetailsService userDetailsService;\n\n\n    @Override\n\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws ServletException, IOException {\n\n        final String authorizationHeader = request.getHeader(&quot;Authorization&quot;);\n\n\n        String username = null;\n\n        String jwt = null;\n\n\n        if (authorizationHeader != null &amp;&amp; authorizationHeader.startsWith(&quot;Bearer &quot;)) {\n\n            jwt = authorizationHeader.substring(7);\n\n            username = jwtTokenUtil.extractUsername(jwt);\n\n        }\n\n\n        if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\n\n            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\n\n\n            if (jwtTokenUtil.validateToken(jwt, userDetails)) {\n\n                UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken = new UsernamePasswordAuthenticationToken(\n\n                        userDetails, null, userDetails.getAuthorities());\n\n                usernamePasswordAuthenticationToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n\n                SecurityContextHolder.getContext().setAuthentication(usernamePasswordAuthenticationToken);\n\n            }\n\n        }\n\n        chain.doFilter(request, response);\n\n    }\n\n}\n\n</code></pre>\n<ol start=\"6\">\n<li>Configure Spring Security in your application by creating a class named SecurityConfig:</li>\n</ol>\n<pre><code>\nimport org.springframework.beans.factory.annotation.Autowired;\n\nimport org.springframework.context.annotation.Bean;\n\nimport org.springframework.context.annotation.Configuration;\n\nimport org.springframework.http.HttpMethod;\n\nimport org.springframework.security.authentication.AuthenticationManager;\n\nimport org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;\n\nimport org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;\n\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\n\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\n\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\n\nimport org.springframework.security.config.http.SessionCreationPolicy;\n\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\n\nimport org.springframework.security.crypto.password.PasswordEncoder;\n\nimport org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;\n\n\n@Configuration\n\n@EnableWebSecurity\n\n@EnableGlobalMethodSecurity(prePostEnabled = true)\n\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n\n    @Autowired\n\n    private JwtAuthenticationEntryPoint jwtAuthenticationEntryPoint;\n\n\n    @Autowired\n\n    private JwtAuthorizationFilter jwtAuthorizationFilter;\n\n\n    @Autowired\n\n    private JwtUserDetailsService jwtUserDetailsService;\n\n\n    @Autowired\n\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n\n        auth.userDetailsService(jwtUserDetailsService).passwordEncoder(passwordEncoder());\n\n    }\n\n\n    @Bean\n\n    public PasswordEncoder passwordEncoder() {\n\n        return new BCryptPasswordEncoder();\n\n    }\n\n\n    @Bean\n\n    @Override\n\n    public AuthenticationManager authenticationManagerBean() throws Exception {\n\n        return super.authenticationManagerBean();\n\n    }\n\n\n    @Override\n\n    protected void configure(HttpSecurity http) throws Exception {\n\n        http.csrf().disable()\n\n                .authorizeRequests()\n\n                .antMatchers(HttpMethod.POST, &quot;/authenticate&quot;).permitAll()\n\n                .antMatchers(&quot;/api/public/**&quot;).permitAll()\n\n                .antMatchers(&quot;/api/auth/consumer/**&quot;).hasRole(&quot;CONSUMER&quot;)\n\n                .antMatchers(&quot;/api/auth/seller/**&quot;).hasRole(&quot;SELLER&quot;)\n\n                .anyRequest().authenticated()\n\n                .and()\n\n                .exceptionHandling().authenticationEntryPoint(jwtAuthenticationEntryPoint)\n\n                .and()\n\n                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n\n\n        http.addFilterBefore(jwtAuthorizationFilter, UsernamePasswordAuthenticationFilter.class);\n\n    }\n\n}\n\n</code></pre>\n<ol start=\"7\">\n<li>Use the JwtTokenUtil class to generate and validate JWT tokens in your controller methods:</li>\n</ol>\n<pre><code>import org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.authentication.UsernamePasswordAuthenticationToken;\nimport org.springframework.security.core.AuthenticationException;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.web.bind.annotation.*;\n\n@RestController\n@RequestMapping(&quot;/authenticate&quot;)\npublic class AuthenticationController {\n\n   @Autowired\n   private AuthenticationManager authenticationManager;\n\n   @Autowired\n   private JwtTokenUtil jwtTokenUtil;\n\n   @Autowired\n   private UserDetailsService userDetailsService;\n\n   @Autowired\n   private PasswordEncoder passwordEncoder;\n\n   @PostMapping\n   public ResponseEntity&lt;?&gt; createAuthenticationToken(@RequestBody AuthenticationRequest authenticationRequest) throws AuthenticationException {\n       authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(authenticationRequest.getUsername(), authenticationRequest.getPassword()));\n\n       final UserDetails userDetails = userDetailsService.loadUserByUsername(authenticationRequest.getUsername());\n       final String token = jwtTokenUtil.generateToken(userDetails, &quot;CONSUMER&quot;);\n\n       return ResponseEntity.ok(new AuthenticationResponse(token));\n   }\n\n   @PostMapping(&quot;/register&quot;)\n   public ResponseEntity&lt;?&gt; registerUser(@RequestBody UserEntity userEntity) {\n       userEntity.setPassword(passwordEncoder.encode(userEntity.getPassword()));\n       userEntity.setRoles(&quot;CONSUMER&quot;);\n       userRepository.save(userEntity);\n       return ResponseEntity.ok(&quot;User registered successfully&quot;);\n   }\n}\n</code></pre>\n<p>In this example, the JwtTokenUtil class is used to generate and validate JWT tokens with the role of &quot;CONSUMER&quot; or &quot;SELLER&quot;. The JwtUserDetailsService class is used to load user details from the database, and the JwtAuthorizationFilter class is used to handle authorization. The SecurityConfig class is used to configure Spring Security, and the AuthenticationController class is used to handle authentication and registration requests.</p>\n"},{"answer_id":76314014,"body":"<p>Certainly! Here's some example code in Java using Spring Boot for the two endpoints described in the image:</p>\n<pre><code>@RestController\n@RequestMapping(&quot;/api/public&quot;)\npublic class ProductController {\n\n @Autowired\n private ProductService productService;\n\n // Endpoint for product search\n @GetMapping(&quot;/product/search&quot;)\n public List&lt;Product&gt; searchProducts(@RequestParam(&quot;keyword&quot;) String keyword) {\n   return productService.searchProducts(keyword);\n }\n\n}\n\n@RestController\n@RequestMapping(&quot;/api/public&quot;)\npublic class AuthController {\n\n @Autowired\n private AuthService authService;\n\n // Endpoint for user authentication\n @PostMapping(&quot;/login&quot;)\n public ResponseEntity&lt;?&gt; login(@RequestBody UserCredentials credentials) {\n   try {\n     String token = authService.authenticate(credentials.getUsername(), credentials.getPassword());\n     return ResponseEntity.ok(token);\n   } catch (AuthenticationException e) {\n     return ResponseEntity.status(HttpStatus.UNAUTHORIZED).build();\n   }\n }\n\n}\n\n@Service\npublic class ProductService {\n\n @Autowired\n private ProductRepository productRepository;\n\n public List&lt;Product&gt; searchProducts(String keyword) {\n   return productRepository.findByProductNameContainingIgnoreCaseOrCategoryNameContainingIgnoreCase(keyword, keyword);\n }\n\n}\n\n@Service\npublic class AuthService {\n\n @Autowired\n private UserRepository userRepository;\n\n public String authenticate(String username, String password) throws AuthenticationException {\n   User user = userRepository.findByUsername(username);\n   if (user == null || !user.getPassword().equals(password)) {\n     throw new AuthenticationException(&quot;Invalid username or password&quot;);\n   }\n   return generateToken(user);\n }\n\n private String generateToken(User user) {\n   // Generate JWT for user\n   return &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.&quot; +\n          &quot;eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.&quot; +\n          &quot;SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c&quot;;\n }\n\n}\n\n@Entity\npublic class Product {\n\n @Id\n private Long id;\n\n private String productName;\n\n private Double price;\n\n private String categoryName;\n\n // Getters and setters\n // ...\n\n}\n\n@Entity\npublic class User {\n\n @Id\n private Long id;\n\n private String username;\n\n private String password;\n\n // Getters and setters\n // ...\n\n}\n\npublic interface ProductRepository extends JpaRepository&lt;Product, Long&gt; {\n\n List&lt;Product&gt; findByProductNameContainingIgnoreCaseOrCategoryNameContainingIgnoreCase(String productName, String categoryName);\n\n}\n\npublic interface UserRepository extends JpaRepository&lt;User, Long&gt; {\n\n User findByUsername(String username);\n\n}\n</code></pre>\n<p>Note that this is just example code and may need to be adapted to your specific use case.</p>\n"}],"last_activity_date":1684841168,"question_id":69134968,"body":"<p>I have this class:</p>\n<pre><code>@Configuration\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true)\npublic class ApiWebSecurityConfig extends WebSecurityConfigurerAdapter {\n\n    private static final String SALT = &quot;fd&amp;lkj§isfs23#$1*(_)nof&quot;;\n\n    private final JwtAuthenticationEntryPoint unauthorizedHandler;\n    private final JwtTokenUtil jwtTokenUtil;\n    private final UserSecurityService userSecurityService;\n\n    @Value(&quot;${jwt.header}&quot;)\n    private String tokenHeader;\n\n\n    public ApiWebSecurityConfig(JwtAuthenticationEntryPoint unauthorizedHandler, JwtTokenUtil jwtTokenUtil,\n            UserSecurityService userSecurityService) {\n        this.unauthorizedHandler = unauthorizedHandler;\n        this.jwtTokenUtil = jwtTokenUtil;\n        this.userSecurityService = userSecurityService;\n    }\n\n    @Autowired\n    public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\n        auth\n                .userDetailsService(userSecurityService)\n                .passwordEncoder(passwordEncoder());\n    }\n\n    @Bean\n    public BCryptPasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder(12, new SecureRandom(SALT.getBytes()));\n    }\n\n    @Bean\n    @Override\n    public AuthenticationManager authenticationManagerBean() throws Exception {\n        return super.authenticationManagerBean();\n    }\n\n    @Override\n    protected void configure(HttpSecurity httpSecurity) throws Exception {\n\n        httpSecurity\n                // we don't need CSRF because our token is invulnerable\n                .csrf().disable()\n\n                .exceptionHandling().authenticationEntryPoint(unauthorizedHandler).and()\n\n                // don't create session\n                .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()\n                .authorizeRequests()\n                // Un-secure H2 Database\n                .antMatchers(&quot;/h2-console/**/**&quot;).permitAll()\n                .antMatchers(&quot;/api/v1/users&quot;).permitAll()\n                .antMatchers(&quot;/error&quot;).permitAll()\n                .anyRequest().authenticated();\n\n        // Custom JWT based security filter\n        JwtAuthorizationTokenFilter authenticationTokenFilter = new JwtAuthorizationTokenFilter(userDetailsService(), jwtTokenUtil, tokenHeader);\n        httpSecurity\n                .addFilterBefore(authenticationTokenFilter, UsernamePasswordAuthenticationFilter.class);\n\n        // disable page caching\n        httpSecurity\n                .headers()\n                .frameOptions()\n                .sameOrigin()  // required to set for H2 else H2 Console will be blank.\n                .cacheControl();\n    }\n\n    @Override\n    public void configure(WebSecurity web) {\n\n        // AuthenticationTokenFilter will ignore the below paths\n        web\n                .ignoring()\n                .antMatchers(\n                        HttpMethod.POST,\n                        &quot;/api/v1/auth&quot;\n                )\n                .antMatchers(\n                        HttpMethod.POST,\n                        &quot;/api/v1/users&quot;\n                )\n                .antMatchers(\n                        HttpMethod.GET,\n                        &quot;/api/v1/countries&quot;\n                );\n\n    }\n\n}\n</code></pre>\n<p>and</p>\n<pre><code>@Provider\n@Slf4j\npublic class JwtAuthorizationTokenFilter extends OncePerRequestFilter {\n\n    private UserDetailsService userDetailsService;\n    private JwtTokenUtil jwtTokenUtil;\n    private String tokenHeader;\n\n    public JwtAuthorizationTokenFilter(UserDetailsService userDetailsService,\n            JwtTokenUtil jwtTokenUtil,\n            String tokenHeader) {\n        this.userDetailsService = userDetailsService;\n        this.jwtTokenUtil = jwtTokenUtil;\n        this.tokenHeader = tokenHeader;\n    }\n\n\n    @Override\n    protected boolean shouldNotFilter(HttpServletRequest request) {\n        return new AntPathMatcher().match(&quot;/api/v1/users&quot;,\n                request.getServletPath());\n    }\n\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws ServletException,\n            IOException {\n\n        log.info(&quot;processing authentication for '{}'&quot;, request.getRequestURL());\n        log.info(&quot;tokenHeader '{}'&quot;, tokenHeader);\n\n        final String requestHeader = request.getHeader(this.tokenHeader);\n\n        log.info(&quot;requestHeader '{}'&quot;, requestHeader);\n\n        String username = null;\n        String authToken = null;\n\n        if (requestHeader != null &amp;&amp; requestHeader.startsWith(&quot;Bearer &quot;)) {\n            authToken = requestHeader.substring(7);\n\n            log.info(&quot;authToken '{}'&quot;, authToken);\n\n            try {\n                username = jwtTokenUtil.getUsernameFromToken(authToken);\n            } catch (IllegalArgumentException e) {\n                logger.info(&quot;an error occured during getting username from token&quot;, e);\n            } catch (ExpiredJwtException e) {\n                logger.info(&quot;the token is expired and not valid anymore&quot;, e);\n            }\n        } else {\n            logger.info(&quot;couldn't find bearer string, will ignore the header&quot;);\n        }\n\n        log.info(&quot;checking authentication for user '{}'&quot;, username);\n\n        if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\n            logger.info(&quot;security context was null, so authorizating user&quot;);\n\n            // It is not compelling necessary to load the use details from the database. You could also store the information\n            // in the token and read it from it. It's up to you ;)\n            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);\n\n            // For simple validation it is completely sufficient to just check the token integrity. You don't have to call\n            // the database compellingly. Again it's up to you ;)\n            if (jwtTokenUtil.validateToken(authToken, userDetails)) {\n                UsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(userDetails, null, userDetails.getAuthorities());\n                authentication.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n                log.info(&quot;authorizated user '{}', setting security context&quot;, username);\n                SecurityContextHolder.getContext().setAuthentication(authentication);\n            }\n        }\n        chain.doFilter(request, response);\n    }\n}\n</code></pre>\n<p>and</p>\n<pre><code>@RestController\n@Slf4j\npublic class AuthenticationRestController {\n\n\n    private static final Logger LOG = LoggerFactory.getLogger   (AuthenticationRestController.class);\n\n    @Value(&quot;${jwt.header}&quot;)\n    private String tokenHeader;\n\n    @Autowired\n    private AuthenticationManager authenticationManager;\n\n    @Autowired\n    private JwtTokenUtil jwtTokenUtil;\n\n    @Autowired\n    private UserSecurityService userSecurityService;\n\n    @PostMapping(path = &quot;/api/v1/auth&quot;, consumes = &quot;application/json&quot;, produces = &quot;application/json&quot;)\n    public ResponseEntity&lt;JwtAuthenticationResponse&gt;\n    createAuthenticationToken(  @RequestBody JwtAuthenticationRequest authenticationRequest,\n            HttpServletRequest request) throws AuthenticationException {\n\n        LOG.info(&quot;authenticating {} &quot; , authenticationRequest.getUsername());\n\n        authenticate(authenticationRequest.getUsername(), authenticationRequest.getPassword());\n\n        // Reload password post-security so we can generate the token\n        final User userDetails = (User) userSecurityService.loadUserByUsername(authenticationRequest.getUsername());\n\n        if (!userDetails.isEnabled()) {\n            throw new UserDisabledException();\n        }\n\n        if (LOG.isDebugEnabled()) {\n            LOG.debug(&quot;UserDetails userDetails [ &quot; + authenticationRequest.getUsername() + &quot; ]&quot;);\n        }\n\n\n        final String token = jwtTokenUtil.generateToken(userDetails);\n\n        // Return the token\n        return ResponseEntity.ok(new JwtAuthenticationResponse(token));\n    }\n\n\n    @GetMapping(path = &quot;${jwt.route.authentication.refresh}&quot;, consumes = &quot;application/json&quot;, produces = &quot;application/json&quot;)\n    public ResponseEntity&lt;?&gt; refreshAndGetAuthenticationToken(HttpServletRequest request) {\n        String authToken = request.getHeader(tokenHeader);\n        final String token = authToken.substring(7);\n        String username = jwtTokenUtil.getUsernameFromToken(token);\n        JwtUser user = (JwtUser) userSecurityService.loadUserByUsername(username);\n\n        if (jwtTokenUtil.canTokenBeRefreshed(token, user.getLastPasswordResetDate())) {\n            String refreshedToken = jwtTokenUtil.refreshToken(token);\n            return ResponseEntity.ok(new JwtAuthenticationResponse(refreshedToken));\n        } else {\n            return ResponseEntity.badRequest().body(null);\n        }\n    }\n\n    @ExceptionHandler({AuthenticationException.class})\n    public ResponseEntity&lt;String&gt; handleAuthenticationException(AuthenticationException e) {\n        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(e.getMessage());\n    }\n\n    /**\n     * Authenticates the user. If something is wrong, an {@link AuthenticationException} will be thrown\n     */\n    private void authenticate(String username, String password) {\n\n        Objects.requireNonNull(username);\n        Objects.requireNonNull(password);\n\n\n        try {\n            authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(username, password));\n        } catch (DisabledException e) {\n            e.printStackTrace();\n            throw new AuthenticationException(&quot;User is disabled!&quot;, e);\n        } catch (BadCredentialsException e) {\n            throw new AuthenticationException(&quot;Bad credentials!&quot;, e);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<p>and</p>\n<pre><code>@RestController\n@RequestMapping(&quot;/api/v1/styles&quot;)\n@Slf4j\npublic class StyleResourceController  {\n\n    \n    @PutMapping(path = &quot;/{styleCode}&quot;)\n    @ResponseStatus(HttpStatus.OK)\n    public void setAlerts(@RequestHeader(value = &quot;Authorization&quot;) String authHeader, @PathVariable String styleCode)\n\n            throws DataAccessException {\n\n        System.out.println(&quot;add style {} &quot;);\n\n        final User user = authUserOnPath(authHeader);\n\n        System.out.println(&quot;user {} &quot; + user);\n\n            protected User authUserOnPath(String authHeader) {\n\n        String authToken = authHeader.substring(7);\n\n        String username = jwtTokenUtil.getUsernameFromToken(authToken);\n        User user = userService.findByUserName(username);\n\n        if (user == null)\n            throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, &quot;UserNotFound&quot;);\n\n        return user;\n\n    }\n\n\n    }\n\n}\n</code></pre>\n<p>and</p>\n<pre><code>@Component\npublic class JwtTokenUtil implements Serializable {\n\n    //static final String CLAIM_KEY_USERNAME = &quot;sub&quot;;\n    //static final String CLAIM_KEY_CREATED = &quot;iat&quot;;\n    private static final long serialVersionUID = -3301605591108950415L;\n    // @SuppressFBWarnings(value = &quot;SE_BAD_FIELD&quot;, justification = &quot;It's okay here&quot;)\n    private Clock clock = DefaultClock.INSTANCE;\n\n    @Value(&quot;${jwt.secret}&quot;)\n    private String secret;\n\n    @Value(&quot;${jwt.expiration}&quot;)\n    private Long expiration;\n\n    public String getUsernameFromToken(String token) {\n        return getClaimFromToken(token, Claims::getSubject);\n    }\n\n    public Date getIssuedAtDateFromToken(String token) {\n        return getClaimFromToken(token, Claims::getIssuedAt);\n    }\n\n    public Date getExpirationDateFromToken(String token) {\n        return getClaimFromToken(token, Claims::getExpiration);\n    }\n\n    public &lt;T&gt; T getClaimFromToken(String token, Function&lt;Claims, T&gt; claimsResolver) {\n        final Claims claims = getAllClaimsFromToken(token);\n        return claimsResolver.apply(claims);\n    }\n\n    private Claims getAllClaimsFromToken(String token) {\n        return Jwts.parser()\n                .setSigningKey(secret)\n                .parseClaimsJws(token)\n                .getBody();\n    }\n\n    private Boolean isTokenExpired(String token) {\n        final Date expiration = getExpirationDateFromToken(token);\n        return expiration.before(clock.now());\n    }\n\n    private Boolean isCreatedBeforeLastPasswordReset(Date created, Date lastPasswordReset) {\n        return (lastPasswordReset != null &amp;&amp; created.before(lastPasswordReset));\n    }\n\n    private Boolean ignoreTokenExpiration(String token) {\n        // here you specify tokens, for that the expiration is ignored\n        return false;\n    }\n\n    public String generateToken(UserDetails userDetails) {\n        Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();\n        return doGenerateToken(claims, userDetails.getUsername());\n    }\n\n    private String doGenerateToken(Map&lt;String, Object&gt; claims, String subject) {\n        final Date createdDate = clock.now();\n        final Date expirationDate = calculateExpirationDate(createdDate);\n\n        return Jwts.builder()\n                .setClaims(claims)\n                .setSubject(subject)\n                .setIssuedAt(createdDate)\n                .setExpiration(expirationDate)\n                .signWith(SignatureAlgorithm.HS512, secret)\n                .compact();\n    }\n\n    public Boolean canTokenBeRefreshed(String token, Date lastPasswordReset) {\n        final Date created = getIssuedAtDateFromToken(token);\n        return !isCreatedBeforeLastPasswordReset(created, lastPasswordReset)\n                &amp;&amp; (!isTokenExpired(token) || ignoreTokenExpiration(token));\n    }\n\n    public String refreshToken(String token) {\n        final Date createdDate = clock.now();\n        final Date expirationDate = calculateExpirationDate(createdDate);\n\n        final Claims claims = getAllClaimsFromToken(token);\n        claims.setIssuedAt(createdDate);\n        claims.setExpiration(expirationDate);\n\n        return Jwts.builder()\n                .setClaims(claims)\n                .signWith(SignatureAlgorithm.HS512, secret)\n                .compact();\n    }\n\n    public Boolean validateToken(String token, UserDetails userDetails) {\n        JwtUser user = (JwtUser) userDetails;\n        final String username = getUsernameFromToken(token);\n        final Date created = getIssuedAtDateFromToken(token);\n        return (\n                username.equals(user.getUsername())\n                        &amp;&amp; !isTokenExpired(token)\n                        &amp;&amp; !isCreatedBeforeLastPasswordReset(created, user.getLastPasswordResetDate())\n        );\n    }\n\n    private Date calculateExpirationDate(Date createdDate) {\n        return new Date(createdDate.getTime() + expiration * 1000);\n    }\n}\n</code></pre>\n<p>but when I get the user from the token is null:</p>\n<pre><code>17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - tokenHeader 'Authorization'\n17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - requestHeader 'Bearer eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE2OTE3NjcxMzYsImlhdCI6MTYzMTI4NzEzNn0.C9s3dbjWNVyGdV5k0LXsNhMGMvPzboTx1J6sGEbfXVOP1CzCLeZFgVPQ4o8jgugvgURF3BcnsWAk7ygd7RCvdg'\n17:19:22.017 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - authToken 'eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE2OTE3NjcxMzYsImlhdCI6MTYzMTI4NzEzNn0.C9s3dbjWNVyGdV5k0LXsNhMGMvPzboTx1J6sGEbfXVOP1CzCLeZFgVPQ4o8jgugvgURF3BcnsWAk7ygd7RCvdg'\n17:19:22.018 [http-nio-1133-exec-8] INFO  c.d.c.JwtAuthorizationTokenFilter - checking authentication for user 'null'\n</code></pre>\n"},{"answers":[{"comments":[{"comment_id":133693123,"body":"is possıable to emulate Tag Type ISO 14443-3A   NXP MİFARE CLASSİC 1K with out root for example"},{"comment_id":133693228,"body":"Tag 4 Type:   The NFC Tag 4 Type is defined to be compatible with ISO 14443A and ISO 14443B standard (13.56MHz).  This mean we can emulate this with HCE right"},{"comment_id":133700346,"body":"&quot;Emulate MİFARE CLASSİC 1K with out root&quot;, this is the one that I believe that if your phone uses a NXP chipset it might be possible with a rooted phone, but not all phones use NXP chipsets. Just to clarify I believe that only the &quot;A&quot; modulation is supported by HCE and you have no control over the ISO 14443 level of the protocol (ISO 14443 is just used for anti collision and the UID related to that is a random number). HCE only gives you control of the ISO 7816-4 (Application protocol) used by type 4 Tags"},{"comment_id":133718040,"body":"<a href=\"https://shop.sonmicro.com/SM5210\" rel=\"nofollow noreferrer\">shop.sonmicro.com/SM5210</a> is this rfid chip can read phone emulator nfc. or how to know its type is ?"}],"answer_id":75789626,"body":"<p>There are many different types of NFC Tags</p>\n<p>You can emulate a Type 4 tag without rooting the phone.\nAs you have seen this can be done as per <a href=\"https://developer.android.com/guide/topics/connectivity/nfc/hce\" rel=\"nofollow noreferrer\">https://developer.android.com/guide/topics/connectivity/nfc/hce</a></p>\n<p>An example of HCE is available at <a href=\"https://github.com/underwindfall/NFCAndroid\" rel=\"nofollow noreferrer\">https://github.com/underwindfall/NFCAndroid</a></p>\n<p>This works without rooting the phone.</p>\n<p>I believe that some (not all) phone hardware might be able to emulate one other type of Tag if you have rooted the phone and know the non public API to access the hardware in the right manner (not confirmed).</p>\n"}],"last_activity_date":1684840315,"question_id":75789540,"body":"<p>I am developing a simple app that emulates reading a card.</p>\n<p>The big problem is, is it possible to emulate a card WITHOUT root access on an Android device?</p>\n<p>if yes, can you share your information</p>\n<p>thank you all.</p>\n<p>I have looked at the following:\n<a href=\"https://developer.android.com/guide/topics/connectivity/nfc/hce\" rel=\"nofollow noreferrer\">https://developer.android.com/guide/topics/connectivity/nfc/hce</a></p>\n<p>this is the working app with root access only\n<a href=\"https://play.google.com/store/apps/details?id=com.yuanwofei.cardemulator.pro&amp;hl=tr&amp;gl=US\" rel=\"nofollow noreferrer\">https://play.google.com/store/apps/details?id=com.yuanwofei.cardemulator.pro&amp;hl=tr&amp;gl=US</a></p>\n"},{"answers":[{"comments":[{"comment_id":91219560,"body":"it seems your snippet only generates 2 Strings!"}],"answer_id":52134782,"body":"<p>Convert number 1 to String \"001\" via below code:</p>\n\n<pre><code>  int num = 1; \n  String var = String.format(\"%03d\", num); // var is \"001\"\n  int num = 99; \n  String var = String.format(\"%03d\", num); // var is \"099\"\n</code></pre>\n\n<p>and you could split 001001-001099 into two strings, each string has three digits.</p>\n"},{"comments":[{"comment_id":91221127,"body":"Or, of course, go between 1001 and 1100, and format with <code>%06d</code>."}],"answer_id":52134791,"body":"<p>Simply you can use this snippet to generate your desired sequence:</p>\n\n<pre><code>    for (int i = 1; i &lt; 100; i++) {\n        String res = String.format(Locale.getDefault(), \"001%03d\", i);\n    }\n</code></pre>\n"},{"answer_id":76314058,"body":"<pre><code>@PostMapping(&quot;/save&quot;)\npublic String save(Candidate c, @RequestParam String firstname, @RequestParam String lastname) {\n    // Retrieve the last CID from the repository\n    Candidate lastCandidate = repo.findLastCandidate();\n    String lastCid = lastCandidate != null ? lastCandidate.getCid() : null;\n\n    // Increment the sequence number\n    int sequenceNumber = 1;\n    if (lastCid != null) {\n        // Extract the sequence number from the last CID\n        String lastSequenceNumber = lastCid.substring(lastCid.length() - 3);\n        sequenceNumber = Integer.parseInt(lastSequenceNumber) + 1;\n    }\n\n    // Get the first four letters of the user's first name\n    String firstNamePrefix = firstname.substring(0, Math.min(firstname.length(), 4)).toUpperCase();\n\n    // Format the new CID with the user's first name prefix and the incremented sequence number\n    String candidateId = firstname.substring(0, 4) + String.format(&quot;%03d&quot;, sequenceNumber);\n    // Check if the CID already exists\n    while (repo.existsById(candidateId)) {\n        candidateId = String.format(&quot;%03d&quot;, sequenceNumber++);\n    }\n\n    c.setCid(candidateId);\n    c.setFirstname(firstname);\n    c.setLastname(lastname);\n\n    // Save the candidate to the database\n    repo.save(c);\n\n    return &quot;Success&quot;;\n}\n</code></pre>\n<p>this is output how to increment  JOHN001  sequence without reapting duplicate</p>\n"}],"last_activity_date":1684840114,"question_id":52134728,"body":"<p>Please help me, I don't know how to create an auto-incrementing number that starts with 001 - 999 in Android studio..</p>\n<p>I want to play audio from url like <a href=\"http://www.everyayah.com/data/Alafasy_64kbps/001001.Mp3\" rel=\"nofollow noreferrer\">this</a>.</p>\n<p>I want to modify 001001 to 001002, 001003 &gt;&gt; 001099 etc</p>\n<p>Thanks in advance..!</p>\n"},{"comments":[{"comment_id":134572749,"body":"What method calls are you doing before you call <code>compareDescription</code>? This might be a case of <a href=\"https://stackoverflow.com/questions/13102045/scanner-is-skipping-nextline-after-using-next-or-nextfoo\">Scanner is skipping nextLine() after using next() or nextFoo()?</a>"},{"comment_id":134572797,"body":"Exactly as @OHGODSPIDERS says -- it seems that we may be missing the offending code. A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would clear this up."}],"last_activity_date":1684840099,"question_id":76314003,"body":"<p>In Java, my problem is in the second printing line, it doesn't print at all which is &quot;Give a Description for the Found Item: &quot; Although during the execution the code works well and gives the expected result.</p>\n<pre><code>   public void compareDescription(){\n   Scanner scanner=new Scanner (System.in);\n    System.out.print(&quot;Give a Description for the Lost Item: &quot;);\n    \n\n    String LostItem= scanner.nextLine();\n    System.out.println(&quot;Give a Description for the Found Item: &quot;);\n    String FoundItem = scanner.nextLine();\n\n    if (LostItem.equalsIgnoreCase(FoundItem))\nSystem.out.println(&quot;Description is matched&quot;);\n    else {\n        System.out.println(&quot;Description is not matched&quot;); }\n   }\n</code></pre>\n"},{"comments":[{"comment_id":134567491,"body":"Stored procedure don&#39;t throw exceptions. They throw database errors that may be translated to SQL exceptions by the JDBC driver."},{"comment_id":134567754,"body":"@aled yes, I wonder why DBeaver client could capture the <code>SQLException</code> but I couldn&#39;t capture it by the JDBC driver."},{"comment_id":134571289,"body":"Error handling of SQL Server procedures is <i>notoriously</i> hard in jdbc, because the exception can come in various places. if you need some specific help, you need to post your jdbc code"},{"comment_id":134572618,"body":"@siggemannen Have updated my question."},{"comment_id":134573450,"body":"Thanks, which code do you get NPE on? Since you didn&#39;t post whole method"}],"last_activity_date":1684840013,"question_id":76310827,"body":"<p>I have the SP like the following:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>ALTER procedure dbo.TroubleSomeSP\nas\nBEGIN\n--  SELECT CONVERT(varchar(10), cast(nullif('2023-10-10', '') as date), 120);\n    SELECT CONVERT(varchar(10), cast(nullif('nothin', '') as date), 120);\nEND\n</code></pre>\n<p>it will throw a <code>NullPointerException</code> with the anwser code from this question: <a href=\"https://stackoverflow.com/questions/42169951/how-to-get-everything-back-from-a-stored-procedure-using-jdbc\">How to get *everything* back from a stored procedure using JDBC</a>, since the <code>ResultSet</code> is <code>null</code>, it should be throw a <code>type convert</code> error but a <code>NullPointerException</code>.</p>\n<p>But, if open the first sql, it's worked.</p>\n<pre class=\"lang-sql prettyprint-override\"><code>ALTER procedure dbo.TroubleSomeSP\nas\nBEGIN\n    SELECT CONVERT(varchar(10), cast(nullif('2023-10-10', '') as date), 120);\n    SELECT CONVERT(varchar(10), cast(nullif('nothin', '') as date), 120);\nEND\n</code></pre>\n<p>DBeaver client could capture the error correctlly both:\n<a href=\"https://i.stack.imgur.com/adhK2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/adhK2.png\" alt=\"enter image description here\" /></a></p>\n<p>So I wonder how to get the &quot;right&quot; exceptions when using JDBC driver to execute SP.</p>\n<p>java code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>        // get connection from HikariDataSource\n        Connection connection = ConnectionPool.getConnection();\n\n        System.out.printf(&quot;Get connection from pool: %s\\n&quot;, connection);\n\n        try (CallableStatement cstmt = connection.prepareCall(&quot;{call dbo.sp_lp_no_params}&quot;);) {\n            int     numberOfResultsProcessed = 0;\n            boolean resultSetAvailable       = false;\n\n            try {\n                resultSetAvailable = cstmt.execute();\n            } catch (SQLServerException sse) {\n                System.out.printf(&quot;Exception thrown on execute: %s%n%n&quot;, sse.getMessage());\n                numberOfResultsProcessed++;\n            }\n\n            int updateCount = -2;  // initialize to impossible(?) value\n            while (true) {\n                boolean exceptionOccurred = true;\n                do {\n                    try {\n                        if (numberOfResultsProcessed &gt; 0) {\n                            resultSetAvailable = cstmt.getMoreResults();\n                        }\n                        exceptionOccurred = false;\n                        updateCount = cstmt.getUpdateCount();\n                    } catch (SQLServerException sse) {\n                        System.out.printf(&quot;Current result is an exception: %s%n%n&quot;, sse.getMessage());\n                    }\n                    numberOfResultsProcessed++;\n                } while (exceptionOccurred);\n\n                if ((!resultSetAvailable) &amp;&amp; (updateCount == -1)) {\n                    break;  // we're done\n                }\n\n                if (resultSetAvailable) {\n                    System.out.println(&quot;Current result is a ResultSet:&quot;);\n                    try (ResultSet rs = cstmt.getResultSet()) {\n                        try {\n                            while (rs.next()) {\n                                System.out.println(rs.getString(1));\n                            }\n                        } catch (SQLServerException sse) {\n                            System.out.printf(&quot;Exception while processing ResultSet: %s%n&quot;, sse);\n                        }\n                    }\n                } else {\n                    System.out.printf(&quot;Current result is an update count: %d %s affected%n&quot;, updateCount, updateCount == 1 ? &quot;row was&quot; : &quot;rows were&quot;);\n                }\n                System.out.println();\n            }\n\n        } catch (SQLException e) {\n            System.out.println(&quot;# SQL server SP error！&quot;);\n            throw new RuntimeException(e);\n        } finally {\n            // close connection \n            connection.close();\n        }\n    }\n</code></pre>\n<p>log:</p>\n<pre><code>15:49:13.533 [main] INFO com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...\n15:49:14.680 [main] INFO com.zaxxer.hikari.pool.PoolBase - HikariPool-1 - Driver does not support get/set network timeout for connections. (com.microsoft.sqlserver.jdbc.SQLServerConnection.getNetworkTimeout()I)\n15:49:14.725 [main] DEBUG com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 5d37805a-6938-4bd6-9117-4040c34aa179\n15:49:14.727 [main] INFO com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.\nGet connection from pool: HikariProxyConnection@131872530 wrapping ConnectionID:1 ClientConnectionId: 5d37805a-6938-4bd6-9117-4040c34aa179\n**Current result is a ResultSet:**\n15:49:18.133 [HikariPool-1 housekeeper] DEBUG com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Pool stats (total=1, active=1, idle=0, waiting=0)\n15:49:18.134 [HikariPool-1 housekeeper] DEBUG com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Fill pool skipped, pool is at sufficient level.\n\nException in thread &quot;main&quot; java.lang.NullPointerException   at com.laipan.test.sqlserver.ExecuteProcedureDemo.main(ExecuteProcedureDemo.java:66)\n\nDisconnected from the target VM, address: '127.0.0.1:55036', transport: 'socket'\n</code></pre>\n"},{"answers":[{"comments":[{"comment_id":119811932,"body":"Thanks for your answer.  When I try your exact proposition, I have this error :  Caused by: com.fasterxml.jackson.databind.JsonMappingException: Scala module 2.10.5 requires Jackson Databind version &gt;= 2.10.0 and &lt; 2.11.0  I also tried to do :  &lt;jackson-bom.version&gt;2.12.3&lt;/jackson-bom.version&gt;  In this case, I have the same error as the start. So :  Caused by: com.fasterxml.jackson.databind.JsonMappingException: Scala module 2.12.3 requires Jackson Databind version &gt;= 2.12.0 and &lt; 2.13.0  I don&#39;t undrestant because jackson databind is in 2.12.3"},{"comment_id":119822465,"body":"Please add your whole pom.xml to the question and the output of <code>mvn dependency:tree</code>.  Ideally, also please add a cut-and-paste of the exception you&#39;re getting."},{"comment_id":119969442,"body":"Hi, I respond to you in comments because it&#39;s too long.  Thanks"}],"answer_id":67779035,"body":"<p>Are you sure of the error?  Scala 2.12 requires Jackson 2.10.x.</p>\n<p>To debug, run <code>mvn dependency:tree</code> to see what dependencies/versions are actually being dragged in.  You are probably getting other Jackson JARs that are not 2.10.x.</p>\n<p>If you are building a Spring project (with parent POM spring-boot-dependencies), set:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;jackson-bom.version&gt;2.10.5.20201202&lt;/jackson-bom.version&gt;\n</code></pre>\n<p>for the latest Jackson that satisfies the Scala requirement.  Otherwise, you'll need to add the following to your <code>&lt;dependencyManagement/&gt;</code>:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>  &lt;dependencyManagement&gt;                                                        \n    &lt;dependencies&gt;\n      ...\n      &lt;dependency&gt;                                                              \n        &lt;groupId&gt;com.fasterxml.jackson&lt;/groupId&gt;                                \n        &lt;artifactId&gt;jackson-bom&lt;/artifactId&gt;                                    \n        &lt;version&gt;${jackson-bom.version}&lt;/version&gt;                               \n        &lt;type&gt;pom&lt;/type&gt;                                                        \n        &lt;scope&gt;import&lt;/scope&gt;                                                   \n      &lt;/dependency&gt;\n      ...\n    &lt;/dependencies&gt;                                                             \n  &lt;/dependencyManagement&gt; \n</code></pre>\n<p>and remove the <code>&lt;version&gt;</code> from you Jackson dependencies.</p>\n"},{"comments":[{"comment_id":119973467,"body":"In your pom.xml, change <code>&lt;jackson-bom.version&gt;2.12.3&lt;&#47;jackson-bom.version&gt;</code> to <code>&lt;jackson-bom.version&gt;2.10.5.20201202&lt;&#47;jackson-bom.version&gt;</code> per my answer above and you should be set,"}],"answer_id":67801058,"body":"<p>Allen D.Ball, my answer is too long for comment. So,\npom.xml :</p>\n<p>\n4.0.0</p>\n<pre><code>&lt;parent&gt;\n    &lt;groupId&gt;fr.cnp.kfk&lt;/groupId&gt;\n    &lt;artifactId&gt;jee&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n&lt;/parent&gt;\n\n&lt;artifactId&gt;kfk-spark-structured-streams&lt;/artifactId&gt;\n&lt;packaging&gt;jar&lt;/packaging&gt;\n\n&lt;name&gt;Spark Structured Streams&lt;/name&gt;\n\n&lt;properties&gt;\n    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;spark.version&gt;3.1.1&lt;/spark.version&gt;\n    &lt;slf4j.version&gt;1.7.7&lt;/slf4j.version&gt;\n    &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt;\n    &lt;scala.version&gt;2.12&lt;/scala.version&gt;\n    &lt;jackson-bom.version&gt;2.12.3&lt;/jackson-bom.version&gt;\n&lt;/properties&gt;\n\n&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n            &lt;configuration&gt;\n                &lt;source&gt;1.8&lt;/source&gt;\n                &lt;target&gt;1.8&lt;/target&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.0.0&lt;/version&gt;\n            &lt;executions&gt;\n                &lt;execution&gt;\n                    &lt;phase&gt;package&lt;/phase&gt;\n                    &lt;goals&gt;\n                        &lt;goal&gt;shade&lt;/goal&gt;\n                    &lt;/goals&gt;\n                    &lt;configuration&gt;\n                        &lt;artifactSet&gt;\n                            &lt;excludes&gt;\n                                &lt;exclude&gt;org.apache.flink:force-shading&lt;/exclude&gt;\n                                &lt;exclude&gt;com.google.code.findbugs:jsr305&lt;/exclude&gt;\n                            &lt;/excludes&gt;\n                        &lt;/artifactSet&gt;\n                        &lt;filters&gt;\n                            &lt;filter&gt;\n                                &lt;artifact&gt;*:*&lt;/artifact&gt;\n                                &lt;excludes&gt;\n                                    &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;\n                                    &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;\n                                &lt;/excludes&gt;\n                            &lt;/filter&gt;\n                        &lt;/filters&gt;\n                        &lt;transformers&gt;\n                            &lt;transformer\n                                implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;\n                                &lt;mainClass&gt;fr.cnp.kfk.streams.Application&lt;/mainClass&gt;\n                            &lt;/transformer&gt;\n                        &lt;/transformers&gt;\n                    &lt;/configuration&gt;\n                &lt;/execution&gt;\n            &lt;/executions&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n\n    &lt;pluginManagement&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;1.8&lt;/source&gt;\n                    &lt;target&gt;1.8&lt;/target&gt;\n                    &lt;compilerId&gt;jdt&lt;/compilerId&gt;\n                &lt;/configuration&gt;\n                &lt;dependencies&gt;\n                    &lt;dependency&gt;\n                        &lt;groupId&gt;org.eclipse.tycho&lt;/groupId&gt;\n                        &lt;artifactId&gt;tycho-compiler-jdt&lt;/artifactId&gt;\n                        &lt;version&gt;0.21.0&lt;/version&gt;\n                    &lt;/dependency&gt;\n                &lt;/dependencies&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.eclipse.m2e&lt;/groupId&gt;\n                &lt;artifactId&gt;lifecycle-mapping&lt;/artifactId&gt;\n                &lt;version&gt;1.0.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;lifecycleMappingMetadata&gt;\n                        &lt;pluginExecutions&gt;\n                            &lt;pluginExecution&gt;\n                                &lt;pluginExecutionFilter&gt;\n                                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                                    &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n                                    &lt;versionRange&gt;[2.4,)&lt;/versionRange&gt;\n                                    &lt;goals&gt;\n                                        &lt;goal&gt;single&lt;/goal&gt;\n                                    &lt;/goals&gt;\n                                &lt;/pluginExecutionFilter&gt;\n                                &lt;action&gt;\n                                    &lt;ignore /&gt;\n                                &lt;/action&gt;\n                            &lt;/pluginExecution&gt;\n                            &lt;pluginExecution&gt;\n                                &lt;pluginExecutionFilter&gt;\n                                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                                    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                                    &lt;versionRange&gt;[3.1,)&lt;/versionRange&gt;\n                                    &lt;goals&gt;\n                                        &lt;goal&gt;testCompile&lt;/goal&gt;\n                                        &lt;goal&gt;compile&lt;/goal&gt;\n                                    &lt;/goals&gt;\n                                &lt;/pluginExecutionFilter&gt;\n                                &lt;action&gt;\n                                    &lt;ignore /&gt;\n                                &lt;/action&gt;\n                            &lt;/pluginExecution&gt;\n                        &lt;/pluginExecutions&gt;\n                    &lt;/lifecycleMappingMetadata&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/pluginManagement&gt;\n&lt;/build&gt;\n\n&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;fr.cnp.kfk&lt;/groupId&gt;\n        &lt;artifactId&gt;kfk-commons&lt;/artifactId&gt;\n        &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\n        &lt;artifactId&gt;spark-sql_${scala.version}&lt;/artifactId&gt;\n        &lt;version&gt;${spark.version}&lt;/version&gt;\n        &lt;exclusions&gt;\n            &lt;exclusion&gt;\n                &lt;groupId&gt;org.codehaus.janino&lt;/groupId&gt;\n                &lt;artifactId&gt;janino&lt;/artifactId&gt;\n            &lt;/exclusion&gt;\n            &lt;exclusion&gt;\n                &lt;groupId&gt;org.codehaus.janino&lt;/groupId&gt;\n                &lt;artifactId&gt;commons-compiler&lt;/artifactId&gt;\n            &lt;/exclusion&gt;\n        &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\n        &lt;artifactId&gt;spark-sql-kafka-0-10_2.12&lt;/artifactId&gt;\n        &lt;version&gt;3.1.1&lt;/version&gt;\n        &lt;exclusions&gt;\n            &lt;exclusion&gt;\n                &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n                &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;\n            &lt;/exclusion&gt;\n        &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;\n        &lt;artifactId&gt;spark-streaming_${scala.version}&lt;/artifactId&gt;\n        &lt;version&gt;${spark.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.opencsv&lt;/groupId&gt;\n        &lt;artifactId&gt;opencsv&lt;/artifactId&gt;\n        &lt;version&gt;4.1&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-dataformat-yaml&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-module-scala_${scala.version}&lt;/artifactId&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- Dépendences pour RecksDB --&gt;\n    &lt;!-- &lt;dependency&gt; &lt;groupId&gt;org.apache.flink&lt;/groupId&gt; &lt;artifactId&gt;flink-statebackend-rocksdb_2.12&lt;/artifactId&gt; \n        &lt;version&gt;${flink.version}&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; --&gt;\n\n    &lt;dependency&gt;\n        &lt;artifactId&gt;janino&lt;/artifactId&gt;\n        &lt;groupId&gt;org.codehaus.janino&lt;/groupId&gt;\n        &lt;version&gt;3.0.8&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;artifactId&gt;commons-compiler&lt;/artifactId&gt;\n        &lt;groupId&gt;org.codehaus.janino&lt;/groupId&gt;\n        &lt;version&gt;3.0.8&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;\n        &lt;version&gt;2.9.0&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n\n&lt;dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-bom&lt;/artifactId&gt;\n            &lt;version&gt;${jackson-bom.version}&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt;\n            &lt;scope&gt;import&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/dependencyManagement&gt;\n</code></pre>\n\n<p>dependency.tree :</p>\n<pre><code>[INFO] --- maven-dependency-plugin:3.0.2:tree (default-cli) @ kfk-spark-structured-streams --- \n[INFO] fr.cnp.kfk:kfk-spark-structured-streams:jar:0.0.1-SNAPSHOT \n[INFO] +- fr.cnp.kfk:kfk-commons:jar:0.0.1-SNAPSHOT:compile \n[INFO] +- org.apache.spark:spark-sql_2.12:jar:3.1.1:compile \n[INFO] |  +- com.univocity:univocity-parsers:jar:2.9.1:compile \n[INFO] |  +- org.apache.spark:spark-sketch_2.12:jar:3.1.1:compile \n[INFO] |  +- org.apache.spark:spark-core_2.12:jar:3.1.1:compile \n[INFO] |  |  +- org.apache.avro:avro:jar:1.8.2:compile \n[INFO] |  |  |  +- org.apache.commons:commons-compress:jar:1.8.1:compile \n[INFO] |  |  |  \\- org.tukaani:xz:jar:1.5:compile \n[INFO] |  |  +- org.apache.avro:avro-mapred:jar:hadoop2:1.8.2:compile \n[INFO] |  |  |  \\- org.apache.avro:avro-ipc:jar:1.8.2:compile \n[INFO] |  |  +- com.twitter:chill_2.12:jar:0.9.5:compile \n[INFO] |  |  |  \\- com.esotericsoftware:kryo-shaded:jar:4.0.2:compile \n[INFO] |  |  |        +- com.esotericsoftware:minlog:jar:1.3.0:compile \n[INFO] |  |  |     \\- org.objenesis:objenesis:jar:2.6:compile \n[INFO] |  |  +- com.twitter:chill-java:jar:0.9.5:compile \n[INFO] |  |  +- org.apache.hadoop:hadoop-client:jar:3.2.0:compile \n[INFO] |  |  |  +- org.apache.hadoop:hadoop-common:jar:3.2.0:compile \n[INFO] |  |  |  |     +- com.google.guava:guava:jar:23.0:compile \n[INFO] |  |  |  |  |  +- com.google.errorprone:error_prone_annotations:jar:2.0.18:compile\n[INFO] |  |  |  |  |  +- com.google.j2objc:j2objc-annotations:jar:1.1:compile \n[INFO] |  |  |  | |  \\- org.codehaus.mojo:animal-sniffer-annotations:jar:1.14:compile [INFO] |  |  |  |  +- commons-cli:commons-cli:jar:1.3.1:compile \n[INFO] |  |  |  |  +- org.apache.httpcomponents:httpclient:jar:4.5.5:compile \n[INFO] |  |  |  |  |  \\- org.apache.httpcomponents:httpcore:jar:4.4.9:compile \n[INFO] |  |  |  |    +- commons-io:commons-io:jar:2.5:compile \n[INFO] |  |  |  |  +- org.eclipse.jetty:jetty-servlet:jar:9.4.8.v20171121:compile \n[INFO] |  |  |  |  +- javax.servlet.jsp:jsp-api:jar:2.2:provided \n[INFO] |  |  |  |  +- org.apache.commons:commons-configuration2:jar:2.1.1:compile \n[INFO] |  |  |  |  +- com.google.re2j:re2j:jar:1.1:compile \n[INFO] |  | |  |  +- com.google.code.gson:gson:jar:2.8.2:compile \n[INFO] |  |  |  |    +- org.apache.hadoop:hadoop-auth:jar:3.2.0:compile \n[INFO] |  |  |  |  |  +- com.nimbusds:nimbus-jose-jwt:jar:4.41.1:compile \n[INFO] |  |  |  |  |  |  \\- com.github.stephenc.jcip:jcip-annotations:jar:1.0-1:compile [INFO] |  |  |  |  |  \\- net.minidev:json-smart:jar:2.3:compile \n[INFO] |  |  |  |  |     \\- net.minidev:accessors-smart:jar:1.2:compile \n[INFO] |  |  | |  +- org.apache.curator:curator-client:jar:2.12.0:compile \n[INFO] |  | |  |  +- org.apache.htrace:htrace-core4:jar:4.1.0-incubating:compile \n[INFO] |  |  |  |  +- org.apache.kerby:kerb-simplekdc:jar:1.0.1:compile \n[INFO] |  |  |  |  |    +- org.apache.kerby:kerb-client:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  +- org.apache.kerby:kerby-config:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  +- org.apache.kerby:kerb-core:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  |  \\- org.apache.kerby:kerby-pkix:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  |     +- org.apache.kerby:kerby-asn1:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  |     \\- org.apache.kerby:kerby-util:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  +- org.apache.kerby:kerb-common:jar:1.0.1:compile \n[INFO] |  | |  |  |  |  |  \\- org.apache.kerby:kerb-crypto:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  +- org.apache.kerby:kerb-util:jar:1.0.1:compile \n[INFO] |  |  |  |  |  |  \\- org.apache.kerby:token-provider:jar:1.0.1:compile \n[INFO] |  |  |  | |  \\- org.apache.kerby:kerb-admin:jar:1.0.1:compile \n[INFO] |  |  |  |  |     +- org.apache.kerby:kerb-server:jar:1.0.1:compile \n[INFO] |  |  | |  |     |  \\- org.apache.kerby:kerb-identity:jar:1.0.1:compile \n[INFO] |  |  |  |  |     \\- org.apache.kerby:kerby-xdr:jar:1.0.1:compile \n[INFO] |  |  |  |  +- org.codehaus.woodstox:stax2-api:jar:3.1.4:compile \n[INFO] |  |  |  |     +- com.fasterxml.woodstox:woodstox-core:jar:5.0.3:compile \n[INFO] |  |  |  |  \\- dnsjava:dnsjava:jar:2.1.7:compile \n[INFO] |  |  |  +- org.apache.hadoop:hadoop-hdfs-client:jar:3.2.0:compile \n[INFO] |  |  |  |  \\- com.squareup.okhttp:okhttp:jar:2.7.5:compile \n[INFO] |  |  |  |   \\- com.squareup.okio:okio:jar:1.6.0:compile \n[INFO] |  |  |  +- org.apache.hadoop:hadoop-yarn-api:jar:3.2.0:compile \n[INFO] |  |  |  |  \\- javax.xml.bind:jaxb-api:jar:2.3.0:provided \n[INFO] |  |  |  +- org.apache.hadoop:hadoop-yarn-client:jar:3.2.0:compile \n[INFO] |  |  |     +- org.apache.hadoop:hadoop-mapreduce-client-core:jar:3.2.0:compile \n[INFO] |  |  |  |  \\- org.apache.hadoop:hadoop-yarn-common:jar:3.2.0:compile \n[INFO] |  |  |  |     +- com.fasterxml.jackson.module:jackson-module-jaxb-annotations:jar:2.12.3:compile \n[INFO] |  |  |  |     |  +- jakarta.xml.bind:jakarta.xml.bind-api:jar:2.3.2:compile \n[INFO] |  |  | |     |  \\- jakarta.activation:jakarta.activation-api:jar:1.2.1:compile [INFO] |  |  |  |     \\- com.fasterxml.jackson.jaxrs:jackson-jaxrs-json-provider:jar:2.12.3:compile \n[INFO] |  |  |  |        \\- com.fasterxml.jackson.jaxrs:jackson-jaxrs-base:jar:2.12.3:compile \n[INFO] |  |  |  +- org.apache.hadoop:hadoop-mapreduce-client-jobclient:jar:3.2.0:compile [INFO] |  |  |  |  \\- org.apache.hadoop:hadoop-mapreduce-client-common:jar:3.2.0:compile [INFO] |  |  |  \\- org.apache.hadoop:hadoop-annotations:jar:3.2.0:compile \n[INFO] |  |  +- org.apache.spark:spark-launcher_2.12:jar:3.1.1:compile \n[INFO] |  |  +- org.apache.spark:spark-kvstore_2.12:jar:3.1.1:compile \n[INFO] |  |  |  \\- org.fusesource.leveldbjni:leveldbjni-all:jar:1.8:compile \n[INFO] |  |  +- org.apache.spark:spark-network-common_2.12:jar:3.1.1:compile \n[INFO] |  |  +- org.apache.spark:spark-network-shuffle_2.12:jar:3.1.1:compile \n[INFO] | |  +- org.apache.spark:spark-unsafe_2.12:jar:3.1.1:compile \n[INFO] |  |    +- javax.activation:activation:jar:1.1.1:provided \n[INFO] |  |  +- org.apache.curator:curator-recipes:jar:2.13.0:compile \n[INFO] |  |  |  \\- org.apache.curator:curator-framework:jar:2.13.0:compile \n[INFO] |  |    +- org.apache.zookeeper:zookeeper:jar:3.4.14:compile \n[INFO] |  |  |  \\- org.apache.yetus:audience-annotations:jar:0.5.0:compile \n[INFO] |  |    +- jakarta.servlet:jakarta.servlet-api:jar:4.0.3:compile \n[INFO] |  |  +- org.apache.commons:commons-math3:jar:3.4.1:compile \n[INFO] |  |  +- com.google.code.findbugs:jsr305:jar:3.0.0:compile \n[INFO] |  |  +- org.slf4j:slf4j-api:jar:1.7.25:compile \n[INFO] |  |  +- org.slf4j:jul-to-slf4j:jar:1.7.25:compile \n[INFO] |  |  +- org.slf4j:jcl-over-slf4j:jar:1.7.25:compile \n[INFO] |  |  +- log4j:log4j:jar:1.2.17:compile \n[INFO] |  |  +- org.slf4j:slf4j-log4j12:jar:1.7.25:compile \n[INFO] |  |  +- com.ning:compress-lzf:jar:1.0.3:compile \n[INFO] |  |  +- org.xerial.snappy:snappy-java:jar:1.1.8.2:compile \n[INFO] |  |  +- org.lz4:lz4-java:jar:1.7.1:compile \n[INFO] |  |  +- com.github.luben:zstd-jni:jar:1.4.8-1:compile \n[INFO] |  |  +- org.roaringbitmap:RoaringBitmap:jar:0.9.0:compile \n[INFO] |  |  |  \\- org.roaringbitmap:shims:jar:0.9.0:runtime \n[INFO] |  |  +- commons-net:commons-net:jar:3.1:compile \n[INFO] |  |  +- org.scala-lang.modules:scala-xml_2.12:jar:1.2.0:compile \n[INFO] |  |     +- org.scala-lang:scala-reflect:jar:2.12.10:compile \n[INFO] |  |  +- org.json4s:json4s-jackson_2.12:jar:3.7.0-M5:compile \n[INFO] |  |  |  \\- org.json4s:json4s-core_2.12:jar:3.7.0-M5:compile \n[INFO] |  |  |     +- org.json4s:json4s-ast_2.12:jar:3.7.0-M5:compile \n[INFO] |  |  |     \\- org.json4s:json4s-scalap_2.12:jar:3.7.0-M5:compile \n[INFO] |  |  +- org.glassfish.jersey.core:jersey-client:jar:2.25.1:compile \n[INFO] |  | |  +- javax.ws.rs:javax.ws.rs-api:jar:2.1:provided \n[INFO] |  |  |  +- org.glassfish.hk2:hk2-api:jar:2.5.0-b32:compile \n[INFO] |  |  |  |  +- org.glassfish.hk2:hk2-utils:jar:2.5.0-b32:compile \n[INFO] |  |  |  |  \\- org.glassfish.hk2.external:aopalliance-repackaged:jar:2.5.0-b32:compile \n[INFO] |  |  |  +- org.glassfish.hk2.external:javax.inject:jar:2.5.0-b32:compile \n[INFO] | |  |  \\- org.glassfish.hk2:hk2-locator:jar:2.5.0-b32:compile \n[INFO] |  |  +- org.glassfish.jersey.core:jersey-common:jar:2.25.1:compile \n[INFO] |  |  |  +- javax.annotation:javax.annotation-api:jar:1.2:compile \n[INFO] |  |  |     +- org.glassfish.jersey.bundles.repackaged:jersey-guava:jar:2.25.1:compile \n[INFO] |  |  |  \\- org.glassfish.hk2:osgi-resource-locator:jar:1.0.1:compile \n[INFO] |  |     +- org.glassfish.jersey.core:jersey-server:jar:2.25.1:compile\n[INFO] |  |  |  +- org.glassfish.jersey.media:jersey-media-jaxb:jar:2.25.1:compile \n[INFO] |  |  |  \\- javax.validation:validation-api:jar:1.1.0.Final:compile \n[INFO] |  |  +- org.glassfish.jersey.containers:jersey-container-servlet:jar:2.25.1:compile \n[INFO] |  |  +- org.glassfish.jersey.containers:jersey-container-servlet-core:jar:2.25.1:compile \n[INFO] |  |  +- org.glassfish.jersey.inject:jersey-hk2:jar:2.30:compile \n[INFO] |  |  | \\- org.javassist:javassist:jar:3.21.0-GA:compile \n[INFO] |  |  +- io.netty:netty-all:jar:4.1.51.Final:compile \n[INFO] |  |  +- com.clearspring.analytics:stream:jar:2.9.6:compile \n[INFO] |  |  +- io.dropwizard.metrics:metrics-core:jar:3.1.5:compile \n[INFO] |  |  +- io.dropwizard.metrics:metrics-jvm:jar:3.1.5:compile \n[INFO] |  |  +- io.dropwizard.metrics:metrics-json:jar:3.1.5:compile \n[INFO] |  |  +- io.dropwizard.metrics:metrics-graphite:jar:3.1.5:compile \n[INFO] |  |     +- io.dropwizard.metrics:metrics-jmx:jar:4.1.1:compile \n[INFO] |  |  +- org.apache.ivy:ivy:jar:2.4.0:compile \n[INFO] |  |  +- oro:oro:jar:2.0.8:compile \n[INFO] |  |  +- net.razorvine:pyrolite:jar:4.30:compile \n[INFO] |  |  +- net.sf.py4j:py4j:jar:0.10.9:compile \n[INFO] |  |  \\- org.apache.commons:commons-crypto:jar:1.1.0:compile \n[INFO] |  +- org.apache.spark:spark-catalyst_2.12:jar:3.1.1:compile \n[INFO] |  |  +- org.scala-lang.modules:scala-parser-combinators_2.12:jar:1.1.2:compile [INFO] |  |  +- org.antlr:antlr4-runtime:jar:4.8-1:compile \n[INFO] |  |    +- commons-codec:commons-codec:jar:1.10:compile \n[INFO] |  |  +- org.apache.arrow:arrow-vector:jar:2.0.0:compile \n[INFO] |  |  |  +- org.apache.arrow:arrow-format:jar:2.0.0:compile \n[INFO] |  |  |  +- org.apache.arrow:arrow-memory-core:jar:2.0.0:compile \n[INFO] |  |  |  \\- com.google.flatbuffers:flatbuffers-java:jar:1.9.0:compile \n[INFO] |  |  \\- org.apache.arrow:arrow-memory-netty:jar:2.0.0:compile \n[INFO] |     +- org.apache.spark:spark-tags_2.12:jar:3.1.1:compile \n[INFO] |  +- org.apache.orc:orc-core:jar:1.5.12:compile \n[INFO] |  |  +- org.apache.orc:orc-shims:jar:1.5.12:compile \n[INFO] |  |  +- com.google.protobuf:protobuf-java:jar:2.5.0:compile \n[INFO] |  |  +- commons-lang:commons-lang:jar:2.6:compile \n[INFO] |  |  +- io.airlift:aircompressor:jar:0.10:compile \n[INFO] |  |  \\- org.threeten:threeten-extra:jar:1.5.0:compile \n[INFO] |  +- org.apache.orc:orc-mapreduce:jar:1.5.12:compile \n[INFO] |  +- org.apache.hive:hive-storage-api:jar:2.7.2:compile \n[INFO] |  +- org.apache.parquet:parquet-column:jar:1.10.1:compile \n[INFO] |  |  +- org.apache.parquet:parquet-common:jar:1.10.1:compile \n[INFO] |  |  \\- org.apache.parquet:parquet-encoding:jar:1.10.1:compile \n[INFO] |  +- org.apache.parquet:parquet-hadoop:jar:1.10.1:compile \n[INFO] |  |  +- org.apache.parquet:parquet-format:jar:2.4.0:compile \n[INFO] |  |  +- org.apache.parquet:parquet-jackson:jar:1.10.1:compile \n[INFO] |  |  +- org.codehaus.jackson:jackson-mapper-asl:jar:1.9.13:compile \n[INFO] |  | \\- org.codehaus.jackson:jackson-core-asl:jar:1.9.13:compile \n[INFO] |     +- org.apache.xbean:xbean-asm7-shaded:jar:4.15:compile \n[INFO] |  \\- org.spark-project.spark:unused:jar:1.0.0:compile \n[INFO] +- org.apache.spark:spark-sql-kafka-0-10_2.12:jar:3.1.1:compile \n[INFO] |     +- org.apache.spark:spark-token-provider-kafka-0-10_2.12:jar:3.1.1:compile \n[INFO] |  \\- org.apache.kafka:kafka-clients:jar:2.6.0:compile \n[INFO]    +- org.apache.spark:spark-streaming_2.12:jar:3.1.1:compile \n[INFO] |  \\- org.scala-lang:scala-library:jar:2.12.10:compile \n[INFO] +- com.opencsv:opencsv:jar:4.1:compile \n[INFO] |  +- org.apache.commons:commons-lang3:jar:3.5:compile \n[INFO] |  +- org.apache.commons:commons-text:jar:1.1:compile \n[INFO] |  \\- commons-beanutils:commons-beanutils:jar:1.9.3:compile \n[INFO] |     \\- commons-collections:commons-collections:jar:3.2.2:compile \n[INFO] +- com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:jar:2.12.3:compile [INFO] |  +- org.yaml:snakeyaml:jar:1.17:compile \n[INFO] |  \\- com.fasterxml.jackson.core:jackson-core:jar:2.12.3:compile \n[INFO] +- com.fasterxml.jackson.module:jackson-module-scala_2.12:jar:2.12.3:runtime \n[INFO] |  +- com.fasterxml.jackson.core:jackson-annotations:jar:2.12.3:compile \n[INFO] |  \\- com.thoughtworks.paranamer:paranamer:jar:2.8:compile \n[INFO] +- com.fasterxml.jackson.core:jackson-databind:jar:2.12.3:compile \n[INFO]    +- org.codehaus.janino:janino:jar:3.0.8:compile \n[INFO] +- org.codehaus.janino:commons-compiler:jar:3.0.8:compile \n[INFO] \\- org.apache.commons:commons-pool2:jar:2.9.0:compile \n[INFO]    ------------------------------------------------------------------------ \n[INFO] BUILD SUCCESS \n[INFO]    ------------------------------------------------------------------------ \n[INFO] Total time:  7.334 s [INFO] Finished at: 2021-06-02T09:19:26+02:00 \n[INFO]    ------------------------------------------------------------------------\n</code></pre>\n<p>The error :</p>\n<pre><code>Error: Bad target:null\njava.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at fr.cnp.kfk.streams.Application.main(Application.java:14)\nCaused by: org.apache.spark.sql.streaming.StreamingQueryException: null\n\n[...]\n\n    at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:354)\n    at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:244)\nCaused by: java.lang.ExceptionInInitializerError\n    at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:215)\n    at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:176)\n    at org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2(WriteToDataSourceV2Exec.scala:338)\n    at org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.writeWithV2$(WriteToDataSourceV2Exec.scala:336)\n    at org.apache.spark.sql.execution.datasources.v2.WriteToDataSourceV2Exec.writeWithV2(WriteToDataSourceV2Exec.scala:297)\n    at org.apache.spark.sql.execution.datasources.v2.WriteToDataSourceV2Exec.run(WriteToDataSourceV2Exec.scala:304)\n    at org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:40)\n    at org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:40)\n    at org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:46)\n    at org.apache.spark.sql.Dataset.collectFromPlan(Dataset.scala:3696)\n    at org.apache.spark.sql.Dataset.$anonfun$collect$1(Dataset.scala:2965)\n    at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3687)\n    at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\n    at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\n    at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\n    at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\n    at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\n    at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3685)\n    at org.apache.spark.sql.Dataset.collect(Dataset.scala:2965)\n    at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$16(MicroBatchExecution.scala:589)\n    at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\n    at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\n    at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\n    at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:772)\n    at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\n    at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$15(MicroBatchExecution.scala:584)\n    at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:357)\n    at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:355)\n    at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:68)\n    at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runBatch(MicroBatchExecution.scala:584)\n    at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$2(MicroBatchExecution.scala:226)\n    at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n    at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:357)\n    at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:355)\n    at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:68)\n    at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$1(MicroBatchExecution.scala:194)\n    at org.apache.spark.sql.execution.streaming.ProcessingTimeExecutor.execute(TriggerExecutor.scala:57)\n    at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runActivatedStream(MicroBatchExecution.scala:188)\n    at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:333)\n    ... 1 more\nCaused by: com.fasterxml.jackson.databind.JsonMappingException: Scala module 2.10.5 requires Jackson Databind version &gt;= 2.10.0 and &lt; 2.11.0\n    at com.fasterxml.jackson.module.scala.JacksonModule.setupModule(JacksonModule.scala:61)\n    at com.fasterxml.jackson.module.scala.JacksonModule.setupModule$(JacksonModule.scala:46)\n    at com.fasterxml.jackson.module.scala.DefaultScalaModule.setupModule(DefaultScalaModule.scala:17)\n    at com.fasterxml.jackson.databind.ObjectMapper.registerModule(ObjectMapper.java:747)\n    at org.apache.spark.rdd.RDDOperationScope$.&lt;init&gt;(RDDOperationScope.scala:82)\n    at org.apache.spark.rdd.RDDOperationScope$.&lt;clinit&gt;(RDDOperationScope.scala)\n    ... 40 more\n</code></pre>\n"}],"last_activity_date":1684839910,"question_id":67769492,"body":"<p>For a project, I'm using spark structured streaming with kafka.</p>\n<p>I have this conf :</p>\n<pre><code>    &lt;spark.version&gt;3.1.1&lt;/spark.version&gt;\n    &lt;slf4j.version&gt;1.7.7&lt;/slf4j.version&gt;\n    &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt;\n    &lt;scala.version&gt;2.12&lt;/scala.version&gt;\n</code></pre>\n<p>But when I run, I have this error :</p>\n<p>Caused by: com.fasterxml.jackson.databind.JsonMappingException: Scala module 2.12.3 requires Jackson Databind version &gt;= 2.12.0 and &lt; 2.13.0</p>\n<p>I'm confused because I alrady import databind in 2.12.3.\nJust here, an extract of my pom.xml :</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-dataformat-yaml&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.module&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-module-scala_${scala.version}&lt;/artifactId&gt;\n        &lt;version&gt;2.12.3&lt;/version&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n        &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n        &lt;version&gt;2.12.3&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>thank you in advance for helping</p>\n"},{"comments":[{"comment_id":134573623,"body":"You get access to <code>Graphics g</code> in the <code>paintComponent</code> method of a <code>JPanel</code>, for example, which you have to override in order to draw custom objects."},{"comment_id":134575897,"body":"It’s hard to tell without more context, but I suspect you’re doing a bunch of things incorrectly.  I recommend reading <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/painting/\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/uiswing/painting</a>."}],"last_activity_date":1684839901,"question_id":76314023,"body":"<p>I have made an obstacle generator but itself it does not work nonetheless,\n<a href=\"https://i.stack.imgur.com/R505M.png\" rel=\"nofollow noreferrer\">Here I try to use object.draw(g)</a></p>\n<p>What I am essentially making is a 2D game that is supposed to spawn rectangles moving towards player and player must move but just when I thought I had it figured out this is what happens.</p>\n<pre><code> public void run() {\n\n        while (isRunning) {\n            timer();\n            unjump();\n            \n            for (Obstacle obstacle : obstacles) {\n                \n                obstacle.draw(g);\n                \n                obstacle.move();\n            }\n\n            detectCollision();\n            \n\n       \n                \n\n            // Check if it's time to spawn a new obstacle\n            long currentTime = System.currentTimeMillis();\n            if (currentTime - obstacleTimer &gt;= 200) {\n                generateObstacle();\n                obstacleTimer = currentTime; // Reset obstacle timer\n            }\n\n           \n            try {\n                Thread.sleep(Sleepduration());\n            } catch (InterruptedException e) {\n                // Handle exception\n            }\n\n            repaint();\n        }\n\n        \n          }```\n\n  public interface Obstacle {\n        void draw(Graphics g);\n        boolean isVisible();\n        void setVisible(boolean visible);\n        void move(); \n       Rectangle getBounds();\n    }\n    \n    class Obstacle1 implements Obstacle {\n        private boolean visible;\n      \n        public void draw(Graphics g) {\n               g.setColor(Color.RED);\n               g.fillRect(obstacle1X, obstacle1Y, OBSTACLE1_WIDTH, OBSTACLE1_HEIGHT);\n               repaint();\n        }\n\n        public boolean isVisible() {\n            return visible;\n        }\n\n        public void setVisible(boolean visible) {\n            this.visible = visible;\n        }\n        \n        public void move() {\n            obstacle1X -= OBSTACLE1_SPEED;\n        }\n        \n        public Rectangle getBounds() {\n            return new Rectangle(obstacle1X, obstacle1Y, OBSTACLE1_WIDTH, OBSTACLE1_HEIGHT);\n        }\n        \n    }\n    class Obstacle2 implements Obstacle {\n        private boolean visible;\n      \n\n        public void draw(Graphics g) {\n         // Draw obstacle 2\n            g.setColor(Color.BLUE);\n            g.fillRect(obstacle2X, obstacle2Y, OBSTACLE2_WIDTH, OBSTACLE2_HEIGHT);\n            repaint();\n        }\n\n        public boolean isVisible() {\n            return visible;\n        }\n\n        public void setVisible(boolean visible) {\n            this.visible = visible;\n        } \n        \n        public void move() {\n            obstacle2X -= OBSTACLE2_SPEED;\n        }\n         \n        \n        public Rectangle getBounds() {\n            return new Rectangle(obstacle2X, obstacle2Y, OBSTACLE2_WIDTH, OBSTACLE2_HEIGHT);\n        }\n\n        \n    }\n    \n    class Obstacle3 implements Obstacle {\n        private boolean visible;\n   \n\n        public void draw(Graphics g) {\n            \n            // Code to draw Obstacle3\n            \n        \n            // Draw obstacle 3\n           \n            g.setColor(Color.GREEN);\n            g.fillRect(obstacle3X, obstacle3Y, OBSTACLE3_WIDTH, OBSTACLE3_HEIGHT);\n            repaint();\n        }\n\n        public boolean isVisible() {\n            return visible;\n        }\n        \n        public void move() {\n            obstacle3X -= OBSTACLE3_SPEED;\n        }\n\n        public void setVisible(boolean visible) {\n            this.visible = visible;\n        }\n   \n        public Rectangle getBounds() {\n            return new Rectangle(obstacle3X, obstacle3Y, OBSTACLE3_WIDTH, OBSTACLE3_HEIGHT);\n        }\n\n        \n    }\n\n\n \n\n    \n    enum ObstacleType {\n        OBSTACLE1,\n        OBSTACLE2,\n        OBSTACLE3\n    }\n    \n     public void generateObstacle() {\n        \n        obstacle1X = 1000; // Initialize obstacle1's X position outside the visible area\n        obstacle2X = 1000; // Initialize obstacle2's X position outside the visible area\n        obstacle3X = 1000;\n        \n          Random random = new Random();\n            ObstacleType[] obstacleTypes = ObstacleType.values();\n            ObstacleType randomType = obstacleTypes[random.nextInt(obstacleTypes.length)];\n\n            // Create the obstacle based on the randomly selected type\n            Obstacle obstacle;\n\n            switch (randomType) {\n                case OBSTACLE1:\n                    obstacle = new Obstacle1();\n                    obstacle.setVisible(true);\n                    obstacle.move();\n                    obstacle1X = 900; // Initialize obstacle's X position outside the visible area\n                    break;\n                case OBSTACLE2:\n                    obstacle = new Obstacle2();\n                    obstacle.setVisible(true);\n                    obstacle.move();\n                    obstacle2X = 900; // Initialize obstacle's X position outside the visible area\n                    break;\n                case OBSTACLE3:\n                    obstacle = new Obstacle3();\n                    obstacle.setVisible(true);\n                    obstacle.move();\n                    obstacle3X = 900; // Initialize obstacle's X position outside the visible area\n                    break;\n                default:\n                    obstacle = new Obstacle1(); // Default to a specific obstacle type\n                    obstacle.setVisible(true);\n                    obstacle.move();\n                    obstacle1X = 900; // Initialize obstacle's X position outside the visible area\n                    break;\n            }\n\n            obstacles.add(obstacle);\n\n    }\n</code></pre>\n<p>this is the relevant code</p>\n<p>I tried to put getgraphics instead bc I think that is what you use (?)</p>\n<p><a href=\"https://i.stack.imgur.com/ARyTK.png\" rel=\"nofollow noreferrer\">Here you see its not recognized I think I had the right modifiers too maybe I made an indentation error?</a></p>\n"},{"last_activity_date":1684839567,"question_id":76313926,"body":"<p>I am trying to search a partial substring from a elastic data but whenever trying to search using partial data results are not coming</p>\n<p>This is my query</p>\n<pre><code>    {\n    &quot;query&quot;: {\n&quot;bool&quot;: {\n  &quot;must&quot;: [\n    {\n      &quot;term&quot;: {\n        &quot;status&quot;: {\n          &quot;value&quot;: 1,\n          &quot;boost&quot;: 1\n        }\n      }\n    },\n    {\n      &quot;term&quot;: {\n        &quot;pamState&quot;: {\n          &quot;value&quot;: &quot;ENABLED&quot;,\n          &quot;boost&quot;: 1\n        }\n      }\n    },\n    {\n      &quot;bool&quot;: {\n        &quot;must&quot;: [\n          {\n            &quot;exists&quot;: {\n              &quot;field&quot;: &quot;securiySystem.firefighteridWorkflow&quot;,\n              &quot;boost&quot;: 1\n            }\n          }\n        ],\n        &quot;must_not&quot;: [\n          {\n            &quot;term&quot;: {\n              &quot;securiySystem.firefighteridWorkflow&quot;: {\n                &quot;value&quot;: &quot;0&quot;,\n                &quot;boost&quot;: 1\n              }\n            }\n          }\n        ],\n        &quot;adjust_pure_negative&quot;: true,\n        &quot;boost&quot;: 1\n      }\n    },\n    {\n      &quot;bool&quot;: {\n        &quot;must&quot;: [\n          {\n            &quot;exists&quot;: {\n              &quot;field&quot;: &quot;securiySystem.firefighteridRequestAccessWorkflow&quot;,\n              &quot;boost&quot;: 1       }\n          }\n        ],\n        &quot;must_not&quot;: [\n          {\n            &quot;term&quot;: {\n              &quot;securiySystem.firefighteridRequestAccessWorkflow&quot;: {\n                &quot;value&quot;: &quot;0&quot;,\n                &quot;boost&quot;: 1\n              }\n            }\n          }\n        ],\n        &quot;adjust_pure_negative&quot;: true,\n        &quot;boost&quot;: 1\n      }\n    },\n    {\n      &quot;bool&quot;: {\n        &quot;must&quot;: [\n          {\n            &quot;exists&quot;: {\n              &quot;field&quot;: &quot;securiySystem.automatedProvisioning&quot;,\n              &quot;boost&quot;: 1\n            }\n          },\n          {\n            &quot;term&quot;: {\n              &quot;securiySystem.automatedProvisioning&quot;: {\n                &quot;value&quot;: true,\n                &quot;boost&quot;: 1\n              }\n            }\n          }\n        ],\n        &quot;adjust_pure_negative&quot;: true,\n        &quot;boost&quot;: 1\n      }\n    },\n    {\n      &quot;exists&quot;: {\n        &quot;field&quot;: &quot;securiySystem.externalConnection&quot;,\n        &quot;boost&quot;: 1\n      }\n    },\n    {\n      &quot;exists&quot;: {\n        &quot;field&quot;: &quot;securiySystem.provisioningConnection&quot;,\n        &quot;boost&quot;: 1\n      }\n    },\n    {\n      &quot;term&quot;: {\n        &quot;securiySystem.externalConnection.externalconnectiontype.connectiontype.keyword&quot;: {\n          &quot;value&quot;: &quot;GCP&quot;,\n          &quot;boost&quot;: 1\n        }\n      }\n    },\n    {\n      &quot;term&quot;: {\n        &quot;pamResourceType&quot;: {\n          &quot;value&quot;: &quot;instance&quot;,\n          &quot;boost&quot;: 1\n        }\n      }\n    },\n    {\n      &quot;simple_query_string&quot;: {\n        &quot;query&quot;: &quot;*cloud*&quot;,\n        &quot;fields&quot;: [\n          &quot;customproperty10^1.0&quot;,\n          &quot;securiySystem.systemname^1.0&quot;,\n          &quot;customproperty5^1.0&quot;,\n          &quot;displayName^1.0&quot;,\n          &quot;endpointname^1.0&quot;,\n          &quot;description^1.0&quot;,\n          &quot;customproperty17^1.0&quot;,\n          &quot;securiySystem.externalConnection.externalconnectiontype.connectiontype^1.0&quot;,\n          &quot;customproperty16^1.0&quot;,\n          &quot;securiySystem.externalConnection.connectionname^1.0&quot;\n        ],\n        &quot;flags&quot;: -1,\n        &quot;default_operator&quot;: &quot;and&quot;,\n        &quot;analyze_wildcard&quot;: true,\n        &quot;minimum_should_match&quot;: &quot;1&quot;,\n        &quot;auto_generate_synonyms_phrase_query&quot;: true,\n        &quot;fuzzy_prefix_length&quot;: 0,\n        &quot;fuzzy_max_expansions&quot;: 50,\n        &quot;fuzzy_transpositions&quot;: true,\n        &quot;boost&quot;: 1\n      }\n    }\n  ],\n  &quot;adjust_pure_negative&quot;: true,\n  &quot;boost&quot;: 1\n   }\n  }\n }\n</code></pre>\n<p>Customproperty17 having data like cloudhello-1234</p>\n<p>Whenever I am doing like <em>cloud</em> -- I am getting the result</p>\n<p>But if do something like this <em>hello</em> -- Not getting output</p>\n<p>Even I am getting output if do <em>123</em> -- Getting output</p>\n<p>If I do <em>34</em>- not getting output</p>\n<p>Can someone help on this ?</p>\n"},{"comments":[{"comment_id":134498839,"body":"The library implementation is probably fairly well optimized. We may not be able to provide you with drop-in replacements for it that would perform better. The part you can improve is probably your pattern, especially if it uses backtracking. And you have not shared that."},{"comment_id":134499629,"body":"Why are there two <code>.*</code> items in the pattern? The RegEx will have to process the first <code>.*</code> which will match the entire string, then the match for the <code>p</code> in <code>purchase</code> will fail. It will backtrack by one character and the <code>p</code> will fail again, and so on. Perhaps changing to a non-greedy initial part (i.e. to <code>.*?\\\\b(purchase)\\\\b.*</code>) would improve matters. But, I repeat, why are the two <code>.*</code> items present."},{"comment_id":134500336,"body":"Should also get same result without &quot;.*&quot; if you use find not matches - <code>Pattern.compile(&quot;\\\\b(purchase)\\\\b&quot;).matcher(text).find()</code> and you can also re-use the Pattern.compile part."},{"comment_id":134501952,"body":"As @DuncG said, use the right operation, i.e. <code>find()</code> instead of abusing <code>matches()</code> with expensive <code>.*</code> around the pattern. This already avoids backtracking. But you also don’t need capturing groups, so <code>Pattern.compile(&quot;\\\\bpurchase\\\\b&quot;).matcher(text).find()</code> will do. Keep in mind that you can keep and reuse the result of <code>Pattern.compile(…)</code>, i.e.  instead of storing the pattern string in a <code>static final</code> field, store the <code>Pattern</code> object, so you’re not repeating the work on every invocation."},{"comment_id":134502020,"body":"If you want to squeeze out the maximum performance with the reference implementation, use <code>Pattern.compile(&quot;purchase\\\\b(?&lt;=\\\\b.{8})&quot;)</code>. Having the literal text at the beginning of the pattern will enable the internal use of the <a href=\"https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string-search_algorithm\" rel=\"nofollow noreferrer\">Boyer–Moore algorithm</a>. But avoiding backtracking and reusing the <code>Pattern</code> object are more important."},{"comment_id":134503490,"body":"If you really want to optimize, avoid using regular expressions for such a simple problem.  You could just do this:  <code>int i = text.indexOf(&quot;purchase&quot;); return i &gt;= 0 &amp;&amp; (i == 0 || !Character.isLetter(text.charAt(i))) &amp;&amp; (i == text.length() - 8 || !Character.isLetter(text.charAt(i + 8)))</code>.  It may look longer, but regular expressions do a lot of work under the hood and involve a lot more code than this approach."},{"comment_id":134558485,"body":"@VGR that’s not doing the same. Your variant checks whether the first occurrence of “purchase” is at word boundaries whereas the original code checks whether there is any occurrence of “purchase” at word boundaries."}],"answers":[{"answer_id":76311173,"body":"<p>There are a few changes you can make.</p>\n<p>You can greatly reduce the CPU consumption by creating re-usable objects.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Example {\n    Pattern pattern = Pattern.compile(&quot;\\\\bpurchase\\\\b&quot;);\n    Matcher matcher;\n\n    private boolean isMatchPattern(String text) {\n        matcher = pattern.matcher(text);\n        return matcher.find();\n    }\n}\n</code></pre>\n<p>Behind the scenes, upon each call of <code>String.matches</code>, a new <code>Pattern</code> and <code>Matcher</code> object is created.</p>\n<p>To combat this, you can create <code>Pattern</code> and <code>Matcher</code> fields within your class.<br />\nThen, access these fields from within your <code>isMatchPattern</code> method.</p>\n<p>Furthermore, for the regular expression pattern, there is no need to capture the text &quot;purchase&quot;, so you can remove the parentheses.</p>\n<p>Additionally, the context of a <code>Pattern</code> pattern is non-conforming; it's expected to be anywhere within the text.<br />\nAs opposed to a <code>String.matches</code> call, which requires the entire parameter to match.<br />\nSo, you don't need the starting and ending <code>.*</code>, as they are redundant.</p>\n<p>In regard to using an <code>String.indexOf</code>, or <code>String.contains</code>.</p>\n<p>If you require the word-boundary check, then this is somewhat out of the question in terms of an idiomatic approach, as you'd have to make more than one call.</p>\n<p>If you don't require the check, then this would be the way to go.</p>\n<p>As a final solution, you can create a character array for-loop, which is more or less what the <code>Matcher</code> class does.</p>\n"}],"last_activity_date":1684839294,"question_id":76270212,"body":"<p>I encountered a performance issue related to regex matching in my Java project, which resulted in high CPU usage. Despite my attempts at regex optimization, I'm still experiencing performance problems, particularly when multiple threads concurrently invoke the code.</p>\n<p>For instance, when calling a method that performs regex matching concurrently 100 times, the CPU usage spikes to 90% for a brief period.</p>\n<p>Here's a simplified example of my code:</p>\n<pre><code>String BUY_PATTERN =&quot;.*\\\\b(purchase)\\\\b.*&quot;;\n\nprivate static boolean isMatchPattern(String pattern, String text) {\n     return text.matches(BUY_PATTERN);\n}\n</code></pre>\n<p>I would like to reduce the CPU usage during regex matching. Can you provide suggestions for more efficient regex patterns that achieve the same functionality?</p>\n<p>Additionally, I came across an article (<a href=\"https://medium.com/javarevisited/a-regular-expression-makes-the-cpu-soar-to-100-72036a4b0771\" rel=\"nofollow noreferrer\">link provided</a>) discussing the impact of backtracking on performance, but I find it challenging to rewrite the regex to minimize backtracking.</p>\n<p>Thank you for your assistance!</p>\n"},{"comments":[{"comment_id":134572580,"body":"<a href=\"https://meta.stackoverflow.com/questions/285551/why-should-i-not-upload-images-of-code-errors-when-asking-a-question\" title=\"why should i not upload images of code errors when asking a question\">meta.stackoverflow.com/questions/285551/&hellip;</a>"}],"last_activity_date":1684839169,"question_id":76313915,"body":"<p><img src=\"https://i.stack.imgur.com/IVM5U.png\" alt=\"enter image description here\" />\nWhen I was in the spring:\napplication:\nname:\nWhen adding an underline to the position, the file will report an error\nSo I was wondering if the yml file configuration cannot include underscores</p>\n<p>help someone can solve this question</p>\n"},{"answers":[{"comments":[{"comment_id":134427024,"body":"thanks for the solution. In my case it was single quote symbol  &quot;"},{"comment_id":134442708,"body":"@SandeepYohans, hope it saved your time :)"}],"answer_id":72355635,"body":"<p>Find and exchange all <code>'</code> symbols in your <code>strings.xml</code> or somewhere else in your code with <code>\\'</code></p>\n"},{"answer_id":72389097,"body":"<p>Check the path:\n//app&gt;src&gt;main&gt;res&gt;values  for unused xmls</p>\n<p>Good luck</p>\n"},{"answer_id":72569480,"body":"<p>I had this same issue when I had this declared</p>\n<p>E0E0E0\ninstead of this\n#E0E0E0</p>\n<p>After placing the missing # symbol in the code the code then compiled and run.</p>\n"},{"comments":[{"comment_id":132573434,"body":"HERO!!!! Thanks man &lt;3"}],"answer_id":72660481,"body":"<p>I had a wrong file in the &quot;//app&gt;src&gt;main&gt;res&gt;values&quot; dir of the project (for me was  file I generated for error &quot;ids.xml&quot;).\nI deleted it and now the build is succesfull</p>\n<p>You can see the problem is in this &quot;Values&quot; dir becouse of this line you posted</p>\n<blockquote>\n<p>(Failed to compile values resource file E:\\My Client\\Henkako\\HenkakoPlus\\app\\build\\intermediates\\incremental\\debug\\mergeDebugResources\\merged.dir\\values\\values.xml...</p>\n</blockquote>\n"},{"answer_id":72750549,"body":"<p>Here is my case on this.\nI was experimenting with '<code>androidx.swiperefreshlayout.widget.SwipeRefreshLayout</code>'\nand added it in my layout that contains a recycler view within it. It started to show similar error as yours.</p>\n<p>The problem seemed to be with the &quot;@+id/someid&quot;. Strangely no id was being allowed to be set into the SwipeRefreshLayout. Checked the enclosing brackets multiple time. Rearranged stuff around here and there. Nothing happened.</p>\n<p>But as soon as I removed that SwipeRefreshLayout and replaced the recycler view outside as before. The problem gone.</p>\n<p>Official android docs do say that SwipeRefreshLayout requires ListView or GridView as its child. May be this is why it was happening.</p>\n<p>That was my case. Try to undo any recent changes that you did in any of the xml files and see if it fixes.</p>\n<p>Or may be I was doing something wrong!?\ni apologize if I couldn't be of much/any help.</p>\n"},{"answer_id":73015222,"body":"<p>In my case in dimens.xml I put 8p instead of 8dp. Replacing 8p with 8dp solved my problem</p>\n"},{"answer_id":73228351,"body":"<p>I used an exclamation mark (!) in my strings.xml file. Just resolved it by adding a backslash before the exclamation mark</p>\n"},{"answer_id":73925768,"body":"<p>In my case I had the error recurring on build:  <code>Can't determine type for tag '&lt;macro name=&quot;m3_comp_switch_disabled_selected_handle_color&quot;&gt;?attr/colorSurface&lt;/macro&gt;'</code>.<br>\nI noticed that I had declared duplicate <code>tag</code> names in the <code>theme</code> file.  After removing the tags I still had the error but stating more generally in <code>values.xml</code>.  I deleted the <code>theme</code> directories and all was well.</p>\n"},{"comments":[{"comment_id":133134723,"body":"5 instead of  6 will also do this, but note 8 is fine, first 2 become opacity and 6 behind become the color."}],"answer_id":74056271,"body":"<p>For me it was that i accidentally used <strong>7 instead of 6 numbers</strong> in colors.xml:\n#fe362bc\ninstead of the correct\n#f362bc\nI advice you to use git so that you can jump back in the commits in these cases\nThats at least how i found mine</p>\n"},{"comments":[{"comment_id":134133114,"body":"2) Somehow Android Studio had marked red almost all unescaped &#39; but one. But notepad++ showed 141 x &#39; and only 140 x \\&#39;  Good tip thank you."},{"comment_id":134262595,"body":"In my case, there was a duplicated attribute in the attrs.xml file, but I think it was duplicated with something internal from Android, it was an attribute called &quot;number&quot;, when I removed the format it worked"}],"answer_id":74137725,"body":"<p>There may be many reasons why you get this error. All of them involve problems with some XML file in your values folder. Unfortunatly, although you can open any XML file and validate it (tools &gt; XML Actions &gt; Validate), some problems are not checked.</p>\n<p>But if you try to run the task <code>gradle :app:mergeDebugResources</code>, it will output the error:</p>\n<p><a href=\"https://i.stack.imgur.com/35Piu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/35Piu.png\" alt=\"enter image description here\" /></a></p>\n<br>\n<p>Since there are plenty of reasons, here's a list of some commom problems:</p>\n<p><strong>1 - Mispelled color:</strong></p>\n<p>Replace  <strong><code>#EAF5FFC</code></strong> =&gt; <strong><code>#EAF5FF</code></strong></p>\n<p>In my case, <strong><code>C</code></strong> was added by mistake. After removing the unused <strong><code>C</code></strong>, it worked, but it could be one or more char less or more.</p>\n<p>You should avoid adding unused characters.</p>\n<br>\n<p><strong>2 - Forgot to scape apostrophe:</strong></p>\n<p>Find and replace <strong><code>'</code></strong> symbols with <strong><code>\\'</code></strong> in <code>strings.xml</code> or other XML files.</p>\n<p>Example: <strong>&quot;<code>dog's leg was broken</code>&quot;</strong> =&gt; <strong>&quot;<code>dog\\'s leg was broken</code>&quot;</strong></p>\n<br>\n<p><strong>3 - Forgot to add the hex sign on a color</strong></p>\n<p>Replace  <strong><code>EAF5FF</code></strong> =&gt; <strong><code>#EAF5FF</code></strong></p>\n<p>In my case, I forgot to add the <strong><code>#</code></strong> symbol. After adding the <strong><code>#</code></strong>, it worked. It happens a lot when you copy and past hex colors.</p>\n<br>\n<p><strong>4 - Forgot to add a unit of measurement or spelled it wrong</strong></p>\n<p>Replace  <strong><code>10p</code></strong> =&gt; <strong><code>10dp</code></strong></p>\n<p>In my case, In <code>dimens.xml</code>, I forgot to add the <strong><code>d</code></strong>. After adding the <strong><code>d</code></strong>, it worked. I can also be an sp for texts, for example.</p>\n<br>\n<p><strong>5 - Forgot to scape exclamation mark</strong></p>\n<p>Find and replace <strong><code>!</code></strong> symbols with <strong><code>\\!</code></strong> in <code>strings.xml</code> or other XML files.</p>\n<p>Example: <strong>&quot;<code>wow! It is a heavy rain</code>&quot;</strong> =&gt; <strong>&quot;<code>wow\\! It is a heavy rain</code>&quot;</strong></p>\n<br>\n<p><strong>6 - Duplicate theme name</strong></p>\n<p>In <strong><code>styles.xml</code></strong>, Check for the duplicate theme name. Do the same for the <strong><code>styles.xml (dark)</code></strong>.</p>\n<br>\n<p><strong>7 - Forgot to add a dark theme</strong></p>\n<p>In your <strong><code>themes</code></strong> folder, Check if you have one for Dark Theme as well.</p>\n<br>\n<p><strong>8 - Forgot to add a dark theme</strong></p>\n<p>In your <strong><code>themes</code></strong> folder, Check if you have one for Dark Theme as well.</p>\n<br>\n<p><strong>9 - Add extra &gt; when closing a tag</strong></p>\n<p>In my case, on my <strong><code>colors.xml</code></strong> file, this was my mistake: <code>**&lt;color name=&quot;colorPrimary&quot;&gt;&gt;#D2070E&lt;/color&gt;**</code>. After removing the extra &gt;, everything worked.</p>\n"},{"answer_id":74252002,"body":"<p>My solution was to check my colors.xml file and see if made any declaration mistakes like forgetting to put the '#'symbol before the hex code</p>\n"},{"answer_id":74842887,"body":"<p>I had this issue when I used <strong>'</strong> instead of <strong>\\'</strong> in the <strong>strings.xml</strong> file.\nFor example, I used the string <strong>Don't</strong> go there instead of <strong>Don\\'t</strong> go there.</p>\n"},{"answer_id":75078084,"body":"<p>This error reason that is invalid value decleration of resources files. It can be colors, strings etc. If you check all of the files you can fix the error.</p>\n"},{"answer_id":75387881,"body":"<p>Go the <code>theme.xml</code> file and check any style tag is declared inside the existing style tag:</p>\n<p><em><strong>res/values/themes.xml</strong></em></p>\n<p>This issue created for example:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;resources xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n    &lt;!-- Base application theme. --&gt;\n    &lt;style name=&quot;Theme.XXXXXXXX&quot;&gt;\n\n        &lt;style name=&quot;xxxxxxx&quot;&gt;\n            &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/black&lt;/item&gt;\n        &lt;/style&gt;\n    &lt;/style&gt;\n&lt;/resources&gt;\n</code></pre>\n<p>Corrected:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;resources xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;\n    &lt;!-- Base application theme. --&gt;\n    &lt;style name=&quot;Theme.XXXXXXXX&quot;&gt;\n\n    &lt;/style&gt;\n\n    &lt;style name=&quot;xxxxxxx&quot;&gt;\n        &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/black&lt;/item&gt;\n    &lt;/style&gt;\n&lt;/resources&gt;\n</code></pre>\n<p>If another style - declare it separately.</p>\n"},{"comments":[{"comment_id":133653295,"body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/75712863/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"answer_id":75712863,"body":"<p>I had some bad dimension in my dimen.xml and by deleting it it was fixed</p>\n"},{"answer_id":75727088,"body":"<p>This error always happens because of <strong>wrong change in xml file</strong>, Check the last file you modified before the error occurred you will find the error</p>\n"},{"answer_id":75884362,"body":"<p>Can not extract resource from com.android.aaptcompiler.ParsedResource@3fee16eb this error is shown after gradle.......\nFor correction u need to delete &quot;ids.xml&quot; after deleting this xml u app work properly</p>\n<p>note:- This ids.xml file is found in values folder</p>\n"},{"comments":[{"comment_id":134474900,"body":"There are many possible reasons why he might be getting this error. Unfortunately, your answer doesn&#39;t provide enough information to help. The question is not good at all, but we can give an answer like yours. Look for the answer given by Rumit Patel to follow it as a model"},{"comment_id":134489305,"body":"This does not provide an answer to the question. Once you have sufficient <a href=\"https://stackoverflow.com/help/whats-reputation\">reputation</a> you will be able to <a href=\"https://stackoverflow.com/help/privileges/comment\">comment on any post</a>; instead, <a href=\"https://meta.stackexchange.com/questions/214173/why-do-i-need-50-reputation-to-comment-what-can-i-do-instead\">provide answers that don&#39;t require clarification from the asker</a>. - <a href=\"/review/late-answers/34391463\">From Review</a>"}],"answer_id":76255794,"body":"<p>I had this problem using ##000000 instead of #000000 in colors file.</p>\n"},{"answer_id":76309488,"body":"<p>I had the wrong file in the <code>//app&gt;src&gt;main&gt;res&gt;values</code> dir of the project. For me was the file I generated for the error <code>ids.xml</code>, by deleting <code>ids.xml</code> the error was gone and the app built successfully.</p>\n"}],"last_activity_date":1684838971,"question_id":72335789,"body":"<p>Can not extract resource from com.android.aaptcompiler.ParsedResource@636e1e76.</p>\n<pre><code>Execution failed for task ':app:mergeDebugResources'.\n&gt; A failure occurred while executing com.android.build.gradle.internal.res.ResourceCompilerRunnable\n   &gt; Resource compilation failed (Failed to compile values resource file E:\\My Client\\Henkako\\HenkakoPlus\\app\\build\\intermediates\\incremental\\debug\\mergeDebugResources\\merged.dir\\values\\values.xml. Cause: java.lang.IllegalStateException: Can not extract resource from com.android.aaptcompiler.ParsedResource@636e1e76.). Check logs for more details.\n\n* Exception is:\norg.gradle.api.tasks.TaskExecutionException: Execution failed for task ':app:mergeDebugResources'.\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.lambda$executeIfValid$1(ExecuteActionsTaskExecuter.java:145)\n    at org.gradle.internal.Try$Failure.ifSuccessfulOrElse(Try.java:282)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeIfValid(ExecuteActionsTaskExecuter.java:143)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:131)\n    at org.gradle.api.internal.tasks.execution.CleanupStaleOutputsExecuter.execute(CleanupStaleOutputsExecuter.java:77)\n    at org.gradle.api.internal.tasks.execution.FinalizePropertiesTaskExecuter.execute(FinalizePropertiesTaskExecuter.java:46)\n    at org.gradle.api.internal.tasks.execution.ResolveTaskExecutionModeExecuter.execute(ResolveTaskExecutionModeExecuter.java:51)\n    at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:57)\n    at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:56)\n    at org.gradle.api.internal.tasks.execution.CatchExceptionTaskExecuter.execute(CatchExceptionTaskExecuter.java:36)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.executeTask(EventFiringTaskExecuter.java:77)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:55)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:52)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:204)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:199)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:53)\n    at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:73)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter.execute(EventFiringTaskExecuter.java:52)\n    at org.gradle.execution.plan.LocalTaskNodeExecutor.execute(LocalTaskNodeExecutor.java:74)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:402)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:389)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$BuildOperationAwareExecutionAction.execute(DefaultTaskExecutionGraph.java:382)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$BuildOperationAwareExecutionAction.execute(DefaultTaskExecutionGraph.java:368)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.lambda$run$0(DefaultPlanExecutor.java:127)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.execute(DefaultPlanExecutor.java:191)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.executeNextNode(DefaultPlanExecutor.java:182)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.run(DefaultPlanExecutor.java:124)\n    at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:64)\n    at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:48)\n    at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:61)\nCaused by: org.gradle.workers.internal.DefaultWorkerExecutor$WorkExecutionException: A failure occurred while executing com.android.build.gradle.internal.res.ResourceCompilerRunnable\n    at org.gradle.workers.internal.DefaultWorkerExecutor$WorkItemExecution.waitForCompletion(DefaultWorkerExecutor.java:342)\n    at org.gradle.internal.work.DefaultAsyncWorkTracker.waitForItemsAndGatherFailures(DefaultAsyncWorkTracker.java:142)\n    at org.gradle.internal.work.DefaultAsyncWorkTracker.waitForItemsAndGatherFailures(DefaultAsyncWorkTracker.java:94)\n    at org.gradle.internal.work.DefaultAsyncWorkTracker.waitForAll(DefaultAsyncWorkTracker.java:80)\n    at org.gradle.internal.work.DefaultAsyncWorkTracker.waitForCompletion(DefaultAsyncWorkTracker.java:68)\n    at org.gradle.api.internal.tasks.execution.TaskExecution$2.run(TaskExecution.java:247)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$1.execute(DefaultBuildOperationRunner.java:29)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$1.execute(DefaultBuildOperationRunner.java:26)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.run(DefaultBuildOperationRunner.java:47)\n    at org.gradle.internal.operations.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:68)\n    at org.gradle.api.internal.tasks.execution.TaskExecution.executeAction(TaskExecution.java:224)\n    at org.gradle.api.internal.tasks.execution.TaskExecution.executeActions(TaskExecution.java:207)\n    at org.gradle.api.internal.tasks.execution.TaskExecution.executeWithPreviousOutputFiles(TaskExecution.java:190)\n    at org.gradle.api.internal.tasks.execution.TaskExecution.execute(TaskExecution.java:168)\n    at org.gradle.internal.execution.steps.ExecuteStep.executeInternal(ExecuteStep.java:89)\n    at org.gradle.internal.execution.steps.ExecuteStep.access$000(ExecuteStep.java:40)\n    at org.gradle.internal.execution.steps.ExecuteStep$1.call(ExecuteStep.java:53)\n    at org.gradle.internal.execution.steps.ExecuteStep$1.call(ExecuteStep.java:50)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:204)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:199)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:53)\n    at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:73)\n    at org.gradle.internal.execution.steps.ExecuteStep.execute(ExecuteStep.java:50)\n    at org.gradle.internal.execution.steps.ExecuteStep.execute(ExecuteStep.java:40)\n    at org.gradle.internal.execution.steps.RemovePreviousOutputsStep.execute(RemovePreviousOutputsStep.java:68)\n    at org.gradle.internal.execution.steps.RemovePreviousOutputsStep.execute(RemovePreviousOutputsStep.java:38)\n    at org.gradle.internal.execution.steps.ResolveInputChangesStep.execute(ResolveInputChangesStep.java:48)\n    at org.gradle.internal.execution.steps.ResolveInputChangesStep.execute(ResolveInputChangesStep.java:36)\n    at org.gradle.internal.execution.steps.CancelExecutionStep.execute(CancelExecutionStep.java:41)\n    at org.gradle.internal.execution.steps.TimeoutStep.executeWithoutTimeout(TimeoutStep.java:74)\n    at org.gradle.internal.execution.steps.TimeoutStep.execute(TimeoutStep.java:55)\n    at org.gradle.internal.execution.steps.CreateOutputsStep.execute(CreateOutputsStep.java:51)\n    at org.gradle.internal.execution.steps.CreateOutputsStep.execute(CreateOutputsStep.java:29)\n    at org.gradle.internal.execution.steps.CaptureStateAfterExecutionStep.execute(CaptureStateAfterExecutionStep.java:61)\n    at org.gradle.internal.execution.steps.CaptureStateAfterExecutionStep.execute(CaptureStateAfterExecutionStep.java:42)\n    at org.gradle.internal.execution.steps.BroadcastChangingOutputsStep.execute(BroadcastChangingOutputsStep.java:60)\n    at org.gradle.internal.execution.steps.BroadcastChangingOutputsStep.execute(BroadcastChangingOutputsStep.java:27)\n    at org.gradle.internal.execution.steps.BuildCacheStep.executeWithoutCache(BuildCacheStep.java:188)\n    at org.gradle.internal.execution.steps.BuildCacheStep.lambda$execute$1(BuildCacheStep.java:75)\n    at org.gradle.internal.Either$Right.fold(Either.java:175)\n    at org.gradle.internal.execution.caching.CachingState.fold(CachingState.java:59)\n    at org.gradle.internal.execution.steps.BuildCacheStep.execute(BuildCacheStep.java:73)\n    at org.gradle.internal.execution.steps.BuildCacheStep.execute(BuildCacheStep.java:48)\n    at org.gradle.internal.execution.steps.StoreExecutionStateStep.execute(StoreExecutionStateStep.java:38)\n    at org.gradle.internal.execution.steps.StoreExecutionStateStep.execute(StoreExecutionStateStep.java:27)\n    at org.gradle.internal.execution.steps.RecordOutputsStep.execute(RecordOutputsStep.java:36)\n    at org.gradle.internal.execution.steps.RecordOutputsStep.execute(RecordOutputsStep.java:22)\n    at org.gradle.internal.execution.steps.SkipUpToDateStep.executeBecause(SkipUpToDateStep.java:109)\n    at org.gradle.internal.execution.steps.SkipUpToDateStep.lambda$execute$2(SkipUpToDateStep.java:56)\n    at org.gradle.internal.execution.steps.SkipUpToDateStep.execute(SkipUpToDateStep.java:56)\n    at org.gradle.internal.execution.steps.SkipUpToDateStep.execute(SkipUpToDateStep.java:38)\n    at org.gradle.internal.execution.steps.ResolveChangesStep.execute(ResolveChangesStep.java:73)\n    at org.gradle.internal.execution.steps.ResolveChangesStep.execute(ResolveChangesStep.java:44)\n    at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsFinishedStep.execute(MarkSnapshottingInputsFinishedStep.java:37)\n    at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsFinishedStep.execute(MarkSnapshottingInputsFinishedStep.java:27)\n    at org.gradle.internal.execution.steps.ResolveCachingStateStep.execute(ResolveCachingStateStep.java:89)\n    at org.gradle.internal.execution.steps.ResolveCachingStateStep.execute(ResolveCachingStateStep.java:50)\n    at org.gradle.internal.execution.steps.ValidateStep.execute(ValidateStep.java:114)\n    at org.gradle.internal.execution.steps.ValidateStep.execute(ValidateStep.java:57)\n    at org.gradle.internal.execution.steps.CaptureStateBeforeExecutionStep.execute(CaptureStateBeforeExecutionStep.java:76)\n    at org.gradle.internal.execution.steps.CaptureStateBeforeExecutionStep.execute(CaptureStateBeforeExecutionStep.java:50)\n    at org.gradle.internal.execution.steps.SkipEmptyWorkStep.lambda$execute$2(SkipEmptyWorkStep.java:93)\n    at org.gradle.internal.execution.steps.SkipEmptyWorkStep.execute(SkipEmptyWorkStep.java:93)\n    at org.gradle.internal.execution.steps.SkipEmptyWorkStep.execute(SkipEmptyWorkStep.java:34)\n    at org.gradle.internal.execution.steps.legacy.MarkSnapshottingInputsStartedStep.execute(MarkSnapshottingInputsStartedStep.java:38)\n    at org.gradle.internal.execution.steps.LoadPreviousExecutionStateStep.execute(LoadPreviousExecutionStateStep.java:43)\n    at org.gradle.internal.execution.steps.LoadPreviousExecutionStateStep.execute(LoadPreviousExecutionStateStep.java:31)\n    at org.gradle.internal.execution.steps.AssignWorkspaceStep.lambda$execute$0(AssignWorkspaceStep.java:40)\n    at org.gradle.api.internal.tasks.execution.TaskExecution$3.withWorkspace(TaskExecution.java:284)\n    at org.gradle.internal.execution.steps.AssignWorkspaceStep.execute(AssignWorkspaceStep.java:40)\n    at org.gradle.internal.execution.steps.AssignWorkspaceStep.execute(AssignWorkspaceStep.java:30)\n    at org.gradle.internal.execution.steps.IdentityCacheStep.execute(IdentityCacheStep.java:37)\n    at org.gradle.internal.execution.steps.IdentityCacheStep.execute(IdentityCacheStep.java:27)\n    at org.gradle.internal.execution.steps.IdentifyStep.execute(IdentifyStep.java:44)\n    at org.gradle.internal.execution.steps.IdentifyStep.execute(IdentifyStep.java:33)\n    at org.gradle.internal.execution.impl.DefaultExecutionEngine$1.execute(DefaultExecutionEngine.java:76)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeIfValid(ExecuteActionsTaskExecuter.java:142)\n    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:131)\n    at org.gradle.api.internal.tasks.execution.CleanupStaleOutputsExecuter.execute(CleanupStaleOutputsExecuter.java:77)\n    at org.gradle.api.internal.tasks.execution.FinalizePropertiesTaskExecuter.execute(FinalizePropertiesTaskExecuter.java:46)\n    at org.gradle.api.internal.tasks.execution.ResolveTaskExecutionModeExecuter.execute(ResolveTaskExecutionModeExecuter.java:51)\n    at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:57)\n    at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:56)\n    at org.gradle.api.internal.tasks.execution.CatchExceptionTaskExecuter.execute(CatchExceptionTaskExecuter.java:36)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.executeTask(EventFiringTaskExecuter.java:77)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:55)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter$1.call(EventFiringTaskExecuter.java:52)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:204)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:199)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:53)\n    at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:73)\n    at org.gradle.api.internal.tasks.execution.EventFiringTaskExecuter.execute(EventFiringTaskExecuter.java:52)\n    at org.gradle.execution.plan.LocalTaskNodeExecutor.execute(LocalTaskNodeExecutor.java:74)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:402)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$InvokeNodeExecutorsAction.execute(DefaultTaskExecutionGraph.java:389)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$BuildOperationAwareExecutionAction.execute(DefaultTaskExecutionGraph.java:382)\n    at org.gradle.execution.taskgraph.DefaultTaskExecutionGraph$BuildOperationAwareExecutionAction.execute(DefaultTaskExecutionGraph.java:368)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.lambda$run$0(DefaultPlanExecutor.java:127)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.execute(DefaultPlanExecutor.java:191)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.executeNextNode(DefaultPlanExecutor.java:182)\n    at org.gradle.execution.plan.DefaultPlanExecutor$ExecutorWorker.run(DefaultPlanExecutor.java:124)\n    at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:64)\n    at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:48)\n    at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:61)\nCaused by: com.android.aaptcompiler.ResourceCompilationException: Resource compilation failed (Failed to compile values resource file E:\\My Client\\Henkako\\HenkakoPlus\\app\\build\\intermediates\\incremental\\debug\\mergeDebugResources\\merged.dir\\values\\values.xml. Cause: java.lang.IllegalStateException: Can not extract resource from com.android.aaptcompiler.ParsedResource@636e1e76.). Check logs for more details.\n    at com.android.aaptcompiler.ResourceCompiler.compileResource(ResourceCompiler.kt:129)\n    at com.android.build.gradle.internal.res.ResourceCompilerRunnable$Companion.compileSingleResource(ResourceCompilerRunnable.kt:34)\n    at com.android.build.gradle.internal.res.ResourceCompilerRunnable.run(ResourceCompilerRunnable.kt:15)\n    at com.android.build.gradle.internal.profile.ProfileAwareWorkAction.execute(ProfileAwareWorkAction.kt:74)\n    at org.gradle.workers.internal.DefaultWorkerServer.execute(DefaultWorkerServer.java:63)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:66)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:62)\n    at org.gradle.internal.classloader.ClassLoaderUtils.executeInClassloader(ClassLoaderUtils.java:97)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1.lambda$execute$0(NoIsolationWorkerFactory.java:62)\n    at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:44)\n    at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:41)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:204)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:199)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:53)\n    at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:73)\n    at org.gradle.workers.internal.AbstractWorker.executeWrappedInBuildOperation(AbstractWorker.java:41)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1.execute(NoIsolationWorkerFactory.java:59)\n    at org.gradle.workers.internal.DefaultWorkerExecutor.lambda$submitWork$2(DefaultWorkerExecutor.java:206)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runExecution(DefaultConditionalExecutionQueue.java:214)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runBatch(DefaultConditionalExecutionQueue.java:164)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.run(DefaultConditionalExecutionQueue.java:131)\n    ... 3 more\nCaused by: com.android.aaptcompiler.ResourceCompilationException: Failed to compile values resource file E:\\My Client\\Henkako\\HenkakoPlus\\app\\build\\intermediates\\incremental\\debug\\mergeDebugResources\\merged.dir\\values\\values.xml\n    at com.android.aaptcompiler.ResourceCompiler.compileTable(ResourceCompiler.kt:192)\n    at com.android.aaptcompiler.ResourceCompiler.access$compileTable(ResourceCompiler.kt:1)\n    at com.android.aaptcompiler.ResourceCompiler$getCompileMethod$1.invoke(ResourceCompiler.kt:138)\n    at com.android.aaptcompiler.ResourceCompiler$getCompileMethod$1.invoke(ResourceCompiler.kt:138)\n    at com.android.aaptcompiler.ResourceCompiler.compileResource(ResourceCompiler.kt:123)\n    ... 27 more\nCaused by: java.lang.IllegalStateException: Can not extract resource from com.android.aaptcompiler.ParsedResource@636e1e76.\n    at com.android.aaptcompiler.TableExtractor.extractResourceValues(TableExtractor.kt:270)\n    at com.android.aaptcompiler.TableExtractor.extract(TableExtractor.kt:181)\n    at com.android.aaptcompiler.ResourceCompiler.compileTable(ResourceCompiler.kt:188)\n    ... 31 more\n</code></pre>\n"},{"comments":[{"comment_id":134474727,"body":"this is documented here in <a href=\"https://docs.spring.io/spring-security/reference/servlet/oauth2/resource-server/jwt.html#oauth2resourceserver-jwt-authorization-extraction\" rel=\"nofollow noreferrer\">docs.spring.io/spring-security/reference/servlet/oauth2/&hellip;</a> in the spring security documentation here is a fully documented example with code, and a large blogpost about how to do what you want to do <a href=\"https://github.com/Tandolf/spring-security-jwt-demo\" rel=\"nofollow noreferrer\">github.com/Tandolf/spring-security-jwt-demo</a>"}],"answers":[{"answer_id":76255841,"body":"<p>Finally, I implemented a new class to convert granted authorities:</p>\n<pre><code>public class JwtGrantedAuthoritiesConverter implements Converter&lt;Jwt, Collection&lt;GrantedAuthority&gt;&gt; {\n\n    @Override\n    public Collection&lt;GrantedAuthority&gt; convert(Jwt jwt) {\n        List&lt;Map&lt;String, String&gt;&gt; authorities = jwt.getClaim(&quot;authorities&quot;);\n\n        return authorities.stream()\n                .map(authority -&gt; new SimpleGrantedAuthority(authority.get(&quot;authority&quot;)))\n                .collect(Collectors.toList());\n    }\n}\n</code></pre>\n<p>Then I use it in SecurityFilterChain:</p>\n<pre><code>                .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt(jwt -&gt; {\n                    jwt.decoder(jwtDecoder);\n                    jwt.jwtAuthenticationConverter(jwtAuthenticationConverter());\n                }));\n</code></pre>\n"},{"answer_id":76313432,"body":"<p>With <code>spring-boot-starter-oauth2-resource-server</code> dependency you can also do that with out-of-box <a href=\"https://github.com/spring-projects/spring-security/blob/main/oauth2/oauth2-resource-server/src/main/java/org/springframework/security/oauth2/server/resource/authentication/JwtAuthenticationConverter.java\" rel=\"nofollow noreferrer\">JwtAuthenticationConverter</a> class by just defining an additional <code>@Bean</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\npublic JwtAuthenticationConverter jwtAuthenticationConverter() {\n    final JwtGrantedAuthoritiesConverter grantedAuthoritiesConverter = new JwtGrantedAuthoritiesConverter();\n    grantedAuthoritiesConverter.setAuthoritiesClaimName(&quot;authorities&quot;); // defaults to &quot;scope&quot; or &quot;scp&quot;\n    grantedAuthoritiesConverter.setAuthorityPrefix(&quot;&quot;); // defaults to &quot;SCOPE_&quot;\n\n    final JwtAuthenticationConverter jwtAuthenticationConverter = new JwtAuthenticationConverter();\n    jwtAuthenticationConverter.setJwtGrantedAuthoritiesConverter(grantedAuthoritiesConverter);\n    return jwtAuthenticationConverter;\n}\n</code></pre>\n<p>With it you don't need to additionally configure your <code>JwtDecoder</code> and set any converters manually to a security filter chain config.<br />\nThis converter supports authorities claim as array and as string, in case of string representation consider defining delimiter using <a href=\"https://github.com/spring-projects/spring-security/blob/main/oauth2/oauth2-resource-server/src/main/java/org/springframework/security/oauth2/server/resource/authentication/JwtGrantedAuthoritiesConverter.java#L91\" rel=\"nofollow noreferrer\"><code>setAuthoritiesClaimDelimiter()</code></a> method, default is <code>&quot; &quot;</code> (single space character).</p>\n"}],"last_activity_date":1684838949,"question_id":76255236,"body":"<p>I am developing a Java service using JDK 17, Spring Boot 3, and Spring Security 6.0.3. The service is an API that requires validation of a JWT token using a public key.</p>\n<p>I have the following security configuration in SecurityConfig.java:</p>\n<pre><code>import org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.web.SecurityFilterChain;\n\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n    public static final String ADMIN = &quot;ROLE_ADMIN&quot;;\n\n    private static final String[] AUTH_WHITELIST = {\n        &quot;/actuator/**&quot;,\n    };\n\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http, JwtDecoder jwtDecoder) throws Exception {\n        http\n            .csrf().disable()\n            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n            .and()\n            .formLogin().disable()\n            .authorizeHttpRequests(requests -&gt; requests\n                .requestMatchers(AUTH_WHITELIST).permitAll()\n                .requestMatchers(&quot;/api/test/**&quot;).hasAnyAuthority(ADMIN)\n                .anyRequest().authenticated()\n            )\n            .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt(jwt -&gt; {\n                jwt.decoder(jwtDecoder);\n            }));\n\n        return http.build();\n    }\n}\n</code></pre>\n<p>In addition, the AppConfig.java class contains the following code:</p>\n<pre><code>import lombok.RequiredArgsConstructor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.core.convert.converter.Converter;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\n\nimport java.time.Instant;\nimport java.util.*;\n\n@Configuration\n@RequiredArgsConstructor\npublic class AppConfig {\n    private final RsaKeyProperties rsaKeys;\n\n    @Bean\n    JwtDecoder jwtDecoder() {\n        return NimbusJwtDecoder.withPublicKey(rsaKeys.publicKey()).build();\n    }\n}\n</code></pre>\n<p>The problem I'm facing is that Spring Security is not loading the authorities as expected. The following log message shows an authenticated token, but the &quot;Granted Authorities&quot; are empty:</p>\n<blockquote>\n<p>2023-05-15T16:26:39.048+02:00 DEBUG 74733 --- [nio-8080-exec-3]\no.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token\n2023-05-15T16:26:39.048+02:00 DEBUG 74733 --- [nio-8080-exec-3]\n.s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder\nto JwtAuthenticationToken\n[Principal=org.springframework.security.oauth2.jwt.Jwt@d70a35df,\nCredentials=[PROTECTED], Authenticated=true,\nDetails=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1,\nSessionId=null], Granted Authorities=[]]</p>\n</blockquote>\n<p>I have even tried using a custom Converter in AppConfig.java to convert the claims and add the authorities, but the issue persists. Here is the relevant code from AppConfig.java:</p>\n<pre><code>import lombok.RequiredArgsConstructor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.core.convert.converter.Converter;\nimport org.springframework.security.oauth2.jwt.JwtDecoder;\nimport org.springframework.security.oauth2.jwt.NimbusJwtDecoder;\n\nimport java.time.Instant;\nimport java.util.*;\n\n@Configuration\n@RequiredArgsConstructor\npublic class AppConfig {\n    private final RsaKeyProperties rsaKeys;\n\n    @Bean\n    JwtDecoder jwtDecoder() {\n        NimbusJwtDecoder jwtDecoder = NimbusJwtDecoder.withPublicKey(rsaKeys.publicKey()).build();\n        jwtDecoder.setClaimSetConverter(getClaimConverter());\n        return jwtDecoder;\n    }\n\n    private Converter&lt;Map&lt;String, Object&gt;, Map&lt;String, Object&gt;&gt; getClaimConverter() {\n        return claims -&gt; {\n            Map&lt;String, Object&gt; mutableClaims = new HashMap&lt;&gt;(claims);\n\n            // Convert 'exp' and 'iat' fields to Instant\n            if (claims.containsKey(&quot;exp&quot;)) {\n                Date expDate = (Date) claims.get(&quot;exp&quot;);\n                Instant expInstant = expDate.toInstant();\n                mutableClaims.put(&quot;exp&quot;, expInstant);\n            }\n\n            if (claims.containsKey(&quot;iat&quot;)) {\n                Date iatDate = (Date) claims.get(&quot;iat&quot;);\n                Instant iatInstant = iatDate.toInstant();\n                mutableClaims.put(&quot;iat&quot;, iatInstant);\n            }\n\n            // Hardcoded authorities for testing\n            List&lt;String&gt; authorities = List.of(&quot;ROLE_ADMIN&quot;);\n            mutableClaims.put(&quot;authorities&quot;, authorities);\n\n            System.out.println(&quot;Claims: &quot; + claims);\n            System.out.println(&quot;Mutable claims: &quot; + mutableClaims);\n\n            return mutableClaims;\n        };\n    }\n}\n</code></pre>\n<p>Despite these modifications, the &quot;Granted Authorities&quot; in the authentication token are still empty. As a result, I receive a 403 Forbidden response with the following message:</p>\n<blockquote>\n<p>www-authenticate: Bearer error=&quot;insufficient_scope&quot;,\nerror_description=&quot;The request requires higher privileges than\nprovided by the access token.&quot;,\nerror_uri=&quot;https://tools.ietf.org/html/rfc6750#section-3.1&quot; I have\nalso tested with hardcoding the authorities to ensure that the token\nformat is not the issue. However, the authorities are still not\nproperly loaded.</p>\n</blockquote>\n<p>I would greatly appreciate any guidance or suggestions on how to resolve this issue and ensure that the authorities are correctly loaded in Spring Security based on the provided token.</p>\n<p>Thank you in advance for your help!</p>\n<hr />\n<p>Edit 1</p>\n<p>Token example</p>\n<pre><code>{\n  &quot;sub&quot;: &quot;admin@example.com&quot;,\n  &quot;iss&quot;: &quot;self&quot;,\n  &quot;exp&quot;: 1684164375,\n  &quot;token_type&quot;: &quot;access_token&quot;,\n  &quot;iat&quot;: 1684160775,\n  &quot;authorities&quot;: [\n    &quot;ROLE_TEST&quot;,\n    &quot;ROLE_ADMIN&quot;,\n  ]\n}\n</code></pre>\n"},{"answers":[{"comments":[{"comment_id":32114236,"body":"user1177636: Your previous code was Integer.toHexString(&lt;String&gt;), but parameter should be integer as Integer.toHexString(&lt;int&gt;)"}],"answer_id":19669109,"body":"<p>First a quote from Selenium's documentation.</p>\n\n<blockquote>\n  <p>Get the value of a given CSS property. Color values should be returned\n  as rgba strings, so, for example if the \"background-color\" property is\n  set as \"green\" in the HTML source, the returned value will be \"rgba(0,\n  255, 0, 1)\". Note that shorthand CSS properties (e.g. background,\n  font, border, border-top, margin, margin-top, padding, padding-top,\n  list-style, outline, pause, cue) are not returned, in accordance with\n  the DOM CSS2 specification - you should directly access the longhand\n  properties (e.g. background-color) to access the desired values.</p>\n</blockquote>\n\n<p>Then this is not a Selenium specific question, this is just a general programming question about how to parse string <code>rgba(102,102,102)</code> to three number.</p>\n\n<pre><code>// Originally untested code, just the logic.\n// Thanks for Ripon Al Wasim's correction.\n\nString color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\n\nString[] numbers = color.replace(\"rgba(\", \"\").replace(\")\", \"\").split(\",\");\nint r = Integer.parseInt(numbers[0].trim());\nint g = Integer.parseInt(numbers[1].trim());\nint b = Integer.parseInt(numbers[2].trim());\nSystem.out.println(\"r: \" + r + \"g: \" + g + \"b: \" + b);\n\nString hex = \"#\" + Integer.toHexString(r) + Integer.toHexString(g) + Integer.toHexString(b);\nSystem.out.println(hex);\n</code></pre>\n"},{"comments":[{"comment_id":74736314,"body":"In &quot;Way 2&quot; you are only using <code>numbers[0]</code>, when I believe you should actually be using <code>numbers[0]</code>, <code>numbers[1]</code> and <code>numbers[2]</code>"},{"comment_id":81778390,"body":"Thanks  Victor Moraes to highlight the mistake. Yes, it should be numbers[0], numbers[1] and numbers[2]. I have corrected accordingly."},{"comment_id":85405878,"body":"&quot;Way 2&quot;: The hex values should most likely be padded with leading 0&#39;s. I am here because a <code>driver.getElement().getCssValue(&quot;background-color&quot;) </code> returns and rgba value: rgba(198, 15, 19, 1). DevTools gives a hex value: #c60f13, the above code returns #c6f13. suggest <code>String hex = String.format(&quot;#%02x%02x%02x&quot;, r,g,b);</code>"}],"answer_id":21307354,"body":"<p>Way 1: Using StringTokenizer:</p>\n\n<pre><code>String color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\nString s1 = color.substring(4);\ncolor = s1.replace(')', ' ');\nStringTokenizer st = new StringTokenizer(color);\nint r = Integer.parseInt(st.nextToken(\",\").trim());\nint g = Integer.parseInt(st.nextToken(\",\").trim());\nint b = Integer.parseInt(st.nextToken(\",\").trim());\nColor c = new Color(r, g, b);\nString hex = \"#\"+Integer.toHexString(c.getRGB()).substring(2);\nSystem.out.println(hex);\n</code></pre>\n\n<p>Way 2:</p>\n\n<pre><code>String color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\nString[] numbers = color.replace(\"rgb(\", \"\").replace(\")\", \"\").split(\",\");\nint r = Integer.parseInt(numbers[0].trim());\nint g = Integer.parseInt(numbers[1].trim());\nint b = Integer.parseInt(numbers[2].trim());\nSystem.out.println(\"r: \" + r + \"g: \" + g + \"b: \" + b);\nString hex = \"#\" + Integer.toHexString(r) + Integer.toHexString(g) + Integer.toHexString(b);\nSystem.out.println(hex);\n</code></pre>\n"},{"answer_id":43850214,"body":"<p>I know this is rather old, but you can get a simpler solution by using <code>org.openqa.selenium.support.Color</code>:</p>\n\n<pre><code>import org.openqa.selenium.support.Color;\nString color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\nSystem.out.println(color);\nString hex = Color.fromString(color).asHex();\nSystem.out.println(hex);\n</code></pre>\n\n<p>It gives you a single line solution and even adds leading zeroes when required (something that the previous answers aren't accounting for)</p>\n"},{"comments":[{"comment_id":75335753,"body":"I don&#39;t think a single letter typo in my answer would be a reason to add another answer to this. Just edit it, as you did. Plus, when you say &quot;The code works, but just a little typo&quot; it is not clear which code you&#39;re talking about. I know you&#39;re referring to mine because I received the notification, but for newcomers it might not be that clear. If you insist in providing a separate answer, I&#39;d advise adding a link to mine, for clarity. By the way, now that you edit my answer, yours is just a duplicate of mine with nothing to add (and it&#39;s even obsolete, since mine doesn&#39;t have typos anymore)"},{"comment_id":75336572,"body":"thanks bro, i couldn&#39;t edit or comment because i am under 15"}],"answer_id":44144119,"body":"<p>The code works, but just a little typo. The Color.fromString would be upper case C</p>\n\n<pre><code>import org.openqa.selenium.support.Color;\n\nString color = driver.findElement(By.xpath(\"xpath_value\")).getCssValue(\"color\");\nSystem.out.println(color);\nString hex = Color.fromString(color).asHex();\nSystem.out.println(hex);\n</code></pre>\n"},{"answer_id":76313855,"body":"<pre><code>import org.openqa.selenium.support.Color;\n\nString color = driver.findElement(By.xpath(&quot;xpath_value&quot;)).getCssValue(&quot;color&quot;);\nSystem.out.println(color);\nString hex = Color.fromString(color).asHex();\nSystem.out.println(hex);\n</code></pre>\n<p>just a simple and sweet code will help you to get a answer</p>\n"}],"last_activity_date":1684838560,"question_id":19668893,"body":"<p>In the following code I need to print the <code>color</code> in <code>Hex format</code>. </p>\n\n<p><em>First</em> Print statement is showing value in <code>RGB</code> format which is <code>rgb(102,102,102)</code>.</p>\n\n<p>The <em>Second</em> statement is showing value in <code>Hex</code>  which is <code>#666666</code></p>\n\n<p>But I am manually entering the value into the second print statement which is <code>102,102,102</code>.</p>\n\n<p>Is there any way to pass the value which I got from the 1st statement (Color) into the second print statement and get result?</p>\n\n<pre><code>import org.openqa.selenium.By;\nimport org.openqa.selenium.WebDriver;\nimport org.openqa.selenium.firefox.FirefoxDriver;\n\npublic class Google {\n\n    public static void main(String[] args) throws Exception {\n\n        WebDriver driver = new FirefoxDriver();\n        driver.get(\"http://www.google.com/\");\n        String Color = driver.findElement(By.xpath(\"//div[@class='gb_e gb_f gb_g gb_xb']/a\")).getCssValue(\"color\");\n        System.out.println(Color);\n        String hex = String.format(\"#%02x%02x%02x\", 102,102,102);\n        System.out.println(hex);\n    }\n}\n</code></pre>\n"}]}